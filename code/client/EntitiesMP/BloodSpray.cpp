/*
 * This file is generated by Entity Class Compiler, (c) CroTeam 1997-98
 */

#line 2 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"

#include "StdH.h"

#include <BloodSpray.h>
#include <BloodSpray_tables.h>
CEntityEvent *ESpawnSpray::MakeCopy(void) { 	CEntityEvent *peeCopy = new ESpawnSpray(*this); 	return peeCopy;}
SLONG ESpawnSpray::GetSizeOf(void) { 	return sizeof(*this);}
ESpawnSpray::ESpawnSpray() : CEntityEvent(EVENTCODE_ESpawnSpray) {
	ClearToDefault(sptType);
	ClearToDefault(fDamagePower);
	ClearToDefault(fSizeMultiplier);
	ClearToDefault(vDirection);
	ClearToDefault(eidOwner);
	ClearToDefault(colCentralColor);
	ClearToDefault(fLaunchPower);
	ClearToDefault(colBurnColor);
}
BOOL ESpawnSpray::CheckIDs(void) {	return TRUE && eidOwner.IsValid(); }

void CBloodSpray::SetDefaultProperties(void) {
	m_sptType = SPT_NONE ;
	m_tmStarted = 0.0f;
	m_vDirection = FLOAT3D(0 , 0 , 0);
	m_penOwner = NULL;
	m_fDamagePower = 1.0f;
	m_boxSizedOwner = FLOATaabbox3D(FLOAT3D (0 , 0 , 0) , 0.01f);
	m_vGDir = FLOAT3D(0 , 0 , 0);
	m_fGA = 0.0f;
	m_fLaunchPower = 1.0f;
	m_colCentralColor = COLOR(C_WHITE  | CT_OPAQUE );
	m_boxOriginalOwner = FLOATaabbox3D(FLOAT3D (0 , 0 , 0) , 0.01f);
	m_colBurnColor = COLOR(C_WHITE  | CT_OPAQUE );
	m_iOwner = -1;
	m_penPrediction = NULL;
	CRationalEntity::SetDefaultProperties();
}

#line 47 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
void CBloodSpray::InitializeFromNet() 
#line 48 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 49 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
ESpawnSpray  eSpawn ;
#line 50 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . sptType  = m_sptType ;
#line 51 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . vDirection  = m_vDirection ;
#line 53 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . fDamagePower  = m_fDamagePower ;
#line 54 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . fLaunchPower  = m_fLaunchPower ;
#line 55 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . colBurnColor  = m_colBurnColor ;
#line 57 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . colCentralColor  = m_colCentralColor ;
#line 59 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
CEntity  * penEntity ;
#line 60 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(m_iOwner  == - 1){
#line 61 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . eidOwner  = (CEntity  *) NULL ;
#line 62 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}else {
#line 63 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
_pNetwork  -> ga_World  . EntityExists  (m_iOwner  , penEntity );
#line 64 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
eSpawn  . eidOwner  = penEntity ;
#line 65 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 67 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Initialize  (eSpawn );
#line 68 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}

#line 71 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
void CBloodSpray::RenderParticles(void) 
#line 72 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
BOOL CBloodSpray::
#line 136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Main(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CBloodSpray_Main
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_ESpawnSpray, "CBloodSpray::Main expects 'ESpawnSpray' as input!");	const ESpawnSpray &eSpawn = (const ESpawnSpray &)__eeInput;
#line 138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
InitAsEditorModel  ();
#line 139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
SetPhysicsFlags  (EPF_MODEL_IMMATERIAL );
#line 140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
SetCollisionFlags  (ECF_IMMATERIAL );
#line 143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
SetModel  (MODEL_MARKER );
#line 144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
SetModelMainTexture  (TEXTURE_MARKER );
#line 147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(((CEntity  *) eSpawn  . eidOwner ) == NULL  || ((CEntity  *) eSpawn  . eidOwner ) -> en_pmoModelObject  == NULL )
#line 148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Destroy  ();
#line 151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Return(STATE_CURRENT,EVoid());
#line 151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
return TRUE;
#line 152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_sptType  = eSpawn  . sptType ;
#line 156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_vDirection  = eSpawn  . vDirection ;
#line 157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_penOwner  = eSpawn  . eidOwner ;
#line 158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_fDamagePower  = eSpawn  . fDamagePower ;
#line 159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_fLaunchPower  = eSpawn  . fLaunchPower ;
#line 160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_colBurnColor  = eSpawn  . colBurnColor ;
#line 161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_tmStarted  = _pTimer  -> CurrentTick  ();
#line 162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_colCentralColor  = eSpawn  . colCentralColor ;
#line 164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_iOwner  = m_penOwner  -> en_ulID ;
#line 166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(((CEntity  *) eSpawn  . eidOwner ) -> en_RenderType  == RT_SKAMODEL  || 
#line 167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
((CEntity  *) eSpawn  . eidOwner ) -> en_RenderType  == RT_SKAEDITORMODEL )
#line 168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
((CEntity  *) eSpawn  . eidOwner ) -> GetSize  (m_boxOriginalOwner );
#line 170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_boxSizedOwner  = m_boxOriginalOwner ;
#line 171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
FLOAT3D vStretchVector  = FLOAT3D (eSpawn  . fSizeMultiplier  , eSpawn  . fSizeMultiplier  , eSpawn  . fSizeMultiplier );
#line 172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_boxSizedOwner  . StretchByVector  (vStretchVector );
#line 173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
else 
#line 175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
((CEntity  *) eSpawn  . eidOwner ) -> en_pmoModelObject  -> GetCurrentFrameBBox  (m_boxSizedOwner );
#line 177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_boxOriginalOwner  = m_boxSizedOwner ;
#line 178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_boxSizedOwner  . StretchByVector  (((CEntity  *) eSpawn  . eidOwner ) -> en_pmoModelObject  -> mo_Stretch  * eSpawn  . fSizeMultiplier );
#line 179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_boxOriginalOwner  . StretchByVector  (((CEntity  *) eSpawn  . eidOwner ) -> en_pmoModelObject  -> mo_Stretch );
#line 180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(! _pNetwork  -> IsServer  () && (m_penOwner  -> GetPhysicsFlags  () & EPF_MOVABLE ) && (m_penOwner  -> en_pciCollisionInfo  != NULL )){
#line 183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
CMovableEntity  * penMovable  = (CMovableEntity  *) ((CEntity  *) m_penOwner );
#line 184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
penMovable  -> TestFields  (penMovable  -> en_iUpContent  , penMovable  -> en_iDnContent  , penMovable  -> en_fImmersionFactor );
#line 185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(m_penOwner  -> GetPhysicsFlags  () & EPF_MOVABLE ){
#line 188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_vGDir  = ((CMovableEntity  *) & * m_penOwner ) -> en_vGravityDir ;
#line 189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_fGA  = ((CMovableEntity  *) & * m_penOwner ) -> en_fGravityA ;
#line 190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}else {
#line 191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
FLOATmatrix3D & m  = m_penOwner  -> en_mRotation ;
#line 192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_vGDir  = FLOAT3D (- m  (1 , 2) , - m  (2 , 2) , - m  (3 , 2));
#line 193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
m_fGA  = 30.0f;
#line 194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
FLOAT fWaitTime  = 4.0f;
#line 197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
if(m_sptType  == SPT_ELECTRICITY_SPARKS  || m_sptType  == SPT_ELECTRICITY_SPARKS_NO_BLOOD )
#line 198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
{
#line 199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
fWaitTime  = 4.0f;
#line 200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
}
#line 201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
SetTimerAfter(fWaitTime );
Jump(STATE_CURRENT, 0x025b0001, FALSE, EBegin());return TRUE;}BOOL CBloodSpray::H0x025b0001_Main_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x025b0001
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x025b0002, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CBloodSpray::H0x025b0002_Main_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x025b0002
;
#line 202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Destroy  ();
#line 204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
Return(STATE_CURRENT,EVoid());
#line 204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/BloodSpray.es"
return TRUE; ASSERT(FALSE); return TRUE;};