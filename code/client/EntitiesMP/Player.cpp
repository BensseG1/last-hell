/*
 * This file is generated by Entity Class Compiler, (c) CroTeam 1997-98
 */

#line 2 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"

	
#include "StdH.h"
#include "GameMP/SEColors.h"
	
#include <Engine/Build.h>
#include <locale.h>
	
#include "ModelsMP/Player/SeriousSam/Player.h"
#include "ModelsMP/Player/SeriousSam/Body.h"
#include "ModelsMP/Player/SeriousSam/Head.h"
#include "EntitiesMP/Common/CharacterDefinition.h"

#include "EntitiesMP/PlayerMarker.h"
#include "EntitiesMP/PlayerAnimator.h"
#include "EntitiesMP/PlayerView.h"
#include "EntitiesMP/MovingBrush.h"
#include "EntitiesMP/Switch.h"
#include "EntitiesMP/Camera.h"
#include "EntitiesMP/WorldLink.h"
#include "EntitiesMP/Pet.h"
#include "EntitiesMP/WildPet.h"
#include "EntitiesMP/Slave.h"
#include "EntitiesMP/EnemySpawner.h"
#include "EntitiesMP/PlayerActionMarker.h"
#include "EntitiesMP/WorldSettingsController.h"
#include "EntitiesMP/HudPicHolder.h"
#include "EntitiesMP/DoorController.h"
#include "EntitiesMP/WorldBase.h"

//강동민 수정 시작 시스템 싱글던젼 개선	10.07
// 고정 시점 카메라 & 제한 영역
#include "EntitiesMP/Common/FixedCameraContainer.h"
//강동민 수정 끝 싱글던젼 개선		10.07
	
//안태훈 수정 시작	//(Add & Modify SSSE Effect)(0.1)	
#include <Engine/Effect/CSkaEffect.h>
//안태훈 수정 끝	//(Add & Modify SSSE Effect)(0.1)
//안태훈 수정 시작	//(Zone Change System)(0.1)
#include <Engine/Interface/UIInternalClasses.h>
#include <Engine/Interface/UIManager.h>
//안태훈 수정 끝	//(Zone Change System)(0.1)
//안태훈 수정 시작	//(5th Closed beta)(0.2)
#define PICKING_EFFECT_REMAIN_TIME (0.0f)
//안태훈 수정 끝	//(5th Closed beta)(0.2)

#include <Engine/GlobalDefinition.h>
#include <Engine/Terrain/Terrain.h>

#include <Engine/Interface/UIAutoHelp.h> 
#include <Engine/Interface/UISignBoard.h> 
#include <Engine/Interface/UISiegeWarfareDoc.h>
#include <Engine/Contents/Base/UINoticeNew.h>
#include <Engine/Interface/UIFlowerTree.h>
#include <Engine/Interface/UIPlayerInfo.h>
#include <Engine/Contents/Base/UIPartyNew.h>
#include <Engine/Interface/UISiegeWarfareNew.h>
#include <Engine/Interface/UIGuildBattle.h>
#include <Engine/Contents/Base/UICharacterInfoNew.h>
#include <Engine/Interface/UIReformSystem.h>
#include <Engine/Interface/UISelectResource.h>
#include <Engine/Interface/UIGuildWarPortal.h>
#include <Engine/Contents/function/GuildStashUI.h>
#include <Engine/Interface/UIBilling.h>
#include <Engine/Contents/function/UIPortalNew.h>
#include <Engine/Interface/UIGuild.h>
#include <Engine/Contents/Base/UIQuestNew.h>
#include <Engine/Contents/Base/UIChangeWeaponNew.h>
#include <Engine/Interface/UIResurrection.h>
#include <Engine/Contents/function/AffinityUI.h>
#include <Engine/Interface/UIRadar.h>
#include <Engine/Interface/UIInitJob.h>
#include <Engine/Contents/function/WildPetInfoUI.h>
#include <Engine/Interface/UIGamble.h>
#include <Engine/Interface/UIMonsterMercenary.h>
#include <engine/Contents/function/SystemMenuUI.h>

#include <Engine/TransformInfo.h>
#include <Engine/Contents/function/SummonUI.h>
#include <Engine/Interface/UIPetInfo.h>
#include <Engine/GameDataManager/GameDataManager.h>
#include <Engine/Contents/Base/ExpressSystem.h>
#include <Engine/Contents/Login/ServerSelect.h>
#include <Engine/Contents/Login/CharacterSelect.h>
#include <Engine/Contents/Login/UICharacterCreateNew.h>
#include <Engine/Contents/Base/Notice.h>
#include <Engine/LoginJobInfo.h>
#include <Engine/Interface/UIQuickSlot.h>
#include <Engine/Contents/Base/UISkillNew.h>
#include <Engine/Contents/Base/UIQuestAccept.h>
#include <Engine/Contents/Base/Party.h>
#include <algorithm>
#include <Engine/GameStageManager/StageMgr.h>
#include <Engine/Object/ActorMgr.h>
#include <Engine/Contents/Base/PersonalshopUI.h>

#include <Common/Packet/ptype_old_do_action.h>
#include <Common/Packet/ptype_old_do_skill.h>
#include <Common/Packet/ptype_old_do_move.h>
#include <Common/Packet/ptype_char_status.h>
#include <Common/Packet/ptype_appear.h>
#include <Engine/Info/MyInfo.h>
#include <Engine/Contents/function/SimplePlayerInfoUI.h>
#include <Engine/Contents/function/TitleData.h>
#include <Engine/Contents/function/PetTargetUI.h>

// Date : 2005-09-23(오전 9:27:43), By Lee Ki-hwan
// 버튼 액션시 보내던 MOVE메세지에 대한 제한을 두기위한 플래그 
#define BUTTON_MOVE_ENABLE	0

//	extern void JumpFromBouncer(CEntity *penToBounce, CEntity *penBouncer);
	// from game
#define GRV_SHOWEXTRAS  (1L<<0)   // add extra stuff like console, weapon, pause
	
// FIXME : GENDER가 쓰이는 부분도 제거대상.
#define GENDER_MALE     0
#define GENDER_FEMALE   1
#define GENDEROFFSET    100   // sound components for genders are offset by this value

#define MAX_TARGETS		20

#define SOUND_BSP_COUNT 3		// yjpark
#define SOUND_TER_COUNT 4		// yjpark

#define		HITTYPE_MISS			(1 << 0)		// 회피
#define		HITTYPE_WEAK			(1 << 1)		// 약하게
#define		HITTYPE_NORMAL			(1 << 2)		// 보통
#define		HITTYPE_STRONG			(1 << 3)		// 강하게
#define		HITTYPE_HARD			(1 << 4)		// 매우 강하게
#define		HITTYPE_CRITICAL		(1 << 5)		// 크리티컬
#define		HITTYPE_DEADLY			(1 << 6)		// 죽도록 강하게

// NOTE : 심하게 밀리는 싱글던젼...
#define	EXTREAM_SINGLEDUNGEON		(10)
	
	//0105
	//INDEX idPlayerWhole_Animation[ANIM_TOTAL]	= {0};
	ENGINE_API extern INDEX idPlayerWhole_Animation[ANIM_TOTAL];

	//INDEX idPlayerWhole_Anim_Face1 = -1;
	//INDEX idPlayerWhole_Anim_Face2 = -1;
	INDEX idPlayerWhole_Anim_Face3 = -1;
	INDEX idPlayerWhole_Anim_Face4 = -1;

	// bone ID's
	// collision boxes
	INDEX idPlayer_Collision_Stand     = -1;

#define PLAYER_ANIM_GROUP_LEGS        0x01
#define PLAYER_ANIM_GROUP_TORSO       0x02
#define PLAYER_ANIM_GROUP_WHOLEBODY   0x03

#define AREA_CASTLE_X0	1015
#define AREA_CASTLE_X1	1340
#define AREA_CASTLE_Z0	815
#define AREA_CASTLE_Z1	1173

#define AREA_CASTLE_DRATAN_X0	1570
#define AREA_CASTLE_DRATAN_X1	2024
#define AREA_CASTLE_DRATAN_Z0	105
#define AREA_CASTLE_DRATAN_Z1	650

#define MUSIC_CASTLE_AREA		CTFILENAME("data\\sounds\\game\\BGM\\GB_pease.ogg")
#define MUSIC_FIELD_AREA		CTFILENAME("data\\sounds\\game\\BGM\\GB_field01.ogg")
#define MUSIC_FIELD_ENVIRON		CTFILENAME("data\\sounds\\game\\BGM\\GBE_field.ogg")

#define MUSIC_DRATAN_ENVIRON		CTFILENAME("data\\sounds\\game\\BGM\\GBE_ruin.ogg")

#define MUSIC_DUNGEON_AREA      CTFILENAME("data\\sounds\\game\\BGM\\GB_dungeon01.ogg")
#define MUSIC_DUNGEON_ENVIRON   CTFILENAME("data\\sounds\\game\\BGM\\GBE_dungeon.ogg")

#define MUSIC_CASTLE_BATTLE		CTFILENAME("Data\\Sounds\\Game\\BGM\\GB_battletheme.ogg")
#define MUSIC_MERAC_FIELD		CTFILENAME("Data\\Sounds\\Game\\BGM\\GB_meracpease.ogg")

// egeha
#define MUSIC_EGEHA_PEASE		CTFILENAME("Data\\Sounds\\Game\\BGM\\GB_egehapease.ogg")

#define MODEL_TREASURE	("Data\\Item\\Common\\ITEM_treasure02.smc")

// Check Attack Flagg
#define ENF_EX2_PVP				(1L<<0)
#define ENF_EX2_LEGIT			(1L<<1)
#define ENF_EX2_MYPARTY			(1L<<2)
#define ENF_EX2_MYGUILD			(1L<<3)
#define ENF_EX2_ENEMYGUILD		(1L<<4)
#define ENF_EX2_WAR_OURFORCE	(1L<<5)
#define ENF_EX2_WAR_ENEMY		(1L<<6)

#ifdef CHAR_EX_ROGUE	// [2012/08/27 : Sora] EX로그 추가
	const BOOL charEXRogue = TRUE;
#else
	const BOOL charEXRogue = FALSE;
#endif
#ifdef CHAR_EX_MAGE	//2013/01/08 jeil EX메이지 추가 
	const BOOL charEXMage = TRUE;
#else
	const BOOL charEXMage = FALSE;
#endif

#ifdef HP_PERCENTAGE // 플레이어 es HP 뭐로 쓸지 [3/29/2013 Ranma]
	const BOOL bHp_Percentage = TRUE;
#else	// HP_PERCENTAGE
	const BOOL bHp_Percentage = FALSE;
#endif	// HP_PERCENTAGE

// enum으로 변경한다. 이유는 서로 겹치면 안되기 때문에 코드상 block처리함. [5/23/2011 rumist]
enum __tagRaidObjectNOutputType
{
	OBJECT_TOUCH_FIELD			= 0,				// same type : OBJECT_TOUCH_FIELD	= 0,
	OBJECT_GATE					= 1,
	OBJECT_PORTAL				= 2,
	OBJECT_ITEM					= 3,
	OBJECT_PADOX_MODEL			= 4,
	OUTPUT_TOGGLE_GATE			= 7,
	OUTPUT_TOGGLE_PORTAL		= 8,
	OUTPUT_PAUSE_AREA			= 12,
	OUTPUT_MODEL_HOLDER_PADOX	= 17,
	OUTPUT_MODEL_NPC_SAY		= 18,				// forgotten temple [5/23/2011 rumist]
};


#define JOINWAR_NONE		0; // 공성 참여 안한 그룹
#define JOINWAR_ATTACK		1; // 공성 공격 그룹
#define JOINWAR_DEFENSE		2; // 공성 수비 그룹

#define DEF_MOB_ID_DRATAN_TOWER		352
#define DEF_MOB_ID_MASTER_TOWER		399

// Raid Output Type과 Raid Object Type은 Number가 겹쳐서는 안된다.
// Raid Output Type
// #define __TOUCH_FIELD			0
// #define PAUSE_AREA				12
// #define TOGGLE_GATE				7
// #define MODEL_HOLDER_PADOX		17
// #define MODEL_NPC_SAY			18				// forgotten temple [5/23/2011 rumist]
// #define TOGGLE_PORTAL			8
// Raid Object Type
// #define OBJECT_TOUCH_FIELD		0
// #define OBJECT_GATE				1
// #define OBJECT_PORTAL			2
// #define OBJECT_ITEM				3
// #define OBJECT_PADOX_MODEL		4

#include <Player.h>
#include <Player_tables.h>
CEntityEvent *ECameraStart::MakeCopy(void) { 	CEntityEvent *peeCopy = new ECameraStart(*this); 	return peeCopy;}
SLONG ECameraStart::GetSizeOf(void) { 	return sizeof(*this);}
ECameraStart::ECameraStart() : CEntityEvent(EVENTCODE_ECameraStart) {
	ClearToDefault(penCamera);
}
BOOL ECameraStart::CheckIDs(void) {	return TRUE ; }

CEntityEvent *ECameraStop::MakeCopy(void) { 	CEntityEvent *peeCopy = new ECameraStop(*this); 	return peeCopy;}
SLONG ECameraStop::GetSizeOf(void) { 	return sizeof(*this);}
ECameraStop::ECameraStop() : CEntityEvent(EVENTCODE_ECameraStop) {
	ClearToDefault(penCamera);
}
BOOL ECameraStop::CheckIDs(void) {	return TRUE ; }

CEntityEvent *ESlaveKilledEnemy::MakeCopy(void) { 	CEntityEvent *peeCopy = new ESlaveKilledEnemy(*this); 	return peeCopy;}
SLONG ESlaveKilledEnemy::GetSizeOf(void) { 	return sizeof(*this);}
ESlaveKilledEnemy::ESlaveKilledEnemy() : CEntityEvent(EVENTCODE_ESlaveKilledEnemy) {
}
BOOL ESlaveKilledEnemy::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EAutoLogin::MakeCopy(void) { 	CEntityEvent *peeCopy = new EAutoLogin(*this); 	return peeCopy;}
SLONG EAutoLogin::GetSizeOf(void) { 	return sizeof(*this);}
EAutoLogin::EAutoLogin() : CEntityEvent(EVENTCODE_EAutoLogin) {
}
BOOL EAutoLogin::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EStopLerp::MakeCopy(void) { 	CEntityEvent *peeCopy = new EStopLerp(*this); 	return peeCopy;}
SLONG EStopLerp::GetSizeOf(void) { 	return sizeof(*this);}
EStopLerp::EStopLerp() : CEntityEvent(EVENTCODE_EStopLerp) {
	ClearToDefault(bActive);
}
BOOL EStopLerp::CheckIDs(void) {	return TRUE ; }

CEntityEvent *ERebirth::MakeCopy(void) { 	CEntityEvent *peeCopy = new ERebirth(*this); 	return peeCopy;}
SLONG ERebirth::GetSizeOf(void) { 	return sizeof(*this);}
ERebirth::ERebirth() : CEntityEvent(EVENTCODE_ERebirth) {
}
BOOL ERebirth::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EPlayerRebirth::MakeCopy(void) { 	CEntityEvent *peeCopy = new EPlayerRebirth(*this); 	return peeCopy;}
SLONG EPlayerRebirth::GetSizeOf(void) { 	return sizeof(*this);}
EPlayerRebirth::EPlayerRebirth() : CEntityEvent(EVENTCODE_EPlayerRebirth) {
	ClearToDefault(iRespawnInPlace);
}
BOOL EPlayerRebirth::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EDisconnected::MakeCopy(void) { 	CEntityEvent *peeCopy = new EDisconnected(*this); 	return peeCopy;}
SLONG EDisconnected::GetSizeOf(void) { 	return sizeof(*this);}
EDisconnected::EDisconnected() : CEntityEvent(EVENTCODE_EDisconnected) {
}
BOOL EDisconnected::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EAutoAction::MakeCopy(void) { 	CEntityEvent *peeCopy = new EAutoAction(*this); 	return peeCopy;}
SLONG EAutoAction::GetSizeOf(void) { 	return sizeof(*this);}
EAutoAction::EAutoAction() : CEntityEvent(EVENTCODE_EAutoAction) {
	ClearToDefault(eidFirstMarker);
}
BOOL EAutoAction::CheckIDs(void) {	return TRUE && eidFirstMarker.IsValid(); }

CEntityEvent *EPlayerKilledEnemy::MakeCopy(void) { 	CEntityEvent *peeCopy = new EPlayerKilledEnemy(*this); 	return peeCopy;}
SLONG EPlayerKilledEnemy::GetSizeOf(void) { 	return sizeof(*this);}
EPlayerKilledEnemy::EPlayerKilledEnemy() : CEntityEvent(EVENTCODE_EPlayerKilledEnemy) {
	ClearToDefault(eidEnemy);
	ClearToDefault(iScore);
	ClearToDefault(eCauseOfDeath);
	ClearToDefault(eKillType);
}
BOOL EPlayerKilledEnemy::CheckIDs(void) {	return TRUE && eidEnemy.IsValid(); }

CEntityEvent *EPlayerDeath::MakeCopy(void) { 	CEntityEvent *peeCopy = new EPlayerDeath(*this); 	return peeCopy;}
SLONG EPlayerDeath::GetSizeOf(void) { 	return sizeof(*this);}
EPlayerDeath::EPlayerDeath() : CEntityEvent(EVENTCODE_EPlayerDeath) {
	ClearToDefault(eidInflictor);
	ClearToDefault(vDirection);
	ClearToDefault(vHitPoint);
	ClearToDefault(fAmount);
	ClearToDefault(dmtType);
}
BOOL EPlayerDeath::CheckIDs(void) {	return TRUE && eidInflictor.IsValid(); }

CEntityEvent *EShowConsole::MakeCopy(void) { 	CEntityEvent *peeCopy = new EShowConsole(*this); 	return peeCopy;}
SLONG EShowConsole::GetSizeOf(void) { 	return sizeof(*this);}
EShowConsole::EShowConsole() : CEntityEvent(EVENTCODE_EShowConsole) {
}
BOOL EShowConsole::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EPlayerStats::MakeCopy(void) { 	CEntityEvent *peeCopy = new EPlayerStats(*this); 	return peeCopy;}
SLONG EPlayerStats::GetSizeOf(void) { 	return sizeof(*this);}
EPlayerStats::EPlayerStats() : CEntityEvent(EVENTCODE_EPlayerStats) {
	ClearToDefault(iIndex);
	ClearToDefault(iFrags);
	ClearToDefault(iKills);
	ClearToDefault(iDeaths);
}
BOOL EPlayerStats::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EAddBulletSpray::MakeCopy(void) { 	CEntityEvent *peeCopy = new EAddBulletSpray(*this); 	return peeCopy;}
SLONG EAddBulletSpray::GetSizeOf(void) { 	return sizeof(*this);}
EAddBulletSpray::EAddBulletSpray() : CEntityEvent(EVENTCODE_EAddBulletSpray) {
	ClearToDefault(vPos);
	ClearToDefault(eptType);
	ClearToDefault(vReflected);
}
BOOL EAddBulletSpray::CheckIDs(void) {	return TRUE ; }

CEntityEvent *EAddGoreSpray::MakeCopy(void) { 	CEntityEvent *peeCopy = new EAddGoreSpray(*this); 	return peeCopy;}
SLONG EAddGoreSpray::GetSizeOf(void) { 	return sizeof(*this);}
EAddGoreSpray::EAddGoreSpray() : CEntityEvent(EVENTCODE_EAddGoreSpray) {
	ClearToDefault(iEntityHit);
	ClearToDefault(vPos);
	ClearToDefault(vHit);
	ClearToDefault(sptType);
	ClearToDefault(colParticles);
}
BOOL EAddGoreSpray::CheckIDs(void) {	return TRUE ; }

#line 361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"

// ----------------------------------------------------------------<<
INDEX	m_timeCnt = 0; // 락체크(3초후 락을 풀어줌) wooss 060515
UBYTE	m_checkLock =0;
// ----------------------------------------------------------------->>
extern void HUD_DrawSkaModel(CDrawPort *pdpCurrent, HUD_MLData *hud_MLData,  FLOAT fMinX, FLOAT fMinY, FLOAT fMaxX, FLOAT fMaxY, FLOAT fDistance, FLOAT fHeight);
extern void HUD_DrawSkaModel_Old(CDrawPort *pdpCurrent, HUD_MLData *hud_MLData,  FLOAT fMinX, FLOAT fMinY, FLOAT fMaxX, FLOAT fMaxY, FLOAT fDistance, FLOAT fHeight);
extern void DrawHUD( const CPlayer *penPlayerCurrent, CDrawPort *pdpCurrent, BOOL bSnooping, const CPlayer *penPlayerOwner);
extern void InitHUD(void);
extern void EndHUD(void);
extern void CameraEffect(const CPlacement3D &plPlr, CPlacement3D &plCam);

static CTimerValue _tvProbingLast;
static BOOL _bTripleHead = FALSE;
static BOOL _bSeparatedTripleHead = FALSE;

// used to render certain entities only for certain players (like picked items, etc.)
extern ULONG _ulPlayerRenderingMask = 0;
extern FLOAT _fAttackLengthMul = 1.0f; //0.8이된다. 애니메이션 길이는 짧아짐.
extern FLOAT _fAttackSpeedMul =  1.0f; //1.2이 된다.
// temporary BOOL used to discard calculating of 3rd view when calculating absolute view placement
BOOL _bDiscard3rdView=FALSE;

//#define NAME name

const FLOAT _fBlowUpAmmount = 70.0f;

//강동민 수정 시작 싱글던젼 스토리	10.12
// 고정 시점 카메라.
static BOOL _bInFixedCamera	= FALSE;
//강동민 수정 끝 싱글던젼 스토리	10.12

//강동민 수정 시작 벽타기	10.21
//static BOOL _bOldClimbWall = FALSE;
//강동민 수정 끝 벽타기	10.21

static BOOL _bPersonalShop = FALSE;

extern ENGINE_API INDEX g_iAutoAttack;
extern ENGINE_API INDEX g_iCountry;

// computer message adding flags
#define CMF_READ       (1L<<0)
#define CMF_ANALYZE    (1L<<1)

struct MarkerDistance {
public:
	FLOAT md_fMinD;
	CPlayerMarker *md_ppm;
	void Clear(void);
};

/*
#define MAX_DEATH	(100)
struct	DeathTable {

	CEntity*  m_penDeathEntity;
	FLOAT	DeathTime;
	BOOL	bActive;
};
*/

//DeathTable _DeathTable[MAX_DEATH];

// export current player projection
CAnyProjection3D prPlayerProjection;

//안태훈 수정 시작	//(Effect Add & Modify for Close Beta)(0.1)
static INDEX g_iPCMinBrightness = 32;
static INDEX g_iChaLightModifyValue = 255;
//안태훈 수정 끝	//(Effect Add & Modify for Close Beta)(0.1)

int qsort_CompareMarkerDistance(const void *pv0, const void *pv1)
{
	MarkerDistance &md0 = *(MarkerDistance*)pv0;
	MarkerDistance &md1 = *(MarkerDistance*)pv1;
	if(      md0.md_fMinD<md1.md_fMinD) return +1;
	else if( md0.md_fMinD>md1.md_fMinD) return -1;
	else                                return  0;
}

static inline FLOAT IntensityAtDistance( FLOAT fFallOff, FLOAT fHotSpot, FLOAT fDistance)
{
	// intensity is zero if further than fall-off range
	if( fDistance>fFallOff) return 0.0f;
	// intensity is maximum if closer than hot-spot range
	if( fDistance<fHotSpot) return 1.0f;
	// interpolate if between fall-off and hot-spot range
	return (fFallOff-fDistance)/(fFallOff-fHotSpot);
}

static CTString MakeEmptyString(INDEX ctLen, char ch=' ')
{
	char ach[2];
	ach[0] = ch;
	ach[1] = 0;
	CTString strSpaces;
	for (INDEX i=0; i<ctLen; i++) {
		strSpaces+=ach;
	}
	return strSpaces;
}

// take a two line string and align into one line of minimum given length
static INDEX _ctAlignWidth = 20;
static CTString AlignString(const CTString &strOrg)
{
	// split into two lines
	CTString strL = strOrg;
	strL.OnlyFirstLine();
	CTString strR = strOrg;
	strR.RemovePrefix(strL);
	strR.DeleteChar(0);
	
	// get their lengths
	INDEX iLenL = strL.LengthNaked();
	INDEX iLenR = strR.LengthNaked();
	
	// find number of spaces to insert
	INDEX ctSpaces = _ctAlignWidth-(iLenL+iLenR);
	if (ctSpaces<1) {
		ctSpaces=1;
	}
	
	// make aligned string
	return strL+MakeEmptyString(ctSpaces)+strR;
}

static CTString CenterString(const CTString &str)
{
	INDEX ctSpaces = (_ctAlignWidth-str.LengthNaked())/2;
	if (ctSpaces<0) {
		ctSpaces=0;
	}
	return MakeEmptyString(ctSpaces)+str;
}

static CTString PadStringRight(const CTString &str, INDEX iLen)
{
	INDEX ctSpaces = iLen-str.LengthNaked();
	if (ctSpaces<0) {
		ctSpaces=0;
	}
	return str+MakeEmptyString(ctSpaces);
}

static CTString PadStringLeft(const CTString &str, INDEX iLen)
{
	INDEX ctSpaces = iLen-str.LengthNaked();
	if (ctSpaces<0) {
		ctSpaces=0;
	}
	return MakeEmptyString(ctSpaces)+str;
}

static void DumpEnemies(void)
{
	// get the world pointer
	CWorld *pwo = (CWorld *)_pShell->GetINDEX("pwoCurrentWorld");
	// if there is no current world
	if (pwo==NULL) return;
	// for each entity in the world
	{FOREACHINDYNAMICCONTAINER(pwo->wo_cenEntities, CEntity, iten) {
		CEntity *pen = iten;
		if( IsDerivedFromClass( pen, &CEnemyBase_DLLClass) && !((CEnemyBase*)pen)->m_bTemplate) {
			FLOAT3D vPos=pen->GetPlacement().pl_PositionVector;
			CPrintF("Class: %s, Name: %s, ID: %d, Coordinates(%d,%d,%d)\n", 
				pen->GetClass()->ec_pdecDLLClass->dec_strName, pen->GetName(),
				pen->en_ulID, (INDEX)vPos(1), (INDEX)vPos(2), (INDEX)vPos(3));
		}
	}}
}

static void DumpSpawners(void)
{
	// get the world pointer
	CWorld *pwo = (CWorld *)_pShell->GetINDEX("pwoCurrentWorld");
	// if there is no current world
	if (pwo==NULL) return;
	// for each entity in the world
	{FOREACHINDYNAMICCONTAINER(pwo->wo_cenEntities, CEntity, iten) {
		CEntity *pen = iten;
		if( IsDerivedFromClass( pen, &CEnemySpawner_DLLClass)) {
			CEnemySpawner *penSpawner = (CEnemySpawner *)pen;
			FLOAT3D vPos=pen->GetPlacement().pl_PositionVector;
			CTString strEnemyClass="Unknown";
			CTString strEnemyName="Unknown";
			if(penSpawner->m_penTarget!=NULL)
			{
				strEnemyClass=penSpawner->m_penTarget->GetClass()->ec_pdecDLLClass->dec_strName+CTString("'s");
				strEnemyName=penSpawner->m_penTarget->GetName();
			}
			CPrintF("Spawner: %s (ID=%d), Pos=%d,%d,%d Not spawned yet %d enemies of class \"%s\", named: \"%s\")\n", 
				pen->GetName(), pen->en_ulID, (INDEX)vPos(1), (INDEX)vPos(2), (INDEX)vPos(3),
				penSpawner->m_ctTotal, strEnemyClass, strEnemyName);
		}
	}}
}

static int HP_FloatToInt(float fCurHp, int Percentage)
{
	int nHp = 0;
	if (fCurHp > 0)
	{
		nHp = fCurHp * Percentage;

		if (nHp <= 0)
			nHp = 1;
	}
	return nHp;
}

static void GoTo(FLOAT x, FLOAT y, FLOAT z, FLOAT r)
{
	CPlayer *pen=(CPlayer *)CEntity::GetPlayerEntity(0);
	if(pen!=NULL)
	{
		CPlacement3D plWhere=CPlacement3D(FLOAT3D(x,y,z),ANGLE3D(r,0,0));
		pen->GetPlayerWeapons()->m_penReservedTarget	= NULL;
		pen->GetPlayerWeapons()->m_penRayHitTmp			= NULL;
		pen->Teleport(plWhere, FALSE);
		((CMovableEntity*)pen)->m_bFallDownToFloor = TRUE;
	}
}

//-----------------------------------------------------------------------------
// Purpose: 컨테이너 내의 모든 엔티티에 한번에 데미지를 줍니다.
// Input  : pEntity - 
//			sTI - 
//			vCenter - 
// Output : static void
//-----------------------------------------------------------------------------
void DamagedTargetsInRange(CEntity* pEntity, CSelectedEntities& dcEntities, enum DamageType dmtType, FLOAT fDamageAmmount, FLOAT3D vCenter, BOOL bSkill)
{	
	if(dcEntities.Count() <= 0)	return;

	for( ENTITIES_ITERATOR it = dcEntities.vectorSelectedEntities.begin();
		it != dcEntities.vectorSelectedEntities.end(); ++it )
	{
		if ((*it) == NULL)
		{
			continue;
		}

		CEntity &en = *(*it);
		
		if (en.en_RenderType != CEntity::RT_SKAMODEL || !(en.GetFlags() & ENF_ALIVE))
		{
			continue;
		}

		//CEntity *pEn = iten;
		FLOAT3D vHitPos;
		
		CModelInstance *pMI = en.GetModelInstance();
		if(!pMI)
		{
			continue;
		}

		//pEntity->InflictDirectDamage( (*it), pEntity, DMT_EXPLOSION,
		//	15.0f, vHitPos, (vHitPos-vCenter).Normalize() );

		if( _pNetwork->m_bSingleMode )
		{				
			// 10번 월드의 경우...
			if( g_slZone == EXTREAM_SINGLEDUNGEON )
			{
				//pEntity->CheckModelRangeDamage(en, vCenter, fMinD, vHitPos);
				pEntity->InflictDirectDamage( (*it), pEntity, dmtType, fDamageAmmount, vCenter, vCenter.Normalize() );
			}
			// 기타 다른 월드의 경우....
			else
			{
				pEntity->InflictDirectDamage( (*it), pEntity, dmtType, bSkill ? 30.0f : 15.0f, vCenter, vCenter.Normalize() );
			}
		}
		else
		{
			pEntity->InflictDirectDamage( (*it), pEntity, dmtType, fDamageAmmount, vCenter, vCenter.Normalize() );
		}
	}
};

#define HEADING_MAX      45.0f
#define PITCH_MAX        85.0f
#define BANKING_MAX      45.0f

// player flags
#define PLF_INITIALIZED           (1UL<<0)   // set when player entity is ready to function
#define PLF_VIEWROTATIONCHANGED   (1UL<<1)   // for adjusting view rotation separately from legs
#define PLF_JUMPALLOWED           (1UL<<2)   // if jumping is allowed
//#define PLF_SYNCWEAPON            (1UL<<3)   // weapon model needs to be synchronized before rendering
#define PLF_AUTOMOVEMENTS         (1UL<<4)   // complete automatic control of movements
#define PLF_DONTRENDER            (1UL<<5)   // don't render view (used at end of level)
#define PLF_CHANGINGLEVEL         (1UL<<6)   // mark that we next are to appear at start of new level
#define PLF_APPLIEDACTION         (1UL<<7)   // used to detect when player is not connected
#define PLF_NOTCONNECTED          (1UL<<8)   // set if the player is not connected
#define PLF_LEVELSTARTED          (1UL<<9)   // marks that level start time was recorded
#define PLF_ISZOOMING             (1UL<<10)  // marks that player is zoomed in with the sniper
#define PLF_RESPAWNINPLACE        (1UL<<11)  // don't move to marker when respawning (for current death only)
#define PLF_REAPPLYINGACTIONS     (1UL<<12)  // mark that we're reapplying actions (client local prediction)  

// defines representing flags used to fill player buttoned actions
#define PLACT_FIRE                (1L<<0)
//#define PLACT_RELOAD              (1L<<1)
//#define PLACT_WEAPON_NEXT         (1L<<2)
//#define PLACT_WEAPON_PREV         (1L<<3)
//#define PLACT_WEAPON_FLIP         (1L<<4)

// FIXME : 어느 순간부터 PLACT_USE 쓰는 부분이 다 막혀있음, 그래서 카메라 마커 동작중에 안먹는듯함...
#define PLACT_USE                 (1L<<5)
#define PLACT_3RD_PERSON_VIEW     (1L<<7)
#define PLACT_CENTER_VIEW         (1L<<8)
#define PLACT_USE_HELD            (1L<<9)
#define PLACT_SELECT_WEAPON_SHIFT (14)
#define PLACT_SELECT_WEAPON_MASK  (0x1FL<<PLACT_SELECT_WEAPON_SHIFT)

#define PICKEDREPORT_TIME   (2.0f)  // how long (picked-up) message stays on screen
// KALYDO
/*
struct PlayerControls 
{
	FLOAT fMoveForward;
	FLOAT fMoveBackward;
	FLOAT fMoveLeft;
	FLOAT fMoveRight;
	FLOAT fMoveUp;
	FLOAT fMoveDown;
	
	FLOAT fTurnLeft;
	FLOAT fTurnRight;
	FLOAT fTurnUp;
	FLOAT fTurnDown;
	FLOAT fTurnBankingLeft;
	FLOAT fTurnBankingRight;	
	
	FLOAT fLookLeft;
	FLOAT fLookRight;
	FLOAT fLookUp;
	FLOAT fLookDown;
	FLOAT fLookBankingLeft;
	FLOAT fLookBankingRight;
	
#define CTL_DIGITAL_FIRST bCenterView
	
	BOOL bCenterView;
	//BOOL bSelectWeapon[MAX_WEAPONS+1];
	//BOOL bWeaponNext;
	//BOOL bWeaponPrev;
	//BOOL bWeaponFlip;
	
	BOOL bWalk;
	BOOL bStrafe;
	BOOL bFire;	
	BOOL bUse;
	BOOL b3rdPersonView;	
};
*/

// KALYDO
//static struct PlayerControls pctlCurrent;


// cheats
static INDEX cht_iGoToMarker = -1;
static INDEX cht_bKillAll    = FALSE;
static INDEX cht_bKillAllAuto = FALSE;
static INDEX cht_bKillAllInLevel = FALSE;
static INDEX cht_bStartDebugTrigger = FALSE;
static INDEX cht_bGiveAll    = FALSE;
static INDEX cht_bOpen       = FALSE;
static INDEX cht_bAllMessages= FALSE;
static INDEX cht_bRefresh    = FALSE;
extern INDEX cht_bGod        = FALSE;
extern INDEX cht_bFly        = FALSE;
extern INDEX cht_bGhost      = FALSE;
extern INDEX cht_bInvisible  = FALSE;
extern FLOAT cht_fTranslationMultiplier = 1.0f;
extern INDEX cht_bEnable     = 0;   

// interface control
static INDEX hud_bShowAll	    = TRUE; // used internaly in menu/console
//extern INDEX hud_bShowWeapon  = TRUE;
//extern INDEX hud_bShowMessages = TRUE;
extern INDEX hud_bShowInfo    = TRUE;
extern INDEX hud_bShowLatency = FALSE;
extern INDEX hud_iShowPlayers = -1;   // auto
extern INDEX hud_iSortPlayers = -1;   // auto
extern FLOAT hud_fOpacity     = 0.9f;
extern FLOAT hud_fScaling     = 1.0f;
//extern FLOAT hud_tmWeaponsOnScreen = 3.0f;
extern FLOAT hud_tmLatencySnapshot = 1.0f;
//extern INDEX hud_bShowMatchInfo = TRUE;
//extern INDEX hud_bShowFloatingScore = TRUE;

extern FLOAT plr_fBreathingStrength = 0.0f;
extern FLOAT plr_tmSnoopingTime;
//extern INDEX cht_bKillFinalBoss = FALSE;
//INDEX cht_bDebugFinalBoss = FALSE;
//INDEX cht_bDumpFinalBossData = FALSE;
//INDEX cht_bDebugFinalBossAnimations = FALSE;
INDEX cht_bDumpPlayerShading = FALSE;

// misc
static FLOAT plr_fAcceleration  = 1000.0f;
static FLOAT plr_fDeceleration  = 600.0f;
/*static FLOAT plr_fSpeedForward  = 10.0f;
static FLOAT plr_fSpeedBackward = 10.0f;
static FLOAT plr_fSpeedSide     = 10.0f;*/
//0105 1line 삭제
//static FLOAT plr_fSpeed         = 10.0f;
//0105
static FLOAT plr_fSpeed         = 5.0f;
static FLOAT plr_fSpeedTmp         = 0.0f;
//..
static FLOAT plr_fSpeedUp       = 11.0f;
static FLOAT plr_fViewHeightStand  = 1.9f;
//static FLOAT plr_fViewHeightCrouch = 0.7f;
static FLOAT plr_fViewHeightSwim   = 0.4f;
static FLOAT plr_fViewHeightDive   = 0.0f;
extern FLOAT plr_fViewDampFactor        = 0.4f;
extern FLOAT plr_fViewDampLimitGroundUp = 0.1f;
extern FLOAT plr_fViewDampLimitGroundDn = 0.4f;
extern FLOAT plr_fViewDampLimitWater    = 0.1f;
static FLOAT plr_fFrontClipDistance = 0.25f;
static FLOAT plr_fFarClipDistance = 500.0f;
static FLOAT plr_fFOV = 90.0f;
static FLOAT gfx_fTripleHeadFOVBias = 1.4f;  // not too much

static FLOAT net_tmLatencyAvg;
extern INDEX plr_bRenderPicked = FALSE;
extern INDEX plr_bRenderPickedParticles = FALSE;
extern INDEX plr_bOnlySam = FALSE;
extern INDEX ent_bReportBrokenChains = FALSE;
extern FLOAT ent_tmMentalIn   = 0.5f;
extern FLOAT ent_tmMentalOut  = 0.75f;
extern FLOAT ent_tmMentalFade = 0.5f;
static INDEX plr_bRespawnInPlaceCoop = TRUE;

extern FLOAT gfx_fEnvParticlesDensity = 1.0f;
extern FLOAT gfx_fEnvParticlesRange   = 1.0f;

static FLOAT plr_fSwimSoundDelay = 0.8f;
static FLOAT plr_fDiveSoundDelay = 1.6f;
static FLOAT plr_fWalkSoundDelay = 0.6f;//0.5f; //0323
static FLOAT plr_fRunSoundDelay  = 0.415f;//0.35f;//0.3f;

//static FLOAT ctl_tmComputerDoubleClick = 0.5f; // double click delay for calling computer
//static FLOAT _tmLastUseOrCompPressed = -10.0f;  // for computer doubleclick

extern INDEX gam_iBlood = 2;     // 0=none, 1=green, 2=red, 3=hippie
extern INDEX gam_bGibs  = TRUE;

// speeds for button rotation
static FLOAT ctl_fButtonRotationSpeedH = 300.0f;
static FLOAT ctl_fButtonRotationSpeedP = 150.0f;
static FLOAT ctl_fButtonRotationSpeedB = 150.0f;
// modifier for axis strafing
static FLOAT ctl_fAxisStrafingModifier = 1.0f;

static BOOL plr_bSetRespawn = FALSE;

//0530 kwon 추가
static unsigned int tmStartTime = 0;

//0625 kwon
static ANGLE aWantedHeadingRelativeTmp = 0;
static BOOL g_bIsRotating = FALSE;
static FLOAT3D g_vMove = FLOAT3D(0,0,0);
static FLOAT3D g_vMoveDirection = FLOAT3D(0,0,0);
static BOOL g_bIsRotateEnd = FALSE;
static BOOL g_bFirstRotate = FALSE;
static FLOAT3D g_bTargetDirection = FLOAT3D(0,0,0);

//0722
static BOOL g_bPreSkill  = FALSE; 
static BOOL g_bDoSkill   = FALSE;
static BOOL g_bPostSkill = FALSE;
static FLOAT g_deltaX = 0;
static FLOAT g_deltaZ = 0;

extern INDEX dbg_bShowEnemyBodyPoint = FALSE;

extern ENGINE_API BOOL g_bHead_change; // 일본 헬멧 추가 관련 

// set when computer is called on level start
DECL_DLL extern BOOL cmp_bLevelStart = FALSE;
// set to play video before and after end of level
//DECL_DLL extern CTString cmp_strVideo1 = "";
//DECL_DLL extern CTString cmp_strVideo2 = "";
//DECL_DLL extern CTString cmp_strVideoInGame = "";

// !=NULL if some player wants to call computer
DECL_DLL extern class CPlayer *cmp_ppenPlayer = NULL;
// !=NULL for rendering computer on secondary display in dualhead
DECL_DLL extern class CPlayer *cmp_ppenDHPlayer = NULL;
// set to update current message in background mode (for dualhead)
DECL_DLL extern BOOL cmp_bUpdateInBackground = FALSE;
// set for initial calling computer without rendering game
DECL_DLL extern BOOL cmp_bInitialStart = FALSE;

// game sets this for player hud and statistics and hiscore sound playing
//DECL_DLL extern INDEX plr_iHiScore = 0.0f;

// these define address and size of player controls structure
DECL_DLL extern void *ctl_pvPlayerControls = &pctlCurrent;
DECL_DLL extern const SLONG ctl_slPlayerControlsSize = sizeof(pctlCurrent);

// called to compose action packet from current controls
DECL_DLL void ctl_ComposeActionPacket(const CPlayerCharacter &pc, CPlayerAction &paAction, BOOL bPreScan)
{
//	return;//0114

	CPlayerSettings *pps = (CPlayerSettings *)pc.pc_aubAppearance;
	
	// find local player, if any
	CPlayer *penThis = (CPlayer *)CEntity::GetPlayerEntity(pc.pc_iPlayerIndex);
	
	// if not found
	if (penThis==NULL) {
		// do nothing
		return;
	}
	
	// accumulate local rotation
	FLOAT3D &vRotation = penThis->m_aLocalRotation;
	FLOAT3D &vViewRotation = penThis->m_aLocalViewRotation;
	FLOAT3D &vTranslation  = penThis->m_vLocalTranslation;
//	FLOAT3D vHeadingforDir = GetHeadingDirection(penThis->m_aHeadingRotation);
	
	//  CPrintF("compose: prescan %d, x:%g\n", bPreScan, paAction.pa_aRotation(1));

/*	if (_pInput->GetInputDevice(1)->id_aicControls[KID_W].ic_fValue > 0.0f)
	{
		pctlCurrent.fMoveForward = _pInput->GetInputDevice(1)->id_aicControls[KID_W].ic_fValue;
	}

	if (_pInput->GetInputDevice(1)->id_aicControls[KID_S].ic_fValue > 0.0f)
	{
		pctlCurrent.fMoveBackward = _pInput->GetInputDevice(1)->id_aicControls[KID_S].ic_fValue;
	}

	if (_pInput->GetInputDevice(1)->id_aicControls[KID_A].ic_fValue > 0.0f)
	{
		pctlCurrent.fTurnLeft = _pInput->GetInputDevice(1)->id_aicControls[KID_A].ic_fValue;
	}

	if (_pInput->GetInputDevice(1)->id_aicControls[KID_D].ic_fValue > 0.0f)
	{
		pctlCurrent.fTurnRight = _pInput->GetInputDevice(1)->id_aicControls[KID_D].ic_fValue;
	}
*/
	// 	if (_pInput->GetInputDevice(1)->id_aicControls[KID_Q].ic_fValue > 0.0f)
// 	{
// 		pctlCurrent.fMoveLeft = _pInput->GetInputDevice(1)->id_aicControls[KID_Q].ic_fValue;
// 	}
// // 	if (_pInput->GetInputDevice(1)->id_aicControls[KID_E].ic_fValue > 0.0f)
// 	{
// 		pctlCurrent.fMoveRight = _pInput->GetInputDevice(1)->id_aicControls[KID_E].ic_fValue;
// 	}
	FLOAT fMoveLeft  = pctlCurrent.fMoveLeft;
	FLOAT fMoveRight = pctlCurrent.fMoveRight;
	if(pctlCurrent.bStrafe&&pctlCurrent.fTurnLeft>0.0f) 
	{
		fMoveLeft += pctlCurrent.fTurnLeft;
	}

	if(pctlCurrent.bStrafe&&pctlCurrent.fTurnRight>0.0f) 
	{
		fMoveRight += pctlCurrent.fTurnRight;
	}
	
	// no analogue controls on move up/down
	if (pctlCurrent.fMoveDown>0.0f) pctlCurrent.fMoveDown = 1.0f;
	//if (pctlCurrent.fMoveUp  >0.0f) pctlCurrent.fMoveUp   = 1.0f;	// 점프
	//pctlCurrent.fMoveUp   = 0.0f;	// 점프
	pctlCurrent.fMoveUp   = 0.0f;	// 점프

/*
	// NOTE : 제한 영역내에서만 점프하도록 하는 루틴임.
	//--------------------------------------------------------------------------
	if(!_bLoginProcess)
	{
		// 제한 영역내에 플레이어가 들어가있다면...
		CRestrictedField *pField = FindPlayerInRestrictedField(penThis);
		if(pField)
		{
			if (pctlCurrent.fMoveUp  >0.0f) pctlCurrent.fMoveUp   = 1.0f;	// 점프
			CPrintF("제한영역 내에 들어와있습니다.!\n");
		}
		else
		{
			pctlCurrent.fMoveUp   = 0.0f;	// 점프
		}
	}
	else
	{
		pctlCurrent.fMoveUp   = 0.0f;	// 점프
	}
	*/
	//--------------------------------------------------------------------------
	
	vTranslation(1) -= fMoveLeft  * plr_fSpeed;
	vTranslation(1) += fMoveRight * plr_fSpeed;
	vTranslation(2) -= pctlCurrent.fMoveDown * plr_fSpeedUp;
	vTranslation(2) += pctlCurrent.fMoveUp   * plr_fSpeedUp;
	vTranslation(3) -= pctlCurrent.fMoveForward  * plr_fSpeed;
	vTranslation(3) += pctlCurrent.fMoveBackward * plr_fSpeed;
	//0212
	//  CPrintF(TRANS("plr_fSpeed : %f\n"), plr_fSpeed);
	
	FLOAT fSensitivityH = ((FLOAT)(pps->ps_iSensitivity)/127.0f)*0.75f;
	FLOAT fSensitivityP = ((FLOAT)(pps->ps_iSensitivity)/127.0f)*0.50f;
	
	// if not strafing
	if(!pctlCurrent.bStrafe) 
	{
/*		if (pctlCurrent.fTurnLeft != 0.0f || pctlCurrent.fTurnRight != 0.0f)
		{
			CPrintF(TRANS("Left Turn : %f, Right Turn : %f\n"), pctlCurrent.fTurnLeft, pctlCurrent.fTurnRight);
		}*/
		vRotation(1)+= pctlCurrent.fTurnLeft*(1.0f+fSensitivityH);
		vRotation(1)-= pctlCurrent.fTurnRight*(1.0f+fSensitivityH);

		SE_Get_UIManagerPtr()->GetCreateChar()->SetCharaterAngle(pctlCurrent.fTurnLeft*(1.0f+fSensitivityH),pctlCurrent.fTurnRight*(1.0f+fSensitivityH));
	}
	
	BOOL bInvertLook = pps->ps_ulFlags&PSF_INVERTLOOK;
	FLOAT fInvert = bInvertLook ? -1.0f : 1.0f;      
	
	vRotation(2)+= fInvert*(pctlCurrent.fTurnUp  *(1.0f+fSensitivityP));
	vRotation(2)-= fInvert*(pctlCurrent.fTurnDown*(1.0f+fSensitivityP));
	vRotation(3)+= pctlCurrent.fTurnBankingLeft ;
	vRotation(3)-= pctlCurrent.fTurnBankingRight;
	
	memset(&pctlCurrent, 0, offsetof(PlayerControls, CTL_DIGITAL_FIRST));
	
	paAction.pa_vTranslation  = penThis->m_vLocalTranslation;
	penThis->m_vLocalTranslation  = FLOAT3D(0,0,0);
	
	// if prescanning
	if (bPreScan) 
	{
		// no button checking
		return;
	}
	
	// use current accumulated rotation
	paAction.pa_aRotation     = penThis->m_aLocalRotation;
	paAction.pa_aViewRotation = penThis->m_aLocalViewRotation;
	
	// reset all button actions
	paAction.pa_ulButtons = 0;
	
	/*
	// set weapon selection bits
	for(INDEX i=1; i<MAX_WEAPONS; i++) 
	{
		if(pctlCurrent.bSelectWeapon[i]) 
		{
			paAction.pa_ulButtons = i<<PLACT_SELECT_WEAPON_SHIFT;
			break;
		}
	}
	*/
	// set button pressed flags
	//if(pctlCurrent.bWeaponNext) paAction.pa_ulButtons |= PLACT_WEAPON_NEXT;
	//if(pctlCurrent.bWeaponPrev) paAction.pa_ulButtons |= PLACT_WEAPON_PREV;
	//if(pctlCurrent.bWeaponFlip) paAction.pa_ulButtons |= PLACT_WEAPON_FLIP;
//	if(pctlCurrent.bFire)       paAction.pa_ulButtons |= PLACT_FIRE;//0114
	//if(pctlCurrent.bReload)     paAction.pa_ulButtons |= PLACT_RELOAD;
//	if(pctlCurrent.bUse)        paAction.pa_ulButtons |= PLACT_USE|PLACT_USE_HELD|PLACT_SNIPER_USE;
	//if(pctlCurrent.bComputer)      paAction.pa_ulButtons |= PLACT_COMPUTER;
	if(pctlCurrent.b3rdPersonView) paAction.pa_ulButtons |= PLACT_3RD_PERSON_VIEW;
	if(pctlCurrent.bCenterView)    paAction.pa_ulButtons |= PLACT_CENTER_VIEW;
	// is 'use' being held?
	//if(pctlCurrent.bUseOrComputer) paAction.pa_ulButtons |= PLACT_USE_HELD|PLACT_SNIPER_USE;

	// FIXME : Sniper들어간 부분 모두 제거하기.
	//if(pctlCurrent.bSniperZoomIn)  paAction.pa_ulButtons |= PLACT_SNIPER_ZOOMIN;
	//if(pctlCurrent.bSniperZoomOut) paAction.pa_ulButtons |= PLACT_SNIPER_ZOOMOUT;
	//if(pctlCurrent.bFireBomb)      paAction.pa_ulButtons |= PLACT_FIREBOMB;
	
	// if userorcomp just pressed
	/*
	if(pctlCurrent.bUseOrComputer && !pctlCurrent.bUseOrComputerLast) 
	{
		// if double-click is off
		if (ctl_tmComputerDoubleClick==0 || (pps->ps_ulFlags&PSF_COMPSINGLECLICK)) 
		{
			// press both
			paAction.pa_ulButtons |= PLACT_USE|PLACT_COMPUTER;
			// if double-click is on
		} 
		else 
		{
			// if double click
			if (_pTimer->GetRealTimeTick()<=_tmLastUseOrCompPressed+ctl_tmComputerDoubleClick) 
			{
				// computer pressed
				paAction.pa_ulButtons |= PLACT_COMPUTER;
				// if single click
			} 
			else 
			{
				// use pressed
				paAction.pa_ulButtons |= PLACT_USE;
			}
		}
		_tmLastUseOrCompPressed = _pTimer->GetRealTimeTick();
	}
	// remember old userorcomp pressed state
	pctlCurrent.bUseOrComputerLast = pctlCurrent.bUseOrComputer;
	*/
};

extern UINT g_uiEntityVersion;
extern ENGINE_API INDEX g_bTestClient;
extern ENGINE_API HWND  _hwndMain;
ENGINE_API char *g_szExitError;


void CPlayer_Precache(void)
{
	CDLLEntityClass *pdec = &CPlayer_DLLClass;
	
	// precache view
	extern void CPlayerView_Precache(void);
	CPlayerView_Precache();

	pdec->PrecacheSound( SOUND_DEFAULT );

	// Bsp
	pdec->PrecacheSound( SOUND_WALK_MARBLE_IN_L );
	pdec->PrecacheSound( SOUND_WALK_MARBLE_IN_R );
	pdec->PrecacheSound( SOUND_WALK_BLOCK_OUT_L );
	pdec->PrecacheSound( SOUND_WALK_BLOCK_OUT_R );
	pdec->PrecacheSound( SOUND_WALK_WOOD_OUT_L );
	pdec->PrecacheSound( SOUND_WALK_WOOD_OUT_R );

	// Terrain
	pdec->PrecacheSound( SOUND_TER_WALK_DIRT_L );
	pdec->PrecacheSound( SOUND_TER_WALK_DIRT_R );
	pdec->PrecacheSound( SOUND_TER_WALK_GRASS_L );
	pdec->PrecacheSound( SOUND_TER_WALK_GRASS_R );
	pdec->PrecacheSound( SOUND_TER_WALK_ROCK_L );
	pdec->PrecacheSound( SOUND_TER_WALK_ROCK_R );
	pdec->PrecacheSound( SOUND_TER_WALK_BLOCK_L );
	pdec->PrecacheSound( SOUND_TER_WALK_BLOCK_R );
	pdec->PrecacheSound( SOUND_WATER_WALK_SHALLOW_L );
	pdec->PrecacheSound( SOUND_WATER_WALK_SHALLOW_R );

	// Effect
	pdec->PrecacheSound( SOUND_HEALER_HEAL_PRE );
	pdec->PrecacheSound( SOUND_HEALER_HEAL_DO );
	pdec->PrecacheSound( SOUND_HEALER_PARTY_HEAL_DO );
	pdec->PrecacheSound( SOUND_HEALER_DEFENCE_MANA_DO );

	// 강신체 사운드.
	pdec->PrecacheSound( SOUND_WALK_ELENEN_WALK		);
	pdec->PrecacheSound( SOUND_WALK_ELENEN_RUN		);
	pdec->PrecacheSound( SOUND_WALK_HELL_WALK		);
	pdec->PrecacheSound( SOUND_WALK_HELL_RUN		);

	pdec->PrecacheSound( SOUND_WALK_HORSE_WALK		);
	pdec->PrecacheSound( SOUND_WALK_HORSE_RUN		);
	pdec->PrecacheSound( SOUND_WALK_DRAGON_WALK		);
	//pdec->PrecacheSound( SOUND_WALK_DRAGON_RUN		);

	pdec->PrecacheSound( SOUND_HEALER_DAMAGE );
	pdec->PrecacheSound( SOUND_MAGE_DAMAGE );
	pdec->PrecacheSound( SOUND_TITAN_DAMAGE );
	pdec->PrecacheSound( SOUND_KNIGHT_DAMAGE );
	pdec->PrecacheSound( SOUND_ROGUE_DAMAGE );
	pdec->PrecacheSound( SOUND_SORCERER_DAMAGE );

	pdec->PrecacheSound( SOUND_HEALER_ATTACK );
	pdec->PrecacheSound( SOUND_MAGE_ATTACK );
	pdec->PrecacheSound( SOUND_TITAN_ATTACK );
	pdec->PrecacheSound( SOUND_KNIGHT_ATTACK );
	pdec->PrecacheSound( SOUND_ROGUE_ATTACK );
	pdec->PrecacheSound( SOUND_SORCERER_ATTACK );

	pdec->PrecacheSound( SOUND_SWORD_BLOW );
	pdec->PrecacheSound( SOUND_SWORD_CRITICAL );
	pdec->PrecacheSound( SOUND_BIGSWORD_BLOW  );
	pdec->PrecacheSound( SOUND_BIGSWORD_CRITICAL );
	pdec->PrecacheSound( SOUND_DROP_ITEM		);
	pdec->PrecacheSound( SOUND_DROP_MONEY		);
	pdec->PrecacheSound( SOUND_PICK_ITEM		);
	pdec->PrecacheSound( SOUND_BUTTON_CLICK		);

	pdec->PrecacheSound(  SOUND_POTION  );
	pdec->PrecacheSound(  SOUND_CRAK  );
	//pdec->PrecacheSound(  SOUND_MINE  );
	pdec->PrecacheSound(  SOUND_PROCESS	);
	pdec->PrecacheSound(  SOUND_PRODUCT	);
	pdec->PrecacheSound(  SOUND_POLYMOPH );

	pdec->PrecacheSound(  SOUND_DAGGER_BLOW);
	pdec->PrecacheSound(  SOUND_DAGGER_CRITICAL);
	pdec->PrecacheSound(  SOUND_FOOT_BLOW);
	pdec->PrecacheSound(  SOUND_FOOT_CRITICAL);
	pdec->PrecacheSound(  SOUND_AXE_BLOW  );
	pdec->PrecacheSound(  SOUND_AXE_CRITICAL );

	pdec->PrecacheSound( SOUND_DAIR_STRIKE_PRE);
	pdec->PrecacheSound( SOUND_DAIR_STRIKE_BLOW1);
	pdec->PrecacheSound( SOUND_DAIR_STRIKE_BLOW2);
	pdec->PrecacheSound( SOUND_DAIR_STRIKE_BLOW3);
	pdec->PrecacheSound( SOUND_A_DAIR_STRIKE_PRE);
	pdec->PrecacheSound( SOUND_A_DAIR_STRIKE_BLOW1);
	pdec->PrecacheSound( SOUND_A_DAIR_STRIKE_BLOW2);
	pdec->PrecacheSound( SOUND_A_DAIR_STRIKE_BLOW3);
}

DECL_DLL void CheckEntityVersion()
{
	if( !((g_bTestClient && g_uiEntityVersion >= 10000) || (!g_bTestClient && g_uiEntityVersion < 10000)) )
	{
		if(g_szExitError) delete[] g_szExitError;
		g_szExitError = new char[4096];
		strcpy(g_szExitError, _S( 864, "버전 정보가 맞지 않습니다." ));
		_pGameState->Running() = FALSE;
		_pGameState->QuitScreen() = FALSE;
	}	
}

/*
//0825
void Init_DeathTable(void)
{
	for ( int i = 0; i < MAX_DEATH; ++i )
	{
		_DeathTable[i].m_penDeathEntity = NULL;
		_DeathTable[i].DeathTime		= 0.0f;
		_DeathTable[i].bActive			= FALSE;
	}
}
*/

void TestEffect()
{
	CEntity *penTarget = ((CPlayer*)CEntity::GetPlayerEntity(0))->GetPlayerWeapons()->m_penRayHitTmp;
	if(penTarget == NULL) return;
	if(penTarget->GetRenderType() != CEntity::RT_SKAMODEL) return;
	if(penTarget->GetModelInstance() == NULL) return;
	if(!penTarget->IsEnemy()) return;
	void ShotConnect(CEntity *penShoter, CEntity *penTarget, FLOAT fWaitTime
					 , const char *szHitEffectName, const char *szConnectEffectName);
	ShotConnect(CEntity::GetPlayerEntity(0), penTarget
		, 3
		, "KN_TN_Dlnk_Hit"
		, "KN_TN_Dlnk_ms"
		);
}

void CPlayer_OnInitClass(void)
{
	// clear current player controls
	memset(&pctlCurrent, 0, sizeof(pctlCurrent));
	_pShell->DeclareSymbol("void TestEffect();", TestEffect);
	_pShell->DeclareSymbol("persistent user INDEX g_iPCMinBrightness;", &g_iPCMinBrightness);
	_pShell->DeclareSymbol("persistent user INDEX g_iChaLightModifyValue;", &g_iChaLightModifyValue);
	_pShell->DeclareSymbol("persistent user INDEX gam_iBlood;", &gam_iBlood);
	_pShell->DeclareSymbol("persistent user INDEX gam_bGibs;",  &gam_bGibs);
	// declare player control variables
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveForward;",  &pctlCurrent.fMoveForward);
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveBackward;", &pctlCurrent.fMoveBackward);
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveLeft;",     &pctlCurrent.fMoveLeft);
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveRight;",    &pctlCurrent.fMoveRight);
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveUp;",       &pctlCurrent.fMoveUp);
	_pShell->DeclareSymbol("user FLOAT ctl_fMoveDown;",     &pctlCurrent.fMoveDown);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnLeft;",         &pctlCurrent.fTurnLeft);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnRight;",        &pctlCurrent.fTurnRight);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnUp;",           &pctlCurrent.fTurnUp);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnDown;",         &pctlCurrent.fTurnDown);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnBankingLeft;",  &pctlCurrent.fTurnBankingLeft);
	_pShell->DeclareSymbol("user FLOAT ctl_fTurnBankingRight;", &pctlCurrent.fTurnBankingRight);
	_pShell->DeclareSymbol("user INDEX ctl_bCenterView;",       &pctlCurrent.bCenterView);
	_pShell->DeclareSymbol("user INDEX ctl_fLookLeft;",         &pctlCurrent.fLookLeft);
	_pShell->DeclareSymbol("user INDEX ctl_fLookRight;",        &pctlCurrent.fLookRight);
	_pShell->DeclareSymbol("user INDEX ctl_fLookUp;",           &pctlCurrent.fLookUp);
	_pShell->DeclareSymbol("user INDEX ctl_fLookDown;",         &pctlCurrent.fLookDown);
	_pShell->DeclareSymbol("user INDEX ctl_fLookBankingLeft;",  &pctlCurrent.fLookBankingLeft);
	_pShell->DeclareSymbol("user INDEX ctl_fLookBankingRight;", &pctlCurrent.fLookBankingRight );
	_pShell->DeclareSymbol("user INDEX ctl_bWalk;",           &pctlCurrent.bWalk);
	_pShell->DeclareSymbol("user INDEX ctl_bStrafe;",         &pctlCurrent.bStrafe);
	_pShell->DeclareSymbol("user INDEX ctl_bFire;",           &pctlCurrent.bFire);
	//_pShell->DeclareSymbol("user INDEX ctl_bReload;",         &pctlCurrent.bReload);
	_pShell->DeclareSymbol("user INDEX ctl_bUse;",            &pctlCurrent.bUse);
	//_pShell->DeclareSymbol("user INDEX ctl_bComputer;",       &pctlCurrent.bComputer);
	//_pShell->DeclareSymbol("user INDEX ctl_bUseOrComputer;",  &pctlCurrent.bUseOrComputer);
	_pShell->DeclareSymbol("user INDEX ctl_b3rdPersonView;",  &pctlCurrent.b3rdPersonView);
	//_pShell->DeclareSymbol("user INDEX ctl_bWeaponNext;",         &pctlCurrent.bWeaponNext);
	//_pShell->DeclareSymbol("user INDEX ctl_bWeaponPrev;",         &pctlCurrent.bWeaponPrev);
	//_pShell->DeclareSymbol("user INDEX ctl_bWeaponFlip;",         &pctlCurrent.bWeaponFlip);
	//_pShell->DeclareSymbol("user INDEX ctl_bSelectWeapon[30+1];", &pctlCurrent.bSelectWeapon);
	//_pShell->DeclareSymbol("persistent user FLOAT ctl_tmComputerDoubleClick;", &ctl_tmComputerDoubleClick);
	_pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedH;", &ctl_fButtonRotationSpeedH);
	_pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedP;", &ctl_fButtonRotationSpeedP);
	_pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedB;", &ctl_fButtonRotationSpeedB);
	_pShell->DeclareSymbol("persistent user FLOAT ctl_fAxisStrafingModifier;", &ctl_fAxisStrafingModifier);
	//new
	//_pShell->DeclareSymbol("user INDEX ctl_bSniperZoomIn;",         &pctlCurrent.bSniperZoomIn);
	//_pShell->DeclareSymbol("user INDEX ctl_bSniperZoomOut;",        &pctlCurrent.bSniperZoomOut);
	//_pShell->DeclareSymbol("user INDEX ctl_bFireBomb;",             &pctlCurrent.bFireBomb);
	
	_pShell->DeclareSymbol("user FLOAT plr_fSwimSoundDelay;", &plr_fSwimSoundDelay);
	_pShell->DeclareSymbol("user FLOAT plr_fDiveSoundDelay;", &plr_fDiveSoundDelay);
	_pShell->DeclareSymbol("user FLOAT plr_fWalkSoundDelay;", &plr_fWalkSoundDelay);
	_pShell->DeclareSymbol("user FLOAT plr_fRunSoundDelay;",  &plr_fRunSoundDelay);
	
	_pShell->DeclareSymbol("     INDEX hud_bShowAll;",     &hud_bShowAll);
	_pShell->DeclareSymbol("user INDEX hud_bShowInfo;",    &hud_bShowInfo);
	_pShell->DeclareSymbol("user const FLOAT net_tmLatencyAvg;", &net_tmLatencyAvg);
	_pShell->DeclareSymbol("persistent user INDEX hud_bShowLatency;", &hud_bShowLatency);
	_pShell->DeclareSymbol("persistent user INDEX hud_iShowPlayers;", &hud_iShowPlayers);
	_pShell->DeclareSymbol("persistent user INDEX hud_iSortPlayers;", &hud_iSortPlayers);
	//_pShell->DeclareSymbol("persistent user INDEX hud_bShowWeapon;",  &hud_bShowWeapon);
	//_pShell->DeclareSymbol("persistent user INDEX hud_bShowMessages;",&hud_bShowMessages);
	_pShell->DeclareSymbol("persistent user FLOAT hud_fScaling;",     &hud_fScaling);
	_pShell->DeclareSymbol("persistent user FLOAT hud_fOpacity;",     &hud_fOpacity);
//	_pShell->DeclareSymbol("persistent user INDEX hud_bShowFloatingScore;", &hud_bShowFloatingScore);  
	//_pShell->DeclareSymbol("persistent user FLOAT hud_tmWeaponsOnScreen;",  &hud_tmWeaponsOnScreen);
	_pShell->DeclareSymbol("persistent user FLOAT hud_tmLatencySnapshot;",  &hud_tmLatencySnapshot);
	_pShell->DeclareSymbol("persistent user FLOAT plr_fBreathingStrength;", &plr_fBreathingStrength);
//	_pShell->DeclareSymbol("INDEX cht_bKillFinalBoss;",  &cht_bKillFinalBoss);
//	_pShell->DeclareSymbol("INDEX cht_bDebugFinalBoss;", &cht_bDebugFinalBoss);
//	_pShell->DeclareSymbol("INDEX cht_bDumpFinalBossData;", &cht_bDumpFinalBossData);
//	_pShell->DeclareSymbol("INDEX cht_bDebugFinalBossAnimations;", &cht_bDebugFinalBossAnimations);
	_pShell->DeclareSymbol("INDEX cht_bDumpPlayerShading;", &cht_bDumpPlayerShading);
	//_pShell->DeclareSymbol("persistent user INDEX hud_bShowMatchInfo;", &hud_bShowMatchInfo);
	
	// cheats
	_pShell->DeclareSymbol("user INDEX cht_bGod;",       &cht_bGod);
	_pShell->DeclareSymbol("user INDEX cht_bFly;",       &cht_bFly);
	_pShell->DeclareSymbol("user INDEX cht_bGhost;",     &cht_bGhost);
	_pShell->DeclareSymbol("user INDEX cht_bInvisible;", &cht_bInvisible);
	_pShell->DeclareSymbol("user INDEX cht_bGiveAll;",   &cht_bGiveAll);
	_pShell->DeclareSymbol("user INDEX cht_bKillAll;",   &cht_bKillAll);
	_pShell->DeclareSymbol("user INDEX cht_bKillAllAuto;",   &cht_bKillAllAuto);
	_pShell->DeclareSymbol("user INDEX cht_bKillAllInLevel;",   &cht_bKillAllInLevel);
	_pShell->DeclareSymbol("user INDEX cht_bStartDebugTrigger;", &cht_bStartDebugTrigger);
	_pShell->DeclareSymbol("user INDEX cht_bOpen;",      &cht_bOpen);
	_pShell->DeclareSymbol("user INDEX cht_bAllMessages;", &cht_bAllMessages);
	_pShell->DeclareSymbol("user FLOAT cht_fTranslationMultiplier ;", &cht_fTranslationMultiplier);
	_pShell->DeclareSymbol("user INDEX cht_bRefresh;", &cht_bRefresh);
	// this one is masqueraded cheat enable variable
	_pShell->DeclareSymbol("INDEX cht_bEnable;", &cht_bEnable);
	
	// this cheat is always enabled
	_pShell->DeclareSymbol("user INDEX cht_iGoToMarker;", &cht_iGoToMarker);
	
	// debug variables
	_pShell->DeclareSymbol("void DumpEnemies(void);", &DumpEnemies);
	_pShell->DeclareSymbol("void DumpSpawners(void);", &DumpSpawners);
	//_pShell->DeclareSymbol("void DumpZombies(void);", &DumpZombies);
	_pShell->DeclareSymbol("void GoTo(INDEX, INDEX, INDEX);", &GoTo);
	_pShell->DeclareSymbol("user INDEX dbg_bEnemyKillTest;", &dbg_bEnemyKillTest);  
	_pShell->DeclareSymbol("persistent user INDEX dbg_bShowEnemyBodyPoint;", &dbg_bShowEnemyBodyPoint);  
	
	// player speed and view parameters, not declared except in internal build
#if 1
	_pShell->DeclareSymbol("user FLOAT plr_fViewHeightStand;", &plr_fViewHeightStand);
	//_pShell->DeclareSymbol("user FLOAT plr_fViewHeightCrouch;",&plr_fViewHeightCrouch);
	_pShell->DeclareSymbol("user FLOAT plr_fViewHeightSwim;",  &plr_fViewHeightSwim);
	_pShell->DeclareSymbol("user FLOAT plr_fViewHeightDive;",  &plr_fViewHeightDive);
	_pShell->DeclareSymbol("user FLOAT plr_fViewDampFactor;",         &plr_fViewDampFactor);
	_pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitGroundUp;",  &plr_fViewDampLimitGroundUp);
	_pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitGroundDn;",  &plr_fViewDampLimitGroundDn);
	_pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitWater;",     &plr_fViewDampLimitWater);
	_pShell->DeclareSymbol("user FLOAT plr_fAcceleration;",  &plr_fAcceleration);
	_pShell->DeclareSymbol("user FLOAT plr_fDeceleration;",  &plr_fDeceleration);
	/*_pShell->DeclareSymbol("user FLOAT plr_fSpeedForward;",  &plr_fSpeedForward);
	_pShell->DeclareSymbol("user FLOAT plr_fSpeedBackward;", &plr_fSpeedBackward);
	_pShell->DeclareSymbol("user FLOAT plr_fSpeedSide;",     &plr_fSpeedSide);*/
	_pShell->DeclareSymbol("user FLOAT plr_fSpeed;",         &plr_fSpeed);
	_pShell->DeclareSymbol("user FLOAT plr_fSpeedUp;",       &plr_fSpeedUp);
#endif
	_pShell->DeclareSymbol("persistent user FLOAT plr_fFOV;", &plr_fFOV);
	_pShell->DeclareSymbol("persistent user FLOAT plr_fFrontClipDistance;", &plr_fFrontClipDistance);
	_pShell->DeclareSymbol("persistent user FLOAT plr_fFarClipDistance;", &plr_fFarClipDistance);
	_pShell->DeclareSymbol("persistent user FLOAT gfx_fTripleHeadFOVBias;", &gfx_fTripleHeadFOVBias);
	_pShell->DeclareSymbol("persistent user INDEX plr_bRenderPicked;", &plr_bRenderPicked);
	_pShell->DeclareSymbol("persistent user INDEX plr_bRenderPickedParticles;", &plr_bRenderPickedParticles);
	_pShell->DeclareSymbol("persistent user INDEX plr_bOnlySam;", &plr_bOnlySam);
	_pShell->DeclareSymbol("persistent user INDEX ent_bReportBrokenChains;", &ent_bReportBrokenChains);
	_pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalIn  ;", &ent_tmMentalIn  );
	_pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalOut ;", &ent_tmMentalOut );
	_pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalFade;", &ent_tmMentalFade);
	_pShell->DeclareSymbol("persistent user FLOAT gfx_fEnvParticlesDensity;", &gfx_fEnvParticlesDensity);
	_pShell->DeclareSymbol("persistent user FLOAT gfx_fEnvParticlesRange;", &gfx_fEnvParticlesRange);
	_pShell->DeclareSymbol("user INDEX plr_bRespawnInPlaceCoop;", &plr_bRespawnInPlaceCoop);
	
	// player appearance interface
	_pShell->DeclareSymbol("INDEX SetPlayerAppearance(INDEX, INDEX, INDEX, INDEX);", (void*)&SetPlayerAppearance);
	//0105
	_pShell->DeclareSymbol("INDEX SetPlayerAppearanceSka(INDEX, INDEX, INDEX, INDEX);", (void*)&SetPlayerAppearanceSka);
	//..
	// call player weapons persistant variable initialization
	extern void CPlayerWeapons_Init(void);
	CPlayerWeapons_Init();
	
	// initialize HUD
	InitHUD();	
	
	//0825
//	Init_DeathTable();	

	// precache
	CPlayer_Precache();
}

// clean up
void CPlayer_OnEndClass(void)
{
	EndHUD();
}

FLOAT TopHealth(void)
{
	if (GetSP()->sp_gdGameDifficulty<=CSessionProperties::GD_EASY) {
		return 200;
	} else {
		return 100;
	}
}

// info structure
static EntityInfo eiPlayerGround = {
	EIBT_FLESH, 80.0f,
	0.0f, 1.7f, 0.0f,     // source (eyes)
	0.0f, 1.0f, 0.0f,     // target (body)
};
/*
static EntityInfo eiPlayerCrouch = {
	EIBT_FLESH, 80.0f,
	0.0f, 1.2f, 0.0f,     // source (eyes)
	0.0f, 0.7f, 0.0f,     // target (body)
};
*/
static EntityInfo eiPlayerSwim = {
	EIBT_FLESH, 40.0f,
	0.0f, 0.0f, 0.0f,     // source (eyes)
	0.0f, 0.0f, 0.0f,     // target (body)
};

// animation light specific
//#define LIGHT_ANIM_MINIGUN 2
//#define LIGHT_ANIM_TOMMYGUN 3
//#define LIGHT_ANIM_COLT_SHOTGUN 4
#define LIGHT_ANIM_NONE 5

const char *NameForState(PlayerState pst)
{
	switch(pst) {
	case PST_STAND: return "stand";
//	case PST_CROUCH: return "crouch";
	case PST_FALL: return "fall";
	case PST_SWIM: return "swim";
	case PST_DIVE: return "dive";
	default: return "???";
	};
}

/*
// print explanation on how a player died
void PrintPlayerDeathMessage(CPlayer *ppl, const EPlayerDeath &ePLDeath)
{
	CTString strMyName = ppl->GetPlayerName();
	CEntity *penKiller = (CEntity*) ePLDeath.eidInflictor;
	// if killed by a valid entity
	if( penKiller!=NULL) {
		// if killed by a player
		if( IsOfClass( penKiller, &CPlayer_DLLClass)) {
			// if not self
			if( penKiller!=ppl) {
				CTString strKillerName = ((CPlayer*)penKiller)->GetPlayerName();
				
				if(ePLDeath.dmtType==DMT_TELEPORT) {
					CPrintF(TRANS("%s telefragged %s\n"), strKillerName, strMyName);
				} else if(ePLDeath.dmtType==DMT_CLOSERANGE) {
					CPrintF(TRANS("%s cut %s into pieces\n"), strKillerName, strMyName);
				} else if(ePLDeath.dmtType==DMT_CHAINSAW) {
					CPrintF(TRANS("%s cut %s into pieces\n"), strKillerName, strMyName);
				} else if(ePLDeath.dmtType==DMT_BULLET ||
					ePLDeath.dmtType==DMT_SHOTGUN ||
					ePLDeath.dmtType==DMT_SNIPER) {
					CPrintF(TRANS("%s poured lead into %s\n"), strKillerName, strMyName);
				} else if(ePLDeath.dmtType==DMT_PROJECTILE || ePLDeath.dmtType==DMT_EXPLOSION) {
					CPrintF(TRANS("%s blew %s away\n"), strKillerName, strMyName);
				} 
				else {
					CPrintF(TRANS("%s killed %s\n"), strKillerName, strMyName);
				}
			} else {
				// make message from damage type
				switch(ePLDeath.dmtType) {
				case DMT_DROWNING:  CPrintF(TRANS("%s drowned\n"), strMyName); break;
				case DMT_BURNING:   CPrintF(TRANS("%s burst into flames\n"), strMyName); break;
				case DMT_SPIKESTAB: CPrintF(TRANS("%s fell into a spike-hole\n"), strMyName); break;
				case DMT_FREEZING:  CPrintF(TRANS("%s has frozen\n"), strMyName); break;
				case DMT_ACID:      CPrintF(TRANS("%s dissolved\n"), strMyName); break;
				case DMT_PROJECTILE:
				case DMT_EXPLOSION:
					CPrintF(TRANS("%s was blown away\n"), strMyName); break;
				default:            CPrintF(TRANS("%s has committed suicide\n"), strMyName);
				}
			}
			// if killed by an enemy
		} else if( IsDerivedFromClass( penKiller, &CEnemyBase_DLLClass)) {
			// check for telefrag first
			if(ePLDeath.dmtType==DMT_TELEPORT) {
				CPrintF(TRANS("%s was telefragged\n"), strMyName);
				return;
			}
			
			// describe how this enemy killed player - conversion to eDeath is done to reduce changes to existing code
			EDeath eDeath;
			eDeath.eLastDamage.penInflictor = (CEntity*) ePLDeath.eidInflictor;
			eDeath.eLastDamage.vDirection   = ePLDeath.vDirection;
			eDeath.eLastDamage.vHitPoint    = ePLDeath.vHitPoint;
			eDeath.eLastDamage.fAmount      = ePLDeath.fAmount;
			eDeath.eLastDamage.dmtType      = ePLDeath.dmtType;
			CPrintF("%s\n", (const char*)((CEnemyBase*)penKiller)->GetPlayerKillDescription(strMyName, eDeath));
			
			// if killed by some other entity
		} else {
			// make message from damage type
			switch(ePLDeath.dmtType) {
			case DMT_SPIKESTAB: CPrintF(TRANS("%s was pierced\n"), strMyName); break;
			case DMT_BRUSH:     CPrintF(TRANS("%s was squashed\n"), strMyName); break;
			case DMT_ABYSS:     CPrintF(TRANS("%s went over the edge\n"), strMyName); break;
			case DMT_IMPACT:    CPrintF(TRANS("%s swashed\n"), strMyName); break;
			case DMT_HEAT:      CPrintF(TRANS("%s stood in the sun for too long\n"), strMyName); break;
			default:            CPrintF(TRANS("%s passed away\n"), strMyName);
			}
		}
		// if no entity pointer (shouldn't happen)
	} else {
		CPrintF(TRANS("%s is missing in action\n"), strMyName);
	}
}
*/

//안태훈 수정 시작	//(Open beta)(2004-12-08)
void ShotMissile(CEntity *penShoter, const char *szShotPosTagName
				 , CEntity *penTarget, FLOAT fMoveSpeed
				 , const char *szHitEffectName, const char *szArrowEffectName
				 , bool bCritical
				 , FLOAT fHorizonalOffset = 0.0f, FLOAT fVerticalOffset = 0.0f	//-1.0f ~ 1.0f
				 , INDEX iArrowType = 0, const char *szMissileModel = NULL, CSelectedEntities* dcEntities = NULL);
void ShotMagicContinued(CEntity *penShoter, FLOAT3D vStartPos, FLOATquat3D qStartRot
				 , CEntity *penTarget, FLOAT fMoveSpeed
				 , const char *szHitEffectName, const char *szMagicEffectName
				 , bool bCritical, INDEX iOrbitType, BOOL bDirectTag = FALSE);
void ShotGoWaitBack(CEntity *penShoter, FLOAT3D vStartPos, FLOATquat3D qStartRot
				 , CEntity *penTarget, FLOAT fMoveSpeed, FLOAT fWaitTime
				 , const char *szHitEffectName, const char *szMoveEffectName
				 , bool bCritical
				 , FLOAT fHorizonalOffset = 0.0f, FLOAT fVerticalOffset = 0.0f	//-1.0f ~ 1.0f
				 );
void ShotConnect(CEntity *penShoter, CEntity *penTarget, FLOAT fWaitTime
				 , const char *szHitEffectName, const char *szConnectEffectName);
//안태훈 수정 끝	//(Open beta)(2004-12-08)
/*
void ShotFallDown(FLOAT3D vStartPos, FLOAT3D vToTargetDir, FLOAT fMoveSpeed
				 , const char *szHitEffectName, const char *szFallObjEffectName
				 , bool bCritical);
*/
extern void GetTargetDirection(CEntity *penMe, CEntity *penTarget, FLOAT3D &vTargetPos, FLOAT3D &vDirection);

void CPlayer::SetDefaultProperties(void) {
	m_strName = "<unnamed player>";
	m_ulLastButtons = 0x0;
	m_fArmor = 0.0f;
	m_strGroup = "";
	m_ulKeys = 0;
	m_fMaxHealth = 1;
	m_ulFlags = 0;
	m_penWeapons = NULL;
	m_penAnimator = NULL;
	m_penView = NULL;
	m_pen3rdPersonView = NULL;
	m_iViewState = PVT_PLAYEREYES ;
	m_iLastViewState = PVT_PLAYEREYES ;
	m_aoLightAnimation.SetData(NULL);

	m_fDamageAmmount = 0.0f;
	m_tmWoundedTime = 0.0f;
	m_iGender = GENDER_MALE ;
	m_pstState = PST_STAND ;
	m_fFallTime = 0.0f;
	m_fSwimTime = 0.0f;
	m_tmOutOfWater = 0.0f;
	m_tmMoveSound = 0.0f;
	m_bMoveSoundLeft = TRUE ;
	m_tmNextAmbientOnce = 0.0f;
	m_tmMouthSoundLast = 0.0f;
	m_penCamera = NULL;
	m_strCenterMessage = "";
	m_tmCenterMessageEnd = 0.0f;
	m_bPendingMessage = FALSE ;
	m_tmMessagePlay = 0.0f;
	m_tmAnalyseEnd = 0.0f;
	m_bComputerInvoked = FALSE ;
	m_tmAnimateInbox = -100.0f;
	m_penMainMusicHolder = NULL;
	m_tmLastDamage = -1.0f;
	m_fMaxDamageAmmount = 0.0f;
	m_vDamage = FLOAT3D(0 , 0 , 0);
	m_tmSpraySpawned = -1.0f;
	m_fSprayDamage = 0.0f;
	m_penSpray = NULL;
	m_soWeapon0.SetOwner(this);
	m_soWeapon0.Stop(FALSE);
	m_soWeapon1.SetOwner(this);
	m_soWeapon1.Stop(FALSE);
	m_soWeapon2.SetOwner(this);
	m_soWeapon2.Stop(FALSE);
	m_soWeapon3.SetOwner(this);
	m_soWeapon3.Stop(FALSE);
	m_soWeaponAmbient.SetOwner(this);
	m_soWeaponAmbient.Stop(FALSE);
	m_soPowerUpBeep.SetOwner(this);
	m_soPowerUpBeep.Stop(FALSE);
	m_soMouth.SetOwner(this);
	m_soMouth.Stop(FALSE);
	m_soFootL.SetOwner(this);
	m_soFootL.Stop(FALSE);
	m_soFootR.SetOwner(this);
	m_soFootR.Stop(FALSE);
	m_soBody.SetOwner(this);
	m_soBody.Stop(FALSE);
	m_soLocalAmbientLoop.SetOwner(this);
	m_soLocalAmbientLoop.Stop(FALSE);
	m_soLocalAmbientOnce.SetOwner(this);
	m_soLocalAmbientOnce.Stop(FALSE);
	m_soMessage.SetOwner(this);
	m_soMessage.Stop(FALSE);
	m_iHighScore = 0;
	m_iBeatenHighScore = 0;
	m_tmLatency = 0.0f;
	m_tmLatencyLastAvg = 0.0f;
	m_tmLatencyAvgSum = 0.0f;
	m_ctLatencyAvg = 0;
	m_bEndOfLevel = FALSE ;
	m_bEndOfGame = FALSE ;
	m_iMayRespawn = 0;
	m_tmSpawned = 0.0f;
	m_vDied = FLOAT3D(0 , 0 , 0);
	m_aDied = FLOAT3D(0 , 0 , 0);
	m_tmEstTime = 0.0f;
	m_iTimeScore = 0;
	m_iStartTime = 0;
	m_iEndTime = 0;
	m_tmLevelStarted = 0.0f;
	m_strLevelStats = "";
	m_penActionMarker = NULL;
	m_fAutoSpeed = 0.0f;
	m_iAutoOrgWeapon = 0;
	m_vAutoSpeed = FLOAT3D(0 , 0 , 0);
	m_tmSpiritStart = 0.0f;
	m_tmFadeStart = 0.0f;
	m_tmLastPicked = -10000.0f;
	m_strPickedName = "";
	m_fPickedAmmount = 0.0f;
	m_fPickedMana = 0.0f;
	m_vLastStain = FLOAT3D(0 , 0 , 0);
	m_iLastRotationH = 0;
	m_iLastRotationP = 0;
	m_iLastRotationB = 0;
	m_iLastViewRotationH = 0;
	m_iLastViewRotationP = 0;
	m_iLastViewRotationB = 0;
	m_vLastTranslation = FLOAT3D(0 , 0 , 0);
	m_aLocalRotation = FLOAT3D(0 , 0 , 0);
	m_aLocalViewRotation = FLOAT3D(0 , 0 , 0);
	m_vLocalTranslation = FLOAT3D(0 , 0 , 0);
	m_tmInvisibility = 0.0f;
	m_tmInvulnerability = 0.0f;
	m_tmSeriousDamage = 0.0f;
	m_tmSeriousSpeed = 0.0f;
	m_tmInvisibilityMax = 30.0f;
	m_tmInvulnerabilityMax = 30.0f;
	m_tmSeriousDamageMax = 40.0f;
	m_tmSeriousSpeedMax = 20.0f;
	m_tmChainShakeEnd = 0.0f;
	m_fChainShakeStrength = 1.0f;
	m_fChainShakeFreqMod = 1.0f;
	m_fChainsawShakeDX = 0.0f;
	m_fChainsawShakeDY = 0.0f;
	m_sbAttackspeed = 0;
	m_sbMagicspeed = 0;
	m_fAttackrange = 0.0f;
	m_fRunspeed = 0.0f;
	m_fWalkspeed = 0.0f;
	m_iWeaponsID = -1;
	m_iAnimatorID = -1;
	m_bInitializeOverNet = TRUE ;
	m_bDontLerpView = FALSE ;
	m_bMdl = FALSE ;
	m_LocCurrent = FLOAT3D(0 , 0 , 0);
	m_LocDesired = FLOAT3D(0 , 0 , 0);
	m_tmSpawnedForInv = -99.0f;
	m_bIsMove = FALSE ;
	m_bStartAttack = FALSE ;
	m_vDesiredPosition = FLOAT3D(0 , 0 , 0);
	m_aRotateSpeed = AngleDeg(1800.0f);
	m_fMoveSpeed = 5.0f;
	m_fMoveFrequency = 0.25f;
	m_bMoving = FALSE ;
	m_fBurnPower = 1.0f;
	m_fBurnRatio = 1.0f;
	m_fBurnTime = 0.5f;
	m_fBurnFadeInTime = 0.2f;
	m_fBurnFadeOutTime = 0.2f;
	m_penAttackingEnemy = NULL;
	m_bLockMove = FALSE ;
	m_bReserveMove = FALSE ;
	m_bForward = FALSE ;
	m_bKeyMove = FALSE ;
	m_nDesiredSkillNum = -1;
	m_bReserveSkill = FALSE ;
	m_bSkilling = FALSE ;
	m_nCurrentSkillNum = -1;
	m_nReservedSkillNum = -1;
	m_fSkillDistance = 15.0f;
	m_idCurrentSkillAnim = -1;
	m_tmSkillStartTime = 0.0f;
	m_tmSkillAnimTime = 0.0f;
	m_fSkillAnimTime = 0.0f;
	m_bWaitForSkillTarget = FALSE ;
	m_aHeadingRotation = 0.0f;
	m_nPreDesiredSkillNum = -1;
	m_bWaitForSkillResponse = FALSE ;
	m_fCameraAngle = 0.0f;
	m_bPlayAction = FALSE ;
	m_nPlayActionNum = -1;
	m_penWillDeathMob = NULL;
	m_bReservedCancel = FALSE ;
	m_bNotRenderParticles = FALSE ;
	m_bRcvAtMsg = FALSE ;
	m_bCriticalDamage = FALSE ;
	m_bReadySendSkillMessage = TRUE ;
	m_idCurrentActionAnim = -1;
	m_nCurrentActionNum = -1;
	m_nDesiredActionNum = -1;
	m_bAction = FALSE ;
	m_nActionSit = 0;
	m_fnMusic = CTFILENAME("data\\sounds\\BGM\\Another_Ballad.ogg");
	m_fVolume = 10.0f;
	m_mtType = MT_LIGHT ;
	m_bFieldArea = FALSE ;
	m_bDying = FALSE ;
	m_bLockSkillCancel = FALSE ;
	m_bConnectEffect = FALSE ;
	m_bProduction = FALSE ;
	m_nProductionNum = -1;
	m_bEnvironmentSound = FALSE ;
	m_bStartPostSkill = TRUE ;
	m_bRunningMode = TRUE ;
	m_iSkillEffectStep = 0;
	m_bCriticalDamageMe = FALSE ;
	m_tmSendSkillMessage = 0.0f;
	m_bSpeedUp = FALSE ;
	m_bSendStopMessage = TRUE ;
	m_vMyPositionTmp = FLOAT3D(0.0f , 0.0f , 0.0f);
	m_bMobChange = FALSE ;
	m_nLegit = FALSE ;
	m_bStuned = FALSE ;
	m_bDisappearWeapon = FALSE ;
	m_bChanging = FALSE ;
	m_nChangeMonsterId = 0;
	m_nProduceItemDBIndex = 0;
	m_bHold = FALSE ;
	m_bCannotUseSkill = FALSE ;
	m_bRide = FALSE ;
	m_iRideType = -1;
	m_bWildRide = FALSE ;
	m_bDeathChk = FALSE ;
	m_bIsTransform = FALSE ;
	m_iTransformType = 0;
	m_bTransforming = FALSE ;
	m_bOnlyRotate = FALSE ;
	m_bClicked = FALSE ;
	m_bCanSkillCancel = TRUE ;
	CPlayerEntity::SetDefaultProperties();
}

#line 2018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Precache(void) 
#line 2019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: Precache  ();
#line 2021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::LevelChangePlayerClear(void) 
#line 2024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLastPicked  = - 99.0f;
#line 2027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmInvisibility  = - 99.0f;
#line 2028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmInvulnerability  = - 99.0f;
#line 2029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousDamage  = - 99.0f;
#line 2030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousSpeed  = - 99.0f;
#line 2031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSpawned  = - 99.0f;
#line 2032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_tmLastBreathed  = en_tmEntityTime ;
#line 2034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSpawnedForInv  = - 99.0f;
#line 2036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::OnEnd(void) 
#line 2039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: OnEnd  ();
#line 2041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::HandleEvent(const CEntityEvent & ee) 
#line 2045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ee  . ee_slEvent  == EVENTCODE_EShowConsole ){
#line 2047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsServer  ()){
#line 2048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetGameEnd  ();
#line 2049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 2051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(ee  . ee_slEvent  == EVENTCODE_EPlayerStats ){
#line 2052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsServer  ()){
#line 2053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerStats  epls  = (EPlayerStats  &) ee ;
#line 2054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * ppl  = (CPlayer  *) _pNetwork  -> ga_srvServer  . srv_apltPlayers  [ epls  . iIndex  ] . plt_penPlayerEntity ;
#line 2055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_srvServer  . srv_apltPlayers  [ epls  . iIndex  ] . IsActive  () && ppl  != NULL ){
#line 2057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppl  -> m_psGameStats  . ps_iKills  = epls  . iKills ;
#line 2058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppl  -> m_psGameStats  . ps_iDeaths  = epls  . iDeaths ;
#line 2059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 2062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(ee  . ee_slEvent  == EVENTCODE_EAddBulletSpray ){
#line 2063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsServer  ()){
#line 2064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EAddBulletSpray  & eabs  = (EAddBulletSpray  &) ee ;
#line 2065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddBulletSpray  (eabs  . vPos  , eabs  . eptType  , eabs  . vReflected );
#line 2066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 2068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(ee  . ee_slEvent  == EVENTCODE_EAddGoreSpray ){
#line 2069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsServer  ()){
#line 2070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EAddGoreSpray  & eags  = (EAddGoreSpray  &) ee ;
#line 2071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 2072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (eags  . iEntityHit  , penEntity )){
#line 2073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vSpillDir  = - en_vGravityDir  * 0.5f;
#line 2074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D boxCutted  = FLOATaabbox3D (FLOAT3D (0 , 0 , 0) , FLOAT3D (1 , 1 , 1));
#line 2075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> GetRenderType  () == RT_MODEL ){
#line 2076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> en_pmoModelObject  -> GetCurrentFrameBBox  (boxCutted );
#line 2077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(penEntity  -> GetRenderType  () == RT_SKAMODEL ){
#line 2078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iColBox  = penEntity  -> GetModelInstance  () -> GetCurrentColisionBoxIndex  ();
#line 2079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColisionBox  cb  = penEntity  -> GetModelInstance  () -> GetColisionBox  (iColBox );
#line 2080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
boxCutted  = FLOATaabbox3D (cb  . Min  () , cb  . Max  ());
#line 2081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fPower  = 4.0f;
#line 2092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddGoreSpray  (eags  . vPos  , eags  . vHit  , eags  . sptType  , vSpillDir  , boxCutted  , fPower  , eags  . colParticles );
#line 2093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 2096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CPlayerEntity  :: HandleEvent  (ee );
#line 2098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetWeaponAndAnimator() 
#line 2102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iWeaponsID  = m_penWeapons  -> en_ulID ;
#line 2104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iAnimatorID  = m_penAnimator  -> en_ulID ;
#line 2105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
SBYTE CPlayer::GetNetworkType()const 
#line 2110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return MSG_CHAR_PC ;
#line 2112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetRotation(INDEX & iRotPacked,FLOAT fUnpacked) 
#line 2115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRotPacked  = (UWORD ) (fUnpacked  * 20);
#line 2117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::GetRotation(INDEX iRotPacked) 
#line 2120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((FLOAT) iRotPacked ) / 20;
#line 2122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::GetRotationDiff(INDEX iRotPacked,FLOAT fUnpacked) 
#line 2125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UWORD  uwRotPacked2  = (UWORD ) (fUnpacked  * 20);
#line 2127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UWORD  uwDiff  = uwRotPacked2  - ((UWORD ) iRotPacked );
#line 2128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((FLOAT) ((SWORD ) uwDiff )) / 20;
#line 2129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlaySound(CSoundObject & so,SLONG idSoundComponent,SLONG slPlayType) 
#line 2132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsReapplyingActions  ()){
#line 2134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: PlaySound  (so  , idSoundComponent  , slPlayType );
#line 2135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlaySound(CSoundObject & so,const CTFileName & fnmSound,SLONG slPlayType) 
#line 2138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsReapplyingActions  ()){
#line 2140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: PlaySound  (so  , fnmSound  , slPlayType );
#line 2141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::InitializeFromNet() 
#line 2145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerInit  ePLInit ;
#line 2147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLInit  . ulWeaponsID  = m_iWeaponsID ;
#line 2148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLInit  . ulAnimatorID  = m_iAnimatorID ;
#line 2149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLInit  . bCreate  = m_bInitializeOverNet ;
#line 2150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Initialize  (ePLInit  , FALSE );
#line 2151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsActionApplied() {
#line 2154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((m_ulFlags  & PLF_APPLIEDACTION ) != 0);
#line 2155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetActionApplied() {
#line 2158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_APPLIEDACTION ;
#line 2159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ClearActionApplied() {
#line 2162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_APPLIEDACTION ;
#line 2163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsReapplyingActions() {
#line 2166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((m_ulFlags  & PLF_REAPPLYINGACTIONS ) != 0);
#line 2167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetReapplyingActions() {
#line 2169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_REAPPLYINGACTIONS ;
#line 2170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ClearReapplyingActions() {
#line 2172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_REAPPLYINGACTIONS ;
#line 2173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::DumpToConsole() 
#line 2176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapons  = (CPlayerWeapons  *) (CEntity  *) m_penWeapons ;
#line 2178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("Entity ID: %X, Name: %s\n") , en_ulID  , en_pcCharacter  . pc_strName );
#line 2179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Health: %d, Armor: %d\n") , (INDEX) en_fHealth  , m_fArmor );
#line 2185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   PlayerFlags: 0x%08X\n") , m_ulFlags );
#line 2186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Available weapons: 0x%X\n") , penWeapons  -> m_iAvailableWeapons );
#line 2189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsFlagOn  (ENF_ALIVE )){
#line 2190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   ENF_ALIVE = TRUE\n"));
#line 2191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 2192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   ENF_ALIVE = FALSE\n"));
#line 2193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Placement:       x: %6.2f, y: %6.2f, z:%6.2f\n") , en_plPlacement  . pl_PositionVector  (1) 
#line 2196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, en_plPlacement  . pl_PositionVector  (2) , en_plPlacement  . pl_PositionVector  (3));
#line 2197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Last Placement:  x: %6.2f, y: %6.2f, z:%6.2f\n") , en_plLastPlacement  . pl_PositionVector  (1) 
#line 2198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, en_plLastPlacement  . pl_PositionVector  (2) , en_plLastPlacement  . pl_PositionVector  (3));
#line 2199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Translation:     x: %6.2f, y: %6.2f, z:%6.2f\n") , en_vCurrentTranslationAbsolute  (1) 
#line 2200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, en_vCurrentTranslationAbsolute  (2) , en_vCurrentTranslationAbsolute  (3));
#line 2201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("   Rotation:        h: %6.2f, p: %6.2f, b:%6.2f\n") , en_aCurrentRotationAbsolute  (1) 
#line 2202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, en_aCurrentRotationAbsolute  (2) , en_aCurrentRotationAbsolute  (3));
#line 2204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(en_RenderType ){
#line 2205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_ILLEGAL : {CPrintF  (TRANS  ("   RenderType: RT_ILLEGAL\n"));break ;}
#line 2206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_NONE : {CPrintF  (TRANS  ("   RenderType: RT_NONE\n"));break ;}
#line 2207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_MODEL : {CPrintF  (TRANS  ("   RenderType: RT_MODEL\n"));break ;}
#line 2208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_BRUSH : {CPrintF  (TRANS  ("   RenderType: RT_BRUSH\n"));break ;}
#line 2209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_EDITORMODEL : {CPrintF  (TRANS  ("   RenderType: RT_EDITORMODEL\n"));break ;}
#line 2210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_VOID : {CPrintF  (TRANS  ("   RenderType: RT_VOID\n"));break ;}
#line 2211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_FIELDBRUSH : {CPrintF  (TRANS  ("   RenderType: RT_FIELDBRUSH\n"));break ;}
#line 2212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_SKAMODEL : {CPrintF  (TRANS  ("   RenderType: RT_SKAMODEL\n"));break ;}
#line 2213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_SKAEDITORMODEL : {CPrintF  (TRANS  ("   RenderType: RT_SKAEDITORMODEL\n"));break ;}
#line 2214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case RT_TERRAIN : {CPrintF  (TRANS  ("   RenderType: RT_TERRAIN\n"));break ;}
#line 2215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
};
#line 2216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ProcessProduce(SBYTE sbChaType,SLONG slChaIndex,SBYTE sbTargetType,SLONG slTargetIndex,SLONG slTargetHP) 
#line 2219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbTargetType  != MSG_CHAR_NPC )
#line 2221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 2227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , slChaIndex );
#line 2229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 2230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  = pObject  -> GetEntity  ();
#line 2233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(slTargetHP  <= 0)
#line 2234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  != NULL )
#line 2236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 2238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . index  == slChaIndex )
#line 2241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsProduct  ())
#line 2246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 2248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  != NULL )
#line 2253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nPlayProduceNum  = - 1;
#line 2255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::UpdateUnitInfo(CEntity * pEntity,INDEX iTargetID,SLONG lTargetHP) 
#line 2263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  == NULL ){return ;}
#line 2265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 2267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_PET ))
#line 2268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> fHealth  = lTargetHP ;
#line 2270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 2271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> fHealth  = lTargetHP ;
#line 2273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 2276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 2279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = UI_SUMMON_START ;i  <= UI_SUMMON_END ;++ i )
#line 2280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSummonUI  * pUISummon  = (CSummonUI  *) pUIManager  -> GetUI  (i );
#line 2282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUISummon  -> GetSummonEntity  () && pUISummon  -> GetSummonIndex  () == iTargetID )
#line 2283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMySlaveInfo  (i  - UI_SUMMON_START ) -> fHealth  = lTargetHP ;
#line 2285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_DrawModel(CDrawPort * pdp,FLOAT fMinX,FLOAT fMinY,FLOAT fMaxX,FLOAT fMaxY,INDEX iType,FLOAT fDistance,FLOAT fHeight) 
#line 2292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iType  == HUD_CHARACTER_TYPE )
#line 2294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_HUDMLData  . iRenderType  == eRENDER_UI_TYPE_MAKETITLE )
#line 2296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
HUD_DrawSkaModel  (pdp  , & m_HUDMLData  , fMinX  , fMinY  , fMaxX  , fMaxY  , fDistance  , fHeight );
#line 2298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
HUD_DrawSkaModel_Old  (pdp  , & m_HUDMLData  , fMinX  , fMinY  , fMaxX  , fMaxY  , fDistance  , fHeight );
#line 2302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iType  == HUD_ITEM_TYPE )
#line 2306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
HUD_DrawSkaModel_Old  (pdp  , & m_HUDItemData  , fMinX  , fMinY  , fMaxX  , fMaxY  , - 2.5f , - 0.35f);
#line 2308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_SetCharModelData(INDEX iJob,INDEX iHairStyle,INDEX iFaceStyle) 
#line 2312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  < 0 || iJob  >= TOTAL_JOB )
#line 2314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_HUDMLData  . bEnable )
#line 2319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_DeleteMI  ();
#line 2321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . Init  ();
#line 2322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pModel  = CLoginJobInfo  :: getSingleton  () -> GetLoginModel  ((eJob ) iJob );
#line 2327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_CopyMI  (pModel  -> GetModelInstance  ());
#line 2330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCharacterAppearance  (m_HUDMLData  . hud_MI  . GetModelInstance  () , iJob  , iHairStyle  , iFaceStyle );
#line 2332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . GetModelInstance  () -> mi_ERType  = ERS_NORMAL ;
#line 2333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_ItemEffect  . SetItemERSubType  (ERS_NORMAL );
#line 2334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . AddAnimation  (ska_GetIDFromStringTable  (CJobInfo  :: getSingleton  () -> GetAnimationName  (iJob  , ANIM_LOGIN_IDLE01 )) , 
#line 2335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AN_LOOPING  | AN_CLEAR  , 1.0f , 0x03 , ESKA_MASTER_MODEL_INSTANCE );
#line 2337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . GetModelInstance  () -> RefreshTagManager  ();
#line 2338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . GetModelInstance  () -> m_tmSkaTagManager  . SetOwner  (& m_HUDMLData  . hud_MI );
#line 2340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_SetItemEffect  ();
#line 2341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . bEnable  = TRUE ;
#line 2342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_ChangeHairMesh(INDEX iJob,INDEX iHairStyle) 
#line 2345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> ChangeHairMesh  (m_HUDMLData  . hud_MI  . GetModelInstance  () , iJob  , iHairStyle  - 1);
#line 2347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_ChangeFaceMesh(INDEX iJob,INDEX iFaceStyle) 
#line 2350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> ChangeFaceMesh  (m_HUDMLData  . hud_MI  . GetModelInstance  () , iJob  , iFaceStyle  - 1);
#line 2352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_PlayAnimation(INDEX iJob,INDEX AnimID) 
#line 2355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . AddAnimation  (ska_GetIDFromStringTable  (CJobInfo  :: getSingleton  () -> GetAnimationName  (iJob  , AnimID )) , 
#line 2357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AN_REMOVE_ON_END  , 1.0f , 0x03 , ESKA_MASTER_MODEL_INSTANCE );
#line 2358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_PlayAnimation(CTString strAniName) 
#line 2361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . AddAnimation  (ska_GetIDFromStringTable  (strAniName ) , 
#line 2363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AN_REMOVE_ON_END  , 1.0f , 0x03 , ESKA_MASTER_MODEL_INSTANCE );
#line 2364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_SetModelColor(const COLOR ModelColor) 
#line 2367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . SetModelColor  (ModelColor );
#line 2369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_SetModelData(INDEX iType,INDEX iIndex,INDEX iUIType) 
#line 2372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iType  == HUD_CHARACTER_TYPE )
#line 2374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_HUDMLData  . bEnable )
#line 2376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_DeleteMI  ();
#line 2378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_DeleteBG  ();
#line 2379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . Init  ();
#line 2380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . SetSkaModel  (CJobInfo  :: getSingleton  () -> GetFileName  (_pNetwork  -> MyCharacterInfo  . job ));
#line 2383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_BG  . SetSkaModel  (CTString ("Data\\Interface\\title_bg\\Title_BG.smc"));
#line 2386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> ChangeFaceMesh  (m_HUDMLData  . hud_MI  . GetModelInstance  () , _pNetwork  -> Get_MyChar_Job  () , _pNetwork  -> Get_MyChar_faceStyle  () - 1);
#line 2387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> ChangeHairMesh  (m_HUDMLData  . hud_MI  . GetModelInstance  () , _pNetwork  -> Get_MyChar_Job  () , _pNetwork  -> Get_MyChar_hairStyle  () - 1);
#line 2389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EFF_RENDER_SUB_TYPE  subType  = ERS_NORMAL ;
#line 2391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iUIType )
#line 2392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case eRENDER_UI_TYPE_CASHSHOP : 
#line 2394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
subType  = ERS_CASHSHOP ;
#line 2396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case eRENDER_UI_TYPE_MAKETITLE : 
#line 2399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
subType  = ERS_MAKETITLE ;
#line 2401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . GetModelInstance  () -> mi_ERType  = subType ;
#line 2405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_BG  . GetModelInstance  () -> mi_ERType  = ERS_MAKETITLE ;
#line 2406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_ItemEffect  . SetItemERSubType  (subType );
#line 2407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . hud_MI  . AddAnimation  (ska_GetIDFromStringTable  (CJobInfo  :: getSingleton  () -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_IDLE )) , 
#line 2408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AN_LOOPING  | AN_CLEAR  , 1.0f , 0x03 , ESKA_MASTER_MODEL_INSTANCE );
#line 2411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . bEnable  = TRUE ;
#line 2412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . iRenderType  = iUIType ;
#line 2413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iType  == HUD_ITEM_TYPE )
#line 2415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iIndex  <= 0)
#line 2417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = _pNetwork  -> GetItemData  (iIndex );
#line 2422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSMC  = pItemData  -> GetItemSmcFileName  ();
#line 2424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_HUDItemData  . bEnable )
#line 2425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . HUD_DeleteMI  ();
#line 2427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . Init  ();
#line 2428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString aniName  = "matryoshka";
#line 2432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX aniIndex  = ska_StringToID  (aniName );
#line 2433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . hud_MI  . SetSkaModel  (strSMC );
#line 2434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . hud_MI  . StretchModel  (FLOAT3D (1.5f , 1.5f , 1.5f));
#line 2435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . iAnim  = aniIndex ;
#line 2437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . hud_MI  . GetModelInstance  () -> mi_bDummyModel  = TRUE ;
#line 2438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . hud_MI  . GetModelInstance  () -> mi_ERType  = ERS_MATRYOSHKA ;
#line 2439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . hud_MI  . AddAnimation  (aniIndex  , AN_LOOPING  | AN_CLEAR  , 1.0f , 0x03 , ESKA_MASTER_MODEL_INSTANCE );
#line 2440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDItemData  . bEnable  = TRUE ;
#line 2441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
FLOAT CPlayer::GetAnimationTime() 
#line 2446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString aniName  = "matryoshka";
#line 2449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX aniIndex  = ska_StringToID  (aniName );
#line 2450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT animTime  = m_HUDItemData  . hud_MI  . GetModelInstance  () -> GetAnimLength  (aniIndex );
#line 2452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return animTime ;
#line 2453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_WearingModel(INDEX iType,INDEX iJob,INDEX iItem,BOOL bLogin) 
#line 2456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iRef  = - 1;
#line 2459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iType  == WEAR_WEAPON ){
#line 2460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 0;
#line 2461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_HELMET ){
#line 2462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 1;
#line 2463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_JACKET ){
#line 2464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 2;
#line 2465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_PANTS ){
#line 2466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 3;
#line 2467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_GLOVES ){
#line 2468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 4;
#line 2469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_BOOTS ){
#line 2470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 5;
#line 2471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_SHIELD ){
#line 2472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 6;
#line 2473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(iType  == WEAR_BACKWING ){
#line 2474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iRef  = 7;
#line 2475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 2476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bLogin  == TRUE )
#line 2480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . SetLoginWearingItems  (iRef  , iType  , iJob  , iItem );
#line 2482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . SetWearingItems  (iRef  , iType  , iJob  , iItem );
#line 2486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::HUD_SetTitleEffect(CTString strEffectName) 
#line 2490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strEffectName  . IsEmpty  () == TRUE )
#line 2492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_DeleteTitleEffect  ();
#line 2494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . HUD_SetTitleEffect  (strEffectName  . str_String );
#line 2498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsHudModel_Used() 
#line 2502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_HUDMLData  . IsHudModelUsed  ();
#line 2504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetHudModel_Use(BOOL bUse) 
#line 2507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_HUDMLData  . SetHUDModelUse  (bUse );
#line 2509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
CModelInstance * CPlayer::GetPlayerModelInstance(CEntity * pEntity) 
#line 2512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity )
#line 2514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsPlayer  ())
#line 2516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return GetCurrentPlayerModelInstance  ();
#line 2518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsCharacter  ())
#line 2520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((CCharacter  *) pEntity ) -> GetCurrentPlayerModelInstance  ();
#line 2522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return NULL ;
#line 2525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 2528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * CPlayer::GetCurrentPlayerModelInstance() 
#line 2529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = NULL ;
#line 2531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bPetRide  || _pNetwork  -> MyCharacterInfo  . bWildPetRide )
#line 2532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMITemp  = GetModelInstance  ();
#line 2535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctmi  = pMITemp  -> mi_cmiChildren  . Count  ();
#line 2536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 2537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  = & pMITemp  -> mi_cmiChildren  [ 0 ];
#line 2539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  = GetModelInstance  ();
#line 2543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  = GetModelInstance  ();
#line 2548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return pMI ;
#line 2550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::EnemyTargetSelected_InputTab() 
#line 2553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * tmpEntity  = NULL ;
#line 2556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  != NULL  && ! _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . empty  ())
#line 2557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
std  :: vector  < CEntityPointer > :: iterator  Itr ;
#line 2559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Itr  = std  :: find  (_pNetwork  -> ga_World  . m_vectorTabTargetEntities  . begin  () , _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . end  () , GetPlayerWeapons  () -> m_penReservedTarget );
#line 2561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Itr  != _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . end  ())
#line 2562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(++ Itr ;Itr  != _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . end  ();++ Itr )
#line 2564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer ItrEntity  = (* Itr );
#line 2567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (ItrEntity  . ep_pen  -> GetFlags  () & ENF_ALIVE ) || ItrEntity  . ep_pen  -> GetFlags  () & ENF_INVISIBLE  || ItrEntity  . ep_pen  -> GetFlags  () & ENF_HIDDEN )
#line 2568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 2570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) ItrEntity  . ep_pen ) -> m_nMobDBIndex  == 1255)
#line 2573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 2575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpEntity  = ItrEntity  . ep_pen ;
#line 2578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpEntity  == NULL )
#line 2584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . m_vectorTabTargetEntities  . clear  ();
#line 2586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . SearchSectorAroundEntity  (this  , prPlayerProjection  -> ViewerPlacementR  () . pl_PositionVector  , prPlayerProjection );
#line 2587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . empty  ())
#line 2588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . TargetSelectedEnemy_Sort  ();
#line 2591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSize  = _pNetwork  -> ga_World  . m_vectorTabTargetEntities  . size  ();
#line 2592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;i  < nSize ;i  ++)
#line 2593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * CheckEntity  = NULL ;
#line 2595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CheckEntity  = _pNetwork  -> ga_World  . m_vectorTabTargetEntities  [ i  ];
#line 2597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CheckEntity  == NULL )
#line 2598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 2600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) CheckEntity ) -> m_nMobDBIndex  == 1255)
#line 2603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 2605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpEntity  = CheckEntity ;
#line 2608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpEntity  != NULL )
#line 2614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT maxHp  = ((CUnit  *) tmpEntity ) -> m_nMaxiHealth ;
#line 2616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CurrentHealth  = ((CUnit  *) tmpEntity ) -> m_nCurrentHealth ;
#line 2617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  Level  = ((CUnit  *) tmpEntity ) -> m_nMobLevel ;
#line 2618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  mobIdx  = ((CUnit  *) tmpEntity ) -> m_nMobDBIndex ;
#line 2620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(mobIdx  == 1255)
#line 2621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = tmpEntity ;
#line 2626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bRet  = tmpEntity  -> SetTargetInfo  (maxHp  , CurrentHealth  , FALSE  , Level  , 0 , 0 , 0 , mobIdx );
#line 2628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRet  == true )
#line 2629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpEntity  -> SetTargetSyndicateInfo  (tmpEntity  -> en_pMobTarget  -> mob_iSyndicateType  , tmpEntity  -> en_pMobTarget  -> mob_iSyndicateGrade );
#line 2631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::EvocationStart(LONG lIndex,int nSkillIndex) 
#line 2636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  type  = TransformInfo  () . GetType  (nSkillIndex );
#line 2639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(lIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 2640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . nEvocationIndex  = nSkillIndex ;
#line 2643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iTransformType  = type ;
#line 2644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = TRUE ;
#line 2645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bIsTransform  = FALSE ;
#line 2646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_EVOCATION_CONVERTING  ();
#line 2647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , lIndex );
#line 2651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 2652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 2654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_nTransformIndex  = nSkillIndex ;
#line 2656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTarget  -> GetEntity  ()) -> m_bIsTransform  = FALSE ;
#line 2657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTarget  -> GetEntity  ()) -> m_iTransformType  = type ;
#line 2658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTarget  -> GetEntity  ()) -> EvocateNow  ();
#line 2659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::EvocationStop(LONG lIndex) 
#line 2663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(lIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 2665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . nEvocationIndex  = 0;
#line 2667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iTransformType  = 0;
#line 2668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iStopTransformItem  = 522;
#line 2672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnSorcerer  ();
#line 2674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penPlEntity ;
#line 2675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlEntity  = CEntity  :: GetPlayerEntity  (0);
#line 2677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = penPlEntity  -> en_pmiModelInstance ;
#line 2679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& (pMI  -> m_tmSkaTagManager ) , 1);
#line 2681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . iNickType  > 0)
#line 2682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  t_index  = _pNetwork  -> MyCharacterInfo  . stCustomTitle  . nEffectIdx ;
#line 2685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(t_index  < 0)
#line 2686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlEntity  -> SetNickNameDamageEffect  (_pNetwork  -> MyCharacterInfo  . iNickType  , CEntity  :: NICKNAME_ATTACH_EFFECT );
#line 2688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlEntity  -> SetCustomTitleEffect  (CustomTitleData  :: m_vecCustomTitleEffect  [ t_index  ] . c_str  ());
#line 2692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , lIndex );
#line 2698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 2699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 2701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_nTransformIndex  = 0;
#line 2702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTarget  -> GetEntity  ()) -> m_iTransformType  = 0;
#line 2703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTarget  -> GetEntity  ()) -> EvocateNow  ();
#line 2704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Mob(int index,CNetworkMessage * istr) 
#line 2709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesiredPosition ;
#line 2711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D DummyAngle ;
#line 2712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 2714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(index )
#line 2715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_MOVE : 
#line 2720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: moveMsg  * pPack  = reinterpret_cast  < ResponseClient  :: moveMsg  * > (istr  -> GetBuffer  ());
#line 2723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (1) = pPack  -> x ;
#line 2724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (2) = pPack  -> h  + 1;
#line 2725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (3) = pPack  -> z ;
#line 2727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , pPack  -> charIndex );
#line 2729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 2730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pMT  = static_cast  < CMobTarget  * > (pObject );
#line 2733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (pMT  -> GetCIndex  () , penEntity ))
#line 2734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  -> SetyLayer  (pPack  -> cYlayer );
#line 2737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 2738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) pMT  -> GetEntity  ()) -> StopNow  ();
#line 2741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 2742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 2743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (pPack  -> mapAttr  & MATT_UNWALKABLE ))
#line 2747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  -> mob_sbAttributePos  = pPack  -> mapAttr ;
#line 2749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_vDesiredPosition  = vDesiredPosition ;
#line 2752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_RUN  || pPack  -> moveType  == MSG_MOVE_WALK )
#line 2753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 2757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 2759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_WALK )
#line 2762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bSingleMode )
#line 2772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = pPack  -> speed ;
#line 2774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = pPack  -> speed ;
#line 2776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = pPack  -> speed ;
#line 2777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> moveType  == MSG_MOVE_STOP )
#line 2780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = 5.0f;
#line 2782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopandTeleport  ();
#line 2783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> MoveNow  ();
#line 2786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 2792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Pet(int index,CNetworkMessage * istr) 
#line 2797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesiredPosition ;
#line 2799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 2800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 2801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 2803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(index )
#line 2804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_MOVE : 
#line 2808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: moveMsg  * pPack  = reinterpret_cast  < ResponseClient  :: moveMsg  * > (istr  -> GetBuffer  ());
#line 2811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (1) = pPack  -> x ;
#line 2812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (2) = pPack  -> h  + 1;
#line 2813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (3) = pPack  -> z ;
#line 2817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  != pInfo  -> GetMyPetInfo  () -> lIndex )
#line 2818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_PET  , pPack  -> charIndex );
#line 2821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 2822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPetTarget  * pTarget  = static_cast  < CPetTarget  * > (pObject );
#line 2825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 2827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  != NULL )
#line 2828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetyLayer  (pPack  -> cYlayer );
#line 2831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 2832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 2838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 2839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (pPack  -> mapAttr  & MATT_UNWALKABLE ))
#line 2842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> pet_sbAttributePos  = pPack  -> mapAttr ;
#line 2844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_iCountry  == KOREA )
#line 2848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_WAR )
#line 2850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 2853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 2855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 2858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 2860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 2863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 2867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_PEACE  || pPack  -> mapAttr  & MATT_WAR )
#line 2872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 2875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 2877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 2880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 2882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 2885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 2889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_vDesiredPosition  = vDesiredPosition ;
#line 2893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_RUN  || pPack  -> moveType  == MSG_MOVE_WALK )
#line 2894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 2898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 2900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = pPack  -> speed ;
#line 2904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = pPack  -> speed ;
#line 2905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = pPack  -> speed ;
#line 2907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> moveType  == MSG_MOVE_STOP )
#line 2909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = 5.0f;
#line 2911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopandTeleport  ();
#line 2912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> MoveNow  ();
#line 2914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> charIndex  == pInfo  -> GetMyPetInfo  () -> lIndex )
#line 2919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyPetInfo  () -> pen_pEntity )
#line 2921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_iCountry  == KOREA )
#line 2924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_WAR )
#line 2926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 2929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 2931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 2934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 2936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> pen_pEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 2938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> pen_pEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 2942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_PEACE  || pPack  -> mapAttr  & MATT_WAR )
#line 2947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 2950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 2952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 2955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 2957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> pen_pEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 2959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 2961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> GetMyPetInfo  () -> pen_pEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 2963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 2968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) pInfo  -> GetMyPetInfo  () -> pen_pEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 2972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 2973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) pInfo  -> GetMyPetInfo  () -> pen_pEntity ) -> SetPlacement  (place );
#line 2974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 2975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 2978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 2981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_EX_PET_COMMAND : 
#line 2982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lPetIndex ;
#line 2984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lCommandSkillIndex ;
#line 2985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbTargetType ;
#line 2986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lTargetIndex ;
#line 2988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> lPetIndex ;
#line 2989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> lCommandSkillIndex ;
#line 2990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> sbTargetType ;
#line 2991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> lTargetIndex ;
#line 2993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 2994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (lPetIndex  , MSG_CHAR_PET  , penEntity ))
#line 2995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 2996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = (SLONG ) lCommandSkillIndex ;
#line 2997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(lPetIndex  != pInfo  -> GetMyPetInfo  () -> lIndex )
#line 2998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 3002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & rSkillData  = _pNetwork  -> GetSkillData  (lCommandSkillIndex );
#line 3003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PetStartEffectGroup  (rSkillData  . GetFireEffect1  (0) , lPetIndex );
#line 3004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_WildPet(int index,CNetworkMessage * istr) 
#line 3011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesiredPosition ;
#line 3013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 3014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 3016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(index )
#line 3017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_SUB_STAT : 
#line 3019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_MOVE : 
#line 3026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: moveMsg  * pPack  = reinterpret_cast  < ResponseClient  :: moveMsg  * > (istr  -> GetBuffer  ());
#line 3029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (1) = pPack  -> x ;
#line 3030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (2) = pPack  -> h  + 1;
#line 3031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (3) = pPack  -> z ;
#line 3035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_WILDPET  , pPack  -> charIndex );
#line 3037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 3038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 3040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWildPetTarget  * pTarget  = static_cast  < CWildPetTarget  * > (pObject );
#line 3041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 3043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> m_nOwnerIndex  != _pNetwork  -> MyCharacterInfo  . index )
#line 3044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  != NULL  && penEntity  -> IsFlagOff  (ENF_DELETED ))
#line 3046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_yLayer  = pPack  -> cYlayer ;
#line 3049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (pPack  -> mapAttr  & MATT_UNWALKABLE ))
#line 3050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_sbAttributePos  = pPack  -> mapAttr ;
#line 3052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_iCountry  == KOREA )
#line 3056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_WAR )
#line 3058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 3063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 3066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 3068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 3070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 3074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_PEACE )
#line 3079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 3084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 3087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 3089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 3091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 3095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 3099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 3103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 3104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 3105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_vDesiredPosition  = vDesiredPosition ;
#line 3109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_RUN  || pPack  -> moveType  == MSG_MOVE_WALK )
#line 3110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 3114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 3116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 3119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = pPack  -> speed ;
#line 3120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = pPack  -> speed ;
#line 3121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = pPack  -> speed ;
#line 3123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> moveType  == MSG_MOVE_STOP )
#line 3125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = 5.0f;
#line 3127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopandTeleport  ();
#line 3128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> MoveNow  ();
#line 3130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pTarget  -> GetSIndex  () == pPack  -> charIndex  && pTarget  -> m_nOwnerIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 3135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 3137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  == NULL )
#line 3140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 3145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = pPack  -> speed ;
#line 3146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = pPack  -> speed ;
#line 3147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = pPack  -> speed ;
#line 3149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_iCountry  == KOREA )
#line 3150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_WAR )
#line 3152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 3157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 3160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 3162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 3164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 3168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_PEACE )
#line 3173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 3178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 3181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 3183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 3185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 3189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 3195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 3200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 3201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_StatusPC(CNetworkMessage * istr) 
#line 3209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charStatusPc  * pPack  = reinterpret_cast  < UpdateClient  :: charStatusPc  * > (istr  -> GetBuffer  ());
#line 3211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 3212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 3213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SQUAD  state  = pPack  -> state ;
#line 3214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  pkstate  = pPack  -> state2 ;
#line 3215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  CurrentHp  , FullHp ;
#line 3217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CurrentHp  = pPack  -> hp ;
#line 3218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FullHp  = pPack  -> maxHp ;
#line 3220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . hp  = pPack  -> hp ;
#line 3223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . maxHP  = pPack  -> maxHp ;
#line 3224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . mp  = pPack  -> mp ;
#line 3225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . maxMP  = pPack  -> maxMp ;
#line 3226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pktitle  = pPack  -> pkName ;
#line 3227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pkpenalty  = pPack  -> pkPenalty ;
#line 3232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance )
#line 3233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IS_FLAG_ON  (state  , EST_ASSIST_FAKEDEATH ))
#line 3235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . m_bDisableAnimating  = TRUE ;
#line 3237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . m_bDisableAnimating  = FALSE ;
#line 3241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetModelInstance  ();
#line 3246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . ChangeStatus  (& pMI  -> m_tmSkaTagManager  , state  , CStatusEffect  :: R_PARTY );
#line 3247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Player must have ska model and tag manager.");
#line 3251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_BLIND ))
#line 3255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LostTarget  ();
#line 3257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsSturn  () 
#line 3260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_STONE ) 
#line 3261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_SLEEP ) 
#line 3262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FREEZE )
#line 3263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 3264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMoveNoSendStopMsg  ();
#line 3266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStuned  = TRUE ;
#line 3267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {m_bStuned  = FALSE ;}
#line 3270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsHold  ())
#line 3271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMoveNoSendStopMsg  ();
#line 3273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bHold  = TRUE ;
#line 3274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {m_bHold  = FALSE ;}
#line 3277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_SILENT )){m_bCannotUseSkill  = TRUE ;}
#line 3278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {m_bCannotUseSkill  = FALSE ;}
#line 3280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pPack  -> charIndex );
#line 3285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 3286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 3289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetChaPkState  (pkstate );
#line 3291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 3293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penEntity )) -> m_nCurrentHealth  = CurrentHp ;
#line 3295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> UpdateTargetInfo  (FullHp  , CurrentHp  , 
#line 3298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkMode  , 
#line 3299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkState  , 
#line 3300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nLegit );
#line 3301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 3304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetTargetInfoReal  (FullHp  , CurrentHp  , 
#line 3306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 3307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkMode  , 
#line 3308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkState  , 
#line 3309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 3310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nLegit  , 
#line 3311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget 
#line 3312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 3315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IS_FLAG_ON  (state  , EST_ASSIST_INVISIBLE ))
#line 3316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> SetTargetActive  (eTARGET_REAL  , FALSE );
#line 3318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> SetTargetActive  (eTARGET_REAL  , TRUE );
#line 3322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 3327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GAMEDATAMGR  () -> GetPartyInfo  () -> UpdateMemberStatus  (pPack  -> charIndex  , CurrentHp  , FullHp  , pPack  -> mp  , pPack  -> maxMp );
#line 3329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_statusEffect  . IsState  (EST_ASSIST_INVISIBLE ) == FALSE  
#line 3330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& IS_FLAG_ON  (state  , EST_ASSIST_INVISIBLE ) 
#line 3331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pNetwork  -> m_ubGMLevel  < 2)
#line 3332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlags  (penEntity  -> GetFlags  () | ENF_HIDDEN );
#line 3334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlr  = (CPlayer  *) CEntity  :: GetPlayerEntity  (0);
#line 3335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsSameTarget  (penEntity ))
#line 3336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsSkilling  ()){penPlr  -> CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );penEntity  -> InflictDirectDamage  (penEntity  , penPlr  , DMT_NONE  , 0 , FLOAT3D (0 , 0 , 0) , ANGLE3D (0 , 0 , 0));}
#line 3338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsAttacking  ()){penPlr  -> StopAttack  ();}
#line 3339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlr  -> SetTargetNull  ();
#line 3340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlr  -> m_bLockMove  = FALSE ;
#line 3341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GAMEDATAMGR  () -> GetPartyInfo  () -> ClearPartyTarget  (pPack  -> charIndex );
#line 3345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pTarget  -> cha_statusEffect  . IsState  (EST_ASSIST_INVISIBLE ) && ! IS_FLAG_ON  (state  , EST_ASSIST_INVISIBLE ))
#line 3347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlags  (penEntity  -> GetFlags  () & ~ ENF_HIDDEN );
#line 3349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetDesiredRotation  (ANGLE3D (0 , 0 , 0));
#line 3350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CCharacter  *) penEntity ) -> m_bIdleAnim )
#line 3351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 3353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ) == FALSE  && 
#line 3357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IS_FLAG_ON  (state  , EST_ASSIST_FAKEDEATH ))
#line 3358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlr  = (CPlayer  *) CEntity  :: GetPlayerEntity  (0);
#line 3360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsSameTarget  (penEntity ))
#line 3361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsSkilling  ()){penPlr  -> CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );penEntity  -> InflictDirectDamage  (penEntity  , penPlr  , DMT_NONE  , 0 , FLOAT3D (0 , 0 , 0) , ANGLE3D (0 , 0 , 0));}
#line 3363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlr  -> IsAttacking  ()){penPlr  -> StopAttack  ();}
#line 3364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlr  -> SetTargetNull  ();
#line 3365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlr  -> m_bLockMove  = FALSE ;
#line 3366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GAMEDATAMGR  () -> GetPartyInfo  () -> ClearPartyTarget  (pPack  -> charIndex );
#line 3371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> en_pmiModelInstance )
#line 3376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CStatusEffect  :: eRelation  rel  = CStatusEffect  :: R_NONE ;
#line 3381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> GetEntity  () -> IsSecondExtraFlagOn  (ENF_EX2_MYPARTY )){rel  = CStatusEffect  :: R_PARTY ;}
#line 3382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> ChangeStatus  (& penEntity  -> en_pmiModelInstance  -> m_tmSkaTagManager  , state  , rel );
#line 3383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Character must have ska model and tag manager.");
#line 3387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_StatusNPC(CNetworkMessage * istr) 
#line 3393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charStatusNpc  * pPack  = reinterpret_cast  < UpdateClient  :: charStatusNpc  * > (istr  -> GetBuffer  ());
#line 3396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 3397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 3398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 3401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bMercenaryDataRead  = FALSE ;
#line 3402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_iCountry  != ITALY )
#line 3403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMercenaryDataRead  = pUIManager  -> GetMonsterMercenary  () -> ReceiveMercenaryMessage  (istr  , pPack  -> hp  , pPack  -> maxHp  , pPack  -> mp  , pPack  -> maxMp );
#line 3406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  mob_ClientId  = - 1;
#line 3410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , pPack  -> charIndex );
#line 3411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pMT  = NULL ;
#line 3413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 3414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  = static_cast  < CMobTarget  * > (pObject );
#line 3417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mob_ClientId  = pMT  -> GetCIndex  ();
#line 3420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> m_nType  == MOB_XMAS_TREE_CENTER  || pMT  -> m_nType  == MOB_XMAS_TREE_DECO )
#line 3421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetFlowerTree  () -> SetMobFlowerTree  (pMT );
#line 3423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetFlowerTree  () -> FlowerTreeUpdate  (pPack  -> hp );
#line 3424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMercenaryDataRead )
#line 3426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MonsterMercenaryInfo  . index  = pMT  -> m_nType ;
#line 3428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(mob_ClientId  != - 1)
#line 3432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (mob_ClientId  , penEntity ))
#line 3434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penEntity )) -> m_nMaxiHealth  = pPack  -> maxHp ;
#line 3436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penEntity )) -> m_nCurrentHealth  = pPack  -> hp ;
#line 3437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> UpdateTargetInfo  (pPack  -> maxHp  , pPack  -> hp );
#line 3440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> en_pmiModelInstance  && pMT  != NULL )
#line 3445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (pMT  -> m_nType );
#line 3448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  -> ChangeStatus  (& penEntity  -> en_pmiModelInstance  -> m_tmSkaTagManager  , pPack  -> state );
#line 3450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> mob_statusEffect  . IsSturn  () 
#line 3451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> mob_statusEffect  . IsState  (EST_ASSIST_STONE ) 
#line 3452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> mob_statusEffect  . IsState  (EST_ASSIST_SLEEP ) 
#line 3453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> mob_statusEffect  . IsState  (EST_ASSIST_BLIND ) 
#line 3454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> mob_statusEffect  . IsState  (EST_ASSIST_FREEZE ))
#line 3455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bStuned  = TRUE ;
#line 3457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bStuned  = FALSE ;}
#line 3459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> mob_statusEffect  . IsHold  ())
#line 3460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bHold  = TRUE ;
#line 3462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bHold  = FALSE ;}
#line 3464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> mob_statusEffect  . IsState  (EST_ASSIST_SILENT )){((CUnit  *) penEntity ) -> m_bCannotUseSkill  = TRUE ;}
#line 3465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bCannotUseSkill  = FALSE ;}
#line 3467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IS_FLAG_ON  (pPack  -> state  , EST_ASSIST_INVISIBLE ))
#line 3468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> mob_iOwnerIndex  != _pNetwork  -> MyCharacterInfo  . index )
#line 3470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 3472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! IS_FLAG_ON  (pPack  -> state  , EST_ASSIST_INVISIBLE ))
#line 3475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! MD  -> IsShadowNPC  ())
#line 3477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 3479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Mob must have ska model and tag manager.");
#line 3485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_StatusPet(CNetworkMessage * istr) 
#line 3491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charStatusPet  * pPack  = reinterpret_cast  < UpdateClient  :: charStatusPet  * > (istr  -> GetBuffer  ());
#line 3495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_StatusElemental(CNetworkMessage * istr) 
#line 3498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charStatusElemental  * pPack  = reinterpret_cast  < UpdateClient  :: charStatusElemental  * > (istr  -> GetBuffer  ());
#line 3501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  clientid ;
#line 3502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 3504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
clientid  = - 1;
#line 3505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSlaveTarget  * pMT  = NULL ;
#line 3507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_SLAVE  , pPack  -> charIndex );
#line 3508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 3510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 3511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  = static_cast  < CSlaveTarget  * > (pObject );
#line 3513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
clientid  = pMT  -> GetCIndex  ();
#line 3514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(clientid  != - 1)
#line 3517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (clientid  , penEntity ))
#line 3519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penEntity )) -> m_nMaxiHealth  = pPack  -> maxHp ;
#line 3521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penEntity )) -> m_nCurrentHealth  = pPack  -> hp ;
#line 3522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 3523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> UpdateTargetInfo  (pPack  -> maxHp  , pPack  -> hp );
#line 3525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> en_pmiModelInstance  && pMT  != NULL )
#line 3530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMT  -> ChangeStatus  (& penEntity  -> en_pmiModelInstance  -> m_tmSkaTagManager  , pPack  -> state );
#line 3533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> slave_statusEffect  . IsSturn  () 
#line 3534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> slave_statusEffect  . IsState  (EST_ASSIST_STONE ) 
#line 3535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> slave_statusEffect  . IsState  (EST_ASSIST_SLEEP ) 
#line 3536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> slave_statusEffect  . IsState  (EST_ASSIST_BLIND ) 
#line 3537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| pMT  -> slave_statusEffect  . IsState  (EST_ASSIST_FREEZE ))
#line 3538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bStuned  = TRUE ;
#line 3540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bStuned  = FALSE ;}
#line 3542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> slave_statusEffect  . IsHold  ())
#line 3543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bHold  = TRUE ;
#line 3545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bHold  = FALSE ;}
#line 3547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> slave_statusEffect  . IsState  (EST_ASSIST_SILENT )){((CUnit  *) penEntity ) -> m_bCannotUseSkill  = TRUE ;}
#line 3548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {((CUnit  *) penEntity ) -> m_bCannotUseSkill  = FALSE ;}
#line 3549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Mob must have ska model and tag manager.");
#line 3553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Damage_Character(CNetworkMessage * istr) 
#line 3562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charDamage  * pPack  = reinterpret_cast  < UpdateClient  :: charDamage  * > (istr  -> GetBuffer  ());
#line 3565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = CUIManager  :: getSingleton  ();
#line 3568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nType  = 0;
#line 3570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> holyitemIndex )
#line 3571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DEF_HOLYWATER_STRONG : 
#line 3573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = 1;
#line 3574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DEF_HOLYWATER_MYSTERY : 
#line 3576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = 2;
#line 3577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DEF_HOLYWATER_DAMAGE : 
#line 3579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = 3;
#line 3580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DEF_HOLYWATER_SKILLDAMAGE : 
#line 3582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = 4;
#line 3583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 3585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = 0;
#line 3586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 3587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . index  == pPack  -> charIndex )
#line 3590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . iHitEffectType  = nType ;
#line 3592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pPack  -> charIndex );
#line 3597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 3598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 3600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_iHitType  = nType ;
#line 3601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bMe  = false ;
#line 3605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMe  = _pNetwork  -> IsAttackMe  (pPack  -> targetIndex );
#line 3607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE  && bMe  == true )
#line 3608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSystemMenu  () -> CancelRestart  ();
#line 3610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_NPC )
#line 3617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 3619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 3620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_enAttackerID  = pPack  -> charIndex ;
#line 3623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowAttackResult  (penTargetEntity  , (SLONG ) pPack  -> damage  , pPack  -> flag  , pPack  -> skillIndex );
#line 3625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> flag  != HITTYPE_MISS )
#line 3626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (this  , penTargetEntity  , NICKNAME_ATTACK_EFFECT );
#line 3628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> m_DamageLogInfo  . GetStart  ())
#line 3631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDamageLogInfo  :: LogDamage  logDamage ;
#line 3633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . ServerID  = _pNetwork  -> MyCharacterInfo  . index ;
#line 3634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . ClientID  = en_ulID ;
#line 3635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . level  = _pNetwork  -> MyCharacterInfo  . level ;
#line 3636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . db_Index  = - 1;
#line 3637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strcpy  (logDamage  . att_EntityInfo  . strName  , _pNetwork  -> MyCharacterInfo  . GetPlayerName  ());
#line 3638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . hp  = _pNetwork  -> MyCharacterInfo  . hp ;
#line 3639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . att_EntityInfo  . mp  = _pNetwork  -> MyCharacterInfo  . mp ;
#line 3641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . ServerID  = pPack  -> targetIndex ;
#line 3642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . ClientID  = penTargetEntity  -> en_ulID ;
#line 3643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . level  = penTargetEntity  -> en_pMobTarget  -> mob_iLevel ;
#line 3644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . db_Index  = penTargetEntity  -> en_pMobTarget  -> m_nType ;
#line 3646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strcpy  (logDamage  . tar_EntityInfo  . strName  , penTargetEntity  -> GetName  ());
#line 3647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . hp  = pPack  -> targetHp ;
#line 3648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . mp  = pPack  -> targetMp ;
#line 3649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . prehp  = ((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nCurrentHealth ;
#line 3650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . tar_EntityInfo  . premp  = pPack  -> targetMp ;
#line 3652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . dam_Type  = pPack  -> flag ;
#line 3653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
logDamage  . dam_Amount  = pPack  -> damage ;
#line 3655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> m_DamageLogInfo  . AddDamage  (logDamage );
#line 3656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 3661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nMaxiHealth  = 1000;}
#line 3666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("------%f--Damage Message\n" , _pTimer  -> GetLerpedCurrentTick  ());
#line 3675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 3676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetInfo  (AU_MOB_KILL );
#line 3678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetKillMonIndex  (pPack  -> targetIndex );
#line 3679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 3681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsSameTarget  (penTargetEntity ))
#line 3682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 3684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> m_DamageLogInfo  . GetStart  ())
#line 3687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> m_DamageLogInfo  . EndDamageMode  ();
#line 3689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetGMNotice  ("데미지를 기록하는 모드를 종료합니다." , 0xFFAA33FF);
#line 3690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 3700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 3701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_enAttackerID  = pPack  -> charIndex ;
#line 3704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 3705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_ubGMLevel  > 1)
#line 3707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowAttackResult  (penTargetEntity  , (SLONG ) pPack  -> damage  , pPack  -> flag  , pPack  -> skillIndex );
#line 3710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> flag  != HITTYPE_MISS )
#line 3713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (this  , penTargetEntity  , NICKNAME_ATTACK_EFFECT );
#line 3715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowAttackResult  (penTargetEntity  , (SLONG ) pPack  -> damage  , pPack  -> flag  , pPack  -> skillIndex );
#line 3722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> flag  != HITTYPE_MISS )
#line 3723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (this  , penTargetEntity  , NICKNAME_ATTACK_EFFECT );
#line 3725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 3730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 3742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 3744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 3749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> damageType  != MSG_DAMAGE_REFLEX  && pPack  -> damageType  != MSG_DAMAGE_LINK )
#line 3760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 3763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iEnermyID  = pPack  -> charIndex ;
#line 3765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> charIndex  , MSG_CHAR_PC  , penEntity ))
#line 3766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 3769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , en_ulID  , TRUE );
#line 3774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((CUnit  *) penEntity ) -> m_bSkilling )
#line 3775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (this );
#line 3777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetAttackSpeed  (pPack  -> attackSpeed );
#line 3778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> AttackNow  ();
#line 3779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 3782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeathYou  ();
#line 3784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> flag  != HITTYPE_MISS )
#line 3788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (this  , penEntity  , NICKNAME_DAMAGE_EFFECT );
#line 3790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> IsSitting  () && pPack  -> flag  != HITTYPE_MISS )
#line 3793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetCharacterInfo  () -> UseAction  (3);
#line 3795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 3803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 3804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_enAttackerID  = pPack  -> charIndex ;
#line 3808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 3809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 3811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 3815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 3817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 3821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((CUnit  *) penEntity ) -> m_bSkilling  && pPack  -> skillIndex  == - 1)
#line 3823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (penTargetEntity );
#line 3825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetAttackSpeed  (pPack  -> attackSpeed );
#line 3826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> AttackNow  ();
#line 3827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsCharacter  () && pPack  -> flag  != HITTYPE_MISS )
#line 3828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_ATTACK_EFFECT );
#line 3830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_DAMAGE_EFFECT );
#line 3831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GAMEDATAMGR  () -> GetPartyInfo  () -> IsPartyMember  (pPack  -> charIndex ))
#line 3834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GAMEDATAMGR  () -> GetPartyInfo  () -> SetPartyTarget  (pPack  -> charIndex  , pPack  -> targetIndex  , pPack  -> targetType );
#line 3836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsCharacter  () && pPack  -> flag  != HITTYPE_MISS )
#line 3841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_ATTACK_EFFECT );
#line 3843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_DAMAGE_EFFECT );
#line 3844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_PET ))
#line 3850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> Get_MyChar_Attack  (pPack  -> targetIndex  , pPack  -> targetHp ))
#line 3853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPetInfo  () -> GetPetDesc  ();
#line 3855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 3867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 3879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bKillEnemy  = TRUE ;
#line 3881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetKillTargetEntity  (penTargetEntity );
#line 3882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 3883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> UpdateTargetInfo  (((CUnit  *) penTargetEntity ) -> m_nMaxiHealth  , pPack  -> targetHp );
#line 3885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 3890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 3901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> IsSitting  () && pPack  -> flag  != HITTYPE_MISS )
#line 3906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetCharacterInfo  () -> UseAction  (3);
#line 3908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 3915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 3916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 3919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 3922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 3931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 3934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 3936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 3941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC  && 
#line 3949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> targetIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 3950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> IsSitting  () && pPack  -> flag  != HITTYPE_MISS )
#line 3952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetCharacterInfo  () -> UseAction  (3);
#line 3954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 3957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 3961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 3962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_enAttackerID  = pPack  -> targetIndex ;
#line 3965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 3966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 3968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 3970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 3975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 3979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Normal Hit" , _pTimer  -> GetLerpedCurrentTick  () 
#line 3981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, penTargetEntity  -> GetPlacement  () . pl_PositionVector  + FLOAT3D (0 , 1 , 0.5f) 
#line 3982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, ANGLE3D (90 , 0 , 90));
#line 3983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 3986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D posOffset  (0 , 1 , 0.5f);
#line 3988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> GetModelInstance  ())
#line 3989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 3990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 3991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> GetModelInstance  () -> GetCurrentColisionBox  (aabb );
#line 3992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D size  = aabb  . Size  () * 0.5f;
#line 3993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
posOffset  (2) += size  (2);
#line 3994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
posOffset  (3) += size  (3);
#line 3995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 3996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Normal Hit" , _pTimer  -> GetLerpedCurrentTick  () 
#line 3997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, penTargetEntity  -> GetPlacement  () . pl_PositionVector  + posOffset  
#line 3998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, ANGLE3D (90 , 0 , 90));
#line 3999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 4002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 4004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 4009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_DissappearEffect(CNetworkMessage * istr) 
#line 4015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charDisappearForClientEffect  * pPack  = reinterpret_cast  < UpdateClient  :: charDisappearForClientEffect  * > (istr  -> GetBuffer  ());
#line 4017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObj  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , pPack  -> charIndex );
#line 4019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObj  != NULL )
#line 4020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = pObj  -> GetEntity  ();
#line 4023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  != NULL )
#line 4024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = 0;
#line 4026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 4027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Damage(SBYTE sbType,CNetworkMessage * istr) 
#line 4031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: charDamage  * pPack  = reinterpret_cast  < UpdateClient  :: charDamage  * > (istr  -> GetBuffer  ());
#line 4034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 4035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 4037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bMe  = false ;
#line 4038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMe  = _pNetwork  -> IsAttackMe  (pPack  -> targetIndex );
#line 4040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE  && bMe  == true )
#line 4041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSystemMenu  () -> CancelRestart  ();
#line 4043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 4047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> charIndex  , sbType  , penEntity ))
#line 4048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbType  == MSG_CHAR_NPC  && pPack  -> targetType  == MSG_CHAR_NPC  && _pNetwork  -> m_bSingleMode )
#line 4051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMobName  = penEntity  -> GetName  ();
#line 4054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 4056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 4058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 4059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> flag )
#line 4061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_MISS : 
#line 4063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (677 , "구출 NPC가 공격을 회피했습니다."));
#line 4064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_WEAK : 
#line 4067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (678 , "구출 NPC가 약한 공격을 받았습니다. "));
#line 4068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_NORMAL : 
#line 4071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (679 , "구출 NPC가 일반 공격을 받았습니다."));
#line 4072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_STRONG : 
#line 4075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (680 , "구출 NPC가 강한 공격을 받았습니다."));
#line 4076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_HARD : 
#line 4079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (681 , "구출 NPC가 매우 강한 공격을 받았습니다."));
#line 4080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_CRITICAL : 
#line 4083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (682 , "구출 NPC가 크리티컬 공격을 받았습니다."));
#line 4084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_DEADLY : 
#line 4087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (683 , "구출 NPC가 데들리 공격을 받았습니다."));
#line 4088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 4089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (706 , "구출 NPC의 현재 HP : %d") , pPack  -> targetHp );
#line 4093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 4094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> UpdateRescueNPC  (penTargetEntity  , pPack  -> targetHp  , pPack  -> targetMp );
#line 4095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penTargetEntity )) -> m_nPreHealth  = pPack  -> targetHp ;
#line 4096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 4102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . index  == pPack  -> targetIndex )
#line 4104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , en_ulID  , TRUE );
#line 4108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowDamageResult  (penEntity  , pPack  -> damage  , pPack  -> flag  , pPack  -> skillIndex );
#line 4111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bProduction )
#line 4112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 4114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bHp_Percentage )
#line 4118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . hp  = pPack  -> targetHp ;
#line 4120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> flag  != HITTYPE_MISS )
#line 4123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (this  , penEntity  , NICKNAME_DAMAGE_EFFECT );
#line 4125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> m_pEntity  != NULL )
#line 4128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) pInfo  -> GetMyApetInfo  () -> m_pEntity ) -> SetEnemyEntity  (penEntity  , 0);
#line 4130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0 && ! m_bDying )
#line 4133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeathYou  ();
#line 4135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 4138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (this );
#line 4141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pPack  -> skillIndex  == - 1) && (pPack  -> damageType  != MSG_DAMAGE_COMBO ))
#line 4142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> AttackNow  ();
#line 4144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> ShowDamage  (en_ulID );
#line 4148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 4156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 4157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_enAttackerID  = pPack  -> charIndex ;
#line 4162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bShowDamage  = FALSE ;
#line 4165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 4166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , FALSE );
#line 4169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bShowDamage  = TRUE ;
#line 4171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> skillIndex  != - 1)
#line 4172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("소환수의 스킬 공격 [%d]타겟에게 : %ld의 데미지를 줌\n" , pPack  -> targetIndex  , pPack  -> damage );
#line 4174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("소환수가 [%d]타겟에게 : %ld의 데미지를 줌\n" , pPack  -> targetIndex  , pPack  -> damage );
#line 4178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 4183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bShowDamage  = TRUE ;
#line 4185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 4186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 4189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 4192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 4195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> m_pEntity  != NULL )
#line 4197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) pInfo  -> GetMyApetInfo  () -> m_pEntity ) -> SetEnemyEntity  (penEntity  , 1);
#line 4199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 4202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((CUnit  *) penEntity ) -> m_bSkilling  && pPack  -> skillIndex  == - 1 && (pPack  -> damageType  != MSG_DAMAGE_COMBO ))
#line 4205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (penTargetEntity );
#line 4207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetAttackSpeed  (pPack  -> attackSpeed );
#line 4208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> AttackNow  ();
#line 4209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsCharacter  () && pPack  -> flag  != HITTYPE_MISS )
#line 4210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_DAMAGE_EFFECT );
#line 4212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 4221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 4225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_fMaxHealth  = 1000.0f;
#line 4226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 4231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bShowDamage )
#line 4235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> ShowDamage  (penTargetEntity  -> en_ulID );
#line 4237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsCharacter  () && pPack  -> flag  != HITTYPE_MISS )
#line 4239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NickNameEffect  (penEntity  , penTargetEntity  , NICKNAME_DAMAGE_EFFECT );
#line 4241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSimplePlayerInfo  () -> UpdateHPMP  ();
#line 4244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_PET ))
#line 4248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> Get_MyChar_Attack  (pPack  -> targetIndex  , pPack  -> targetHp ))
#line 4251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPetInfo  () -> GetPetDesc  ();
#line 4253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 4265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 4269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_fMaxHealth  = 1000.0f;
#line 4270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nPreHealth  = pPack  -> targetHp ;
#line 4275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 4278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_bKillEnemy  = TRUE ;
#line 4280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetKillTargetEntity  (penTargetEntity );
#line 4281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 4282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penTargetEntity )
#line 4283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearTargetInfo  (penTargetEntity );
#line 4285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 4291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetType  == MSG_CHAR_PC )
#line 4300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 4303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 4310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 4311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 4314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 4317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTargetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 4319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> AddDamageData  (pPack  -> damage  , pPack  -> flag  , penTargetEntity  -> en_ulID  , TRUE );
#line 4322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 4325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 4329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_fMaxHealth  = 1000.0f;
#line 4330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  = pPack  -> targetHp ;
#line 4335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> targetHp  <= 0)
#line 4338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penTargetEntity ) -> DeathNow  ();
#line 4340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe  == false )
#line 4343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateUnitInfo  (penTargetEntity  , pPack  -> targetIndex  , pPack  -> targetHp );
#line 4345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Summon(int index,CNetworkMessage * istr) 
#line 4351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesiredPosition ;
#line 4353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 4354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 4356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(index )
#line 4357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_MOVE : 
#line 4361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: moveMsg  * pPack  = reinterpret_cast  < ResponseClient  :: moveMsg  * > (istr  -> GetBuffer  ());
#line 4364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (1) = pPack  -> x ;
#line 4365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (2) = pPack  -> h  + 1;
#line 4366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (3) = pPack  -> z ;
#line 4368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_SLAVE  , pPack  -> charIndex );
#line 4369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 4371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 4372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSlaveTarget  * pTarget  = static_cast  < CSlaveTarget  * > (pObject );
#line 4376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 4379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetyLayer  (pPack  -> cYlayer );
#line 4381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 4382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) pTarget  -> GetEntity  ()) -> StopNow  ();
#line 4385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 4386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 4387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (pPack  -> mapAttr  & MATT_UNWALKABLE ))
#line 4391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> slave_sbAttributePos  = pPack  -> mapAttr ;
#line 4393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsGamigo  (g_iCountry ) == TRUE )
#line 4396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> mapAttr  & MATT_PEACE )
#line 4399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 4401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 4403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 4405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 4407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOn  (ENF_HIDDEN );
#line 4409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetFlagOff  (ENF_HIDDEN );
#line 4413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_vDesiredPosition  = vDesiredPosition ;
#line 4417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_RUN  || pPack  -> moveType  == MSG_MOVE_WALK )
#line 4418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 4422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 4424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = pPack  -> speed ;
#line 4427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 4428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = pPack  -> speed ;
#line 4429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = pPack  -> speed ;
#line 4430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! penEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 4431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> MoveNow  ();
#line 4433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> moveType  == MSG_MOVE_STOP )
#line 4436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = 5.0f;
#line 4439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! penEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 4440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopandTeleport  ();
#line 4442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::OpenGate(int iGateNumber,BOOL bOpenGate) 
#line 4452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == 7 || g_slZone  == 4)
#line 4455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pDoor  = NULL ;
#line 4460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == 7)
#line 4461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iGateNumber )
#line 4463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 0: 
#line 4465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (19182);
#line 4466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 1: 
#line 4468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (19183);
#line 4469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 2: 
#line 4471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (19184);
#line 4472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  :
#line 4474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{return ;}
#line 4475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_slZone  == 4)
#line 4478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iGateNumber )
#line 4481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 4484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (15510);
#line 4485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 4: 
#line 4488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (15753);
#line 4489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 5: 
#line 4492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (15752);
#line 4493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 6: 
#line 4496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (15517);
#line 4497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 7: 
#line 4500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pDoor  = _pNetwork  -> ga_World  . EntityFromID  (15516);
#line 4501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 4502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  :
#line 4503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{return ;}
#line 4504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pDoor )
#line 4510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iGateNumber  < 3)
#line 4512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CDoorController  *) pDoor ) -> m_bOpened  = bOpenGate ;
#line 4515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (pDoor  , EET_TRIGGER  , this );
#line 4516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iGateNumber  < 8)
#line 4519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX tIdx ;
#line 4521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iGateNumber )
#line 4522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 4524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tIdx  = 11003;break ;
#line 4525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 4: 
#line 4526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tIdx  = 15554;break ;
#line 4527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 5: 
#line 4528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tIdx  = 15565;break ;
#line 4529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 6: 
#line 4530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tIdx  = 15497;break ;
#line 4531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 7: 
#line 4532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tIdx  = 15496;break ;
#line 4533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bOpenGate )
#line 4536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CWorldBase  *) pDoor ) -> SetCollisionFlags  (ECF_MODEL_NO_COLLISION );
#line 4539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pDoor  = _pNetwork  -> ga_World  . EntityFromID  (tIdx ))
#line 4540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CModelHolder3  *) pDoor ) -> SendEvent  (EStop  ());
#line 4542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
};
#line 4543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  != WCJF_OWNER  && 
#line 4548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  != WCJF_DEFENSE_GUILD  && 
#line 4549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  != WCJF_DEFENSE_CHAR )
#line 4550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CWorldBase  *) pDoor ) -> SetCollisionFlags  (ECF_BRUSH );
#line 4552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CWorldBase  *) pDoor ) -> SetCollisionFlags  (ECF_MODEL_NO_COLLISION );
#line 4556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pDoor  = _pNetwork  -> ga_World  . EntityFromID  (tIdx ))
#line 4560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CModelHolder3  *) pDoor ) -> SendEvent  (EStart  ());
#line 4562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
};
#line 4563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::StandDown(BOOL bStand) 
#line 4572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nActionSit  == 0)
#line 4574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 1;
#line 4576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . job  == NIGHTSHADOW )
#line 4577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , FALSE );
#line 4579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nActionSit  == 2)
#line 4582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 3;
#line 4584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 4588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 4591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = ACTION_NUM_SELL ;
#line 4592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bPersonalShop  = TRUE ;
#line 4593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetChaData(int index,int type,ULONG hp,ULONG maxHp,SBYTE hairStyle,SBYTE faceStyle,CTString & strName,UWORD state,SBYTE pkTitle,SLONG pkstate) 
#line 4596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 4598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (index  , penEntity ))
#line 4599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penEntity  != NULL  && "Invalid Entity Pointer");
#line 4602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_ChaList  = type ;
#line 4603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetSkaModel  (CJobInfo  :: getSingleton  () -> GetFileName  (type ));
#line 4605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = penEntity  -> GetModelInstance  ();
#line 4606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 4607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> SetCharacterAppearance  (pMI  , type  , hairStyle  , faceStyle );
#line 4609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetAnimation  (type );
#line 4613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penEntity ) -> m_strName  = strName ;
#line 4614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = maxHp ;
#line 4615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = hp ;
#line 4616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nHairStyle  = hairStyle ;
#line 4617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nFaceStyle  = faceStyle ;
#line 4619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkTitle  = pkTitle ;
#line 4620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkState  = pkstate ;
#line 4621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_ChaState  = state ;
#line 4623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(state  & PLAYER_STATE_FLYING )
#line 4624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_bDisappearWeapon  = TRUE ;
#line 4626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(state  & PLAYER_STATE_SITDOWN )
#line 4629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nSitDown  = 2;
#line 4631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = 3;
#line 4632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((state  & PLAYER_STATE_PKMODE ) && (state  & PLAYER_STATE_PKMODEDELAY ))
#line 4635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 2;
#line 4637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(state  & PLAYER_STATE_PKMODE )
#line 4639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 1;
#line 4641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 0;
#line 4645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(hp  <= 0)
#line 4648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> DeathNow  ();
#line 4651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> AnimForDeath  ();
#line 4652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penEntity ) -> m_bDeath  = FALSE ;
#line 4656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> GetModelInstance  ())
#line 4660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 4662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 4663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 4664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 4665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 4666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 4667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 4668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 4669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 4670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 4671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetCharacterState(CEntity * cha_Entity,INDEX ch_state) 
#line 4677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cha_Entity  != NULL )
#line 4679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) cha_Entity ) -> m_ChaState  = ch_state ;
#line 4681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetShopData(INDEX index,SBYTE sbShopType) 
#line 4685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 4687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (index  , penEntity ))
#line 4688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penEntity  != NULL  && "Invalid Entity Pointer");
#line 4690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbShopType  != PST_NOSHOP )
#line 4691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nSitDown  = 2;
#line 4693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = ACTION_NUM_SELL ;
#line 4694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nSitDown  = 0;
#line 4698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = ACTION_NUM_SELL ;
#line 4699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 4701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetImportantValues(FLOAT fWalkspeed,FLOAT fRunspeed,FLOAT fAttackrange,SBYTE sbAttackspeed,SBYTE sbMagicspeed) 
#line 4706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fWalkspeed  = fWalkspeed ;
#line 4708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fRunspeed  = fRunspeed ;
#line 4709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fAttackrange  = fAttackrange ;
#line 4710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_sbAttackspeed  = sbAttackspeed ;
#line 4711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_sbMagicspeed  = sbMagicspeed ;
#line 4712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
FLOAT CPlayer::GetWalkspeed() 
#line 4714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_fWalkspeed ;
#line 4716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
FLOAT CPlayer::GetRunspeed() 
#line 4718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_fRunspeed ;
#line 4720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
FLOAT CPlayer::GetAttackrange() 
#line 4722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_fAttackrange ;
#line 4724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
SBYTE CPlayer::GetAttackspeed() 
#line 4726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_sbAttackspeed ;
#line 4728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
SBYTE CPlayer::GetMagicspeed() 
#line 4730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_sbMagicspeed ;
#line 4732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetSkillCancel(BOOL bCanSkillCancel) 
#line 4735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = bCanSkillCancel ;
#line 4737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CheckNormalAttack(CEntity * pEntity,FLOAT fDist) 
#line 4742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsCharacter  ())
#line 4745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackCharacter  (pEntity  , fDist );
#line 4747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsEnemy  ())
#line 4749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackEnemy  (pEntity  , fDist );
#line 4751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsPet  ())
#line 4753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackPet  (pEntity  , fDist );
#line 4755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsSlave  ())
#line 4757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackSlave  (pEntity  , fDist );
#line 4759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pEntity  -> IsWildPet  ())
#line 4761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackWildPet  (pEntity  , fDist );
#line 4763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CheckAttackTarget(INDEX iSkillIndex,CEntity * pEntity,FLOAT fDist) 
#line 4769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pEntity )
#line 4771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SE_Get_UIManagerPtr  () -> IsCSFlagOn  (CSF_CANNOT_ATTACK_MASK ))
#line 4777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> GetFirstExFlags  () & (ENF_EX1_PEACEFUL  | ENF_EX1_PRODUCTION  | ENF_EX1_NPC  | ENF_EX1_CURRENT_PET  | ENF_EX1_CURRENT_WILDPET  | ENF_EX1_TOTEM ))
#line 4783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iSkillIndex  == - 1 && ! (pEntity  -> GetFlags  () & ENF_ALIVE ))
#line 4789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iSkillIndex  == - 1 && _pNetwork  -> MyCharacterInfo  . bPetRide )
#line 4795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iSkillIndex  == - 1 && _pNetwork  -> MyCharacterInfo  . bWildPetRide )
#line 4801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 4806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iSkillIndex  == - 1)
#line 4812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckNormalAttack  (pEntity  , fDist );
#line 4815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return _pNetwork  -> CheckSkillAttack  (iSkillIndex  , pEntity );
#line 4820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CheckEntityOfTarget(CEntity * pEntity,CEntity * pTarget) 
#line 4825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  == NULL )
#line 4827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((CUnit  *) pEntity ) -> CheckTarget  (pTarget );
#line 4832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 4834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckDratanWarInside(CCharacterTarget * pTarget) 
#line 4835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  == NULL )
#line 4837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . zoneNo  == 4 && 
#line 4843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pNetwork  -> MyCharacterInfo  . x  >= 72 && _pNetwork  -> MyCharacterInfo  . x  <= 696 && 
#line 4844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . z  >= 2344 && _pNetwork  -> MyCharacterInfo  . z  <= 3016))
#line 4845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vObjectPos ;
#line 4847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vObjectPos  = pTarget  -> GetEntity  () -> en_plPlacement  . pl_PositionVector ;
#line 4848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vObjectPos  (1) >= 72 && vObjectPos  (1) <= 696 && 
#line 4849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vObjectPos  (3) >= 2344 && vObjectPos  (3) <= 3016)
#line 4850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 4852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 4858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::MyCheckDratanWarInside() 
#line 4859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . zoneNo  == 4 && 
#line 4862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pNetwork  -> MyCharacterInfo  . x  >= 72 && _pNetwork  -> MyCharacterInfo  . x  <= 696 && 
#line 4863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . z  >= 2344 && _pNetwork  -> MyCharacterInfo  . z  <= 3016))
#line 4864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 4866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 4871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX CPlayer::WarTypeAttackGroup(SBYTE sbType) 
#line 4872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbType  == WCJF_ATTACK_GUILD  || sbType  == WCJF_ATTACK_CHAR )
#line 4874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return JOINWAR_ATTACK ;
#line 4876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbType  == WCJF_OWNER  || sbType  == WCJF_DEFENSE_GUILD  || sbType  == WCJF_DEFENSE_CHAR )
#line 4878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return JOINWAR_DEFENSE ;
#line 4880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return JOINWAR_NONE ;
#line 4883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 4887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAttackCharacter(CEntity * penEnt,FLOAT fLength) 
#line 4888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bIsPartyMember  = FALSE ;
#line 4890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bIsPartyMember  = penEnt  -> IsSecondExtraFlagOn  (ENF_EX2_MYPARTY );
#line 4892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  > _pNetwork  -> MyCharacterInfo  . attackrange )
#line 4893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bIsPartyMember )
#line 4899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , penEnt  -> GetNetworkID  ());
#line 4905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  == NULL )
#line 4906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 4913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 4917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GAMEDATAMGR  () -> GetPartyInfo  () -> IsExpedetionMember  (pTarget  -> GetCIndex  ()))
#line 4918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const UWORD  sbAttributePos  = _pNetwork  -> MyCharacterInfo  . sbAttributePos ;
#line 4923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const UWORD  sbCharAttributePos  = pTarget  -> cha_sbAttributePos ;
#line 4925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbJoinFlagMerac  = _pNetwork  -> MyCharacterInfo  . sbJoinFlagMerac ;
#line 4926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbCharacterJoinFlagMerac  = pTarget  -> cha_sbJoinFlagMerac ;
#line 4929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbJoinFlagDratan  = _pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan ;
#line 4930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbCharacterJoinFlagDratan  = pTarget  -> cha_sbJoinFlagDratan ;
#line 4932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const LONG  lGuildIndex  = pTarget  -> cha_lGuildIndex ;
#line 4934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bIsDartanWar  = pUIManager  -> GetSiegeWarfareNew  () -> GetWarState  ();
#line 4935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bIsMeracWar  = _pUISWDoc  -> IsWar  ();
#line 4937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bIsCharacterInsideDratan  = CheckDratanWarInside  (pTarget );
#line 4938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iSyndicateType  = pTarget  -> cha_iSyndicateType ;
#line 4940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbAttributePos  & MATT_FREEPKZONE  && sbCharAttributePos  & MATT_FREEPKZONE )
#line 4941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 4943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbAttributePos  & MATT_PEACE  || sbCharAttributePos  & MATT_PEACE )
#line 4947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsRvrZone  () == TRUE )
#line 4952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . iSyndicateType  != iSyndicateType )
#line 4954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 4956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . lGuildIndex  != - 1 
#line 4961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& lGuildIndex  == _pNetwork  -> MyCharacterInfo  . lGuildIndex  
#line 4962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pNetwork  -> MyCharacterInfo  . EntranceType  != CURRENT_ENTER_PARTYCUBE )
#line 4963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((sbAttributePos  & MATT_WAR  && sbCharAttributePos  & MATT_WAR ) || 
#line 4973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CheckDratanWarInside  (pTarget ))
#line 4974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetSiegeWarfareNew  () -> GetWarState  ())
#line 4981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbJoinFlagDratan  == WCJF_NONE )
#line 4984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 4986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagDratan  == WCJF_OWNER  || 
#line 4990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlagDratan  == WCJF_DEFENSE_GUILD )
#line 4991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagDratan  == WCJF_OWNER  || 
#line 4994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagDratan  == WCJF_DEFENSE_GUILD )
#line 4995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 4996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 4997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 4998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 4999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagDratan  == WCJF_ATTACK_GUILD )
#line 5005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagDratan  == WCJF_ATTACK_GUILD )
#line 5008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pUISWDoc  -> IsWar  () && ! _pUISWDoc  -> IsSelectBattle  ())
#line 5022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbJoinFlagMerac  == WCJF_NONE )
#line 5025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagMerac  == WCJF_DEFENSE_CHAR  || sbJoinFlagMerac  == WCJF_OWNER  || sbJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagMerac  == WCJF_OWNER  || 
#line 5033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_CHAR  || 
#line 5034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagMerac  == WCJF_ATTACK_GUILD  || 
#line 5045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlagMerac  == WCJF_ATTACK_CHAR )
#line 5046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagMerac  == WCJF_ATTACK_GUILD  || 
#line 5049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_ATTACK_CHAR )
#line 5050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  () || IsLegitTarget  (penEnt ))
#line 5052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pUISWDoc  -> IsSelectBattle  ())
#line 5066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbJoinFlagMerac  == WCJF_NONE )
#line 5069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagMerac  == WCJF_DEFENSE_CHAR  || sbJoinFlagMerac  == WCJF_OWNER  || sbJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagMerac  == WCJF_OWNER  || 
#line 5077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_CHAR  || 
#line 5078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagMerac  == WCJF_OWNER  || 
#line 5089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbCharacterJoinFlagMerac  == WCJF_OWNER  || 
#line 5093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_CHAR  || 
#line 5094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbCharacterJoinFlagMerac  == WCJF_DEFENSE_GUILD )
#line 5095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlagMerac  == WCJF_ATTACK_GUILD  || 
#line 5105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlagMerac  == WCJF_ATTACK_CHAR )
#line 5106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  () || IsLegitTarget  (penEnt ) || pUIManager  -> GetGuildBattle  () -> IsEnemy  (penEnt  -> en_ulID ))
#line 5114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  () || IsLegitTarget  (penEnt ) || pUIManager  -> GetGuildBattle  () -> IsEnemy  (penEnt  -> en_ulID ))
#line 5128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAttackPet(CEntity * pEntity,FLOAT fLength) 
#line 5143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_PET ))
#line 5145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_PET  , pEntity  -> GetNetworkID  ());
#line 5151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPetTarget  * pTarget  = static_cast  < CPetTarget  * > (pObject );
#line 5155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pCharObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pTarget  -> pet_OwnerIndex );
#line 5157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharObject  != NULL )
#line 5158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackCharacter  (pCharObject  -> GetEntity  () , fLength );
#line 5161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAttackWildPet(CEntity * pEntity,FLOAT fLength) 
#line 5169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 5171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_WILDPET  , pEntity  -> GetNetworkID  ());
#line 5177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWildPetTarget  * pTarget  = static_cast  < CWildPetTarget  * > (pObject );
#line 5181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pCharObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pTarget  -> m_nOwnerIndex );
#line 5183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharObject  != NULL )
#line 5184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pCharTarget  = static_cast  < CCharacterTarget  * > (pCharObject );
#line 5187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharTarget  -> cha_statusEffect  . IsState  (EST_ASSIST_INVISIBLE ))
#line 5188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackCharacter  (pCharTarget  -> GetEntity  () , fLength );
#line 5194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAttackSlave(CEntity * pEntity,FLOAT fLength) 
#line 5205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE )){return FALSE ;}
#line 5208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_SLAVE  , pEntity  -> GetNetworkID  ());
#line 5210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSlaveTarget  * pTarget  = static_cast  < CSlaveTarget  * > (pObject );
#line 5214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pCharObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pTarget  -> slave_OwnerIndex );
#line 5216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharObject  != NULL )
#line 5217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackCharacter  (pCharObject  -> GetEntity  () , fLength );
#line 5219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAttackEnemy(CEntity * pEntity,float fLength) 
#line 5230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) ((CEntity  *) pEntity )) -> m_nMobDBIndex ;
#line 5233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbJoinFlagMerac  = _pNetwork  -> MyCharacterInfo  . sbJoinFlagMerac ;
#line 5234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbJoinFlag  = sbJoinFlagMerac ;
#line 5236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 5237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScaledSize  = MD  -> GetScaledSize  ();
#line 5238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iSyndicateType  = MD  -> GetSyndicateType  ();
#line 5241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsRvrZone  () && iSyndicateType  == _pNetwork  -> MyCharacterInfo  . iSyndicateType )
#line 5242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbJoinFlagDratan  = _pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan ;
#line 5250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (sbJoinFlagMerac  == WCJF_NONE  || sbJoinFlagDratan  == WCJF_NONE );
#line 5252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  = (_pNetwork  -> MyCharacterInfo  . zoneNo  == 7) ? sbJoinFlagMerac  : sbJoinFlagDratan ;
#line 5257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == DRATAN_LORD_SYMBOL_INDEX )
#line 5258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  > (_pNetwork  -> MyCharacterInfo  . attackrange  + fScaledSize ))
#line 5262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == LORD_SYMBOL_INDEX )
#line 5266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . lGuildPosition  < GUILD_MEMBER_MEMBER  && 
#line 5269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_ATTACK_GUILD  && fLength  <= 3.0f)
#line 5270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) pEntity ) -> m_nCurrentHealth  <= 0)
#line 5280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 5284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsCastleTower  ())
#line 5285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsCastleGuard  () || MD  -> IsLordSymbol  ())
#line 5291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbJoinFlag  == WCJF_OWNER  || 
#line 5294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_DEFENSE_CHAR  || 
#line 5295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_DEFENSE_GUILD  || 
#line 5296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_NONE )
#line 5297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbJoinFlag  == WCJF_ATTACK_GUILD  && _pUISWDoc  -> IsWar  ())
#line 5302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 5316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  tQtr  = MD  -> IsMyQuarter  ();
#line 5317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tQtr  != QUARTER_NONE )
#line 5318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(tQtr )
#line 5320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case QUARTER_MINE : 
#line 5322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case QUARTER_INSTALL : 
#line 5323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 5325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case QUARTER_ATTACK : 
#line 5326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 5328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsCastleGuard  () || MD  -> IsCastleTower  () || MD  -> IsLordSymbol  ())
#line 5331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbJoinFlag  == WCJF_OWNER  || 
#line 5334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_DEFENSE_CHAR  || 
#line 5335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_DEFENSE_GUILD  || 
#line 5336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbJoinFlag  == WCJF_NONE )
#line 5338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ownerIndex  = 0;
#line 5348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObjectByCIndex  (eOBJ_MOB  , pEntity  -> en_ulID );
#line 5350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pMT  = static_cast  < CMobTarget  * > (pObject );
#line 5353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ownerIndex  = pMT  -> mob_iOwnerIndex ;
#line 5354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ownerIndex  > 0)
#line 5357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . index  == ownerIndex )
#line 5359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 5361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , ownerIndex );
#line 5366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CheckAttackCharacter  (pObject  -> GetEntity  () , 0.f);
#line 5372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 5377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::StartCamera(CEntity * pTarget,BOOL bRestart) 
#line 5386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = pTarget ;
#line 5388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCamera  *) pTarget ) -> m_penTarget  = ((CCamera  *) pTarget ) -> m_penTargetOld ;
#line 5389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (m_penCamera  , EET_TRIGGER  , this );
#line 5390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetWideScreen(CEntity * pTarget,BOOL bWide,FLOAT fFov) 
#line 5393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCamera  *) pTarget ) -> m_bWideScreen  = bWide ;
#line 5396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCamera  *) pTarget ) -> m_fFOV  = fFov ;
#line 5397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCamera  *) pTarget ) -> m_fLastFOV  = fFov ;
#line 5398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::GetProjection(CAnyProjection3D & apr) 
#line 5406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  = m_apr ;
#line 5408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetProduct(SLONG slChaIndex,SBYTE slProductType) 
#line 5412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 5414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  chaID  = _pNetwork  -> SearchClientChaIndex  (slChaIndex );
#line 5415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chaID  != - 1)
#line 5416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (chaID  , penEntity ))
#line 5418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPlayProduceNum  = (SLONG ) slProductType  + 1;
#line 5420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penEntity ) -> ProduceNow  ();
#line 5421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetConsensus(SLONG slChaIndex) 
#line 5427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 5429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  chaID  = _pNetwork  -> SearchClientChaIndex  (slChaIndex );
#line 5430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chaID  != - 1)
#line 5431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (chaID  , penEntity ))
#line 5433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penEntity ) -> ConsensusNow  ();
#line 5440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetSummonCommand(CEntity * pEntity,INDEX iCommand) 
#line 5446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pEntity )
#line 5448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 5450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CSlave  *) pEntity ) -> SetCurrentCommand  (iCommand );
#line 5453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::WarpTeleport(FLOAT fX,FLOAT fZ,FLOAT fH,FLOAT fR,SBYTE sbLayer) 
#line 5456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET_REAL );
#line 5459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . x  = fX ;
#line 5460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . z  = fZ ;
#line 5461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . h  = fH ;
#line 5462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r  = fR ;
#line 5463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . yLayer  = sbLayer ;
#line 5468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fCameraAngle  = 0.0f;
#line 5470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 5471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 5472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 5475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = FALSE ;
#line 5476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRcvAtMsg  = TRUE ;
#line 5477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = FALSE ;
#line 5478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = - 1;
#line 5480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerInit  (false );
#line 5488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 5492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoTo  (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  + 0.5f , _pNetwork  -> MyCharacterInfo  . z  , 
#line 5493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r );
#line 5494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName CPlayer::GetHairMeshName(int iJob,SBYTE sbHairType) 
#line 5497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctName  = CTFileName ("");
#line 5500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbHairType  >= HAIR_GREEN_CAP )
#line 5501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHelmetMeshName  [ iJob  ] [ 1 ];
#line 5503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbHairType  >= HAIR_RED_CAP )
#line 5505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHelmetMeshName  [ iJob  ] [ 0 ];
#line 5507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHairMeshName  [ iJob  ] [ sbHairType  ];
#line 5511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ctName ;
#line 5514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName CPlayer::GetHairTextureName(int iJob,SBYTE sbHairType,SBYTE sbSubType) 
#line 5517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctName  = CTFileName ("");
#line 5520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbHairType  >= HAIR_GREEN_CAP  && sbSubType  == 0)
#line 5521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHelmetTextureName  [ iJob  ] [ 1 ];
#line 5523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbHairType  >= HAIR_RED_CAP  && sbSubType  == 0)
#line 5525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHelmetTextureName  [ iJob  ] [ 0 ];
#line 5527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nType  = sbHairType ;
#line 5532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nType  >= HAIR_GREEN_CAP ){nType  -= HAIR_GREEN_CAP ;}
#line 5533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(nType  >= HAIR_RED_CAP ){nType  -= HAIR_RED_CAP ;}
#line 5535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctName  = _afnHairTextureName  [ iJob  ] [ nType  + sbSubType  ];
#line 5536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ctName ;
#line 5539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetCharacterHairChange(INDEX nSIdx,SBYTE sbType,BOOL IsMe) 
#line 5542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nJob  , nCurCosIndex  = 0;
#line 5544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbHairIndex  = sbType  - 1;
#line 5545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = NULL ;
#line 5546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = NULL ;
#line 5548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsMe )
#line 5549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nJob  = _pNetwork  -> MyCharacterInfo  . job ;
#line 5551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penPlEntity ;
#line 5552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlEntity  = CEntity  :: GetPlayerEntity  (0);
#line 5553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  = penPlEntity  -> en_pmiModelInstance ;
#line 5555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nCurCosIndex  = _pNetwork  -> MyWearCostItem  [ WEAR_COSTUME_HELMET  ] . Item_Index ;
#line 5556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , nSIdx );
#line 5561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  == NULL )
#line 5562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 5564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 5568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pTargetEntity  = pTarget  -> GetEntity  ();
#line 5569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pTargetEntity ) -> m_nHairStyle  = sbType ;
#line 5570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nJob  = pTarget  -> m_nType ;
#line 5571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nCurCosIndex  = ((CCharacter  *) pTargetEntity ) -> IsThereCostumeWearing  (WEAR_COSTUME_HELMET );
#line 5572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  = ((CCharacter  *) pTargetEntity ) -> GetCurrentPlayerModelInstance  ();
#line 5573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nCurCosIndex  > 0)
#line 5576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pCurCosItem  = _pNetwork  -> GetItemData  (nCurCosIndex );
#line 5579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCurCosItem  != NULL )
#line 5580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCurCosItem  -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == true  || pCurCosItem  -> GetItemSmcFileName  () == MODEL_TREASURE )
#line 5582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nCurCosIndex  == ITEM_TREASURE_HELMET )
#line 5584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbHairIndex  = sbHairIndex  % 10;
#line 5586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 5591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , nJob  , sbHairIndex );
#line 5597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsMe )
#line 5598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 5600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 5601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 5605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 5606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetCharacterAppearance(CModelInstance * pMI,int iJob,SBYTE sbHairType,SBYTE sbFaceType) 
#line 5610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeFaceMesh  (pMI  , iJob  , sbFaceType  - 1);
#line 5612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , iJob  , sbHairType  - 1);
#line 5613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 5615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ChangeFaceMesh(CModelInstance * pMI,int iJob,SBYTE sbType) 
#line 5616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pMI  != NULL  && "Invalid ModelInstance Pointer");
#line 5619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iOldMeshID  = pMI  -> mi_iFaceMesh ;
#line 5620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iNewMeshID  = ska_GetIDFromStringTable  (_afnFaceMeshName  [ iJob  ] [ sbType  ]);
#line 5629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXRogue  (iJob ))
#line 5630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * tmpMesh  = pMI  -> FindMeshInstance  (ska_GetIDFromStringTable  ((CTString) _afnFaceMeshName  [ ROGUE  ] [ 0 ]));
#line 5633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpMesh )
#line 5634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (tmpMesh  -> mi_pMesh  -> GetName  ());
#line 5636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXMage  (iJob ))
#line 5641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * tmpMesh  = pMI  -> FindMeshInstance  (ska_GetIDFromStringTable  ((CTString) _afnFaceMeshName  [ MAGE  ] [ 0 ]));
#line 5644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpMesh )
#line 5645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (tmpMesh  -> mi_pMesh  -> GetName  ());
#line 5647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iOldMeshID  == - 1)
#line 5651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iOldMeshID  = ska_GetIDFromStringTable  ((CTString) _afnFaceMeshName  [ iJob  ] [ 0 ]);
#line 5654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * pMESH  = pMI  -> FindMeshInstance  (iOldMeshID );
#line 5657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMESH )
#line 5658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (pMESH  -> mi_pMesh  -> GetName  ());
#line 5660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iNewMeshID  != - 1)
#line 5662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddMesh_t  (_afnFaceMeshName  [ iJob  ] [ sbType  ]);
#line 5664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * pMESHNew  = pMI  -> FindMeshInstance  (iNewMeshID );
#line 5665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iFaceMesh  = iNewMeshID ;
#line 5668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (_afnFaceTextureName  [ iJob  ] [ sbType  ] , _afnFaceTextureName  [ iJob  ] [ sbType  ] . FileName  () , pMESHNew );
#line 5670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_afnFaceTextureName  [ iJob  ] [ sbType  + TOTAL_HEAD  ] . Length  () > 0)
#line 5671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (_afnFaceTextureName  [ iJob  ] [ sbType  + TOTAL_HEAD  ] , _afnFaceTextureName  [ iJob  ] [ sbType  + TOTAL_HEAD  ] . FileName  () , pMESHNew );
#line 5674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ChangeHairMesh(CModelInstance * pMI,int iJob,SBYTE sbType) 
#line 5679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pMI  != NULL  && "Invalid ModelInstance Pointer");
#line 5682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctHairMeshName  = GetHairMeshName  (iJob  , sbType );
#line 5683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctHairTexture0  = GetHairTextureName  (iJob  , sbType  , 0);
#line 5684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctHairTexture1  = GetHairTextureName  (iJob  , sbType  , TOTAL_HAIR );
#line 5685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName ctHairTexture2  = GetHairTextureName  (iJob  , sbType  , TOTAL_HAIR  * 2);
#line 5687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iOldMeshID  = pMI  -> mi_iHairMesh ;
#line 5688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iNewMeshID  = ska_GetIDFromStringTable  (ctHairMeshName );
#line 5691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iOldMeshID  == iNewMeshID )
#line 5692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 5694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXRogue  (iJob ))
#line 5698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * tmpMesh  = pMI  -> FindMeshInstance  (ska_GetIDFromStringTable  ((CTString) _afnHairMeshName  [ ROGUE  ] [ 0 ]));
#line 5701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpMesh )
#line 5702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (tmpMesh  -> mi_pMesh  -> GetName  ());
#line 5704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXMage  (iJob ))
#line 5708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * tmpMesh  = pMI  -> FindMeshInstance  (ska_GetIDFromStringTable  ((CTString) _afnHairMeshName  [ MAGE  ] [ 0 ]));
#line 5711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpMesh )
#line 5712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (tmpMesh  -> mi_pMesh  -> GetName  ());
#line 5714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iOldMeshID  == - 1)
#line 5718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iOldMeshID  = ska_GetIDFromStringTable  ((CTString) _afnHairMeshName  [ iJob  ] [ 0 ]);
#line 5722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * pMESH  = pMI  -> FindMeshInstance  (iOldMeshID );
#line 5725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMESH )
#line 5726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (pMESH  -> mi_pMesh  -> GetName  ());
#line 5728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iNewMeshID  != - 1)
#line 5730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddMesh_t  (ctHairMeshName );
#line 5732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * pMESHNew  = pMI  -> FindMeshInstance  (iNewMeshID );
#line 5733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iHairMesh  = iNewMeshID ;
#line 5738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (ctHairTexture0  , ctHairTexture0  . FileName  () , pMESHNew );
#line 5740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctHairTexture1  . Length  () > 0)
#line 5741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (ctHairTexture1  , ctHairTexture1  . FileName  () , pMESHNew );
#line 5744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctHairTexture2  . Length  () > 0)
#line 5746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (ctHairTexture2  , ctHairTexture2  . FileName  () , pMESHNew );
#line 5749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetChaWearing(CCharacterTarget * pTarget,CEntity * penEntity,CNetworkMessage * istr) 
#line 5755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  i ;
#line 5757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  wear_index ;
#line 5758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  item_plus ;
#line 5759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX cos_index ;
#line 5762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: appearPc  * pPack  = reinterpret_cast  < UpdateClient  :: appearPc  * > (istr  -> GetBuffer  ());
#line 5764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(i  = 0;i  < WEAR_COUNT ;++ i )
#line 5765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bNotWear  = FALSE ;
#line 5768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  >= WEARING_SHOW_END  + 1)
#line 5769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
wear_index  = pPack  -> backwing  . dbIndex ;
#line 5771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
item_plus  = pPack  -> backwing  . plus ;
#line 5772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
wear_index  = pPack  -> wearingShowList  [ i  ] . dbIndex ;
#line 5776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
item_plus  = pPack  -> wearingShowList  [ i  ] . plus ;
#line 5777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cos_index  = ((CCharacter  *) penEntity ) -> IsThereCostumeWearing  (i );
#line 5780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 5782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cos_index  >= 0)
#line 5783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bNotWear  = TRUE ;
#line 5786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetItemData  (cos_index ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 5787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemCos  = _pNetwork  -> GetItemData  (cos_index );
#line 5790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((CTString) pItemCos  -> GetItemSmcFileName  () != MODEL_TREASURE )
#line 5791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (i );
#line 5793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , i  , ((CCharacter  *) penEntity ) -> m_ChaList );
#line 5794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> GetItemData  (cos_index ));
#line 5795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cos_index  == ITEM_TREASURE_HELMET )
#line 5799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> ModelChangeHair  (penEntity  , pPack  -> job  , pPack  -> hairStyle  % 10);
#line 5801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(wear_index  > 0)
#line 5805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (wear_index  , _pNetwork  -> GetItemData  (wear_index ) -> GetWearingPosition  ());
#line 5807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bNotWear  = FALSE ;
#line 5811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_index  >= 0)
#line 5814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetWearing  (_pNetwork  -> GetItemData  (wear_index ) -> GetWearingPosition  () , wear_index );
#line 5816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(wear_index  > 0)
#line 5819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (wear_index  , _pNetwork  -> GetItemData  (wear_index ) -> GetWearingPosition  ());
#line 5821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bNotWear  = TRUE ;
#line 5822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemPlus  [ i  ] = item_plus ;
#line 5825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bNotWear  && pMI )
#line 5826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  itemIdx  = (pTarget  -> cha_CosWear  [ i  ] < 0) ? wear_index  : pTarget  -> cha_CosWear  [ i  ];
#line 5828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  subType  = - 1;
#line 5829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pWearItem  = _pNetwork  -> GetItemData  (itemIdx );
#line 5830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWearItem  != NULL )
#line 5831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
subType  = pWearItem  -> GetSubType  ();
#line 5833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Change  (
#line 5835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_nType  
#line 5836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, pWearItem  
#line 5837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (wear_index ) -> GetWearingPosition  () 
#line 5838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, pTarget  -> cha_itemPlus  [ i  ] 
#line 5839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 5840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption  
#line 5841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, subType 
#line 5842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 5843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 5844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(i  = WEAR_ACCESSORY_1 ;i  < WEAR_ACCESSORY_MAX ;i  ++)
#line 5848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> accessory  [ i  ] > - 1)
#line 5850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 5852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 5853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Change  (
#line 5855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_nType  
#line 5856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (pPack  -> accessory  [ i  ]) 
#line 5857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, i  
#line 5858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, 0 
#line 5859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 5860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption  
#line 5861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (pPack  -> accessory  [ i  ]) -> GetSubType  ()
#line 5862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 5863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemAccessory  [ i  ] = pPack  -> accessory  [ i  ];
#line 5867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nRelicEffectType  = - 1;
#line 5869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> accessory  [ i  ])
#line 5870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10951: {nRelicEffectType  = 0;}break ;
#line 5872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10952: {nRelicEffectType  = 1;}break ;
#line 5873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10953: {nRelicEffectType  = 2;}break ;
#line 5874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nRelicEffectType  != - 1)
#line 5877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddRelicEffect  (nRelicEffectType  , & pMI  -> m_tmSkaTagManager );
#line 5879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetCharCostumeWearing(CCharacterTarget * pTarget,CEntity * penEntity,CNetworkMessage * istr) 
#line 5888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  == NULL )
#line 5890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 5892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateClient  :: appearPc  * pPack  = reinterpret_cast  < UpdateClient  :: appearPc  * > (istr  -> GetBuffer  ());
#line 5896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;i  < WEAR_COSTUME_TOTAL ;++ i )
#line 5897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetCostumeWearing  (i  , pPack  -> costume2  [ i  ]);
#line 5899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_CosWear  [ i  ] = pPack  -> costume2  [ i  ];
#line 5900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::WearingCostumeArmor(CNetworkMessage * istr) 
#line 5905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index  , item_index ;
#line 5907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  wear_pos ;
#line 5909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 5910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> wear_pos ;
#line 5911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_index ;
#line 5913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 5915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , cha_index );
#line 5917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 5918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pObject  -> GetEntity  ();
#line 5921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 5922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX wear_index  = ((CCharacter  *) penEntity ) -> IsThereWearing  (wear_pos );
#line 5923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX realWearIndex  = - 1;
#line 5924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  effect_plus  = - 1;
#line 5926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 5928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = ((CCharacter  *) penEntity ) -> IsThereCostumeWearing  (wear_pos );
#line 5930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(realWearIndex  > 0)
#line 5931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetCostumeWearing  (wear_pos  , - 1);
#line 5934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetItemData  (realWearIndex ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 5935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((CTString) _pNetwork  -> GetItemData  (realWearIndex ) -> GetItemSmcFileName  () != MODEL_TREASURE )
#line 5937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (realWearIndex );
#line 5939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(wear_pos  == WEAR_HELMET  && (CTString) _pNetwork  -> GetItemData  (realWearIndex ) -> GetItemSmcFileName  () == MODEL_TREASURE )
#line 5941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (wear_pos );
#line 5943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_index  > 0)
#line 5948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (wear_index );
#line 5950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (wear_pos );
#line 5954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(item_index  > 0 && _pNetwork  -> GetItemData  (item_index ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 5960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_index  > 0)
#line 5962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (wear_index );
#line 5964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (wear_pos );
#line 5968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(item_index  > 0)
#line 5973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemCos  = _pNetwork  -> GetItemData  (item_index );
#line 5976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemCos  -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false  && (CTString) pItemCos  -> GetItemSmcFileName  () != MODEL_TREASURE )
#line 5977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (item_index  , wear_pos );
#line 5979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = item_index ;
#line 5980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(item_index  == ITEM_TREASURE_HELMET )
#line 5984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbHair  = ((CCharacter  *) penEntity ) -> m_nHairStyle  - 1;
#line 5986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbHair  = sbHair  % 10;
#line 5987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , pTarget  -> m_nType  , sbHair );
#line 5988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = item_index ;
#line 5989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetCostumeWearing  (wear_pos  , item_index );
#line 5992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(wear_index  > 0)
#line 5994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 5995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (wear_index  , wear_pos );
#line 5996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = wear_index ;
#line 5997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 5998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 5999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_pos  != WEAR_COSTUME_HELMET )
#line 6001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingDefaultArmor  (wear_pos );
#line 6003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , pTarget  -> m_nType  , ((CCharacter  *) penEntity ) -> m_nHairStyle  - 1);
#line 6007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . DeleteEffect  (wear_pos );
#line 6009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption );
#line 6010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = - 1;
#line 6011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(realWearIndex  >= 0)
#line 6014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Change  (
#line 6016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_nType  
#line 6017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realWearIndex ) 
#line 6018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, wear_pos  
#line 6019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, pTarget  -> cha_itemPlus  [ wear_pos  ] 
#line 6020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 6021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption  
#line 6022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realWearIndex ) -> GetSubType  ()
#line 6023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 6025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_state  & PLAYER_STATE_SUPPORTER )
#line 6026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strEffectName  = CTString ("Item_support");
#line 6028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddAccessoryEffect  (strEffectName  , & pMI  -> m_tmSkaTagManager );
#line 6029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption );
#line 6031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 6032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::WearingCostumeArmorOneSuit(CNetworkMessage * istr) 
#line 6038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX cha_index  , item_index  , slCount ;
#line 6040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX wear_pos ;
#line 6042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 6043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> slCount ;
#line 6044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < slCount ;++ i )
#line 6045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> wear_pos ;
#line 6047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_index ;
#line 6048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
WearingCostumeArmorProcess  (cha_index  , wear_pos  , item_index );
#line 6049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsHelmet(INDEX iCharIndex) 
#line 6053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , iCharIndex );
#line 6056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 6057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CCharacter  *) (pObject  -> GetEntity  ())) -> IsThereWearing  (WEAR_HELMET ) >= 0 || 
#line 6059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) (pObject  -> GetEntity  ())) -> IsThereCostumeWearing  (WEAR_COSTUME_HELMET ) >= 0)
#line 6060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 6062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 6065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::WearingCostumeArmorProcess(INDEX slCharIndex,INDEX sbWwearPos,INDEX slItemIndex) 
#line 6069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 6072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , slCharIndex );
#line 6074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 6075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 6078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 6080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 6081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX wear_index  = ((CCharacter  *) penEntity ) -> IsThereWearing  (sbWwearPos );
#line 6082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX realWearIndex  = - 1;
#line 6083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  effect_plus  = - 1;
#line 6085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = ((CCharacter  *) penEntity ) -> IsThereCostumeWearing  (sbWwearPos );
#line 6087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(realWearIndex  > 0)
#line 6088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetCostumeWearing  (sbWwearPos  , - 1);
#line 6091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetItemData  (realWearIndex ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 6092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((CTString) _pNetwork  -> GetItemData  (realWearIndex ) -> GetItemSmcFileName  () != MODEL_TREASURE )
#line 6094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (realWearIndex );
#line 6096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(sbWwearPos  == WEAR_HELMET  && (CTString) _pNetwork  -> GetItemData  (realWearIndex ) -> GetItemSmcFileName  () == MODEL_TREASURE )
#line 6098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (sbWwearPos );
#line 6100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_index  > 0)
#line 6105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (wear_index );
#line 6107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (sbWwearPos );
#line 6111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(slItemIndex  > 0 && 
#line 6115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> GetItemData  (slItemIndex ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 6116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_index  > 0)
#line 6118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteCurrentArmor  (wear_index );
#line 6120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> DeleteDefaultArmor  (sbWwearPos );
#line 6124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(slItemIndex  > 0)
#line 6128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetItemData  (slItemIndex ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 6130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (slItemIndex  , sbWwearPos );
#line 6132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = slItemIndex ;
#line 6133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetCostumeWearing  (sbWwearPos  , slItemIndex );
#line 6136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(wear_index  > 0)
#line 6138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (wear_index  , sbWwearPos );
#line 6140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = wear_index ;
#line 6141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbWwearPos  != WEAR_COSTUME_HELMET )
#line 6145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingDefaultArmor  (sbWwearPos );
#line 6147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , pTarget  -> m_nType  , ((CCharacter  *) penEntity ) -> m_nHairStyle  - 1);
#line 6151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . DeleteEffect  (sbWwearPos );
#line 6153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption );
#line 6154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realWearIndex  = - 1;
#line 6155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(realWearIndex  >= 0)
#line 6158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Change  (
#line 6160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_nType  
#line 6161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realWearIndex ) 
#line 6162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, sbWwearPos  
#line 6163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, pTarget  -> cha_itemPlus  [ sbWwearPos  ] 
#line 6164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 6165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption  
#line 6166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realWearIndex ) -> GetSubType  ()
#line 6167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 6169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_state  & PLAYER_STATE_SUPPORTER )
#line 6170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strEffectName  = CTString ("Item_support");
#line 6172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddAccessoryEffect  (strEffectName  , & pMI  -> m_tmSkaTagManager );
#line 6173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption );
#line 6175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 6176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::NickNameEffect(CEntity * pAttackEn,CEntity * pTargetEn,NickNameEffectType iType) 
#line 6182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNickDamageFile ;
#line 6184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iNickIndex ;
#line 6187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pAttackEn  == this )
#line 6188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iNickIndex  = _pNetwork  -> MyCharacterInfo  . iNickType ;
#line 6192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iType  == NICKNAME_ATTACK_EFFECT )
#line 6193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTargetEn  -> SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTargetEn  -> IsCharacter  ())
#line 6197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iNickIndex  = pTargetEn  -> en_pCharacterTarget  -> cha_NickType ;
#line 6200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTargetEn  -> SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iType  == NICKNAME_DAMAGE_EFFECT )
#line 6205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTargetEn  -> IsCharacter  ())
#line 6209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iNickIndex  = pTargetEn  -> en_pCharacterTarget  -> cha_NickType ;
#line 6212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iType  == NICKNAME_ATTACH_EFFECT )
#line 6217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pAttackEn  -> IsCharacter  () && iType  == NICKNAME_ATTACK_EFFECT )
#line 6226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iNickIndex  = pAttackEn  -> en_pCharacterTarget  -> cha_NickType ;
#line 6229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTargetEn  -> SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTargetEn  -> IsCharacter  () && iType  == NICKNAME_DAMAGE_EFFECT )
#line 6233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iNickIndex  = pTargetEn  -> en_pCharacterTarget  -> cha_NickType ;
#line 6236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTargetEn  -> SetNickNameDamageEffect  (iNickIndex  , iType );
#line 6237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetNickNameDamageEffect(INDEX iNickIndex,NickNameEffectType iType) 
#line 6242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNickDamageFile ;
#line 6245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iNickIndex  > 0 && iType  == NICKNAME_ATTACK_EFFECT )
#line 6246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strNickDamageFile  = TitleStaticData  :: getData  (iNickIndex ) -> GetAttackEffectFile  ();
#line 6248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iNickIndex  > 0 && iType  == NICKNAME_DAMAGE_EFFECT )
#line 6250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strNickDamageFile  = TitleStaticData  :: getData  (iNickIndex ) -> GetDamageEffectFile  ();
#line 6252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iNickIndex  > 0 && iType  == NICKNAME_ATTACH_EFFECT )
#line 6254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strNickDamageFile  = TitleStaticData  :: getData  (iNickIndex ) -> GetEffectFile  ();
#line 6256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strNickDamageFile  != CTString ("") && iType  != NICKNAME_ATTACH_EFFECT )
#line 6259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (strNickDamageFile  
#line 6261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & GetCurrentPlayerModelInstance  () -> m_tmSkaTagManager  
#line 6262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 6263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(strNickDamageFile  != CTString ("") && iType  == NICKNAME_ATTACH_EFFECT )
#line 6265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . AddNickEffect  (strNickDamageFile  , & GetCurrentPlayerModelInstance  () -> m_tmSkaTagManager );
#line 6267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetCustomTitleEffect(CTString effectName) 
#line 6271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(effectName  != CTString (""))
#line 6273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . AddNickEffect  (effectName  , & GetCurrentPlayerModelInstance  () -> m_tmSkaTagManager );
#line 6275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetDecoModeCamera(FLOAT fDistance,FLOAT fHeight) 
#line 6279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = GetPlacement  () . pl_OrientationAngle  (1) / 2 + 90;
#line 6282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (2) = 0.0f;
#line 6285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_fCameraHeight  = fHeight ;
#line 6286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_fFaceChangeDistance  = fDistance ;
#line 6303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetAppearanceData(int index,SBYTE hairstyle,SBYTE facestyle) 
#line 6306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 6308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (index  , penEntity ))
#line 6309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nHairStyle  = hairstyle ;
#line 6311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nFaceStyle  = facestyle ;
#line 6312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ShowDamageResult(CEntity * pEntity,ULONG targetDamage,SBYTE targetFlag,SLONG skillIndex) 
#line 6318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 6320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strHp ;
#line 6321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strName ;
#line 6322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strName  = pEntity  -> GetName  ();
#line 6324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSkillMessage ;
#line 6326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> IsSitting  () && targetFlag  != HITTYPE_MISS )
#line 6327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> GetCharacterInfo  () -> UseAction  (3);
#line 6329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(targetFlag )
#line 6332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_MISS : 
#line 6334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (413 , "%s의 공격을 피했습니다.") , strName );
#line 6335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_WEAK : 
#line 6338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (685 , "약한 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_NORMAL : 
#line 6355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (414 , "일반공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_STRONG : 
#line 6372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (686 , "강한 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_HARD : 
#line 6389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (687 , "매우 강한 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_CRITICAL : 
#line 6406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (411 , "크리티컬 히트! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamageMe  = TRUE ;
#line 6422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_DEADLY : 
#line 6424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  != - 1)
#line 6425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(targetDamage  != 0){
#line 6428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1390 , "스킬 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 6430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSkillMessage  . PrintF  (_S  (5814 , "%s의 스킬 공격을 막았습니다.") , strName );
#line 6431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSkillMessage );
#line 6432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (688 , "데들리 공격! %s에게 %d의 데미지를 받았습니다.") , strName  , targetDamage );
#line 6437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACKED );
#line 6439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamageMe  = TRUE ;
#line 6440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 6444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ShowAttackResult(CEntity * penTargetEntity,ULONG targetDamage,SBYTE targetFlag,SLONG skillIndex) 
#line 6445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 6447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strHp ;
#line 6448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMobName ;
#line 6449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMobName  = penTargetEntity  -> GetName  ();
#line 6451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  slCurrentWeight  = _pNetwork  -> MyCharacterInfo  . weight ;
#line 6452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  slMaxWeight  = _pNetwork  -> MyCharacterInfo  . maxweight ;
#line 6453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> AddDamageData  (targetDamage  , targetFlag  , penTargetEntity  -> en_ulID  , FALSE );
#line 6456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(targetFlag )
#line 6457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_MISS : 
#line 6459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S2  (409 , strMobName  , "%s<가> 당신의 공격을 피했습니다.") , strMobName );
#line 6460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_WEAK : 
#line 6463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (689 , "약한 공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_NORMAL : 
#line 6467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  == - 1)
#line 6468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (410 , "일반공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (787 , "스킬 공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_STRONG : 
#line 6478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (690 , "강한 공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_HARD : 
#line 6482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (691 , "매우 강한 공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_CRITICAL : 
#line 6486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (407 , "크리티컬 히트! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = TRUE ;
#line 6489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HITTYPE_DEADLY : 
#line 6491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (692 , "데들리 공격! %s에게 %d의 데미지를 주었습니다.") , strMobName  , targetDamage );
#line 6492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ATTACK );
#line 6493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = TRUE ;
#line 6494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
#define IS_FLAG_ON(flagAll, flagVal) ( (flagAll) & (static_cast<SQUAD>((1L))<<(flagVal)) )
void CPlayer::CancelProduct() 
#line 6500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = FALSE ;
#line 6502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = - 1;
#line 6506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 6507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 6509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 6512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Read_net_Character(int type,int sub_type,CNetworkMessage * istr) 
#line 6518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 6521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesiredPosition ;
#line 6522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aDesiredAngle ;
#line 6523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 6524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 6526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index ;
#line 6527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  wear_pos ;
#line 6528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  item_index ;
#line 6530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(istr  == NULL )
#line 6531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 6533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 6534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 6535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 6536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(type )
#line 6539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_WEARING : 
#line 6541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 6543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> wear_pos ;
#line 6544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_index ;
#line 6545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  item_plus ;
#line 6546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_plus ;
#line 6548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX realTakeOffIndex  = - 1;
#line 6550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , cha_index );
#line 6552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 6553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 6555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 6557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  != NULL )
#line 6558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  tmpItem_plus  = item_plus ;
#line 6560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bAccessory  = false ;
#line 6561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nAcceWearPos  = 0;
#line 6562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nRelicEffectType  = - 1;
#line 6564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_pos  >= 7 && wear_pos  < 10)
#line 6565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAccessory  = true ;
#line 6567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nAcceWearPos  = wear_pos  - 7;
#line 6568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(item_index  != - 1)
#line 6571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> WearingArmor  (item_index  , wear_pos );
#line 6574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_pos  < WEAR_COUNT )
#line 6575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemPlus  [ wear_pos  ] = item_plus ;
#line 6577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAccessory  == true )
#line 6580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemAccessory  [ nAcceWearPos  ] = item_index ;
#line 6583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(item_index )
#line 6584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10951: {nRelicEffectType  = 0;}break ;
#line 6586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10952: {nRelicEffectType  = 1;}break ;
#line 6587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10953: {nRelicEffectType  = 2;}break ;
#line 6588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> TakeOffWearing  (wear_pos  , pTarget );
#line 6595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_pos  < WEAR_COUNT )
#line 6596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemPlus  [ wear_pos  ] = - 1;
#line 6598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CCharacter  *) penEntity ) -> IsThereWearing  (wear_pos ) >= 0)
#line 6601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpItem_plus  = - 1;
#line 6603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAccessory  == true )
#line 6606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  DeleteRelicEffect  = false ;
#line 6610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pTarget  -> cha_itemAccessory  [ nAcceWearPos  ])
#line 6611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10951: 
#line 6613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10952: 
#line 6614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10953: 
#line 6615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteRelicEffect  = true ;
#line 6617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemAccessory  [ nAcceWearPos  ] = item_index ;
#line 6624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(DeleteRelicEffect  == true )
#line 6625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . DeleteRelicEffect  ();
#line 6627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nRelicEffectType  = pTarget  -> GetShowAnotherRelicEffect  ();
#line 6628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realTakeOffIndex  = ((CCharacter  *) penEntity ) -> IsThereWearing  (wear_pos );
#line 6633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iCosWear  = - 1;
#line 6634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(wear_pos  != WEAR_BACKWING )
#line 6635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iCosWear  = ((CCharacter  *) penEntity ) -> IsThereCostumeWearing  (wear_pos );
#line 6637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iCosWear  = ((CCharacter  *) penEntity ) -> IsThereCostumeWearing  (WEAR_COSTUME_BACKWING );
#line 6641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCosWear  > 0)
#line 6643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
realTakeOffIndex  = iCosWear ;
#line 6645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 6649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 6650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Change  (
#line 6652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> m_nType  
#line 6653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realTakeOffIndex ) 
#line 6654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, wear_pos  
#line 6655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, tmpItem_plus  
#line 6656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 6657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption  
#line 6658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (realTakeOffIndex ) -> GetSubType  ()
#line 6659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 6661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_state  & PLAYER_STATE_SUPPORTER )
#line 6662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strEffectName  = CTString ("Item_support");
#line 6664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddAccessoryEffect  (strEffectName  , & pMI  -> m_tmSkaTagManager );
#line 6665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , (pTarget  -> m_nType  == NIGHTSHADOW ) ? 1 : pTarget  -> cha_sbItemEffectOption );
#line 6667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 6669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nRelicEffectType  != - 1)
#line 6670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pCharMI  = penEntity  -> GetModelInstance  ();
#line 6672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharMI  != NULL )
#line 6673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddRelicEffect  (nRelicEffectType  , & pCharMI  -> m_tmSkaTagManager );
#line 6675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE : 
#line 6684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  type ;
#line 6686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index ;
#line 6687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  mobnum ;
#line 6689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> type ;
#line 6691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(type  == MSG_CHANGE_START )
#line 6692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 6694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> mobnum ;
#line 6696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cha_index  == _pNetwork  -> MyCharacterInfo  . index )
#line 6697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nChangeMonsterId  = mobnum ;
#line 6699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = TRUE ;
#line 6700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMobChange  = FALSE ;
#line 6702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iStopChangeItem  = 521;
#line 6705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Notice  * pNotice  = GAMEDATAMGR  () -> GetNotice  ();
#line 6706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pNotice  != NULL )
#line 6707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pNotice  -> AddToNoticeList  (iStopChangeItem  , Notice  :: NOTICE_POLYMOPH );
#line 6709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> SetCSFlagOn  (CSF_TELEPORT );
#line 6712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else 
#line 6713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  chaID  = _pNetwork  -> SearchClientChaIndex  (cha_index );
#line 6715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chaID  != - 1)
#line 6716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (chaID  , penEntity ))
#line 6718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_bMobChange  = FALSE ;
#line 6720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetPolymophMobIndex  (mobnum );
#line 6721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> PolymophNow  ();
#line 6722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(type  == MSG_CHANGE_STOP )
#line 6727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 6730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cha_index  == _pNetwork  -> MyCharacterInfo  . index )
#line 6731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nChangeMonsterId  = 0;
#line 6733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = TRUE ;
#line 6734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iStopChangeItem  = 521;
#line 6736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Notice  * pNotice  = GAMEDATAMGR  () -> GetNotice  ();
#line 6738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pNotice  != NULL )
#line 6739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pNotice  -> DelFromNoticeList  (iStopChangeItem  , Notice  :: NOTICE_POLYMOPH );
#line 6741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> SetCSFlagOn  (CSF_TELEPORT );
#line 6744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  chaID  = _pNetwork  -> SearchClientChaIndex  (cha_index );
#line 6748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chaID  != - 1)
#line 6749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (chaID  , penEntity ))
#line 6751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> SetPolymophMobIndex  (- 1);
#line 6753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> PolymophNow  ();
#line 6754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(type  == MSG_CHANGE_ERR )
#line 6759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  err ;
#line 6762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> err ;
#line 6763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (err );
#line 6766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_MORPH_END  ();
#line 6768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_PC_REBIRTH : 
#line 6774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  type ;
#line 6776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index ;
#line 6777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  hp  , maxHp  , mp  , maxMp ;
#line 6778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  CurrentHP  , FullHP ;
#line 6780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> type ;
#line 6781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 6782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHp_Percentage )
#line 6783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT hp_percentage ;
#line 6785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> hp_percentage ;
#line 6786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> hp ;
#line 6787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> maxHp ;
#line 6788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CurrentHP  = HP_FloatToInt  (hp_percentage  , 10);
#line 6789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FullHP  = 1000;
#line 6790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> hp ;
#line 6794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> maxHp ;
#line 6795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CurrentHP  = hp ;
#line 6796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FullHP  = maxHp ;
#line 6797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> mp ;
#line 6800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> maxMp ;
#line 6802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cha_index  == _pNetwork  -> MyCharacterInfo  . index )
#line 6803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = TRUE ;
#line 6805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . hp  = hp ;
#line 6806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . maxHP  = maxHp ;
#line 6807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . mp  = mp ;
#line 6808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . maxMP  = maxMp ;
#line 6810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_MORPH_END  ();
#line 6813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetSiegeWarfareNew  () -> GetWarState  () && 
#line 6814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_WAR  && 
#line 6815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  != WCJF_NONE )
#line 6816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetSiegeWarfareNew  () -> GetWaitTime  () > 0)
#line 6819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> RearrangeOrder  (UI_SIEGE_WARFARE_NEW  , FALSE );
#line 6821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 6828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , TRUE );
#line 6830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bExtension  = 0;
#line 6831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> Rebirth  ();
#line 6834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  chaID  = _pNetwork  -> SearchClientChaIndex  (cha_index );
#line 6838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chaID  != - 1)
#line 6839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (chaID  , penEntity ))
#line 6841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = FullHP ;
#line 6844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = CurrentHP ;
#line 6845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penEntity ) -> Rebirth  ();
#line 6846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_ITEM : 
#line 6853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Read_net_Character_Item  (sub_type  , istr );
#line 6855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_ACTION : 
#line 6859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: action  * pPack  = reinterpret_cast  < ResponseClient  :: action  * > (istr  -> GetBuffer  ());
#line 6861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = CUIManager  :: getSingleton  ();
#line 6863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 6864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 6867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> actionvalue )
#line 6868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_PK : 
#line 6870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pPack  -> state  & PLAYER_STATE_PKMODE ) && (pPack  -> state  & PLAYER_STATE_PKMODEDELAY ))
#line 6871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (693 , "10초 후에 PK모드가 해제됩니다."));
#line 6874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pk_mode  = 2;
#line 6876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> state  & PLAYER_STATE_PKMODE )
#line 6878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  && 
#line 6880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  -> IsCharacter  ())
#line 6881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 6883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 6884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bIsPvp ){_pNetwork  -> SetPvpMode  ();}
#line 6887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (694 , "PK 모드를 선언하였습니다!\n"));
#line 6888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pk_mode  = 1;
#line 6890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bIsPvp ){_pNetwork  -> SetPvpMode  ();}
#line 6894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (695 , "PK 모드가 해제되었습니다!\n"));
#line 6895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pk_mode  = 0;
#line 6896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 6898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 6900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pPack  -> charIndex );
#line 6908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 6909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 6911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 6913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetChaState  (pPack  -> state );
#line 6915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 6917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = (SLONG ) pPack  -> actionvalue ;
#line 6920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> actionvalue )
#line 6921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GREET : 
#line 6923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SMILE : 
#line 6924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_CRY : 
#line 6925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_NUMBER_ONE : 
#line 6926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_HANDCLAP : 
#line 6927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_REFUSE : 
#line 6928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GOOD_LOOKS : 
#line 6929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GOOD_LOOKS2 : 
#line 6930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_BANTER : 
#line 6931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_CHEER : 
#line 6932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_COMBAT : 
#line 6933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SUBMISSION : 
#line 6934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_WATER_SPREAD : 
#line 6935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 6936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SITDOWN : 
#line 6940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> state  & PLAYER_STATE_SITDOWN )
#line 6941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nSitDown  = 2;
#line 6943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nSitDown  = 0;
#line 6947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (m_bSkilling );
#line 6948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 6950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_PK : 
#line 6953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pPack  -> state  & PLAYER_STATE_PKMODE ) && (pPack  -> state  & PLAYER_STATE_PKMODEDELAY ))
#line 6954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 2;
#line 6956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> state  & PLAYER_STATE_PKMODE )
#line 6958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 1;
#line 6960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 6962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penEntity ) -> m_nPkMode  = 0;
#line 6964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penEntity )
#line 6967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> UpdateTargetInfo  (((CCharacter  *) ((CEntity  *) penEntity )) -> m_nMaxiHealth  , 
#line 6969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nCurrentHealth  , 
#line 6970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkMode  , 
#line 6971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkState  , 
#line 6972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nLegit );
#line 6973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET_REAL ) == penEntity )
#line 6975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetTargetInfoReal  (0 , 0 , 
#line 6977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 6978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkMode  , 
#line 6979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nPkState  , 
#line 6980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 6981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) ((CEntity  *) penEntity )) -> m_nLegit  , 
#line 6982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget 
#line 6983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 6984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 6993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_SKILL : 
#line 6994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 6995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Read_net_Character_Skill  (sub_type  , istr );
#line 6996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 6997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_GOTO : 
#line 7001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: goMsg  * pPack  = reinterpret_cast  < ResponseClient  :: goMsg  * > (istr  -> GetBuffer  ());
#line 7005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_checkLock  = pPack  -> hack ;
#line 7007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_checkLock  == 1){
#line 7008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = TRUE ;
#line 7009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_timeCnt  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 7010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 7013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerInit  (false );
#line 7014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . x  = pPack  -> x ;
#line 7018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . z  = pPack  -> z ;
#line 7019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . h  = pPack  -> h ;
#line 7020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r  = pPack  -> r ;
#line 7021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . yLayer  = pPack  -> cYlayer ;
#line 7024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> DeleteAllMob  ();
#line 7028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fCameraAngle  = 0.0f;
#line 7031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 7032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 7033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 7036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = FALSE ;
#line 7037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRcvAtMsg  = TRUE ;
#line 7039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 7040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = FALSE ;
#line 7041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = - 1;
#line 7043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 7044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 7046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsFlagOn  (ENF_ALIVE ))
#line 7049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoTo  (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  + 1.0f , _pNetwork  -> MyCharacterInfo  . z  , 
#line 7052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r  + 10.0f);
#line 7053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_AT : 
#line 7059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bIsTransform )
#line 7061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJobType  = en_pcCharacter  . pc_iPlayerType ;
#line 7063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (CJobInfo  :: getSingleton  () -> GetFileName  (iJobType ));
#line 7064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetModelInstance  ();
#line 7065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 7066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbFaceStyle  = _pNetwork  -> Get_MyChar_faceStyle  ();
#line 7069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbHairStyle  = _pNetwork  -> Get_MyChar_hairStyle  ();
#line 7072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> SetCharacterAppearance  (pMI  , iJobType  , sbHairStyle  , sbFaceStyle );
#line 7073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = FALSE ;
#line 7075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = FALSE ;
#line 7079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange )
#line 7080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnChange  (TRUE );
#line 7082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iStopChangeItem  = 521;
#line 7084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Notice  * pNotice  = GAMEDATAMGR  () -> GetNotice  ();
#line 7086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pNotice  != NULL )
#line 7087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pNotice  -> DelFromNoticeList  (iStopChangeItem  , Notice  :: NOTICE_POLYMOPH );
#line 7089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoTo  (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  + 0.5f , _pNetwork  -> MyCharacterInfo  . z  , 
#line 7104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r );
#line 7105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_OrientationAngle  (1) = _pNetwork  -> MyCharacterInfo  . r ;
#line 7106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = FALSE ;
#line 7107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRcvAtMsg  = TRUE ;
#line 7108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 7109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = 0;
#line 7110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = TRUE ;
#line 7111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nLegit  = 0;
#line 7112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStuned  = FALSE ;
#line 7113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 7116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  ())
#line 7117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetPvpMode  ();
#line 7119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = 0.0f;
#line 7121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_ALIVE );
#line 7124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_WALKING );
#line 7125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_MODEL );
#line 7128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetModelInstance  ())
#line 7129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 7131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 7132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 7133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 7134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 7135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 7136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 7137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 7138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 7139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 7140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . SetOwner  (this );
#line 7141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 7146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 7147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TransformSorcerer  (m_iTransformType );
#line 7149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == 4)
#line 7153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetInfo  (AU_MOVE_DRATAN );
#line 7155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowSignBoard  (_pNetwork  -> MyCharacterInfo  . LocalNo );
#line 7161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . LocalNo  = 0;
#line 7165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bConsensus )
#line 7166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bConsensus  = FALSE ;
#line 7168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_MOVE : 
#line 7176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: moveMsg  * pPack  = reinterpret_cast  < ResponseClient  :: moveMsg  * > (istr  -> GetBuffer  ());
#line 7179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (1) = pPack  -> x ;
#line 7180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (2) = pPack  -> h  + 1;
#line 7181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesiredPosition  (3) = pPack  -> z ;
#line 7183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , pPack  -> charIndex );
#line 7185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 7186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 7190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  = pTarget  -> GetEntity  ();
#line 7192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetyLayer  (pPack  -> cYlayer );
#line 7194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_PLACE )
#line 7195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) pTarget  -> m_pEntity ) -> StopNow  ();
#line 7198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D place  (vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 7199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetPlacement  (place );
#line 7200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 7201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (pPack  -> mapAttr  & MATT_UNWALKABLE ))
#line 7204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_sbAttributePos  = pPack  -> mapAttr ;
#line 7206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_vDesiredPosition  = vDesiredPosition ;
#line 7209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_aDesiredRotation  = ANGLE3D (pPack  -> r  , 0 , 0);
#line 7210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> moveType  == MSG_MOVE_RUN  || pPack  -> moveType  == MSG_MOVE_WALK  || pPack  -> moveType  == MSG_MOVE_FLY )
#line 7211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> speed  < 0)
#line 7215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> speed  = 0.1f;
#line 7217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = pPack  -> speed ;
#line 7220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> MoveNow  ();
#line 7222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bProduction )
#line 7223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 7225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pPack  -> moveType  == MSG_MOVE_STOP )
#line 7229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fMoveSpeed  = 5.0f;
#line 7231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopandTeleport  ();
#line 7232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 7238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Read_net_Character_Item(int sub_type,CNetworkMessage * istr) 
#line 7243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 7245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  item_index ;
#line 7246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index ;
#line 7248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(sub_type )
#line 7249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_ITEM_GET : 
#line 7251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strName ;
#line 7253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SQUAD  slCount ;
#line 7254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> strName ;
#line 7255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_index ;
#line 7256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> slCount ;
#line 7258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMessage  , strCount ;
#line 7259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const char  * szItemName  = _pNetwork  -> GetItemName  (item_index );
#line 7264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strCount  = pUIManager  -> IntegerToCommaString  (slCount );
#line 7266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_EXPEDITION ))
#line 7267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  . PrintF  (_SMgr  (pUIManager  , 4682 , "[원정대] %s님이 %s를 %s개 획득하였습니다.") , strName  , szItemName  , strCount );
#line 7269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 7271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  . PrintF  (_S2Mgr  (pUIManager  , 707 , szItemName  , "[파티원] %s님이 %s<를> %s개 획득하였습니다.") , strName  , szItemName  , strCount );
#line 7273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strMessage );
#line 7275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_ITEM_TAKE : 
#line 7278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbType ;
#line 7280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> sbType ;
#line 7281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> cha_index ;
#line 7282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> item_index ;
#line 7284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbType  == MSG_CHAR_PC  && cha_index  == _pNetwork  -> MyCharacterInfo  . index )
#line 7285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 7288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity  = NULL ;
#line 7290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (cha_index  , sbType  , penEntity ))
#line 7291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nPlayActionNum  = (SLONG ) ACTION_NUM_PICKITEM ;
#line 7293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> ActionNow  ();
#line 7294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ACTORMGR  () -> RemoveObject  (eOBJ_ITEM  , item_index );
#line 7298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Read_net_Character_Skill(int sub_type,CNetworkMessage * istr) 
#line 7304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 7306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEntity ;
#line 7307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity ;
#line 7309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(sub_type )
#line 7310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_SKILL_FIRE : 
#line 7312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: skillFireMsg  * pPack  = reinterpret_cast  < ResponseClient  :: skillFireMsg  * > (istr  -> GetBuffer  ());
#line 7314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: skillFireMsg  :: tag_list  * pList  = NULL ;
#line 7316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> skillIndex )
#line 7317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 7319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 32: 
#line 7320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 33: 
#line 7321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 44: 
#line 7322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 64: 
#line 7323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 123: 
#line 7324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 125: 
#line 7325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 129: 
#line 7326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillSpeed  = 0;
#line 7327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bMy  = false ;
#line 7332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> charType )
#line 7333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHAR_PC : 
#line 7335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMy  = true ;
#line 7339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHAR_PET : 
#line 7343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_PET  , pPack  -> charIndex );
#line 7346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 7347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CPetTarget  * pTarget  = static_cast  < CPetTarget  * > (pObject ))
#line 7349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> pet_OwnerIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMy  = true ;
#line 7353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHAR_ELEMENTAL : 
#line 7359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_SLAVE  , pPack  -> charIndex );
#line 7362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 7363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CSlaveTarget  * pTarget  = static_cast  < CSlaveTarget  * > (pObject ))
#line 7365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> slave_OwnerIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMy  = true ;
#line 7369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHAR_WILDPET : 
#line 7375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_WILDPET  , pPack  -> charIndex );
#line 7378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 7379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CWildPetTarget  * pTarget  = static_cast  < CWildPetTarget  * > (pObject ))
#line 7381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> m_nOwnerIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMy  = true ;
#line 7385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMy  == true )
#line 7394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (pPack  -> skillIndex );
#line 7396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . SetStartTime  ();
#line 7398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILLREADY );
#line 7399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 7402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> skillIndex  == HE_SHINING_ARROW  || 
#line 7407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == HE_STORM_ARROW  || 
#line 7408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == HE_DOUBLE_STING  || 
#line 7409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == 128
#line 7410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 7411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> charIndex  , pPack  -> charType  , penEntity ))
#line 7416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 7418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_dcEnemies  . Add  (penTargetEntity );
#line 7421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  != penTargetEntity )
#line 7422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (penTargetEntity );
#line 7424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> listCount  > 0)
#line 7428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pList  = new  ResponseClient  :: skillFireMsg  :: tag_list  [ pPack  -> listCount  ];
#line 7430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
memcpy  (pList  , & pPack  -> list  [ 0 ] , sizeof  (ResponseClient  :: skillFireMsg  :: tag_list ) * pPack  -> listCount );
#line 7431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  t  = 0;t  < pPack  -> listCount ;++ t )
#line 7434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = NULL ;
#line 7436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pList  [ t  ] . multiIndex  , pList  [ t  ] . multiType  , penTargetEntity ))
#line 7437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_dcEnemies  . Add  (penTargetEntity );
#line 7440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsEnemy  () && ((CUnit  *) penTargetEntity ) -> m_nCurrentHealth  > 0)
#line 7441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (penTargetEntity );
#line 7443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentSkillNum  = pPack  -> skillIndex ;
#line 7447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fSkillSpeed  = (100 - pPack  -> skillSpeed ) / 100.0f;
#line 7448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SkillNow  ();
#line 7449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SAFE_ARRAY_DELETE  (pList );
#line 7450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_SKILL_READY : 
#line 7456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: skillReadyMsg  * pPack  = reinterpret_cast  < ResponseClient  :: skillReadyMsg  * > (istr  -> GetBuffer  ());
#line 7459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pPack  -> skillIndex )
#line 7460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 7462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 32: 
#line 7463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 33: 
#line 7464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 44: 
#line 7465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 64: 
#line 7466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 123: 
#line 7467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 125: 
#line 7468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 129: 
#line 7469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillSpeed  = 0;
#line 7470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> skillIndex  != - 1)
#line 7476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SpellSkill  (pPack  -> skillIndex );
#line 7478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 7479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = TRUE ;
#line 7480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> charIndex  , pPack  -> charType  , penEntity ))
#line 7486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> targetIndex  , pPack  -> targetType  , penTargetEntity ))
#line 7488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SetTargetEntity  (penTargetEntity );
#line 7490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentSkillNum  = pPack  -> skillIndex ;
#line 7491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fSkillSpeed  = (100 - pPack  -> skillSpeed ) / 100.0f;
#line 7493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> skillIndex  == HE_SHINING_ARROW  || 
#line 7494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == HE_STORM_ARROW  || 
#line 7495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == HE_DOUBLE_STING  || 
#line 7496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pPack  -> skillIndex  == 128
#line 7497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 7498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SkillNow  ();
#line 7500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 7502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> PreSkillNow  ();
#line 7504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_SKILL_CANCEL : 
#line 7513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ResponseClient  :: skillCancelMsg  * pPack  = reinterpret_cast  < ResponseClient  :: skillCancelMsg  * > (istr  -> GetBuffer  ());
#line 7516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILLREADY );
#line 7517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 7519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charType  == MSG_CHAR_PC )
#line 7520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 7522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 7524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 7525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> SearchEntityByNetworkID  (pPack  -> charIndex  , pPack  -> charType  , penEntity ))
#line 7529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pPack  -> charType  == MSG_CHAR_NPC  || pPack  -> charType  == MSG_CHAR_PET  || pPack  -> charType  == MSG_CHAR_WILDPET )
#line 7531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 7533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopNow  ();
#line 7535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 7538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> StopNow  ();
#line 7540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 7544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX CPlayer::GenderSound(INDEX iSound) 
#line 7548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return iSound  + m_iGender  * GENDEROFFSET ;
#line 7550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AddBouble(FLOAT3D vPos,FLOAT3D vSpeedRelative) 
#line 7553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShellLaunchData  & sld  = m_asldData  [ m_iFirstEmptySLD  ];
#line 7555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sld  . sld_vPos  = vPos ;
#line 7556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOATmatrix3D & m  = GetRotationMatrix  ();
#line 7557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vUp  (m  (1 , 2) , m  (2 , 2) , m  (3 , 2));
#line 7558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sld  . sld_vUp  = vUp ;
#line 7559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sld  . sld_vSpeed  = vSpeedRelative  * m ;
#line 7560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sld  . sld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 7561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sld  . sld_estType  = ESL_BUBBLE ;
#line 7563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptySLD  = (m_iFirstEmptySLD  + 1) % MAX_FLYING_SHELLS ;
#line 7564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ClearShellLaunchData(void) 
#line 7567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptySLD  = 0;
#line 7570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iShell  = 0;iShell  < MAX_FLYING_SHELLS ;iShell  ++){
#line 7571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_asldData  [ iShell  ] . sld_estType  = ESL_NONE ;
#line 7572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_asldData  [ iShell  ] . sld_tmLaunch  = - 100.0f;
#line 7573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AddBulletSpray(FLOAT3D vPos,EffectParticlesType eptType,FLOAT3D vStretch) 
#line 7577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BulletSprayLaunchData  & bsld  = m_absldData  [ m_iFirstEmptyBSLD  ];
#line 7579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_vPos  = vPos ;
#line 7580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_vG  = en_vGravityDir ;
#line 7581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_eptType  = eptType ;
#line 7582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_iRndBase  = FRnd  () * 123456;
#line 7583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 7584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_vStretch  = vStretch ;
#line 7586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptyBSLD  = (m_iFirstEmptyBSLD  + 1) % MAX_BULLET_SPRAYS ;
#line 7587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ClearBulletSprayLaunchData(void) 
#line 7590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptyBSLD  = 0;
#line 7592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iBulletSpray  = 0;iBulletSpray  < MAX_BULLET_SPRAYS ;iBulletSpray  ++)
#line 7593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_absldData  [ iBulletSpray  ] . bsld_tmLaunch  = - 100.0f;
#line 7595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AddGoreSpray(FLOAT3D vPos,FLOAT3D v3rdPos,SprayParticlesType sptType,FLOAT3D vSpilDirection,
#line 7599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D boxHitted,FLOAT fDamagePower,COLOR colParticles) 
#line 7600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoreSprayLaunchData  & gsld  = m_agsldData  [ m_iFirstEmptyGSLD  ];
#line 7602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_vPos  = vPos ;
#line 7603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_v3rdPos  = v3rdPos ;
#line 7604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_vG  = en_vGravityDir ;
#line 7605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_fGA  = en_fGravityA ;
#line 7606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_sptType  = sptType ;
#line 7607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_boxHitted  = boxHitted ;
#line 7608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_vSpilDirection  = vSpilDirection ;
#line 7609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_fDamagePower  = fDamagePower ;
#line 7610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 7611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_colParticles  = colParticles ;
#line 7613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptyGSLD  = (m_iFirstEmptyGSLD  + 1) % MAX_GORE_SPRAYS ;
#line 7614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ClearGoreSprayLaunchData(void) 
#line 7617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iFirstEmptyGSLD  = 0;
#line 7619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iGoreSpray  = 0;iGoreSpray  < MAX_GORE_SPRAYS ;iGoreSpray  ++)
#line 7620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_agsldData  [ iGoreSpray  ] . gsld_tmLaunch  = - 100.0f;
#line 7622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
 CPlayer::CPlayer(void) 
#line 7626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearShellLaunchData  ();
#line 7629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearBulletSprayLaunchData  ();
#line 7630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearGoreSprayLaunchData  ();
#line 7637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bNoAniGuildSkill  = FALSE ;
#line 7638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
class CPlayerWeapons * CPlayer::GetPlayerWeapons(void) 
#line 7641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (m_penWeapons  != NULL );
#line 7643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (CPlayerWeapons  *) & * m_penWeapons ;
#line 7644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
class CPlayerAnimator * CPlayer::GetPlayerAnimator(void) 
#line 7646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (m_penAnimator  != NULL );
#line 7648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (CPlayerAnimator  *) & * m_penAnimator ;
#line 7649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerSettings * CPlayer::GetSettings(void) 
#line 7652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (CPlayerSettings  *) en_pcCharacter  . pc_aubAppearance ;
#line 7654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Copy(CEntity & enOther,ULONG ulFlags) 
#line 7657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: Copy  (enOther  , ulFlags );
#line 7659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penOther  = (CPlayer  *) (& enOther );
#line 7661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl ){
#line 7662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_moRender  . Copy  (penOther  -> m_moRender );
#line 7663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_miRender  . Copy  (penOther  -> m_miRender );
#line 7665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psLevelStats  = penOther  -> m_psLevelStats ;
#line 7668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psLevelTotal  = penOther  -> m_psLevelTotal ;
#line 7669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psGameStats  = penOther  -> m_psGameStats ;
#line 7670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psGameTotal  = penOther  -> m_psGameTotal ;
#line 7671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::UpdateLatency(FLOAT tmLatencyNow) 
#line 7675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 7679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  < m_tmLatencyLastAvg  + hud_tmLatencySnapshot ){
#line 7681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLatencyAvgSum  += tmLatencyNow ;
#line 7682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ctLatencyAvg  ++;
#line 7685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ctLatencyAvg  > 0.0f || m_ctLatencyAvg  < 0.0f)
#line 7688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLatency  = m_tmLatencyAvgSum  / m_ctLatencyAvg ;
#line 7690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 7692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLatency  = 0.0f;
#line 7694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLatencyAvgSum  = 0.0f;
#line 7697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ctLatencyAvg  = 0;
#line 7698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLatencyLastAvg  = tmNow ;
#line 7699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){
#line 7702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_tmPing  = m_tmLatency ;
#line 7703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
net_tmLatencyAvg  = en_tmPing ;
#line 7704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ValidateCharacter(void) 
#line 7709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 7713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerSettings  * pps  = (CPlayerSettings  *) en_pcCharacter  . pc_aubAppearance ;
#line 7714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
memset  (pps  -> ps_achModelFile  , 0 , sizeof  (pps  -> ps_achModelFile ));
#line 7715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ParseGender(CTString & strName) 
#line 7719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strName  . RemovePrefix  ("#male#")){
#line 7721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iGender  = GENDER_MALE ;
#line 7722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(strName  . RemovePrefix  ("#female#")){
#line 7723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iGender  = GENDER_FEMALE ;
#line 7724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iGender  = GENDER_MALE ;
#line 7726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Write_t(CTStream * ostr,BOOL bNetwork) 
#line 7731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: Write_t  (ostr  , bNetwork );
#line 7734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psLevelStats  , sizeof  (m_psLevelStats ));
#line 7735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psLevelTotal  , sizeof  (m_psLevelTotal ));
#line 7736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psGameStats  , sizeof  (m_psGameStats ));
#line 7737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psGameTotal  , sizeof  (m_psGameTotal ));
#line 7738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Read_t(CTStream * istr,BOOL bNetwork) 
#line 7741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: Read_t  (istr  , bNetwork );
#line 7744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearShellLaunchData  ();
#line 7745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearBulletSprayLaunchData  ();
#line 7746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ClearGoreSprayLaunchData  ();
#line 7748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psLevelStats  , sizeof  (m_psLevelStats ));
#line 7749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psLevelTotal  , sizeof  (m_psLevelTotal ));
#line 7750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psGameStats  , sizeof  (m_psGameStats ));
#line 7751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psGameTotal  , sizeof  (m_psGameTotal ));
#line 7754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 7755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strDummy ;
#line 7757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl ){
#line 7758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 7759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CreateAnimAndBoneIDs  ();
#line 7761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> StretchModel  (FLOAT3D (0.4f , 0.4f , 0.4f));
#line 7762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearanceSka  (& m_miRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 7763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ParseGender  (strDummy );
#line 7772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLastPicked  = - 99.0f;
#line 7773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME CPlayer::GetStatsInGameTimeLevel(void) 
#line 7787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 7789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_psLevelStats  . ps_tmTime ;
#line 7790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return _pNetwork  -> GetGameTime  () - m_tmLevelStarted ;
#line 7792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME CPlayer::GetStatsInGameTimeGame(void) 
#line 7795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 7797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_psGameStats  . ps_tmTime ;
#line 7798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_psGameStats  . ps_tmTime  + (_pNetwork  -> GetGameTime  () - m_tmLevelStarted );
#line 7800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::GetStatsRealWorldTime(void) 
#line 7804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
time_t  timeNow ;
#line 7806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 7807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
timeNow  = m_iEndTime ;
#line 7808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 7809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
time  (& timeNow );
#line 7810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (FLOAT) difftime  (timeNow  , m_iStartTime );
#line 7812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString CPlayer::GetStatsRealWorldStarted(void) 
#line 7815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
struct  tm  * newtime ;
#line 7817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
newtime  = localtime  ((const time_t  *) & m_iStartTime );
#line 7819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
setlocale  (LC_ALL  , "");
#line 7820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strTimeline ;
#line 7821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
char  achTimeLine  [ 256 ];
#line 7822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strftime  (achTimeLine  , sizeof  (achTimeLine ) - 1 , "%a %x %H:%M" , newtime );
#line 7823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTimeline  = achTimeLine ;
#line 7824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
setlocale  (LC_ALL  , "C");
#line 7825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return strTimeline ;
#line 7826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::GetStats(CTString & strStats,const CompStatType csType,INDEX ctCharsPerRow) 
#line 7830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetShortStats(CTString & strStats) 
#line 7855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  . PrintF  (TRANS  ("%s Kills: %d/%d") , 
#line 7857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TimeToString  (GetStatsInGameTimeLevel  ()) , m_psLevelStats  . ps_iKills  , m_psLevelTotal  . ps_iKills );
#line 7858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsDM(CTString & strStats) 
#line 7862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  INDEX SetAllPlayersStats  (INDEX iSortKey );
#line 7864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  CPlayer  * _apenPlayers  [ NET_MAXGAMEPLAYERS  ];
#line 7866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bFragMatch  = GetSP  () -> sp_bUseFrags ;
#line 7869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX ctPlayers  = SetAllPlayersStats  (bFragMatch  ? 5 : 3);
#line 7872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("TIME") , TimeToString  (_pNetwork  -> GetGameTime  ())));
#line 7873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iMaxFrags  = LowerLimit  (INDEX (0));
#line 7877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iMaxScore  = LowerLimit  (INDEX (0));
#line 7878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 7879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 7880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iMaxFrags  = Max  (iMaxFrags  , penPlayer  -> m_psLevelStats  . ps_iKills );
#line 7882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}}
#line 7885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const CSessionProperties  & sp  = * GetSP  ();
#line 7886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sp  . sp_iTimeLimit  > 0){
#line 7887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fTimeLeft  = ClampDn  (sp  . sp_iTimeLimit  * 60.0f - _pNetwork  -> GetGameTime  () , 0.0f);
#line 7888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("TIME LEFT") , TimeToString  (fTimeLeft )));
#line 7889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bFragMatch  && sp  . sp_iFragLimit  > 0){
#line 7892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iFragsLeft  = ClampDn  (sp  . sp_iFragLimit  - iMaxFrags  , INDEX (0));
#line 7893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%d" , TRANS  ("FRAGS LEFT") , iFragsLeft ));
#line 7894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 7901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strRank  = TRANS  ("NO.");
#line 7904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strFrag  = bFragMatch  ? TRANS  ("FRAGS") : TRANS  ("SCORE");
#line 7905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strPing  = TRANS  ("PING");
#line 7906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strName  = TRANS  ("PLAYER");
#line 7907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctRankChars  = Max  (strRank  . Length  () , INDEX (3));
#line 7908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctFragChars  = Max  (strFrag  . Length  () , INDEX (7));
#line 7909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctPingChars  = Max  (strPing  . Length  () , INDEX (5));
#line 7910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctNameChars  = Max  (strName  . Length  () , INDEX (20));
#line 7913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^cFFFFFF";
#line 7914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringRight  (strRank  , ctRankChars ) + " ";
#line 7915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringLeft  (strFrag  , ctFragChars ) + " ";
#line 7916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringLeft  (strPing  , ctPingChars ) + " ";
#line 7917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringRight  (strName  , ctNameChars ) + " ";
#line 7918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^r";
#line 7919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n\n";
#line 7920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 7921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strLine ;
#line 7922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 7923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPing  = ceil  (penPlayer  -> en_tmPing  * 1000.0f);
#line 7925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strName  = penPlayer  -> GetPlayerName  ();
#line 7927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringRight  (CTString (0 , "%d" , iPlayer  + 1) , ctRankChars ) + " ";
#line 7929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringLeft  (CTString (0 , "%d" , iPing ) , ctPingChars ) + " ";
#line 7930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += PadStringRight  (strName  , ctNameChars ) + " ";
#line 7931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}}
#line 7933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 7936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsCoop(CTString & strStats) 
#line 7937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 7939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("YOUR STATS")) + "^r\n";
#line 7940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetDetailStatsSP  (strStats  , 1);
#line 7944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  INDEX SetAllPlayersStats  (INDEX iSortKey );
#line 7945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  CPlayer  * _apenPlayers  [ NET_MAXGAMEPLAYERS  ];
#line 7946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX ctPlayers  = SetAllPlayersStats  (3);
#line 7949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerStats  psSquadLevel  = PlayerStats  ();
#line 7950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerStats  psSquadGame  = PlayerStats  ();
#line 7951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 7952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 7954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penPlayer  != NULL );
#line 7955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerStats  psLevel  = penPlayer  -> m_psLevelStats ;
#line 7956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerStats  psGame  = penPlayer  -> m_psGameStats ;
#line 7958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
psSquadLevel  . ps_iKills  += psLevel  . ps_iKills ;
#line 7959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
psSquadLevel  . ps_iDeaths  += psLevel  . ps_iDeaths ;
#line 7962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
psSquadGame  . ps_iKills  += psGame  . ps_iKills ;
#line 7963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
psSquadGame  . ps_iDeaths  += psGame  . ps_iDeaths ;
#line 7965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}}
#line 7968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("SQUAD TOTAL")) + "^r\n";
#line 7970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += CTString (0 , "^cFFFFFF%s^r" , TranslateConst  (en_pwoWorld  -> GetName  () , 0));
#line 7972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , psSquadLevel  . ps_iDeaths ));
#line 7976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , psSquadLevel  . ps_iKills  , m_psLevelTotal  . ps_iKills ));
#line 7978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("TOTAL") + "^r\n";
#line 7985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , psSquadGame  . ps_iDeaths ));
#line 7986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , psSquadGame  . ps_iKills  , m_psGameTotal  . ps_iKills ));
#line 7988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("OTHER PLAYERS")) + "^r\n";
#line 7996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 7999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 8000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 8002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penPlayer  == this ){
#line 8004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 8005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "^cFFFFFF" + CenterString  (penPlayer  -> GetPlayerName  ()) + "^r\n\n";
#line 8008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlayer  -> GetDetailStatsSP  (strStats  , 2);
#line 8009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}}
#line 8011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsSP(CTString & strStats,INDEX iCoopType) 
#line 8015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  <= 1)
#line 8017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEndOfGame )
#line 8019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 8038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("STARTED") , GetStatsRealWorldStarted  ()));
#line 8039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("PLAYING TIME") , TimeToString  (GetStatsRealWorldTime  ())));
#line 8041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n\n";
#line 8048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += CTString (0 , "^cFFFFFF%s^r" , TranslateConst  (en_pwoWorld  -> GetName  () , 0));
#line 8052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 8054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 8055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("ESTIMATED TIME") , TimeToString  (m_tmEstTime )));
#line 8056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("TIME BONUS") , m_iTimeScore ));
#line 8058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , m_psLevelStats  . ps_iKills  , m_psLevelTotal  . ps_iKills ));
#line 8067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  >= 1){
#line 8069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , m_psLevelStats  . ps_iDeaths  , m_psLevelTotal  . ps_iDeaths ));
#line 8070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 8075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("TIME") , TimeToString  (GetStatsInGameTimeLevel  ())));
#line 8076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("TOTAL") + "^r";
#line 8082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , m_psGameStats  . ps_iKills  , m_psGameTotal  . ps_iKills ));
#line 8086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  >= 1){
#line 8088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , m_psGameStats  . ps_iDeaths  , m_psGameTotal  . ps_iDeaths ));
#line 8089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 8094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("GAME TIME") , TimeToString  (GetStatsInGameTimeGame  ())));
#line 8095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += "\n";
#line 8100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCoopType  < 1){
#line 8101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_strLevelStats  != ""){
#line 8102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("Per level statistics") + "^r\n\n" + m_strLevelStats ;
#line 8103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SayVoiceMessage(const CTFileName & fnmMessage) 
#line 8108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSettings  () -> ps_ulFlags  & PSF_NOQUOTES ){
#line 8110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 8111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayLightAnim(INDEX iAnim,ULONG ulFlags) {
#line 8138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_aoLightAnimation  . GetData  () != NULL ){
#line 8139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_aoLightAnimation  . PlayAnim  (iAnim  , ulFlags );
#line 8140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::AdjustShadingParameters(FLOAT3D & vLightDirection,COLOR & colLight,COLOR & colAmbient) 
#line 8145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_iPCMinBrightness  = Clamp  (g_iPCMinBrightness  , (INDEX) 0 , (INDEX) 255);
#line 8148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRecalcAmbient  = FALSE ;
#line 8149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRecalcDiffuse  = FALSE ;
#line 8151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubAH  , ubAS  , ubAV ;
#line 8152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToHSV  (colAmbient  , ubAH  , ubAS  , ubAV );
#line 8153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubDH  , ubDS  , ubDV ;
#line 8154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToHSV  (colLight  , ubDH  , ubDS  , ubDV );
#line 8156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubAV  < g_iPCMinBrightness )
#line 8157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubAR  , ubAG  , ubAB ;
#line 8159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToRGB  (colAmbient  , ubAR  , ubAG  , ubAB );
#line 8160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ubAR  = g_iPCMinBrightness ;
#line 8161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ubAG  = g_iPCMinBrightness ;
#line 8162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ubAB  = g_iPCMinBrightness ;
#line 8163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToHSV  (RGBToColor  (ubAR  , ubAG  , ubAB ) , ubAH  , ubAS  , ubAV );
#line 8164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRecalcAmbient  = TRUE ;
#line 8165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubAV  < ubDV  && g_iChaLightModifyValue  < ubDV  - ubAV )
#line 8167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX value  = (ubDV  - ubAV  - g_iChaLightModifyValue ) >> 1;
#line 8169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ubDV  = Clamp  (INDEX (ubDV ) - value  , INDEX (0) , INDEX (255));
#line 8170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ubAV  = Clamp  (INDEX (ubAV ) + value  , INDEX (0) , INDEX (255));
#line 8171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRecalcAmbient  = bRecalcDiffuse  = TRUE ;
#line 8172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRecalcDiffuse ){colLight  = HSVToColor  (ubDH  , ubDS  , ubDV );}
#line 8175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRecalcAmbient ){colAmbient  = HSVToColor  (ubAH  , ubAS  , ubAV );}
#line 8205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return CPlayerEntity  :: AdjustShadingParameters  (vLightDirection  , colLight  , colAmbient );
#line 8206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject * CPlayer::GetModelForRendering(void) 
#line 8210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED )){
#line 8214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return GetModelObject  ();
#line 8215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 8219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . Lerp  (en_plLastViewpoint  , en_plViewpoint  , _pTimer  -> GetLerpFactor  ());
#line 8223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . OnPreRender  ();
#line 8225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_moRender  . Synchronize  (* GetModelObject  ());
#line 8234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmNow  = en_tmEntityTime ;
#line 8236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFading  = 1.0f;
#line 8237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_tmFadeStart  != 0){
#line 8238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFactor  = (tmNow  - m_tmFadeStart ) / 5.0f;
#line 8239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFactor  = Clamp  (fFactor  , 0.0f , 1.0f);
#line 8240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= fFactor ;
#line 8241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmSpawnInvulnerability  = GetSP  () -> sp_tmSpawnInvulnerability ;
#line 8245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmSpawnInvulnerability  > 0 && tmNow  - m_tmSpawned  < tmSpawnInvulnerability ){
#line 8247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDelta  = tmNow  - m_tmSpawned ;
#line 8248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= 0.75f + 0.25f * Sin  (fDelta  / 0.5f * 360);
#line 8249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colAlpha  = m_moRender  . mo_colBlendColor ;
#line 8252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) + (COLOR (fFading  * 0xff) & 0xff);
#line 8253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_moRender  . mo_colBlendColor  = colAlpha ;
#line 8256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 8258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= 0.25f + 0.25f * Sin  (tmNow  / 2.0f * 360);
#line 8260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_tmInvisibility  > tmNow ){
#line 8261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fIntensity  = 0.0f;
#line 8262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 3.0f)
#line 8263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  = 0.5f - 0.5f * cos  ((m_tmInvisibility  - tmNow ) * (6.0f * 3.1415927f / 3.0f));
#line 8265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_ulPlayerRenderingMask  == 1 << GetMyPlayerIndex  ()){
#line 8267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_LOCAL  + (FLOAT) (254 - INVISIBILITY_ALPHA_LOCAL ) * fIntensity );
#line 8268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(TRUE ){
#line 8269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 1.28f){
#line 8270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_REMOTE  + (FLOAT) (254 - INVISIBILITY_ALPHA_REMOTE ) * fIntensity );
#line 8271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(TRUE ){
#line 8272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | INVISIBILITY_ALPHA_REMOTE ;
#line 8273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_moRender  . mo_colBlendColor  = colAlpha ;
#line 8276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return & m_moRender ;
#line 8280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * CPlayer::GetModelInstanceForRendering(void) 
#line 8284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return GetModelInstance  ();
#line 8293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 8295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . Lerp  (en_plLastViewpoint  , en_plViewpoint  , _pTimer  -> GetLerpFactor  ());
#line 8298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . OnPreRender  ();
#line 8300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_miRender  . Synchronize  (* GetModelInstance  ());
#line 8302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmNow  = en_tmEntityTime ;
#line 8304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFading  = 1.0f;
#line 8305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_tmFadeStart  != 0){
#line 8306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFactor  = (tmNow  - m_tmFadeStart ) / 5.0f;
#line 8307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFactor  = Clamp  (fFactor  , 0.0f , 1.0f);
#line 8308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= fFactor ;
#line 8309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmSpawnInvulnerability  = GetSP  () -> sp_tmSpawnInvulnerability ;
#line 8313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmSpawnInvulnerability  > 0 && tmNow  - m_tmSpawnedForInv  < tmSpawnInvulnerability ){
#line 8315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDelta  = tmNow  - m_tmSpawnedForInv ;
#line 8316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= 0.75f + 0.25f * Sin  (fDelta  / 0.5f * 360);
#line 8317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colAlpha  = m_miRender  . mi_colModelColor ;
#line 8320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) + (COLOR (fFading  * 0xff) & 0xff);
#line 8321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_miRender  . mi_colModelColor  = colAlpha ;
#line 8324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 8326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFading  *= 0.25f + 0.25f * Sin  (tmNow  / 2.0f * 360);
#line 8328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_tmInvisibility  > tmNow ){
#line 8329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fIntensity  = 0.0f;
#line 8330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 3.0f)
#line 8331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  = 0.5f - 0.5f * cos  ((m_tmInvisibility  - tmNow ) * (6.0f * 3.1415927f / 3.0f));
#line 8333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_ulPlayerRenderingMask  == 1 << GetMyPlayerIndex  ()){
#line 8335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_LOCAL  + (FLOAT) (254 - INVISIBILITY_ALPHA_LOCAL ) * fIntensity );
#line 8336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(TRUE ){
#line 8337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 1.28f){
#line 8338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_REMOTE  + (FLOAT) (254 - INVISIBILITY_ALPHA_REMOTE ) * fIntensity );
#line 8339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(TRUE ){
#line 8340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | INVISIBILITY_ALPHA_REMOTE ;
#line 8341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_miRender  . mi_colModelColor  = colAlpha ;
#line 8344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return & m_miRender ;
#line 8348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
class CPlayerActionMarker * CPlayer::GetActionMarker(void) {
#line 8353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (CPlayerActionMarker  *) & * m_penActionMarker ;
#line 8354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::FindMusicHolder(void) 
#line 8358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 8360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penMainMusicHolder  = _pNetwork  -> GetEntityWithName  ("MusicHolder" , 0);
#line 8361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::UpdateLevelStats(void) 
#line 8366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psLevelStats  = PlayerStats  ();
#line 8371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 8372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 8373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMusicHolder  & mh  = (CMusicHolder  &) * m_penMainMusicHolder ;
#line 8377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(mh  . m_ctEnemiesInWorld  == 0){
#line 8378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mh  . CountEnemies  ();
#line 8379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psLevelTotal  . ps_iKills  = mh  . m_ctEnemiesInWorld ;
#line 8382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psGameTotal  . ps_iKills  += mh  . m_ctEnemiesInWorld ;
#line 8385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsFuss(void) 
#line 8389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 8393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 8394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((CMusicHolder  *) & * m_penMainMusicHolder ) -> m_cenFussMakers  . Count  () > 0;
#line 8397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetDefaultMouthPitch(void) 
#line 8400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , 1.0f);
#line 8402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetRandomMouthPitch(FLOAT fMin,FLOAT fMax) 
#line 8404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , Lerp  (fMin  , fMax  , FRnd  ()));
#line 8406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ApplyShaking(CPlacement3D & plViewer) 
#line 8410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fT  = _pTimer  -> GetLerpedCurrentTick  ();
#line 8413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fT  < m_tmChainShakeEnd )
#line 8414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fChainsawShakeDX  = 0.03f * m_fChainShakeStrength  * SinFast  (fT  * m_fChainShakeFreqMod  * 3300.0f);
#line 8416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fChainsawShakeDY  = 0.03f * m_fChainShakeStrength  * SinFast  (fT  * m_fChainShakeFreqMod  * 2900.0f);
#line 8418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (1) += m_fChainsawShakeDX ;
#line 8419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (3) += m_fChainsawShakeDY ;
#line 8420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 8423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pwsc  == NULL  || pwsc  -> m_tmShakeStarted  < 0){
#line 8424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 8425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tm  = _pTimer  -> GetLerpedCurrentTick  () - pwsc  -> m_tmShakeStarted ;
#line 8428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tm  < 0){
#line 8429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 8430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDistance  = (plViewer  . pl_PositionVector  - pwsc  -> m_vShakePos ) . Length  ();
#line 8432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fIntensity  = IntensityAtDistance  (pwsc  -> m_fShakeFalloff  , 0 , fDistance );
#line 8433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fShakeY  , fShakeB  , fShakeZ ;
#line 8434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pwsc  -> m_bShakeFadeIn ){
#line 8435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeY  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyY  * 360.0f) * 
#line 8436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 8437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityY ;
#line 8438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeB  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyB  * 360.0f) * 
#line 8439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 8440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityB ;
#line 8441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeZ  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyZ  * 360.0f) * 
#line 8442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 8443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityZ ;
#line 8444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 8445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT ootm  = 1.0f / tm ;
#line 8446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeY  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyY  * 360.0f) * 
#line 8447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 8448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityY ;
#line 8449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeB  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyB  * 360.0f) * 
#line 8450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 8451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityB ;
#line 8452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fShakeZ  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyZ  * 360.0f) * 
#line 8453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 8454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityZ ;
#line 8455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (2) += fShakeY ;
#line 8457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (3) += fShakeZ ;
#line 8458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  . pl_OrientationAngle  (3) += fShakeB ;
#line 8460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR CPlayer::GetWorldGlaring(void) 
#line 8463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 8465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pwsc  == NULL  || pwsc  -> m_tmGlaringStarted  < 0){
#line 8466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return 0;
#line 8467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tm  = _pTimer  -> GetLerpedCurrentTick  ();
#line 8469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRatio  = CalculateRatio  (tm  , pwsc  -> m_tmGlaringStarted  , pwsc  -> m_tmGlaringEnded  , 
#line 8470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pwsc  -> m_fGlaringFadeInRatio  , pwsc  -> m_fGlaringFadeOutRatio );
#line 8471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colResult  = (pwsc  -> m_colGlade  & 0xFFFFFF00) | (UBYTE  (fRatio  * 255.0f));
#line 8472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return colResult ;
#line 8473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderHudPicFX(CDrawPort * pdp) 
#line 8476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 8478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_penHudPicFXHolder  != NULL )
#line 8479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CHudPicHolder  & hpfx  = (CHudPicHolder  &) * pwsc  -> m_penHudPicFXHolder ;
#line 8481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
hpfx  . HudPic_Render  (& hpfx  , pdp );
#line 8482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetupView(CDrawPort * pdp,CAnyProjection3D & apr,CEntity * & penViewer,
#line 8490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D & plViewer,COLOR & colBlend,BOOL bCamera) 
#line 8491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetLerpedAbsoluteViewPlacement  (plViewer );
#line 8498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iViewState  = m_iViewState ;
#line 8499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CFixedCameraField  * pField  = FindPlayerInCameraField  (this );
#line 8500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pField  && pField  -> m_penMarker )
#line 8501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iViewState  = PVT_SCENECAMERA ;
#line 8503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  = (pField  -> m_penMarker ) -> GetPlacement  ();
#line 8504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penViewer  = pField  -> m_penMarker ;
#line 8505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = penViewer ;
#line 8506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bInFixedCamera  = TRUE ;
#line 8507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penViewer  = GetViewEntity  (FALSE );
#line 8515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bInFixedCamera )
#line 8516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bInFixedCamera  = FALSE ;
#line 8518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 8519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL  && bCamera )
#line 8522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iViewState  = PVT_SCENECAMERA ;
#line 8524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plViewer  = m_penCamera  -> GetLerpedPlacement  ();
#line 8525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penViewer  = m_penCamera ;
#line 8526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPerspectiveProjection3D  prPerspectiveProjection ;
#line 8531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fMinFOV  = 1.0f;
#line 8532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fStdFOV  = 90.0f;
#line 8533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fMaxFOV  = _bSeparatedTripleHead  ? 120.0f : 160.0f;
#line 8534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gfx_fTripleHeadFOVBias  = Clamp  (gfx_fTripleHeadFOVBias  , 1.0f , 1.75f);
#line 8535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFOVBias  = 1.0f;
#line 8536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bTripleHead )
#line 8537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bSeparatedTripleHead )
#line 8539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFOVBias  = 1.0f / gfx_fTripleHeadFOVBias ;
#line 8541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFOVBias  = gfx_fTripleHeadFOVBias ;
#line 8545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fFOV  = Clamp  (plr_fFOV  , fMinFOV  , fMaxFOV );
#line 8548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aFOV  = plr_fFOV ;
#line 8571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CameraEffect  (GetPlacement  () , plViewer );
#line 8572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aFOV  *= fFOVBias ;
#line 8575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fMinFCD  = 0.06f;
#line 8576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fMaxFCD  = 0.25f;
#line 8577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fFrontClipDistance  = Clamp  (plr_fFrontClipDistance  , 0.05f , 0.50f);
#line 8578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bSinglePlayer  && ! GetSP  () -> sp_bCooperative )
#line 8579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fFrontClipDistance  = 0.25;
#line 8581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFCD  = plr_fFrontClipDistance ;
#line 8584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fAllowFCD  = fMaxFCD  - (aFOV  - fStdFOV ) / (fMaxFOV  - fStdFOV ) * (fMaxFCD  - fMinFCD );
#line 8585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFCD  = Min  (fFCD  , fAllowFCD );
#line 8586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  && iViewState  == PVT_PLAYEREYES ){fFCD  *= 0.666f;}
#line 8588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fFarClipDistance  = Clamp  (plr_fFarClipDistance  , plr_fFrontClipDistance  + 1.0f , 32768.0f);
#line 8589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFarCD  = plr_fFarClipDistance ;
#line 8591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colBlend  = 0;
#line 8592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iViewState  == PVT_SCENECAMERA )
#line 8593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCamera  * pcm  = (CCamera  *) & * m_penCamera ;
#line 8595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . FOVL  () = 
#line 8596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Lerp  (pcm  -> m_fLastFOV  , pcm  -> m_fFOV  , _pTimer  -> GetLerpFactor  ());
#line 8597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pcm  -> m_tmDelta  > 0.001f)
#line 8598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFactor  = (_pTimer  -> GetLerpedCurrentTick  () - pcm  -> m_tmAtMarker ) / pcm  -> m_tmDelta ;
#line 8600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fFactor  = Clamp  (fFactor  , 0.0f , 1.0f);
#line 8601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colBlend  = LerpColor  (pcm  -> m_colFade0  , pcm  -> m_colFade1  , fFactor );
#line 8602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
colBlend  = pcm  -> m_colFade0 ;
#line 8606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . FOVL  () = aFOV ;
#line 8611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . ScreenBBoxL  () = FLOATaabbox2D  (FLOAT2D  (0.0f , 0.0f) , 
#line 8613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT2D  ((FLOAT) pdp  -> GetWidth  () , (FLOAT) pdp  -> GetHeight  ()));
#line 8614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . FrontClipDistanceL  () = fFCD ;
#line 8615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . FarClipDistanceL  () = fFarCD ;
#line 8616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPerspectiveProjection  . AspectRatioL  () = 1.0f;
#line 8618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  = prPerspectiveProjection ;
#line 8619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  -> ViewerPlacementL  () = plViewer ;
#line 8620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  -> ObjectPlacementL  () = CPlacement3D (FLOAT3D (0 , 0 , 0) , ANGLE3D (0 , 0 , 0));
#line 8621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  -> Prepare  ();
#line 8622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prPlayerProjection  = apr ;
#line 8624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ListenFromEntity(CEntity * penListener,const CPlacement3D & plSound) 
#line 8628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D mRotation ;
#line 8630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MakeRotationMatrixFast  (mRotation  , plSound  . pl_OrientationAngle );
#line 8631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_penEntity  = penListener ;
#line 8632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_vPosition  = plSound  . pl_PositionVector ;
#line 8633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_mRotation  = mRotation ;
#line 8634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_vSpeed  = en_vCurrentTranslationAbsolute ;
#line 8635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_fVolume  = 1.0f;
#line 8638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 8640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_eEnvType  = SEFX_UNDERWATER ;
#line 8641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_fFilter  = 10.0f;
#line 8642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 8644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iEnv  = 0;
#line 8645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CBrushSector  * pbsc  = penListener  -> GetSectorFromPoint  (plSound  . pl_PositionVector );
#line 8646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pbsc  != NULL ){iEnv  = pbsc  -> GetEnvironmentType  ();}
#line 8647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEnvironmentType  & et  = GetWorld  () -> wo_aetEnvironmentTypes  [ iEnv  ];
#line 8648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_eEnvType  = (SndEnvFX ) et  . et_iType ;
#line 8649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sliSound  . sli_fFilter  = 0.0f;
#line 8650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pSound  -> Listen  (sliSound );
#line 8654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderDummyView(CDrawPort * pdp) 
#line 8658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> Fill  (C_BLACK  | CT_OPAQUE );
#line 8663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bSinglePlayer ){
#line 8665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PIX  pixDPWidth  = pdp  -> GetWidth  ();
#line 8666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PIX  pixDPHeight  = pdp  -> GetHeight  ();
#line 8667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScale  = (FLOAT) pixDPHeight  / 480.0f;
#line 8668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 8669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale  / 2);
#line 8670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 8671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextShadow  (+ 2);
#line 8672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMsg ;
#line 8673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMsg  . PrintF  (TRANS  ("%s connected") , GetPlayerName  ());
#line 8674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (strMsg  , pixDPWidth  * 0.5f , pixDPHeight  * 0.5f , SE_COL_BLUE_NEUTRAL_LT  | CT_OPAQUE );
#line 8675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderPlayerView(CDrawPort * pdp,BOOL bShowExtras) 
#line 8685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 8687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penViewer ;
#line 8688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plViewer ;
#line 8689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colBlend ;
#line 8692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iEye  = STEREO_LEFT ;iEye  <= (Stereo_IsEnabled  () ? STEREO_RIGHT  : STEREO_LEFT );iEye  ++)
#line 8693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_SetBuffer  (iEye );
#line 8696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 1 << GetMyPlayerIndex  ();
#line 8697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bTripleHead  = pdp  -> IsTripleHead  ();
#line 8698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bSeparatedTripleHead  = pdp  -> IsTripleHead  () && _pShell  -> GetINDEX  ("gfx_bSeparateTripleHead") != 0;
#line 8701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bSeparatedTripleHead )
#line 8702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpL  (pdp  , - 1);
#line 8705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (& dpL  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 8706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fFOV  = ((CPerspectiveProjection3D  &) * apr ) . FOVR  ();
#line 8707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  -> ViewerPlacementL  () . Rotate_Airplane  (ANGLE3D (+ fFOV  , 0 , 0));
#line 8708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpL  . SetAsCurrent  ();
#line 8710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , dpL );
#line 8712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpR  (pdp  , + 1);
#line 8713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (& dpR  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 8714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  -> ViewerPlacementL  () . Rotate_Airplane  (ANGLE3D (- fFOV  , 0 , 0));
#line 8715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpR  . SetAsCurrent  ();
#line 8717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , dpR );
#line 8719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpC  (pdp  , 0);
#line 8720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (& dpC  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 8721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpC  . SetAsCurrent  ();
#line 8723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , dpC );
#line 8724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (pdp  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 8730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , * pdp );
#line 8732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 0;
#line 8735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iEye  == STEREO_LEFT ){
#line 8737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ListenFromEntity  (this  , plViewer );
#line 8738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpCenter  (pdp  , 0);
#line 8742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpCenter  . SetAsCurrent  ();
#line 8743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (& dpCenter  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 8744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderHudPicFX  (& dpCenter );
#line 8751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(hud_bShowAll  && bShowExtras )
#line 8752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plLight  (_vViewerLightDirection  , ANGLE3D (0 , 0 , 0));
#line 8755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plLight  . AbsoluteToRelative  (plViewer );
#line 8756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderHUD  (* (CPerspectiveProjection3D  *) (CProjection3D  *) apr  , & dpCenter  , 
#line 8757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plLight  . pl_PositionVector  , _colViewerLight  , _colViewerAmbient  , 
#line 8758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penViewer  == this  && (GetFlags  () & ENF_ALIVE ) , iEye );
#line 8759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetAsCurrent  ();
#line 8764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_apr  = apr ;
#line 8766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_SetBuffer  (STEREO_BOTH );
#line 8772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PIX  pixDPWidth  = pdp  -> GetWidth  ();
#line 8773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PIX  pixDPHeight  = pdp  -> GetHeight  ();
#line 8774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScale  = (FLOAT) pixDPHeight  / 480.0f;
#line 8805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () < m_tmAnalyseEnd ){
#line 8806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 8807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale  / 2);
#line 8808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 8809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetTextShadow  (+ 2);
#line 8810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubA  = int  (sin  (_pTimer  -> CurrentTick  () * 10.0f) * 127 + 128);
#line 8811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (TRANS  ("Analyzing...") , pixDPWidth  * 0.5f , pixDPHeight  * 0.2f , SE_COL_BLUE_NEUTRAL_LT  | ubA );
#line 8812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderCameraView(CDrawPort * pdp,BOOL bListen) 
#line 8817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpCamera ;
#line 8819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  * pdpCamera  = pdp ;
#line 8820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL  && ((CCamera  &) * m_penCamera ) . m_bWideScreen )
#line 8821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> MakeWideScreen  (& dpCamera );
#line 8823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  = & dpCamera ;
#line 8824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> SetAsCurrent  ();
#line 8828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 8829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penViewer ;
#line 8831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plViewer ;
#line 8832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colBlend ;
#line 8835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iEye  = STEREO_LEFT ;iEye  <= (Stereo_IsEnabled  () ? STEREO_RIGHT  : STEREO_LEFT );iEye  ++)
#line 8836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (pdpCamera  , apr  , penViewer  , plViewer  , colBlend  , TRUE );
#line 8841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_SetBuffer  (iEye );
#line 8842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 8845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  BOOL _bWorldEditorApp ;
#line 8846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bLoginProcess  && ! _bWorldEditorApp )
#line 8847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_apr  = apr ;
#line 8849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (IsValidFloat  (plViewer  . pl_OrientationAngle  (1)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (2)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (3)));
#line 8854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 1 << GetMyPlayerIndex  ();
#line 8855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , * pdpCamera );
#line 8856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 0;
#line 8859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bListen  && iEye  == STEREO_LEFT ){
#line 8860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ListenFromEntity  (penViewer  , plViewer );
#line 8861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_SetBuffer  (STEREO_BOTH );
#line 8865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpCenter  (pdp  , 0);
#line 8866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpCenter  . SetAsCurrent  ();
#line 8871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderHudPicFX  (& dpCenter );
#line 8874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> SetAsCurrent  ();
#line 8876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colGlare  = GetWorldGlaring  ();
#line 8877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubR  , ubG  , ubB  , ubA ;
#line 8878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToRGBA  (colGlare  , ubR  , ubG  , ubB  , ubA );
#line 8879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubA  != 0){
#line 8880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingRA  += ULONG  (ubR ) * ULONG  (ubA );
#line 8881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingGA  += ULONG  (ubG ) * ULONG  (ubA );
#line 8882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingBA  += ULONG  (ubB ) * ULONG  (ubA );
#line 8883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingA  += ULONG  (ubA );
#line 8884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdpCamera  -> BlendScreen  ();
#line 8887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetAsCurrent  ();
#line 8892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((colBlend  & CT_AMASK ) != 0){
#line 8893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> Fill  (colBlend );
#line 8894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderGameView(CDrawPort * pdp,void * pvUserData) 
#line 8905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bShowExtras  = (ULONG  (pvUserData ) & GRV_SHOWEXTRAS );
#line 8909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED ) || (m_ulFlags  & PLF_DONTRENDER ))
#line 8910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetAsCurrent  ();
#line 8913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderDummyView  (pdp );
#line 8914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 8915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pvUserData  != 0)
#line 8919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTimerValue  tvNow  = _pTimer  -> GetHighPrecisionTimer  ();
#line 8922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tvNow  - _tvProbingLast ) . GetSeconds  () < 0.1)
#line 8923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGfx  -> gl_bAllowProbing  = TRUE ;
#line 8926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_tvProbingLast  = tvNow ;
#line 8928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bAllowMultiHead  = (GetSP  () -> sp_gmGameMode  != CSessionProperties  :: GM_FLYOVER ) 
#line 8932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (m_penActionMarker  == NULL );
#line 8933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bDualHead  = pdp  -> IsDualHead  () && bAllowMultiHead ;
#line 8934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bTripleHead  = pdp  -> IsTripleHead  () && bAllowMultiHead ;
#line 8935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL bMultiHead  = bDualHead  || bTripleHead ;
#line 8938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMultiHead  || m_penCamera  == NULL )
#line 8939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bDualHead )
#line 8941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpView  (pdp  , 0);
#line 8944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpView  . SetAsCurrent  ();
#line 8945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderPlayerView  (& dpView  , bShowExtras );
#line 8946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderPlayerView  (pdp  , bShowExtras );
#line 8950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL )
#line 8955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMonitor  = (m_penActionMarker  != NULL ) ? 3 : + 1;
#line 8958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpView  (pdp  , iMonitor );
#line 8959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpView  . SetAsCurrent  ();
#line 8961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderCameraView  (& dpView  , ! bDualHead );
#line 8963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 8965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bDualHead )
#line 8968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 8970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_ppenDHPlayer  = this ;
#line 8971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 8974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetAsCurrent  ();
#line 8975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 8985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PreMoving(void) 
#line 8986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAnimator  != NULL )
#line 9003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . StoreLast  ();
#line 9005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE  && m_iViewState  == PVT_PLAYERAUTOVIEW )
#line 9009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = PVT_PLAYEREYES ;
#line 9011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_vDesiredDirection  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 9016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_vDesiredDirection  . Length  () != 0)
#line 9017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_vDesiredDirection  . Normalize  ();
#line 9019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: PreMoving  ();
#line 9022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::DoMoving(void) 
#line 9026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: DoMoving  ();
#line 9030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsReapplyingActions  ())
#line 9031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAnimator  != NULL )
#line 9033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimateBanking  ();
#line 9035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL )
#line 9038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . DoMoving  ();
#line 9040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL )
#line 9042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . DoMoving  ();
#line 9044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PostMoving(void) 
#line 9050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: PostMoving  ();
#line 9054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_ulFlags  &= ~ ENF_INRENDERING ;
#line 9056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAnimator  != NULL )
#line 9057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimateSoftEyes  ();
#line 9059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE )
#line 9065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plRay ;
#line 9083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_apr  && ! _pInput  -> IsRMouseButtonPressed  () && ! _pInput  -> inp_bFreeMode )
#line 9084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plRay  = GetPlayerWeapons  () -> GetMouseHitInformation  (_pInput  -> inp_ptMousePos  , m_apr  , tmStartTime  , FALSE );
#line 9086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 9087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penCurrent  = GetPlayerWeapons  () -> m_penRayHitNow ;
#line 9090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penCurrent  != NULL  && (penCurrent  -> GetFlags  () & ENF_ALIVE  || penCurrent  -> GetFlags  () & ENF_ITEM ))
#line 9091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT MaxHealth ;
#line 9093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CurrentHealth ;
#line 9094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  Level ;
#line 9095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkMode  = - 1;
#line 9096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkState  , PkLegit ;
#line 9097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SQUAD  llItemSum  = 0;
#line 9098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nType  = - 1;
#line 9099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * tCT  = NULL ;
#line 9101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MaxHealth  = ((CUnit  *) ((CEntity  *) penCurrent )) -> m_nMaxiHealth ;
#line 9102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CurrentHealth  = ((CUnit  *) ((CEntity  *) penCurrent )) -> m_nCurrentHealth ;
#line 9103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  = ((CUnit  *) ((CEntity  *) penCurrent )) -> m_nMobLevel ;
#line 9105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penCurrent  -> IsCharacter  ())
#line 9106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  = 0;
#line 9108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkMode  = ((CCharacter  *) ((CEntity  *) penCurrent )) -> m_nPkMode ;
#line 9109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkState  = ((CCharacter  *) ((CEntity  *) penCurrent )) -> m_nPkState ;
#line 9110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkLegit  = ((CCharacter  *) ((CEntity  *) penCurrent )) -> m_nLegit ;
#line 9112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , penCurrent  -> GetNetworkID  ());
#line 9114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 9115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 9117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tCT  = pTarget ;
#line 9118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penCurrent  -> GetFlags  () & ENF_ITEM )
#line 9121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_ITEM  , penCurrent  -> GetNetworkID  ());
#line 9124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 9125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemTarget  * pTarget  = static_cast  < CItemTarget  * > (pObject );
#line 9128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
llItemSum  = pTarget  -> item_llCount ;
#line 9129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nType  = pTarget  -> m_nType ;
#line 9130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penCurrent  -> GetFlags  () & ENF_ITEM )
#line 9134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penCurrent  -> SetTargetInfoReal  (MaxHealth  , CurrentHealth  , 
#line 9136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  , 
#line 9137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 9138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 9139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
llItemSum  , - 1 , NULL  , nType );
#line 9140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(PkMode  != - 1)
#line 9142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tCT  != NULL )
#line 9144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penCurrent  -> SetTargetInfoReal  (MaxHealth  , CurrentHealth  , 
#line 9146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  , 
#line 9147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkMode  , 
#line 9148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkState  , 
#line 9149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
0 , 
#line 9150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkLegit  , 
#line 9151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tCT 
#line 9152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
);
#line 9153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 9156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penCurrent  -> SetTargetInfoReal  (MaxHealth  , CurrentHealth  , 
#line 9160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level );
#line 9161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 9164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET_REAL );
#line 9167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsReapplyingActions  ())
#line 9171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL )
#line 9173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . PostMoving  ();
#line 9175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL )
#line 9177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . PostMoving  ();
#line 9179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_APPLIEDACTION ;
#line 9187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_penReference  != NULL  && en_penReference  -> GetRenderType  () == CEntity  :: RT_BRUSH  && (en_penReference  -> GetPhysicsFlags  () & EPF_MOVABLE ))
#line 9188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetParent  (en_penReference );
#line 9192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMovableEntity  * penRef  = ((CMovableEntity  *) (CEntity  *) en_penReference );
#line 9195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penRef  -> m_iPlayerRefCounter  == 0)
#line 9196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penRef  -> ForceFullStop  ();
#line 9199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityMessage  emEntityMessage ;
#line 9201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ())
#line 9202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
emEntityMessage  . WritePlacementNotify  (penRef  -> en_ulID  , TRUE );
#line 9204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_srvServer  . SendMessage  (emEntityMessage );
#line 9206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{FOREACHINLIST  (CEntity  , en_lnInParent  , penRef  -> en_lhChildren  , itenChild )
#line 9207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(itenChild  -> en_ulPhysicsFlags  & EPF_MOVABLE )
#line 9209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMovableEntity  * penChild  = ((CMovableEntity  *) (CEntity  *) itenChild );
#line 9212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penChild  -> ForceFullStop  ();
#line 9213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
emEntityMessage  . WritePlacementNotify  (penChild  -> en_ulID  , TRUE );
#line 9214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_srvServer  . SendMessage  (emEntityMessage );
#line 9215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}}
#line 9217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penRef  -> m_iPlayerRefCounter  = 5;
#line 9222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iPlayerRefCounter  = 5;
#line 9223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 9225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetParent  (NULL );
#line 9228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iPlayerRefCounter  --;
#line 9229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetUnconnected(void) 
#line 9247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED )
#line 9249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_NOTCONNECTED ;
#line 9255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ForceFullStop  ();
#line 9256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 9257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () & ~ ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 9258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plLastViewpoint  . pl_OrientationAngle  = en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 9260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 9266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetConnected(void) 
#line 9270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_NOTCONNECTED ))
#line 9272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_NOTCONNECTED ;
#line 9277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 9278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () | ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 9279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsConnected(void)const 
#line 9283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ! (m_ulFlags  & PLF_NOTCONNECTED );
#line 9285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::LeaveStain(BOOL bGrow) 
#line 9294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESpawnEffect  ese ;
#line 9296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPoint ;
#line 9297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATplane3D vPlaneNormal ;
#line 9298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDistanceToEdge ;
#line 9300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D box ;
#line 9301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetBoundingBox  (box );
#line 9304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetNearestPolygon  (vPoint  , vPlaneNormal  , fDistanceToEdge )){
#line 9306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((vPoint  - GetPlacement  () . pl_PositionVector ) . Length  () < 0.5f 
#line 9307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (m_vLastStain  - vPoint ) . Length  () > 1.0f){
#line 9308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vLastStain  = vPoint ;
#line 9309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fStretch  = box  . Size  () . Length  ();
#line 9310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . colMuliplier  = C_WHITE  | CT_OPAQUE ;
#line 9312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bGrow ){
#line 9313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . betType  = BET_BLOODSTAINGROW ;
#line 9314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fStretch  * 1.5f , fStretch  * 1.5f , 1.0f);
#line 9315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 9316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . betType  = BET_BLOODSTAIN ;
#line 9317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fStretch  * 0.75f , fStretch  * 0.75f , 1.0f);
#line 9318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vNormal  = FLOAT3D (vPlaneNormal );
#line 9320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vDirection  = FLOAT3D (0 , 0 , 0);
#line 9321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPos  = vPoint  + ese  . vNormal  / 50.0f * (FRnd  () + 0.5f);
#line 9322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer penEffect  = CreateEntity  (CPlacement3D (vPos  , ANGLE3D (0 , 0 , 0)) , CLASS_BASIC_EFFECT );
#line 9323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEffect  -> Initialize  (ese );
#line 9324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::DamageImpact(enum DamageType dmtType,
#line 9329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDamageAmmount,const FLOAT3D & vHitPoint,const FLOAT3D & vDirection) 
#line 9330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetRenderType  () != RT_MODEL ){
#line 9334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_ABYSS  || dmtType  == DMT_SPIKESTAB ){
#line 9338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  = Clamp  (fDamageAmmount  , 0.0f , 5000.0f);
#line 9343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fKickDamage  = fDamageAmmount ;
#line 9344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((dmtType  == DMT_EXPLOSION ) || (dmtType  == DMT_IMPACT ))
#line 9345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fKickDamage  *= 1.5;
#line 9347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING  || dmtType  == DMT_CLOSERANGE ){
#line 9349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fKickDamage  /= 10;
#line 9350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_CHAINSAW )
#line 9352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fKickDamage  /= 10;
#line 9354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> CurrentTick  ();
#line 9358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmDelta  = tmNow  - m_tmLastDamage ;
#line 9359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLastDamage  = tmNow ;
#line 9362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmDelta  >= _pTimer  -> TickQuantum  * 3){
#line 9363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDamage  = FLOAT3D (0 , 0 , 0);
#line 9364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirectionFixed ;
#line 9367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDirection  . ManhattanNorm  () > 0.5f){
#line 9368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirectionFixed  = vDirection ;
#line 9369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 9370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirectionFixed  = - en_vGravityDir ;
#line 9371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDamageOld  = m_vDamage ;
#line 9373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDamage  += (vDirectionFixed ) * fKickDamage ;
#line 9375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fOldLen  = vDamageOld  . Length  ();
#line 9376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fNewLen  = m_vDamage  . Length  ();
#line 9377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fOldRootLen  = Sqrt  (fOldLen );
#line 9378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fNewRootLen  = Sqrt  (fNewLen );
#line 9380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fMassFactor  = 200.0f / ((EntityInfo  *) GetEntityInfo  ()) -> fMass ;
#line 9382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (en_ulFlags  & ENF_ALIVE ))
#line 9383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fMassFactor  /= 3;
#line 9385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(dmtType )
#line 9388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_CLOSERANGE : 
#line 9390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_CHAINSAW : 
#line 9391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_DROWNING : 
#line 9392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_IMPACT : 
#line 9393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_BRUSH : 
#line 9394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case DMT_BURNING : 
#line 9396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  :
#line 9398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fOldLen  != 0.0f)
#line 9400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GiveImpulseTranslationAbsolute  (- vDamageOld  / fOldRootLen  * fMassFactor );
#line 9403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GiveImpulseTranslationAbsolute  (m_vDamage  / fNewRootLen  * fMassFactor );
#line 9413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fMaxDamageAmmount  < fDamageAmmount )
#line 9417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fMaxDamageAmmount  = fDamageAmmount ;
#line 9419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_tmSpraySpawned  <= _pTimer  -> CurrentTick  () - _pTimer  -> TickQuantum  * 8 || 
#line 9422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSprayDamage  + fDamageAmmount  > 50.0f))
#line 9423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plSpray  = CPlacement3D (vHitPoint  , ANGLE3D (0 , 0 , 0));
#line 9426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penSpray  = CreateEntity  (plSpray  , CLASS_BLOOD_SPRAY );
#line 9427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penSpray  -> SetParent  (this );
#line 9428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESpawnSpray  eSpawnSpray ;
#line 9429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . colBurnColor  = C_WHITE  | CT_OPAQUE ;
#line 9431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fMaxDamageAmmount  > 10.0f)
#line 9432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 3.0f;
#line 9434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_fSprayDamage  + fDamageAmmount  > 50.0f)
#line 9436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 2.0f;
#line 9438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 9440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 1.0f;
#line 9442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . sptType  = SPT_BLOOD ;
#line 9445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . fSizeMultiplier  = 1.0f;
#line 9448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPointRelative  = vHitPoint  - GetPlacement  () . pl_PositionVector ;
#line 9449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vReflectingNormal ;
#line 9450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetNormalComponent  (vHitPointRelative  , en_vGravityDir  , vReflectingNormal );
#line 9451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vReflectingNormal  . Normalize  ();
#line 9453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vReflectingNormal  (1) /= 5.0f;
#line 9455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vProjectedComponent  = vReflectingNormal  * (vDirection  % vReflectingNormal );
#line 9456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vSpilDirection  = vDirection  - vProjectedComponent  * 2.0f - en_vGravityDir  * 0.5f;
#line 9458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . vDirection  = vSpilDirection ;
#line 9459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSpawnSpray  . eidOwner  = this ;
#line 9462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penSpray  -> Initialize  (eSpawnSpray );
#line 9463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSpraySpawned  = _pTimer  -> CurrentTick  ();
#line 9464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSprayDamage  = 0.0f;
#line 9465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fMaxDamageAmmount  = 0.0f;
#line 9466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSprayDamage  += fDamageAmmount ;
#line 9468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ReceiveDamage(CEntity * penInflictor,enum DamageType dmtType,
#line 9472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDamageAmmount,const FLOAT3D & vHitPoint,const FLOAT3D & vDirection) 
#line 9473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_NONE ){return ;}
#line 9477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penInflictor  == this  && (dmtType  == DMT_CLOSERANGE  || dmtType  == DMT_CHAINSAW  || 
#line 9478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((dmtType  == DMT_EXPLOSION  || dmtType  == DMT_PROJECTILE ) && 
#line 9479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetSP  () -> sp_gdGameDifficulty  <= CSessionProperties  :: GD_EASY ))){
#line 9480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 9486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cht_bGod  && CheatsEnabled  ()){return ;}
#line 9493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const TIME  tmDelta  = m_tmInvulnerability  - en_tmEntityTime ;
#line 9494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmDelta  > 0 && dmtType  != DMT_ABYSS  && dmtType  != DMT_TELEPORT ){return ;}
#line 9497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmSpawnInvulnerability  = GetSP  () -> sp_tmSpawnInvulnerability ;
#line 9498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmSpawnInvulnerability  > 0 && en_tmEntityTime  - m_tmSpawned  < tmSpawnInvulnerability ){
#line 9500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_HEAT  && ! (GetFlags  () & ENF_ALIVE )){
#line 9514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDifficultyDamage  = GetSP  () -> sp_fDamageStrength ;
#line 9519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDifficultyDamage  <= 1.0f || penInflictor  != this ){
#line 9520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  *= fDifficultyDamage ;
#line 9521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDamageAmmount  <= 0){
#line 9525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fSubHealth  , fSubArmor ;
#line 9529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING ){
#line 9531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fSubHealth  = fDamageAmmount ;
#line 9532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 9535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fSubArmor  = fDamageAmmount  * 2.0f / 3.0f;
#line 9536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fSubHealth  = fDamageAmmount  - fSubArmor ;
#line 9537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fArmor  -= fSubArmor ;
#line 9538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fArmor  < 0){
#line 9539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fSubHealth  -= m_fArmor ;
#line 9540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 9541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fSubHealth  > 0){
#line 9547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 9549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penOnBreak  = ((CCamera  &) * m_penCamera ) . m_penOnBreak ;
#line 9550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penOnBreak  != NULL ){
#line 9552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (penOnBreak  , EET_TRIGGER  , this );
#line 9554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 9556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 9557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penActionMarker  != NULL ){
#line 9564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 9565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  iJob  = 0;
#line 9596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  iHitType  = 0;
#line 9598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  != DMT_NONE  && fDamageAmmount  > 0)
#line 9599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vAxisY  (0 , 1 , 0);
#line 9601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT angle  = acos  (vDirection  % vAxisY );
#line 9602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D axis  = vAxisY  * vDirection ;
#line 9603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
axis  . Normalize  ();
#line 9604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D quat ;
#line 9605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
quat  . FromAxisAngle  (axis  , angle );
#line 9607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObj  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , m_iEnermyID );
#line 9609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObj  != NULL )
#line 9610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pCT  = static_cast  < CCharacterTarget  * > (pObj );
#line 9613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCT  != NULL )
#line 9614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iHitType  = pCT  -> cha_iHitType ;
#line 9616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  = pObj  -> GetType  ();
#line 9618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iHitType  < 0 || iHitType  >= DEF_HIT_TYPE_MAX )
#line 9621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iHitType  = 0;
#line 9623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (szHitEffect  [ iJob  ] [ iHitType  ] 
#line 9626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> CurrentTick  () , vHitPoint  , quat );
#line 9627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamageImpact  (dmtType  , fSubHealth  , vHitPoint  , vDirection );
#line 9632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  :: ReceiveDamage  (penInflictor  , dmtType  , fSubHealth  , vHitPoint  , vDirection );
#line 9636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamageMe )
#line 9637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == HEALER )
#line 9639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_DAMAGE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == MAGE )
#line 9643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_MAGE_DAMAGE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == TITAN )
#line 9647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_TITAN_DAMAGE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == KNIGHT )
#line 9651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_KNIGHT_DAMAGE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == ROGUE )
#line 9655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_ROGUE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == SORCERER )
#line 9659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_SORCERER_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXRogue  (iJob ))
#line 9663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_ROGUE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXMage  (iJob ))
#line 9667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_MAGE_DAMAGE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 9669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamageMe  = FALSE ;
#line 9671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDamageAmmount  > 1.0f){
#line 9676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_EXPLOSION  || dmtType  == DMT_PROJECTILE  || dmtType  == DMT_BULLET  
#line 9677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| dmtType  == DMT_IMPACT )
#line 9678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 9683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fDamageAmmount  += fDamageAmmount ;
#line 9684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmWoundedTime  = en_tmEntityTime ;
#line 9685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESound  eSound ;
#line 9690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSound  . EsndtSound  = SNDT_PLAYER ;
#line 9691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSound  . penTarget  = this ;
#line 9692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEventInRange  (eSound  , FLOATaabbox3D (GetPlacement  () . pl_PositionVector  , 10.0f));
#line 9695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING ){
#line 9696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 9698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("WoundWater");}
#line 9699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMouthSoundLast  = _pTimer  -> CurrentTick  ();
#line 9700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soLocalAmbientOnce  . Set3DParameters  (25.0f , 5.0f , 0.8f , Lerp  (0.5f , 1.5f , FRnd  ()));
#line 9702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SpawnBubbles  (10 + INDEX (FRnd  () * 10));
#line 9703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_fDamageAmmount  > 1.0f){
#line 9706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 9708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iSound ;
#line 9709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
char  * strIFeel  = NULL ;
#line 9710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fDamageAmmount  < 5.0f){
#line 9712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_DEFAULT );
#line 9714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strIFeel  = "WoundWeak";
#line 9715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_fDamageAmmount  < 25.0f){
#line 9717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_DEFAULT );
#line 9718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strIFeel  = "WoundMedium";
#line 9719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 9721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_DEFAULT );
#line 9722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strIFeel  = "WoundStrong";
#line 9723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 9725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_DEFAULT );
#line 9726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strIFeel  = "WoundWater";
#line 9727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 9730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> CurrentTick  ();
#line 9738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::ShouldBlowUp(void) 
#line 9744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return 
#line 9748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gam_bGibs  && 
#line 9750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(GetHealth  () <= 0) && 
#line 9752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_vDamage  . Length  () > _fBlowUpAmmount ) && 
#line 9754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetRenderType  () == RT_MODEL ;
#line 9755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::GetPlaneFrustumAngle(const FLOAT3D & vDir) 
#line 9759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPlaneDelta ;
#line 9762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetNormalComponent  (vDir  , en_vGravityDir  , vPlaneDelta );
#line 9764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vFront  = - GetRotationMatrix  () . GetColumn  (3);
#line 9765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPlaneFront ;
#line 9766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetNormalComponent  (vFront  , en_vGravityDir  , vPlaneFront );
#line 9768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vPlaneDelta  . SafeNormalize  ();
#line 9769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vPlaneFront  . SafeNormalize  ();
#line 9770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return vPlaneDelta  % vPlaneFront ;
#line 9771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void * CPlayer::GetEntityInfo(void) 
#line 9778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
struct  EntityInfo 
#line 9781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EntityInfoBodyType  Eeibt ;
#line 9783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fMass ;
#line 9784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT vSourceCenter  [ 3 ];
#line 9785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT vTargetCenter  [ 3 ];
#line 9786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
};
#line 9787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static EntityInfo  ei ;
#line 9788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . Eeibt  = EIBT_FLESH ;
#line 9789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . fMass  = 100.0f;
#line 9790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vSourceCenter  [ 0 ] = 0;
#line 9791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vSourceCenter  [ 1 ] = 1;
#line 9792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vSourceCenter  [ 2 ] = 0;
#line 9793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 0 ] = 0;
#line 9794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1;
#line 9795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 2 ] = 0;
#line 9796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(en_pcCharacter  . pc_iPlayerType ){
#line 9797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case TITAN : 
#line 9798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MAGE : 
#line 9801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 0.95f;
#line 9802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HEALER : 
#line 9804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case KNIGHT : 
#line 9807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ROGUE : 
#line 9810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case SORCERER : 
#line 9813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 7: 
#line 9816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXRogue  (en_pcCharacter  . pc_iPlayerType ))
#line 9818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 1.00f;
#line 9820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXMage  (en_pcCharacter  . pc_iPlayerType ))
#line 9835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ei  . vTargetCenter  [ 1 ] = 0.95f;
#line 9837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return & ei ;
#line 9840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ChangePlayerView() 
#line 9853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 9857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (m_pen3rdPersonView  == NULL );
#line 9858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  == NULL ){
#line 9859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_VIEW  , WLD_AUTO_ENTITY_ID  , FALSE );
#line 9860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EViewInit  eInit ;
#line 9861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidOwner  = this ;
#line 9862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidCamera  = (CEntity  *) NULL ;
#line 9863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . vtView  = VT_3RDPERSONVIEW ;
#line 9864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . bDeathFixed  = FALSE ;
#line 9865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Initialize  (eInit  , FALSE );
#line 9866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = PVT_3RDPERSONVIEW ;
#line 9871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_3RDPERSONVIEW ){
#line 9872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = PVT_PLAYEREYES ;
#line 9875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 9876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . SendEvent  (EEnd  () , FALSE );
#line 9877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  = NULL ;
#line 9878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::UsePressed(BOOL bOrComputer) 
#line 9902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapons  = GetPlayerWeapons  ();
#line 9905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = penWeapons  -> m_penRayHit ;
#line 9906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSomethingToUse  = FALSE ;
#line 9909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL ){
#line 9911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsOfClass  (pen  , "Moving Brush")){
#line 9912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CMovingBrush  &) * pen ) . m_penSwitch  != NULL ){
#line 9913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = ((CMovingBrush  &) * pen ) . m_penSwitch ;
#line 9914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsOfClass  (pen  , "Switch") && penWeapons  -> m_fRayHitDistance  < 2.0f){
#line 9919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSwitch  & enSwitch  = (CSwitch  &) * pen ;
#line 9921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(enSwitch  . m_bUseable ){
#line 9923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (pen  , EET_TRIGGER  , this );
#line 9924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSomethingToUse  = TRUE ;
#line 9925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetGameEnd(void) 
#line 9966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 9968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 9969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerEntity  (iPlayer );
#line 9970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL ){
#line 9971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  ENGINE_API  BOOL _bDedicatedServer ;
#line 9972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cmp_ppenPlayer  == NULL  && (_pNetwork  -> IsPlayerLocal  (pen ) || _bDedicatedServer )){
#line 9973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_ppenPlayer  = (CPlayer  *) pen ;
#line 9974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 9975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 9976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < NET_MAXGAMEPLAYERS ;i  ++){
#line 9977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerTarget  & plt  = _pNetwork  -> ga_srvServer  . srv_apltPlayers  [ i  ];
#line 9978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(plt  . IsActive  () && plt  . plt_penPlayerEntity  != NULL ){
#line 9979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * ppl  = (CPlayer  *) plt  . plt_penPlayerEntity ;
#line 9980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerStats  epls ;
#line 9981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epls  . iIndex  = i ;
#line 9983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epls  . iKills  = ppl  -> m_psGameStats  . ps_iKills ;
#line 9984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epls  . iDeaths  = ppl  -> m_psGameStats  . ps_iDeaths ;
#line 9985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (epls  , TRUE );
#line 9986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (EShowConsole  () , TRUE );
#line 9990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 9992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 9995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetGameFinished  ();
#line 9996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 9998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::CalculateViewRotationDamping(void) 
#line 9999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRotationDamping  = 1.0f;
#line 10011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return fRotationDamping ;
#line 10012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ApplyAction(const CPlayerAction & paOriginal,FLOAT tmLatency) 
#line 10016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED )){return ;}
#line 10030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED )
#line 10031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetConnected  ();
#line 10034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_APPLIEDACTION ;
#line 10039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAction  paAction  = paOriginal ;
#line 10043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRotationDamping  = CalculateViewRotationDamping  ();
#line 10046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aDeltaRotation ;
#line 10047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aDeltaViewRotation ;
#line 10049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaRotation  (1) = GetRotationDiff  (m_iLastRotationH  , paAction  . pa_aRotation  (1));
#line 10050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaRotation  (2) = GetRotationDiff  (m_iLastRotationP  , paAction  . pa_aRotation  (2));
#line 10051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaRotation  (3) = GetRotationDiff  (m_iLastRotationB  , paAction  . pa_aRotation  (3));
#line 10054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaViewRotation  (1) = GetRotationDiff  (m_iLastViewRotationH  , paAction  . pa_aViewRotation  (1));
#line 10055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaViewRotation  (2) = GetRotationDiff  (m_iLastViewRotationP  , paAction  . pa_aViewRotation  (2));
#line 10056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaViewRotation  (3) = GetRotationDiff  (m_iLastViewRotationB  , paAction  . pa_aViewRotation  (3));
#line 10058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaRotation  *= fRotationDamping ;
#line 10059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDeltaViewRotation  *= fRotationDamping ;
#line 10061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastRotationH  , paAction  . pa_aRotation  (1));
#line 10062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastRotationP  , paAction  . pa_aRotation  (2));
#line 10063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastRotationB  , paAction  . pa_aRotation  (3));
#line 10064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastViewRotationH  , paAction  . pa_aViewRotation  (1));
#line 10065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastViewRotationP  , paAction  . pa_aViewRotation  (2));
#line 10066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRotation  (m_iLastViewRotationB  , paAction  . pa_aViewRotation  (3));
#line 10068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  = aDeltaRotation ;
#line 10069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = aDeltaViewRotation ;
#line 10072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  /= _pTimer  -> TickQuantum ;
#line 10073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  /= _pTimer  -> TickQuantum ;
#line 10075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penMe  = this ;
#line 10079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (1) = Clamp  (paAction  . pa_vTranslation  (1) , - plr_fSpeed  , plr_fSpeed );
#line 10080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (2) = Clamp  (paAction  . pa_vTranslation  (2) , - plr_fSpeedUp  , plr_fSpeedUp );
#line 10081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (3) = Clamp  (paAction  . pa_vTranslation  (3) , - plr_fSpeed  , plr_fSpeed );
#line 10084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (paAction  . pa_vTranslation  (3)) < plr_fSpeed  / 1.99f 
#line 10085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& Abs  (paAction  . pa_vTranslation  (1)) < plr_fSpeed  / 1.99f){
#line 10087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fStepDnHeight  = 1.5f;
#line 10089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 10091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fStepDnHeight  = - 1;
#line 10092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D & v  = paAction  . pa_vTranslation ;
#line 10096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDiag  = Sqrt  (v  (1) * v  (1) + v  (3) * v  (3));
#line 10097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDiag  > 0.01f)
#line 10098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDiagLimited  = Min  (fDiag  , plr_fSpeed );
#line 10100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFactor  = fDiagLimited  / fDiag ;
#line 10101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
v  (1) *= fFactor ;
#line 10102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
v  (3) *= fFactor ;
#line 10103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulButtonsNow  = paAction  . pa_ulButtons ;
#line 10106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulButtonsBefore  = m_ulLastButtons ;
#line 10107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulNewButtons  = ulButtonsNow  & ~ ulButtonsBefore ;
#line 10108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulReleasedButtons  = (~ ulButtonsNow ) & (ulButtonsBefore );
#line 10110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulLastButtons  = ulButtonsNow ;
#line 10111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plLastViewpoint  = en_plViewpoint ;
#line 10114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((g_slZone  == 0 || g_slZone  == 4) && ! _bLoginProcess  && _pNetwork  -> GetLoadingZone  () == - 1)
#line 10115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CheckField  ();
#line 10117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayMusic  ();
#line 10118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_slZone  == 7 && _pUISWDoc  -> IsWar  ())
#line 10120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> PlayBGM  (MUSIC_CASTLE_BATTLE );
#line 10122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE )
#line 10126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AliveActions  (paAction );
#line 10130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeathActions  (paAction );
#line 10135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateLatency  (tmLatency );
#line 10139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Disconnect(void) 
#line 10143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_strName  = GetPlayerName  ();
#line 10147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pcCharacter  = CPlayerCharacter  ();
#line 10149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (EDisconnected  ());
#line 10150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
#define TRANSFORMATION_TIME		1.8f

#line 10156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::TransformSorcerer(int iType) 
#line 10157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 10160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static double  dTransformingTime  = TRANSFORMATION_TIME ;
#line 10162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 10165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static bool  s_bStart  = true ;
#line 10166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static DOUBLE  dStartAnimationTime  = 0.0f;
#line 10173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(s_bStart  && ! m_bIsTransform )
#line 10174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dStartAnimationTime  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 10176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
s_bStart  = false ;
#line 10177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DOUBLE  dDelayForAnimate  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  () - dStartAnimationTime ;
#line 10181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dDelayForAnimate  < dTransformingTime )
#line 10182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 10184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNewLook ;
#line 10189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.05f;
#line 10192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = FALSE ;
#line 10195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bIsTransform  = TRUE ;
#line 10199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_EVOCATION  ();
#line 10203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCollisionInfo  pciCollisionInfo  = * (this  -> en_pciCollisionInfo );
#line 10205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (TransformInfo  () . GetFileName  (iType ));
#line 10207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
* (this  -> en_pciCollisionInfo ) = pciCollisionInfo ;
#line 10209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX t  = ANIM_BASIC_BEGIN ;t  < ANIM_BASIC_END ;++ t )
#line 10210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ t  ] = ska_GetIDFromStringTable  (TransformInfo  () . GetAnimationName  (iType  , t ));
#line 10212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_Effect  (1 , CStatusEffect  :: R_NONE );
#line 10218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
s_bStart  = true ;
#line 10220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penPlEntity ;
#line 10221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlEntity  = CEntity  :: GetPlayerEntity  (0);
#line 10223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = penPlEntity  -> en_pmiModelInstance ;
#line 10225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . AddHolyWaterEffect  (_pNetwork  -> MyCharacterInfo  . iHitEffectType  , 
#line 10226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& (pMI  -> m_tmSkaTagManager ));
#line 10228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . RefreshPetStashEffect  (& (pMI  -> m_tmSkaTagManager ));
#line 10229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . RefreshRelicEffect  (& (pMI  -> m_tmSkaTagManager ));
#line 10230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ReturnSorcerer() 
#line 10234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bIsTransform  && ! ISEVOCATION  (_pNetwork  -> Get_MyChar_MorphStatus  ()))
#line 10238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 10240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 10242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNewLook ;
#line 10247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 10248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (CJobInfo  :: getSingleton  () -> GetFileName  (iJob ));
#line 10250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.05f;
#line 10253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetModelInstance  ();
#line 10256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 10257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iFaceMesh  = - 1;
#line 10259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iHairMesh  = - 1;
#line 10261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbFaceStyle  = _pNetwork  -> Get_MyChar_faceStyle  ();
#line 10262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbHairStyle  = _pNetwork  -> Get_MyChar_hairStyle  ();
#line 10265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> SetCharacterAppearance  (pMI  , iJob  , sbHairStyle  , sbFaceStyle );
#line 10266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX t  = ANIM_BASIC_BEGIN ;t  < ANIM_BASIC_END ;++ t )
#line 10269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ t  ] = ska_GetIDFromStringTable  (CJobInfo  :: getSingleton  () -> GetAnimationName  (iJob  , t ));
#line 10271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nCosIndex  = - 1;
#line 10275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;i  < WEAR_TOTAL ;++ i )
#line 10276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nCosIndex  = _pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ;
#line 10280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  < WEAR_COSTUME_TOTAL  && nCosIndex  > 0 && 
#line 10281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> GetItemData  (nCosIndex ) -> IsFlag  (ITEM_FLAG_INVISIBLE_COSTUME ) == false )
#line 10282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  != WEAR_HELMET  || (i  == WEAR_HELMET  && (CTString) _pNetwork  -> GetItemData  (_pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ) -> GetItemSmcFileName  () != MODEL_TREASURE ))
#line 10284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPlayerType  = en_pcCharacter  . pc_iPlayerType ;
#line 10286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 10287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , i  , iPlayerType );
#line 10288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> GetItemData  (_pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ));
#line 10289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pNetwork  -> MyWearItem  [ i  ] . IsEmptyItem  () == FALSE )
#line 10292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  == WEAR_BACKWING  && _pNetwork  -> MyWearCostItem  [ WEAR_COSTUME_BACKWING  ] . Item_Index  > 0)
#line 10294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 10296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItems  * tmpItem  = & _pNetwork  -> MyWearItem  [ i  ];
#line 10298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SWORD  nTab  , nIdx ;
#line 10299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nTab  = _pNetwork  -> MyWearItem  [ i  ] . Item_Tab ;
#line 10300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nIdx  = _pNetwork  -> MyWearItem  [ i  ] . InvenIndex ;
#line 10302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  != WEAR_HELMET  || (i  == WEAR_HELMET  && (CTString) tmpItem  -> ItemData  -> GetItemSmcFileName  () != MODEL_TREASURE ))
#line 10303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , i  , iJob );
#line 10305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> MyWearItem  [ i  ] . ItemData );
#line 10306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bIsTransform  = FALSE ;
#line 10311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = FALSE ;
#line 10313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_MORPH_END  ();
#line 10317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::MonsterChange(int type) 
#line 10321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 10325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNewLook ;
#line 10327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.05f;
#line 10330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMobChange  = TRUE ;
#line 10334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (type );
#line 10336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CStaticArray  < struct  ColisionBox  > AABox ;
#line 10337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AABox  . CopyArray  (GetModelInstance  () -> mi_cbAABox );
#line 10339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (MD  -> GetMobSmcFileName  ());
#line 10340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> mi_cbAABox  . Clear  ();
#line 10341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> mi_cbAABox  = AABox ;
#line 10343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_ATTACK_IDLE  ] = idPlayerWhole_Animation  [ ANIM_IDLE  ] = ska_GetIDFromStringTable  (MD  -> GetAnimDefaultName  ());
#line 10344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RUN_2  ] = idPlayerWhole_Animation  [ ANIM_RUN_1  ] = ska_GetIDFromStringTable  (MD  -> GetAnimRunName  ());
#line 10345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_WALK_2  ] = idPlayerWhole_Animation  [ ANIM_WALK_1  ] = ska_GetIDFromStringTable  (MD  -> GetAnimWalkName  ());
#line 10346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_DIE  ] = ska_GetIDFromStringTable  (MD  -> GetAnimDeathName  ());
#line 10347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_DAMAGE  ] = ska_GetIDFromStringTable  (MD  -> GetAnimWoundName  ());
#line 10349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (NULL  , 1);
#line 10350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (NULL  , CStatusEffect  :: R_NONE );
#line 10351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ReturnChange(BOOL bAppear) 
#line 10355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bMobChange  && ! ISTRANSFORMATION  (_pNetwork  -> MyCharacterInfo  . eMorphStatus ))
#line 10358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 10360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CJobInfo  * pInfo  = CJobInfo  :: getSingleton  ();
#line 10364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 10365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNewLook ;
#line 10367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.05f;
#line 10370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 10373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> Clear  ();
#line 10374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (pInfo  -> GetFileName  (iJob ));
#line 10376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetModelInstance  ();
#line 10377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMI )
#line 10378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iFaceMesh  = - 1;
#line 10380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> mi_iHairMesh  = - 1;
#line 10382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbFaceStyle  = _pNetwork  -> Get_MyChar_faceStyle  ();
#line 10383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const SBYTE  sbHairStyle  = _pNetwork  -> Get_MyChar_hairStyle  ();
#line 10386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> SetCharacterAppearance  (pMI  , iJob  , sbHairStyle  , sbFaceStyle );
#line 10387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAppear )
#line 10390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> StretchModel  (FLOAT3D (1.0f , 1.0f , 1.0f));
#line 10392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> StretchModel  (FLOAT3D (0.1f , 0.1f , 0.1f));
#line 10396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_IDLE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_IDLE ));
#line 10400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RUN_1  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_RUN_1 ));
#line 10401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_WALK_1  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_WALK_1 ));
#line 10402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_DIE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_DIE ));
#line 10403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_ATTACK_IDLE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_ATTACK_IDLE ));
#line 10404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RUN_2  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_RUN_2 ));
#line 10405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_WALK_2  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_WALK_2 ));
#line 10406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_DAMAGE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (iJob  , ANIM_DAMAGE ));
#line 10408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nCosIndex  = - 1;
#line 10410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;i  < WEAR_TOTAL ;++ i )
#line 10411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nCosIndex  = _pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ;
#line 10415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  < WEAR_COSTUME_TOTAL  && nCosIndex  > 0 && 
#line 10416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> GetItemData  (nCosIndex ) -> IsFlag  (nCosIndex ) == false )
#line 10417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  != WEAR_HELMET  || (i  == WEAR_HELMET  && (CTString) _pNetwork  -> GetItemData  (_pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ) -> GetItemSmcFileName  () != MODEL_TREASURE ))
#line 10419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPlayerType  = en_pcCharacter  . pc_iPlayerType ;
#line 10421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 10422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , i  , iPlayerType );
#line 10423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> GetItemData  (_pNetwork  -> MyWearCostItem  [ i  ] . Item_Index ));
#line 10424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pNetwork  -> MyWearItem  [ i  ] . IsEmptyItem  () == FALSE )
#line 10427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  == WEAR_BACKWING  && _pNetwork  -> MyWearCostItem  [ WEAR_COSTUME_BACKWING  ] . Item_Index  > 0)
#line 10429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 10431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItems  * tmpItem  = & _pNetwork  -> MyWearItem  [ i  ];
#line 10433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SWORD  nTab  , nIdx ;
#line 10434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nTab  = _pNetwork  -> MyWearItem  [ i  ] . Item_Tab ;
#line 10435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nIdx  = _pNetwork  -> MyWearItem  [ i  ] . InvenIndex ;
#line 10437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(i  != WEAR_HELMET  || (i  == WEAR_HELMET  && (CTString) tmpItem  -> ItemData  -> GetItemSmcFileName  () != MODEL_TREASURE ))
#line 10438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , i  , iJob );
#line 10440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> MyWearItem  [ i  ] . ItemData );
#line 10441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMobChange  = FALSE ;
#line 10446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY );
#line 10447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::MinMaximize() 
#line 10450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bMinimize  = TRUE ;
#line 10453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bChanging )
#line 10454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMinimize )
#line 10456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static int  cnt  = 0;
#line 10459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static unsigned  int  tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 10461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == 0)
#line 10462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 10464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  ++;
#line 10465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  time  = ((unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000) - tmStartTime ) % 1000) / 100;
#line 10468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(time  < 1)
#line 10469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 10471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = cnt  + time ;
#line 10475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  > 9)
#line 10476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 9;
#line 10478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fScale  = 0.1f * (10 - cnt );
#line 10482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == 9)
#line 10483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bMobChange )
#line 10485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MonsterChange  (m_nChangeMonsterId );
#line 10487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnChange  (FALSE );
#line 10491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMinimize  = FALSE ;
#line 10494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 0;
#line 10495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> StretchModel  (FLOAT3D (fScale  , fScale  , fScale ));
#line 10500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static int  cnt  = 10;
#line 10506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static unsigned  int  tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 10508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == 10)
#line 10509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 10511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  --;
#line 10513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nChangeMonsterId  == GM_CHANGE )
#line 10514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX animID  = ska_StringToID  ("cusedrich_skill");
#line 10516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT animTime  = GetModelInstance  () -> GetAnimLength  (animID );
#line 10518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 10519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("cusedrich_disguise" , & GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 10520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Polymorph" , & GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 10525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_POLYMOPH  , SOF_3D  | SOF_VOLUMETRIC );
#line 10527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  time  = ((unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000) - tmStartTime ) % 1000) / 100;
#line 10532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(time  < 1)
#line 10533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 10535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = cnt  - time ;
#line 10539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  < 1)
#line 10540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 1;
#line 10542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nChangeMonsterId  == GM_CHANGE )
#line 10545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> StretchModel  (FLOAT3D (GM_CHANGE_MUL  * (11 - cnt ) , GM_CHANGE_MUL  * (11 - cnt ) , GM_CHANGE_MUL  * (11 - cnt )));
#line 10547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> StretchModel  (FLOAT3D (0.1f * (11 - cnt ) , 0.1f * (11 - cnt ) , 0.1f * (11 - cnt )));
#line 10551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == 1)
#line 10555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaColisionInfo  ();
#line 10557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = FALSE ;
#line 10558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMinimize  = TRUE ;
#line 10559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange  == FALSE )
#line 10560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_MORPH_END  ();
#line 10563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_TRANSFORMATION  ();
#line 10568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 10;
#line 10572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nPlayActionNum  == ACTION_NUM_SELL )
#line 10573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 1;
#line 10575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . job  == NIGHTSHADOW )
#line 10576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , FALSE );
#line 10578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 10580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.2f;
#line 10585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& en_pmiModelInstance  -> m_tmSkaTagManager  , 1);
#line 10588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& en_pmiModelInstance  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 10590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> SetCSFlagOff  (CSF_TELEPORT );
#line 10591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::Transforming() 
#line 10598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bTransforming )
#line 10600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bIsTransform )
#line 10602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TransformSorcerer  (m_iTransformType );
#line 10604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnSorcerer  ();
#line 10608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::CharacterChanged(const CPlayerCharacter & pcNew) 
#line 10617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerCharacter  pcOrg  = en_pcCharacter ;
#line 10622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pcCharacter  = pcNew ;
#line 10623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 10626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pcOrg  . GetName  () != pcNew  . GetName  ()){
#line 10628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s is now known as %s\n") , 
#line 10629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pcOrg  . GetNameForPrinting  () , pcNew  . GetNameForPrinting  ());
#line 10630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerSettings  * ppsOrg  = (CPlayerSettings  *) pcOrg  . pc_aubAppearance ;
#line 10634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerSettings  * ppsNew  = (CPlayerSettings  *) pcNew  . pc_aubAppearance ;
#line 10640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strNewLook ;
#line 10642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSuccess ;
#line 10643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl ){
#line 10644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSuccess  = SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strNewLook  , FALSE );
#line 10645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 10646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSuccess  = SetPlayerAppearanceSka  (& m_miRender  , & en_pcCharacter  , strNewLook  , FALSE );
#line 10647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJobType  = en_pcCharacter  . pc_iPlayerType ;
#line 10651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSkaModel  (CJobInfo  :: getSingleton  () -> GetFileName  (iJobType ));
#line 10654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetModelInstance  ())
#line 10655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 10657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 10658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 10659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 10660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 10661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 10662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 10663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 10664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 10665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 10666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bSuccess ){
#line 10672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ParseGender  (strNewLook );
#line 10677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 10679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("Cannot change appearance for %s: setting '%s' is unavailable\n") , 
#line 10680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pcNew  . GetNameForPrinting  () , (const char  *) ppsNew  -> GetModelFilename  ());
#line 10681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FillAnimAndBoneIDs  ();
#line 10704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 10705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  = GetPlacement  ();
#line 10706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) = plPlacement  . pl_PositionVector  (2) + 0.05f;
#line 10707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plPlacement );
#line 10710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 10711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 10712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 10713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pmiModelInstance  -> m_tmSkaTagManager  . Register  (& tag );
#line 10714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 10715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 10716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 10717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 10718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 10719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 10721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckEscKey(void) 
#line 10725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bCanSkillCancel )
#line 10727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 10729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  * pSkill  = & _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 10733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pSkill  != NULL  && pSkill  -> bCanCancel  == FALSE ) || m_bNoAniGuildSkill )
#line 10734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 10736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bForward  || m_bStartAttack  || m_bKeyMove )
#line 10739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 10741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 10744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penReservedTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 10746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 10747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> IsEnemy  () || 
#line 10749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penTarget  -> IsCharacter  ()) || 
#line 10750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penTarget  -> IsPet  ()) || 
#line 10751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penTarget  -> IsSlave  ()) || 
#line 10752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penTarget  -> IsWildPet  ()) || 
#line 10753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penTarget  -> GetFlags  () & ENF_ITEM ) || penTarget  == this )
#line 10754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 10756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penReservedTarget  != NULL )
#line 10760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penReservedTarget  -> IsEnemy  () || 
#line 10762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penReservedTarget  -> IsCharacter  ()) || 
#line 10763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penReservedTarget  -> IsPet  ()) || 
#line 10764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penReservedTarget  -> IsSlave  ()) || 
#line 10765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penReservedTarget  -> IsWildPet  ()) || 
#line 10766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(penReservedTarget  -> GetFlags  () & ENF_ITEM ) || penReservedTarget  == this )
#line 10767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 10769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1 || m_nDesiredSkillNum  != - 1)
#line 10773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 10775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 10778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AliveActions(const CPlayerAction & pa) 
#line 10783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 10787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fAcceleration  = plr_fAcceleration ;
#line 10788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fDeceleration  = plr_fDeceleration ;
#line 10790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAction  paAction  = pa ;
#line 10795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  BOOL _bWorldEditorApp ;
#line 10796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL  && ! _bInFixedCamera )
#line 10797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bLoginProcess  || _bWorldEditorApp )
#line 10799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , 0);
#line 10802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (0 , 0 , 0);
#line 10803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = ANGLE3D (0 , 0 , 0);
#line 10805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & (PLACT_FIRE  | PLACT_USE ))
#line 10806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 10809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ButtonsActions  (paAction );
#line 10815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(STAGEMGR  () -> GetCurStage  () == eSTAGE_GAMEPLAY  || _bInTestGame )
#line 10820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ActiveActions  (paAction );
#line 10823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AutoActions(const CPlayerAction & pa) 
#line 10829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  == NULL )
#line 10832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EAutoAction  eAutoAction ;
#line 10835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eAutoAction  . eidFirstMarker  = (CEntity  *) NULL ;
#line 10836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (eAutoAction );
#line 10837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & (PLACT_FIRE  | PLACT_USE )){
#line 10841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 10842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penOnBreak  = ((CCamera  &) * m_penCamera ) . m_penOnBreak ;
#line 10843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penOnBreak  != NULL ){
#line 10844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (penOnBreak  , EET_TRIGGER  , this );
#line 10845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAction  paAction  = pa ;
#line 10851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , 0);
#line 10852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (0 , 0 , 0);
#line 10853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = ANGLE3D (0 , 0 , 0);
#line 10856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fAutoSpeed  > 0)
#line 10857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = 
#line 10859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 10860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ;
#line 10862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDistance  = vDelta  . Length  ();
#line 10863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDistance  > 0.1f)
#line 10864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  /= fDistance ;
#line 10866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aDH  = GetRelativeHeading  (vDelta );
#line 10869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fSpeed  = m_fAutoSpeed ;
#line 10870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_paaAction  == PAA_RUNANDSTOP )
#line 10871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fSpeed  = Min  (fSpeed  , fDistance  / _pTimer  -> TickQuantum );
#line 10874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (aDH ) > 1.0f)
#line 10877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fSpeed  > m_fAutoSpeed  - 0.1f)
#line 10879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aDH  = Clamp  (aDH  , - 10.0f , 10.0f);
#line 10881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (aDH  / _pTimer  -> TickQuantum  , 0 , 0);
#line 10883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , - fSpeed );
#line 10886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = m_vAutoSpeed ;
#line 10891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_AUTOMOVEMENTS )){
#line 10895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ActiveActions  (paAction );
#line 10896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetLerpedWeaponPosition(FLOAT3D vRel,CPlacement3D & pl) 
#line 10900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pl  = CPlacement3D (vRel  , ANGLE3D (0 , 0 , 0));
#line 10902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 10903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bDiscard3rdView  = GetViewEntity  (FALSE ) != this ;
#line 10904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetLerpedAbsoluteViewPlacement  (plView );
#line 10905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pl  . RelativeToAbsolute  (plView );
#line 10906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SpawnBubbles(INDEX ctBubbles) 
#line 10909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iBouble  = 0;iBouble  < ctBubbles ;iBouble  ++)
#line 10911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRndRel  = FLOAT3D ((FRnd  () - 0.5f) * 0.25f , - 0.25f , - 0.5f + FRnd  () / 10.0f);
#line 10913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aDummy  = ANGLE3D (0 , 0 , 0);
#line 10914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plMouth  = CPlacement3D (vRndRel  , aDummy );
#line 10916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plMouth  . RelativeToAbsolute  (en_plViewpoint );
#line 10917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plMouth  . RelativeToAbsolute  (GetPlacement  ());
#line 10918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRndSpd  = FLOAT3D ((FRnd  () - 0.5f) * 0.25f , (FRnd  () - 0.5f) * 0.25f , (FRnd  () - 0.5f) * 0.25f);
#line 10919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plMouth  . pl_PositionVector  (2) += 0.5f;
#line 10920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddBouble  (plMouth  . pl_PositionVector  , vRndSpd );
#line 10921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 10932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ActiveActions(const CPlayerAction & paAction) 
#line 10933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 10935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 10937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTranslation  = paAction  . pa_vTranslation ;
#line 10946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative )
#line 10947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTranslation  (1) *= 1.35f;
#line 10949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTranslation  (3) *= 1.35f;
#line 10951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CContentType  & ctUp  = GetWorld  () -> wo_actContentTypes  [ en_iUpContent  ];
#line 10954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CContentType  & ctDn  = GetWorld  () -> wo_actContentTypes  [ en_iDnContent  ];
#line 10955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerState  pstWanted  = PST_STAND ;
#line 10956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bUpSwimable  = (ctUp  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  <= 0.99f;
#line 10957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bDnSwimable  = (ctDn  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  >= 0.5f;
#line 10961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bUpSwimable  || bDnSwimable )
#line 10962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_JUMPALLOWED ;
#line 10967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_fImmersionFactor  >= 0.99f || bUpSwimable )
#line 10968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pstWanted  = PST_DIVE ;
#line 10972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pstWanted  = PST_SWIM ;
#line 10977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 10983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_penReference  != NULL )
#line 10984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fFallTime  = 0.0f;
#line 10987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 10991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 10994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fFallTime  += _pTimer  -> TickQuantum ;
#line 10995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 10997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vTranslation  (2) < 0.1f)
#line 10998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_JUMPALLOWED ;
#line 11001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fFallTime  >= 0.5f){
#line 11006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pstWanted  = PST_FALL ;
#line 11007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pstWanted  = PST_STAND ;
#line 11013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerState  pstOld  = m_pstState ;
#line 11019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pstWanted  != m_pstState )
#line 11020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(pstWanted )
#line 11023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case PST_STAND : 
#line 11026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_STAND ))
#line 11029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 11031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Stand  ();
#line 11032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 11033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case PST_SWIM : 
#line 11039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case PST_DIVE : 
#line 11045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case PST_FALL : 
#line 11052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_STAND ))
#line 11055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pstState  = PST_FALL ;
#line 11057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 11058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Fall  ();
#line 11059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> m_bTcpIp )
#line 11067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bChanging  && ISTRANSFORMATION  (_pNetwork  -> MyCharacterInfo  . eMorphStatus ))
#line 11069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MinMaximize  ();
#line 11071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bTransforming  && ISEVOCATION  (_pNetwork  -> MyCharacterInfo  . eMorphStatus ))
#line 11074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Transforming  ();
#line 11076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bStuned  || CheckAction  ())
#line 11078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWaitForSkillResponse  && (_pTimer  -> CurrentTick  () - m_tmSendSkillMessage  > 5000.0f))
#line 11084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 11086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2083 , "잘못된 조작으로 스킬을 취소합니다."));
#line 11087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 11090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 11091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 11092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 11093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILL );
#line 11094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 11095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! CheckSkill  ())
#line 11099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CheckTarget  ())
#line 11101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulFlags  = SetDesiredMovement  ();
#line 11103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 11111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetMyPosition  (GetPlacement  () , m_fCameraAngle );
#line 11116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling )
#line 11117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 11119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 11120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide  == TRUE  && pInfo  -> GetMyApetInfo  () != NULL )
#line 11124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () -> m_nFaith  <= 0 || pInfo  -> GetMyApetInfo  () -> m_nStm  <= 0)
#line 11126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 11128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 11129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsSealPet  (NULL ) == true )
#line 11133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 11135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 11136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((m_bForward  || m_bKeyMove ) && ! m_bHold  && ! m_bStuned ) || (m_bKeyMove  && _pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 11141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 11145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDesirePosition  = m_vDesiredPosition ;
#line 11146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vOriginPosition  = GetPlacement  () . pl_PositionVector ;
#line 11147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDesirePosition  (2) = 0.0f;
#line 11148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vOriginPosition  (2) = 0.0f;
#line 11149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fHeight  = fabs  (m_vDesiredPosition  (2) - GetPlacement  () . pl_PositionVector  (2));
#line 11150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDistance  = (vOriginPosition  - vDesirePosition ) . Length  ();
#line 11151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fAngle  = ATan2  (fHeight  , fDistance );
#line 11154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fAngle  > MAX_MOVE_SLOPE_GRADE )
#line 11155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTranslation  = FLOAT3D (0.0f , 0.0f , 0.0f);
#line 11158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopTranslating  ();
#line 11159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDeltatmp  = vDelta ;
#line 11164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fLength  = plr_fSpeed ;
#line 11166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDeltatmp  . Normalize  ();
#line 11168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTranslation  = (vDeltatmp  * fLength );
#line 11203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (vTranslation );
#line 11210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . Rotate_HPB  (ANGLE3D (
#line 11211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (1) * _pTimer  -> TickQuantum ) , 
#line 11212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (2) * _pTimer  -> TickQuantum ) , 
#line 11213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (3) * _pTimer  -> TickQuantum )));
#line 11215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> inp_bFreeMode )
#line 11216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_FreePosition  = m_pen3rdPersonView  -> GetPlacement  ();
#line 11218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_FreePosition  . Rotate_HPB  (ANGLE3D (
#line 11219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (1) * _pTimer  -> TickQuantum ) , 
#line 11220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (2) * _pTimer  -> TickQuantum ) , 
#line 11221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (3) * _pTimer  -> TickQuantum )));
#line 11222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fCameraAngle  = en_plViewpoint  . pl_OrientationAngle  (1) * 2;
#line 11227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (2) , PITCH_MAX );
#line 11228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (3) , BANKING_MAX );
#line 11231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fWantSpeed  = en_vDesiredTranslationRelative  . Length  ();
#line 11232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fGoesSpeed  = en_vCurrentTranslationAbsolute  . Length  ();
#line 11233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bOnGround  = (m_pstState  == PST_STAND );
#line 11234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRunning  = bOnGround  && fWantSpeed  > 4.0f && fGoesSpeed  > 4.0f;
#line 11235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bWalking  = bOnGround  && ! bRunning  && fWantSpeed  > 1.5f && fGoesSpeed  > 1.5f;
#line 11236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSwimming  = (m_pstState  == PST_SWIM ) && fWantSpeed  > 2.0f && fGoesSpeed  > 2.0f;
#line 11237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bDiving  = (m_pstState  == PST_DIVE ) && fWantSpeed  > 2.0f && fGoesSpeed  > 2.0f;
#line 11238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmNow  = en_tmEntityTime ;
#line 11239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX iSoundWalkL  = SOUND_WALK_MARBLE_IN_L ;
#line 11240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX iSoundWalkR  = SOUND_WALK_MARBLE_IN_R ;
#line 11242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((ctDn  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  >= 0.1f)
#line 11243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_DEFAULT ;
#line 11245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_DEFAULT ;
#line 11246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(en_pbpoStandOn  != NULL )
#line 11248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pbpoStandOn  -> bpo_ubPolygonAttribute  > BPOA_NONE )
#line 11250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbyLayer  = ((en_pbpoStandOn  -> bpo_ubPolygonAttribute  - 1) % 10) << 1;
#line 11252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pbpoStandOn  -> bpo_ubPolygonAttribute  >= BPOA_STAIR1F2F  && en_pbpoStandOn  -> bpo_ubPolygonAttribute  <= BPOA_STAIRWALL4F5F )
#line 11253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbyLayer  += 1;
#line 11255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_PEACE ))
#line 11258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . yLayer  = sbyLayer ;
#line 11260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 11267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iTransformType  == CTransformInfo  :: TYPE_1 )
#line 11269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_HELL_WALK ;
#line 11271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_HELL_RUN ;
#line 11272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iTransformType  == CTransformInfo  :: TYPE_2 )
#line 11274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_ELENEN_WALK ;
#line 11276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_ELENEN_RUN ;
#line 11277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bRide )
#line 11280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 11283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = - 1;
#line 11285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_HORSE_RUN ;
#line 11286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = - 1;
#line 11290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = - 1;
#line 11291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType )
#line 11296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case LC_SURFACE_MARBLE_IN : 
#line 11298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_MARBLE_IN_L ;
#line 11300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_MARBLE_IN_R ;
#line 11303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case LC_SURFACE_BLOCK_OUT : 
#line 11307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_BLOCK_OUT_L ;
#line 11309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_BLOCK_OUT_R ;
#line 11312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case LC_SURFACE_WOOD_OUT : 
#line 11316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_WOOD_OUT_L ;
#line 11318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_WOOD_OUT_R ;
#line 11321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case LC_SURFACE_WATER_SHALLOW_IN : 
#line 11325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WATER_WALK_SHALLOW_L ;
#line 11327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WATER_WALK_SHALLOW_R ;
#line 11328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  :
#line 11332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_MARBLE_IN_L ;
#line 11334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_MARBLE_IN_R ;
#line 11337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fX  = _pNetwork  -> MyCharacterInfo  . x ;
#line 11346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fZ  = _pNetwork  -> MyCharacterInfo  . z ;
#line 11347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iTerSound  = TR_GetTerrainLayerSound  (fX  , fZ );
#line 11349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iTerSound  >= 0)
#line 11350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 11358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iTransformType  == CTransformInfo  :: TYPE_1 )
#line 11360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_HELL_WALK ;
#line 11362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_HELL_RUN ;
#line 11363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iTransformType  == CTransformInfo  :: TYPE_2 )
#line 11365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_ELENEN_WALK ;
#line 11367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_ELENEN_RUN ;
#line 11368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bRide )
#line 11371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 11374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = - 1;
#line 11376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_HORSE_RUN ;
#line 11377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = - 1;
#line 11381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = - 1;
#line 11382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fWaterDiff  = _pNetwork  -> MyCharacterInfo  . fWaterHeight  - en_plPlacement  . pl_PositionVector  (2);
#line 11387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fWaterDiff  > 0.01f)
#line 11388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WATER_WALK_SHALLOW_L ;
#line 11399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WATER_WALK_SHALLOW_R ;
#line 11400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iTerSound  <<= 1;
#line 11404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_TER_WALK_DIRT_L  + iTerSound ;
#line 11405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_TER_WALK_DIRT_R  + iTerSound ;
#line 11408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 11415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(bRunning )
#line 11419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fRunSoundDelay )
#line 11421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 11423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 11424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMoveSoundLeft  && iSoundWalkL  != - 1)
#line 11425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , iSoundWalkL  , SOF_3D  | SOF_VOLUMETRIC );
#line 11427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iSoundWalkR  != - 1)
#line 11429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , iSoundWalkR  , SOF_3D  | SOF_VOLUMETRIC );
#line 11431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(bWalking )
#line 11435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fWalkSoundDelay )
#line 11437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 11439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 11440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMoveSoundLeft  && iSoundWalkL  != - 1)
#line 11441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , iSoundWalkL  , SOF_3D  | SOF_VOLUMETRIC );
#line 11443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iSoundWalkR  != - 1)
#line 11445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , iSoundWalkR  , SOF_3D  | SOF_VOLUMETRIC );
#line 11447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(bDiving )
#line 11451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fDiveSoundDelay )
#line 11453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 11455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 11456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMoveSoundLeft )
#line 11457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(bSwimming )
#line 11467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fSwimSoundDelay )
#line 11469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 11471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 11472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMoveSoundLeft )
#line 11473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmBreathDelay  = tmNow  - en_tmLastBreathed ;
#line 11485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_tmMaxHoldBreath  - tmBreathDelay  < 20.0f)
#line 11486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_tmMouthSoundLast  + 2.0f < tmNow )
#line 11489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmMouthSoundLast  = tmNow ;
#line 11491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 11493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1 && m_bSkilling )
#line 11500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillAnimationEx  () && ! HardCodingSkill  (FALSE ))
#line 11503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillAnimation  ();
#line 11505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 11508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimatePlayer  ();
#line 11511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 11515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::SkillCondition(INDEX skillIndex,CEntityPointer penTarget,BOOL & bLostTarget,BOOL & bAutoAttack) 
#line 11516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (skillIndex );
#line 11518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bLostTarget  = TRUE ;
#line 11519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAutoAttack  = FALSE ;
#line 11520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(m_nCurrentSkillNum )
#line 11521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 128: 
#line 11523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bConfused  = TRUE ;
#line 11526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> IsEnemy  ())
#line 11527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , penTarget  -> GetNetworkID  ());
#line 11530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 11531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pMT  = static_cast  < CMobTarget  * > (pObject );
#line 11533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMT  -> mob_statusEffect  . IsConfuse  () == FALSE )
#line 11534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bConfused  = FALSE ;
#line 11536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsCharacter  ())
#line 11540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , penTarget  -> GetNetworkID  ());
#line 11543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 11544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 11547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_statusEffect  . IsConfuse  () == FALSE )
#line 11548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bConfused  = FALSE ;
#line 11550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsSlave  ())
#line 11554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_SLAVE  , penTarget  -> GetNetworkID  ());
#line 11557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 11558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSlaveTarget  * pTarget  = static_cast  < CSlaveTarget  * > (pObject );
#line 11561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> slave_statusEffect  . IsConfuse  () == FALSE )
#line 11562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bConfused  = FALSE ;
#line 11564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bConfused )
#line 11569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMsg ;
#line 11571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMsg  . PrintF  (_S  (1447 , "%s 스킬을 쓰려면 목표가 혼란상태여야 합니다.") , skill  . GetName  ());
#line 11572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strMsg  , SYSMSG_ERROR );
#line 11573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bLostTarget  = FALSE ;
#line 11574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAutoAttack  = FALSE ;
#line 11575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 11576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE ;
#line 11580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 152: 
#line 11581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 153: 
#line 11582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 228: 
#line 11583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fHP_PERCENT  = 0.70f;
#line 11585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . maxHP  * fHP_PERCENT  < _pNetwork  -> MyCharacterInfo  . hp )
#line 11586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMsg ;
#line 11588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMsg  . PrintF  (_S  (2084 , "%s 스킬을 쓰려면 현재 hp가 최대 hp의 %.0f 퍼센트 이하여야 합니다.") , skill  . GetName  () , (fHP_PERCENT  * 100));
#line 11589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strMsg  , SYSMSG_ERROR );
#line 11590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 11591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE ;
#line 11593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 11597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::SkillAnimationEx(void) 
#line 11598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 11603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 11604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 11605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bEndSkill_Act  = FALSE ;
#line 11607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT skillSpeed  = (100 - _pNetwork  -> MyCharacterInfo  . skillSpeed ) / 100.0f;
#line 11609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetJob  () == NIGHTSHADOW )
#line 11610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . IsNeedTarget  ())
#line 11612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  != NULL  && (m_penStillTarget  -> IsEnemy  () || m_penStillTarget  -> IsPet  () || m_penStillTarget  -> IsSlave  () || m_penStillTarget  -> IsCharacter  ()))
#line 11614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - m_penStillTarget  -> GetPlacement  () . pl_PositionVector ;
#line 11616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 11617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 360.0f , TRUE );
#line 11618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  && skill  . IsNeedTarget  ())
#line 11622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  == NULL  || m_penStillTarget  -> en_RenderType  != RT_SKAMODEL  || ! (m_penStillTarget  -> GetFlags  () & ENF_ALIVE ))
#line 11624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(m_nCurrentSkillNum )
#line 11632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 661: 
#line 11634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  == NULL  || ! m_penStillTarget  -> IsEnemy  ())
#line 11636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bEndSkill_Act )
#line 11641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 11643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetReadyAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  = StartEffectGroup  (skill  . GetReadyEffect  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetStillAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pSkillReadyEffect  , 0.1f);
#line 11669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pAttachPlayerEffect  = StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 11673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pAttachEnemyEffect  = StartEffectGroup  (skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& m_penStillTarget  -> GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillTexture  . SetData_t  (CTFILENAME  ("Data\\Models\\Weapons\\GhostBuster\\Projectile\\Pink_Ray.tex"));
#line 11679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = TRUE ;
#line 11684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 2)
#line 11691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > skill  . GetDestDelay  (_pNetwork  -> MyCharacterInfo  . bExtension ))
#line 11693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 11695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , m_penStillTarget  , m_penStillTarget  -> GetNetworkID  () , TRUE );
#line 11697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachPlayerEffect  , 0.1f);
#line 11699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachEnemyEffect  , 0.1f);
#line 11701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = FALSE ;
#line 11705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 664: 
#line 11714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 11716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , m_penStillTarget  , m_penStillTarget  -> GetNetworkID  () , TRUE );
#line 11735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 11736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "HEAD" , m_penStillTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
false  , 0.0f , 0.0f , 2);
#line 11740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 666: case 667: case 668: case 669: 
#line 11752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 11754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_penStillTarget  -> IsEnemy  ())
#line 11756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 11775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ENTITIES_ITERATOR  Itr ;
#line 11778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(Itr  = m_dcEnemies  . vectorSelectedEntities  . begin  ();Itr  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ Itr )
#line 11779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & tmpEntity  = * (* Itr );
#line 11782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpEntity  . en_RenderType  == RT_SKAMODEL  && tmpEntity  . GetFlags  () & ENF_ALIVE )
#line 11783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& tmpEntity  . GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 11795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 676: 
#line 11805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 11825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ENTITIES_ITERATOR  Itr ;
#line 11828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(Itr  = m_dcEnemies  . vectorSelectedEntities  . begin  ();Itr  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ Itr )
#line 11829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & tmpEntity  = * (* Itr );
#line 11832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpEntity  . en_RenderType  == RT_SKAMODEL  && tmpEntity  . GetFlags  () & ENF_ALIVE )
#line 11833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& tmpEntity  . GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , FLOAT3D (0 , 0 , 0) , TRUE );
#line 11841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 11842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 677: 
#line 11851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 11853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , m_penStillTarget  , m_penStillTarget  -> GetNetworkID  () , TRUE );
#line 11870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 11871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "LHAND" , m_penStillTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
false  , 0.0f , 0.0f , 2);
#line 11875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 764: case 765: case 766: 
#line 11887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , this  , _pNetwork  -> MyCharacterInfo  . index  , TRUE );
#line 11905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 681: 
#line 11914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 11916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 11921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , m_penStillTarget  , m_penStillTarget  -> GetNetworkID  () , TRUE );
#line 11922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 11923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 11924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 11926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 11931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 11933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 11935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 11937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& m_penStillTarget  -> GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 11938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 11941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 11945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 11948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 11992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 684: 
#line 11993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 11995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 11997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 11998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 11999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 12003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 12010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 12012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& m_penStillTarget  -> GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 12018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , FLOAT3D (0 , 0 , 0) , TRUE );
#line 12020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 12024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 12026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 685: 
#line 12035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 12037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 12041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 12045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillTexture  . SetData_t  (CTFILENAME  ("Data\\Models\\Weapons\\GhostBuster\\Projectile\\Green_Ray.tex"));
#line 12048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = TRUE ;
#line 12049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 12054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 12058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& m_penStillTarget  -> GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 2)
#line 12068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > skill  . GetDestDelay  (_pNetwork  -> MyCharacterInfo  . bExtension ))
#line 12070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 12073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 12074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , FLOAT3D (0 , 0 , 0) , TRUE );
#line 12076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 12079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = FALSE ;
#line 12080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penStillTarget  = NULL ;
#line 12081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 686: 
#line 12090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 683: 
#line 12091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 673: 
#line 12092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 1353: 
#line 12093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 12095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 12099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 12103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 12110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 12114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "LHAND" , m_penStillTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
false  , 0.0f , 0.0f , 2 , NULL  , & m_dcEnemies );
#line 12118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 12122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 12123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 687: 
#line 12132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget )
#line 12134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 12138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 12142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 12149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 12153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& m_penStillTarget  -> GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , m_penStillTarget  , m_penStillTarget  -> GetNetworkID  () , TRUE );
#line 12159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 12160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 670: case 671: case 672: 
#line 12169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 12173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 12177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 12184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 12188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ENTITIES_ITERATOR  Itr ;
#line 12191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(Itr  = m_dcEnemies  . vectorSelectedEntities  . begin  ();Itr  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ Itr )
#line 12192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & tmpEntity  = * (* Itr );
#line 12195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpEntity  . en_RenderType  == RT_SKAMODEL  && tmpEntity  . GetFlags  () & ENF_ALIVE )
#line 12196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& tmpEntity  . GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& tmpEntity  . GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 12210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bEndSkill_Act  = TRUE ;
#line 12211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bEndSkill_Act )
#line 12221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = TRUE ;
#line 12224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = FALSE ;
#line 12225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartPostSkill  = TRUE ;
#line 12226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 12228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 12230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = - 1;
#line 12231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = 0.0f;
#line 12232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = FALSE ;
#line 12233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 12234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 12236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 12237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 12239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = TRUE ;
#line 12241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 12242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 12244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nReservedSkillNum  != - 1)
#line 12245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nReservedSkillNum ;
#line 12247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 12248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! g_iAutoAttack )
#line 12250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 12252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 12254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penStillTarget  = NULL ;
#line 12256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_HIDDEN );
#line 12257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopRotating  ();
#line 12259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILL );
#line 12260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 12261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = FALSE ;
#line 12262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillTexture  . SetData  (NULL );
#line 12263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachPlayerEffect  , 0.1f);
#line 12264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachEnemyEffect  , 0.1f);
#line 12265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 12270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 12272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::HardCodingSkill(BOOL bOnlyTest) 
#line 12273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 12276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != 128 
#line 12277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_nCurrentSkillNum  != 155 
#line 12278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_nCurrentSkillNum  != 191 
#line 12279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_nCurrentSkillNum  != 1540 
#line 12280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_nCurrentSkillNum  != 661 
#line 12281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (m_nCurrentSkillNum  >= 670 && m_nCurrentSkillNum  <= 672)
#line 12283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 12284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 12286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bOnlyTest ){return TRUE ;}
#line 12289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 12290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bIdleAnim  = TRUE ;
#line 12291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 12292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 12294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_afHardCodeValue  . Count  () == 0){m_afHardCodeValue  . New  (32);}
#line 12296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(m_nCurrentSkillNum )
#line 12297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 128: 
#line 12299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fFirstAttackTime  = 0.25f;
#line 12302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX iFireAnimID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT fAttackTimeOnce  = GetModelInstance  () -> GetAnimLength  (iFireAnimID );
#line 12304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT fDistFromCB  = 1.0f;
#line 12305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT fDamageTime  = 999.0f;
#line 12306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  == NULL ){break ;}
#line 12308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D pl  = GetPlacement  ();
#line 12314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 11 ] = pl  . pl_OrientationAngle  (1);
#line 12315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 12 ] = pl  . pl_OrientationAngle  (2);
#line 12316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 13 ] = pl  . pl_OrientationAngle  (3);
#line 12317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 14 ] = pl  . pl_PositionVector  (1);
#line 12318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 15 ] = pl  . pl_PositionVector  (2);
#line 12319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 16 ] = pl  . pl_PositionVector  (3);
#line 12320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (NULL  , 1);
#line 12321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (NULL  , CStatusEffect  :: R_NONE );
#line 12322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOn  (ENF_HIDDEN );
#line 12323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDir  = penTarget  -> GetPlacement  () . pl_PositionVector  - GetPlacement  () . pl_PositionVector ;
#line 12324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 9 ] = vDir  . Length  () / fFirstAttackTime ;
#line 12325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lTargetIndex  = - 1;
#line 12331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
lTargetIndex  = penTarget  -> GetNetworkID  ();
#line 12332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , penTarget  
#line 12333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, lTargetIndex  , TRUE );
#line 12334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime ) < fFirstAttackTime )
#line 12340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT delta  = _pTimer  -> GetLerpedCurrentTick  () - m_afHardCodeValue  [ 1 ];
#line 12342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDir  = penTarget  -> GetPlacement  () . pl_PositionVector  
#line 12344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
- GetPlacement  () . pl_PositionVector ;
#line 12345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDir  . SafeNormalize  ();
#line 12346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew  = GetPlacement  ();
#line 12347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  += vDir  * m_afHardCodeValue  [ 9 ] * delta ;
#line 12348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 12354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTarget  -> GetModelInstance  () -> GetCurrentColisionBox  (aabb );
#line 12355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D size  = aabb  . Size  ();
#line 12356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 0 ] = sqrtf  (size  (1) * size  (1) + size  (3) * size  (3)) * 0.5f;
#line 12358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_HIDDEN );
#line 12359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& GetModelInstance  () -> m_tmSkaTagManager  , 1);
#line 12360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& GetModelInstance  () -> m_tmSkaTagManager  , CStatusEffect  :: R_PARTY );
#line 12362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRadius  = m_afHardCodeValue  [ 0 ] + fDistFromCB ;
#line 12364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaPos  (fRadius  * (0.5f * 1.7320f) , 0 , fRadius  * 0.5f);
#line 12365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaPos ;
#line 12367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (0);
#line 12370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (iFireAnimID  , AN_NORESTART  , 1 , 0 , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 12372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bExtension )
#line 12373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAIR_STRIKE_BLOW1 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_A_DAIR_STRIKE_BLOW1 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 2 ] = 2 * (m_afHardCodeValue  [ 0 ] + fDistFromCB ) / fAttackTimeOnce ;
#line 12386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = skill  . GetDelay  (0 , _pNetwork  -> MyCharacterInfo  . bExtension );
#line 12387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 2)
#line 12390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT delta  = _pTimer  -> GetLerpedCurrentTick  () - m_afHardCodeValue  [ 1 ];
#line 12393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaDist  = m_afHardCodeValue  [ 2 ] * delta ;
#line 12395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaDir  = (penTarget  -> GetPlacement  () . pl_PositionVector  - GetPlacement  () . pl_PositionVector ) . SafeNormalize  ();
#line 12397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = GetPlacement  () . pl_PositionVector  + deltaDir  * deltaDist ;
#line 12399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + fDamageTime )
#line 12402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPoint  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaDir  * (- m_afHardCodeValue  [ 0 ]);
#line 12405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Normal Hit" , _pTimer  -> GetLerpedCurrentTick  () , vHitPoint  , deltaDir );
#line 12406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = 999.0f;
#line 12407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + fAttackTimeOnce )
#line 12409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = skill  . GetDelay  (0 , _pNetwork  -> MyCharacterInfo  . bExtension );
#line 12411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 3)
#line 12417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRadius  = m_afHardCodeValue  [ 0 ] + fDistFromCB ;
#line 12422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaPos  (- fRadius  * (0.5f * 1.7320f) , 0 , fRadius  * 0.5f);
#line 12423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaPos ;
#line 12425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (0);
#line 12428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (iFireAnimID  , AN_NORESTART  , 1 , 0 , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 12430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bExtension )
#line 12431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAIR_STRIKE_BLOW2 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_A_DAIR_STRIKE_BLOW2 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 4)
#line 12446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT delta  = _pTimer  -> GetLerpedCurrentTick  () - m_afHardCodeValue  [ 1 ];
#line 12449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaDist  = m_afHardCodeValue  [ 2 ] * delta ;
#line 12451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaDir  = (penTarget  -> GetPlacement  () . pl_PositionVector  - GetPlacement  () . pl_PositionVector ) . SafeNormalize  ();
#line 12453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = GetPlacement  () . pl_PositionVector  + deltaDir  * deltaDist ;
#line 12455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + fDamageTime )
#line 12458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPoint  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaDir  * (- m_afHardCodeValue  [ 0 ]);
#line 12461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Normal Hit" , _pTimer  -> GetLerpedCurrentTick  () , vHitPoint  , deltaDir );
#line 12462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = 999.0f;
#line 12463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + 2 * fAttackTimeOnce )
#line 12465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = skill  . GetDelay  (0 , _pNetwork  -> MyCharacterInfo  . bExtension );
#line 12467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 5)
#line 12473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRadius  = m_afHardCodeValue  [ 0 ] + fDistFromCB ;
#line 12478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaPos  (0 , 0 , - fRadius  * 0.5f);
#line 12479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaPos ;
#line 12481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (0);
#line 12484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (iFireAnimID  , AN_NORESTART  , 1 , 0 , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 12486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bExtension )
#line 12487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAIR_STRIKE_BLOW3 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_A_DAIR_STRIKE_BLOW3 ) , SOF_3D  | SOF_VOLUMETRIC );
#line 12493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 6)
#line 12502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT delta  = _pTimer  -> GetLerpedCurrentTick  () - m_afHardCodeValue  [ 1 ];
#line 12505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_afHardCodeValue  [ 1 ] = _pTimer  -> GetLerpedCurrentTick  ();
#line 12506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaDist  = m_afHardCodeValue  [ 2 ] * delta ;
#line 12507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D deltaDir  = (penTarget  -> GetPlacement  () . pl_PositionVector  - GetPlacement  () . pl_PositionVector ) . SafeNormalize  ();
#line 12509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  = GetPlacement  () . pl_PositionVector  + deltaDir  * deltaDist ;
#line 12511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + fDamageTime )
#line 12514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPoint  = penTarget  -> GetPlacement  () . pl_PositionVector  + deltaDir  * (- m_afHardCodeValue  [ 0 ]);
#line 12517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Normal Hit" , _pTimer  -> GetLerpedCurrentTick  () , vHitPoint  , deltaDir );
#line 12518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = 999.0f;
#line 12519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  > fFirstAttackTime  + 3 * fAttackTimeOnce )
#line 12521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = skill  . GetDelay  (0 , _pNetwork  -> MyCharacterInfo  . bExtension );
#line 12523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 7)
#line 12529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InflictDirectDamage  (penTarget  , this  , DMT_NONE  , 0 , FLOAT3D (0 , 0 , 0) , FLOAT3D (0 , 0 , 0));
#line 12531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew ;
#line 12532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_OrientationAngle  (1) = m_afHardCodeValue  [ 11 ];
#line 12533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_OrientationAngle  (2) = m_afHardCodeValue  [ 12 ];
#line 12534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_OrientationAngle  (3) = m_afHardCodeValue  [ 13 ];
#line 12535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  (1) = m_afHardCodeValue  [ 14 ];
#line 12536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  (2) = m_afHardCodeValue  [ 15 ];
#line 12537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  (3) = m_afHardCodeValue  [ 16 ];
#line 12538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlacement  (plNew );
#line 12539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 12540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & penTarget  -> GetModelInstance  () -> m_tmSkaTagManager  
#line 12541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 12542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageTime  = 999.0f;
#line 12543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}break ;
#line 12545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 155: 
#line 12546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) , 
#line 12548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
& GetModelInstance  () -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 12549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , this  , _pNetwork  -> MyCharacterInfo  . index  , TRUE );
#line 12550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}break ;
#line 12551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 191: 
#line 12552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 1540: 
#line 12553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX animID  = ska_StringToID  (skill  . GetFireAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 12555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT animTime  = GetModelInstance  () -> GetAnimLength  (animID );
#line 12556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 12557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> GetLerpedCurrentTick  ();
#line 12560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , this  , _pNetwork  -> MyCharacterInfo  . index  , TRUE );
#line 12561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (animID  , AN_NORESTART  | AN_CLEAR  , 1.0f , 0 , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 12562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 1)
#line 12565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime  <= animTime )
#line 12567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bIdleAnim  = FALSE ;
#line 12572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 12573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}break ;
#line 12575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  :
#line 12576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 12578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 12580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = TRUE ;
#line 12584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = FALSE ;
#line 12585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartPostSkill  = TRUE ;
#line 12586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 12588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 12590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = - 1;
#line 12591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = 0.0f;
#line 12592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = FALSE ;
#line 12593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 12594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 12596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 12598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = TRUE ;
#line 12600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bIdleAnim )
#line 12601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 12603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 12604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nReservedSkillNum  != - 1)
#line 12607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nReservedSkillNum ;
#line 12609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 12610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! g_iAutoAttack )
#line 12615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 12617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 12621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_HIDDEN );
#line 12622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopRotating  ();
#line 12624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILL );
#line 12626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 12627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 12630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RoundViewAngle(ANGLE & aViewAngle,ANGLE aRound) 
#line 12631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aViewAngle  > aRound )
#line 12633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aViewAngle  = aRound ;
#line 12635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aViewAngle  < - aRound )
#line 12637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aViewAngle  = - aRound ;
#line 12639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 12643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::DeathActions(const CPlayerAction & paAction) 
#line 12644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsReapplyingActions  ()){return ;}
#line 12647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0 , 0 , 0));
#line 12661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . Rotate_HPB  (ANGLE3D (
#line 12662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (1) * _pTimer  -> TickQuantum ) , 
#line 12663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (2) * _pTimer  -> TickQuantum ) , 
#line 12664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (3) * _pTimer  -> TickQuantum )));
#line 12667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fCameraAngle  = en_plViewpoint  . pl_OrientationAngle  (1) * 2;
#line 12670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (2) , PITCH_MAX );
#line 12671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (3) , BANKING_MAX );
#line 12673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulReleasedButtons  & PLACT_FIRE )
#line 12674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 12686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  == NULL ){
#line 12687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_VIEW  , WLD_AUTO_ENTITY_ID  , FALSE );
#line 12688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EViewInit  eInit ;
#line 12689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidOwner  = this ;
#line 12690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidCamera  = (CEntity  *) NULL ;
#line 12691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . vtView  = VT_3RDPERSONVIEW ;
#line 12692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . bDeathFixed  = FALSE ;
#line 12693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Initialize  (eInit  , FALSE );
#line 12694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = PVT_3RDPERSONVIEW ;
#line 12699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 12704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ButtonsActions(CPlayerAction & paAction) 
#line 12705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 12709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_checkLock  == 1){
#line 12710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> GetHighPrecisionTimer  () . GetSeconds  () - m_timeCnt ) > 3){
#line 12711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 12712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_checkLock  = 0;
#line 12713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_timeCnt  = 0;
#line 12714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsReapplyingActions  ())
#line 12720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 12722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bDying  && ! m_bDeathChk )
#line 12727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeathYou  ();
#line 12729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_ARROWLEFT  ] . ic_fValue  == 1.0f 
#line 12732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_NUM4  ] . ic_fValue  == 1.0f)
#line 12733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) += 3;
#line 12735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_ARROWRIGHT  ] . ic_fValue  == 1.0f 
#line 12737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_NUM6  ] . ic_fValue  == 1.0f)
#line 12738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) -= 3;
#line 12740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_ARROWUP  ] . ic_fValue  == 1.0f 
#line 12742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_NUM8  ] . ic_fValue  == 1.0f)
#line 12743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (2) -= 3;
#line 12745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_ARROWDOWN  ] . ic_fValue  == 1.0f 
#line 12747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_NUM2  ] . ic_fValue  == 1.0f)
#line 12748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (2) += 3;
#line 12750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_SPACE  ] . ic_fValue  == 1.0f && 
#line 12753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> m_ubGMLevel  > 1 && 
#line 12754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! pUIManager  -> IsFocusAllEditBox  ())
#line 12755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_LSHIFT  ] . ic_fValue  == 1.0f)
#line 12757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_fCameraHeight  -= 1.0f;
#line 12759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_fCameraHeight  += 1.0f;
#line 12763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmpDist  = ((CPlayerView  &) * m_pen3rdPersonView ) . m_fCameraHeight ;
#line 12766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . m_fCameraHeight  = Clamp  (tmpDist  , 0.0f , 10.0f);
#line 12767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_plViewpoint  . pl_OrientationAngle  (2) >= 20.0f)
#line 12770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (2) = 20.0f;
#line 12772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> IsLMousePressed  ())
#line 12775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulNewButtons  |= PLACT_FIRE ;
#line 12778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pInput  -> SetLMousePressed  (FALSE );
#line 12779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsFocusInAllEditbox  () || IsSitting  () || IsSocialActing  () || 
#line 12787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> IsCSFlagOn  (CSF_TELEPORT ) || pUIManager  -> GetLacaBall  () -> IsVisible  () || 
#line 12788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetReformSystem  () -> IsVisible  () || _pNetwork  -> bMoveCharacterSelectUI  == TRUE )
#line 12789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 12791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InputKey  (0);
#line 12795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_ESCAPE  ] . ic_fValue )
#line 12798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  test  = 0;
#line 12800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL _bFlip  = FALSE ;
#line 12804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> IsWheelPressed  ())
#line 12805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bFlip )
#line 12807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = GetPlacement  () . pl_OrientationAngle  (1) / 2;
#line 12810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = GetPlacement  () . pl_OrientationAngle  (1) / 2 + 90;
#line 12815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bFlip  = ! _bFlip ;
#line 12818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pInput  -> SetWheelPressed  (FALSE );
#line 12819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> IsHomePressed  ())
#line 12823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = 0.0f;
#line 12825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pInput  -> SetHomePressed  (FALSE );
#line 12826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bInTestGame )
#line 12836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRunningMode )
#line 12838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fSpeed  = GetRunspeed  ();
#line 12841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fSpeed  = GetWalkspeed  ();
#line 12846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSpeedUp )
#line 12851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousSpeed  = 1000.0f;
#line 12853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousSpeed  = 0.0f;
#line 12857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bInTestGame  && 
#line 12860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_bChanging  || 
#line 12861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  || 
#line 12862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStuned  || 
#line 12863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! m_apr  || 
#line 12864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  || 
#line 12865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . hp  == 0
#line 12867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
))
#line 12868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 12870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bLockMove  && (ulNewButtons  & PLACT_FIRE  || m_bReserveMove  || _pInput  -> IsRMousePressed  () 
#line 12879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| (GetPlayerWeapons  () -> m_penRayHitTmp  == NULL  && m_bKeyMove )
#line 12880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
) && ! _pInput  -> inp_bFreeMode )
#line 12881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_CANNOT_MOVE_MASK ))
#line 12883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 12885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  *) & * m_penView ) -> UnlockRotate  ();
#line 12888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bReserveMove )
#line 12889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plRay ;
#line 12896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plRay  = GetPlayerWeapons  () -> GetMouseHitInformation  (_pInput  -> inp_ptMousePos  , m_apr  , tmStartTime  , TRUE );
#line 12897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ))
#line 12901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 12904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_vRayHitTmp  = GetPlayerWeapons  () -> m_vRayHitReserve ;
#line 12906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = GetPlayerWeapons  () -> m_penRayHitReserve ;
#line 12907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_fRayHitDistanceTmp  = GetPlayerWeapons  () -> m_fRayHitDistanceReserve ;
#line 12909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = FLOAT3D (GetPlayerWeapons  () -> m_vRayHitTmp  (1) , GetPlayerWeapons  () -> m_vRayHitTmp  (2) , GetPlayerWeapons  () -> m_vRayHitTmp  (3));
#line 12910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEnt  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 12911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEnt  != NULL  && penEnt  -> GetFlags  () & ENF_ALIVE )
#line 12912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = penEnt  -> en_plPlacement  . pl_PositionVector ;
#line 12914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlayerWeapons  () -> m_vRayHitTmp ;
#line 12918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 12922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp )
#line 12923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  -> GetFlags  () & ENF_ALIVE  || 
#line 12925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  -> GetFlags  () & ENF_ITEM )
#line 12926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 12928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 12934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 12935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> GetFlags  () & ENF_ALIVE  || penTarget  -> IsCharacter  ())
#line 12937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT MaxHealth ;
#line 12939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CurrentHealth ;
#line 12940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  Level ;
#line 12941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  mobIdx ;
#line 12942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkMode  = - 1;
#line 12943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkState ;
#line 12944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkLegit ;
#line 12945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSyndicateType  = 0;
#line 12946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSyndicateGrade  = 0;
#line 12947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bRet  = false ;
#line 12949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MaxHealth  = ((CUnit  *) ((CEntity  *) penTarget )) -> m_nMaxiHealth ;
#line 12950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CurrentHealth  = ((CUnit  *) ((CEntity  *) penTarget )) -> m_nCurrentHealth ;
#line 12951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  = ((CUnit  *) ((CEntity  *) penTarget )) -> m_nMobLevel ;
#line 12952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mobIdx  = ((CUnit  *) ((CEntity  *) penTarget )) -> m_nMobDBIndex ;
#line 12953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> en_pMobTarget  != NULL )
#line 12954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateType  = penTarget  -> en_pMobTarget  -> mob_iSyndicateType ;
#line 12956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateGrade  = penTarget  -> en_pMobTarget  -> mob_iSyndicateGrade ;
#line 12957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> IsCharacter  ())
#line 12960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  = 0;
#line 12962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkMode  = ((CCharacter  *) ((CEntity  *) penTarget )) -> m_nPkMode ;
#line 12963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkState  = ((CCharacter  *) ((CEntity  *) penTarget )) -> m_nPkState ;
#line 12964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkLegit  = ((CCharacter  *) ((CEntity  *) penTarget )) -> m_nLegit ;
#line 12966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> en_pCharacterTarget  != NULL )
#line 12967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateType  = penTarget  -> en_pCharacterTarget  -> cha_iSyndicateType ;
#line 12969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateGrade  = penTarget  -> en_pCharacterTarget  -> cha_iSyndicateGrade ;
#line 12970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(PkMode  != - 1)
#line 12974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRet  = penTarget  -> SetTargetInfo  (MaxHealth  , CurrentHealth  , FALSE  , Level  , PkMode  , PkState  , PkLegit );
#line 12976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRet  = penTarget  -> SetTargetInfo  (MaxHealth  , CurrentHealth  , FALSE  , Level  , 0 , 0 , 0 , mobIdx );
#line 12981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRet  == true )
#line 12984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTarget  -> SetTargetSyndicateInfo  (nSyndicateType  , nSyndicateGrade );
#line 12986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 12989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 12991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CEffectGroupManager  :: Instance  () . IsValidCreated  (m_pPickingEffectGroup ))
#line 12996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 12997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  -> Stop  (PICKING_EFFECT_REMAIN_TIME );
#line 12998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 12999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  = NULL ;
#line 13002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL )
#line 13004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  -> GetRenderType  () == RT_TERRAIN )
#line 13006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  = StartEffectGroup  ("Picking Terrain" 
#line 13008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  () , m_vDesiredPosition  , ANGLE3D (0 , 0 , 0));
#line 13009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((GetPlayerWeapons  () -> m_penRayHitTmp  -> GetRenderType  () == RT_BRUSH  
#line 13011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| GetPlayerWeapons  () -> m_penRayHitTmp  -> GetRenderType  () == RT_FIELDBRUSH ) 
#line 13012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& GetPlayerWeapons  () -> m_bPickConditionOk )
#line 13013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D angle  = GetEulerAngleFromDir  (GetPlayerWeapons  () -> m_vRayHitSurfaceNormal );
#line 13017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(angle  (2) < MAX_MOVE_SLOPE_GRADE )
#line 13018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  = StartEffectGroup  ("Picking BSP" 
#line 13020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  () , m_vDesiredPosition  , angle );
#line 13021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pInput  -> SetRMousePressed  (FALSE );
#line 13029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 13030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDeltaTmp  = vDelta ;
#line 13032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fLength  = vDeltaTmp  . Length  ();
#line 13034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL  && GetPlayerWeapons  () -> m_penRayHitTmp  -> GetFlags  () & ENF_ALIVE  && m_nDesiredSkillNum  != - 1)
#line 13035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nDesiredSkillNum );
#line 13038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetFireRange  () >= fLength )
#line 13039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEnt  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEnt  != NULL  && penEnt  -> GetFlags  () & ENF_ALIVE  && penEnt  != this )
#line 13049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEnt  -> IsFirstExtraFlagOn  (ENF_EX1_NPC ) || 
#line 13051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEnt  -> IsFirstExtraFlagOn  (ENF_EX1_PRODUCTION ) || 
#line 13052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEnt  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_PET ) || 
#line 13053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEnt  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ) || 
#line 13054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEnt  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ))
#line 13055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsRvrZone  () || IsPvp  () || IsLegitTarget  (penEnt ) || 
#line 13061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildBattle  () -> IsEnemy  (penEnt  -> en_ulID ) || _pUISWDoc  -> IsWar  ())
#line 13062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 13066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fAttackDistance  = GetAttackrange  ();
#line 13068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsAttacking  () && m_nCurrentSkillNum  != - 1)
#line 13069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 13072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillDistance  = SkillData  . GetFireRange  ();
#line 13074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  < m_fSkillDistance )
#line 13075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2085 , "가로막혀서 스킬을 사용할수 없습니다."));
#line 13087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 13092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! IsAttacking  () && m_nDesiredSkillNum  != - 1)
#line 13104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nDesiredSkillNum );
#line 13106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillDistance  = SkillData  . GetFireRange  ();
#line 13108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  < m_fSkillDistance )
#line 13109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2085 , "가로막혀서 스킬을 사용할수 없습니다."));
#line 13120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 13125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 13134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  < fAttackDistance  && ! IsAttacking  () && m_nCurrentSkillNum  == - 1)
#line 13137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2086 , "가로막혀서 공격할수 없습니다."));
#line 13148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , penEnt  , fLength );
#line 13158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 13159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartAttack  ();
#line 13161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 13165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  >= 2.0f && ! IsAttacking  ())
#line 13171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEnt  -> IsCharacter  ())
#line 13181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  >= 1.0f)
#line 13183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penEnt  == this )
#line 13191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penEnt  -> IsEnemy  () || penEnt  -> IsPet  () || penEnt  -> IsSlave  ())
#line 13195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 13197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScaledSize  = 0.0f;
#line 13198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fAttackDistance  = _pNetwork  -> MyCharacterInfo  . attackrange ;
#line 13200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEnt  -> IsEnemy  ())
#line 13201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fScaledSize  = CMobData  :: getData  (((CEnemy  *) penEnt ) -> m_nMobDBIndex ) -> GetScaledSize  ();
#line 13203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fAttackDistance  += fScaledSize ;
#line 13204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsAttacking  () && m_nCurrentSkillNum  != - 1)
#line 13208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 13211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillDistance  = SkillData  . GetFireRange  ();
#line 13213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  < m_fSkillDistance )
#line 13214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2085 , "가로막혀서 스킬을 사용할수 없습니다."));
#line 13226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 13231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! IsAttacking  () && m_nDesiredSkillNum  != - 1)
#line 13245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nDesiredSkillNum );
#line 13248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillDistance  = SkillData  . GetFireRange  ();
#line 13250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fLength  < m_fSkillDistance )
#line 13251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2085 , "가로막혀서 스킬을 사용할수 없습니다."));
#line 13262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 13267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  < fAttackDistance  && ! IsAttacking  () && m_nCurrentSkillNum  == - 1)
#line 13281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward  || m_bKeyMove ))
#line 13283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penEnt ))
#line 13290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 13292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2086 , "가로막혀서 공격할수 없습니다."));
#line 13293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 13295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 13296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 13298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , penEnt  , fLength );
#line 13303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 13304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartAttack  ();
#line 13306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 13310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  >= 2.0f && ! IsAttacking  ())
#line 13315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(BUTTON_MOVE_ENABLE ){SendMyNextMovePosition  (vDelta );}
#line 13320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(fLength  >= 0.5f)
#line 13325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 13328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = TRUE ;
#line 13329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bTargetDirection  = vDelta ;
#line 13334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((ulNewButtons  & PLACT_FIRE  || m_bKeyMove ) && m_bLockMove )
#line 13338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plRay ;
#line 13342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = TRUE ;
#line 13343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plRay  = GetPlayerWeapons  () -> GetMouseHitInformationReserve  (_pInput  -> inp_ptMousePos  , m_apr  , TRUE  , TRUE );
#line 13344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsAttacking  ())
#line 13347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 13349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 13351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 13352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 13357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  == NULL ){
#line 13358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_VIEW  , WLD_AUTO_ENTITY_ID  , FALSE );
#line 13359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EViewInit  eInit ;
#line 13360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidOwner  = this ;
#line 13361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . eidCamera  = (CEntity  *) NULL ;
#line 13362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . vtView  = VT_3RDPERSONVIEW ;
#line 13363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInit  . bDeathFixed  = FALSE ;
#line 13364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Initialize  (eInit  , FALSE );
#line 13365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = PVT_3RDPERSONVIEW ;
#line 13370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulButtonsNow  & PLACT_CENTER_VIEW ){
#line 13375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
paAction  . pa_aRotation  (2) += Clamp  (- en_plViewpoint  . pl_OrientationAngle  (2) / _pTimer  -> TickQuantum  , - 900.0f , + 900.0f);
#line 13376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheatsEnabled(void) 
#line 13405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (GetSP  () -> sp_ctMaxPlayers  == 1 || GetSP  () -> sp_bQuickTest ) && m_penActionMarker  == NULL  && ! _SE_DEMO ;
#line 13407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::GetLerpedAbsoluteViewPlacement(CPlacement3D & plView) 
#line 13416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED ))
#line 13418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = GetPlacement  ();
#line 13420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bDiscard3rdView  = FALSE ;
#line 13421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 13422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSharpTurning  = TRUE ;
#line 13425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((! _pNetwork  -> IsPlayerLocal  (this ) && ! _pNetwork  -> IsPlayingDemo  ()) || _pNetwork  -> IsPlayingDemo  () || _pNetwork  -> IsGameFinished  ())
#line 13426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSharpTurning  = FALSE ;
#line 13428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fLerpFactor  = _pTimer  -> GetLerpFactor  ();
#line 13433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bDontLerpView )
#line 13434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plLastViewpoint  = en_plViewpoint ;
#line 13436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = en_plViewpoint ;
#line 13437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDontLerpView  = FALSE ;
#line 13438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . Lerp  (en_plLastViewpoint  , en_plViewpoint  , fLerpFactor );
#line 13442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fOriginalPitch  = plView  . pl_OrientationAngle  (2);
#line 13447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . ChangeView  (plView );
#line 13452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES  || _bDiscard3rdView )
#line 13453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPosLerped  = GetLerpedPlacement  ();
#line 13456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bSharpTurning )
#line 13457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRotationDamping  = CalculateViewRotationDamping  ();
#line 13460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  (1) = en_plViewpoint  . pl_OrientationAngle  (1) + GetRotationDiff  (m_iLastRotationH  , m_aLocalRotation  (1)) * fRotationDamping ;
#line 13461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  (2) = en_plViewpoint  . pl_OrientationAngle  (2) + GetRotationDiff  (m_iLastRotationP  , m_aLocalRotation  (2)) * fRotationDamping ;
#line 13462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  (3) = en_plViewpoint  . pl_OrientationAngle  (3) + GetRotationDiff  (m_iLastRotationB  , m_aLocalRotation  (3)) * fRotationDamping ;
#line 13465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (plView  . pl_OrientationAngle  (2) , PITCH_MAX );
#line 13466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RoundViewAngle  (plView  . pl_OrientationAngle  (3) , BANKING_MAX );
#line 13471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aCurr  = GetPlacement  () . pl_OrientationAngle ;
#line 13472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aLast  = en_plLastPlacement  . pl_OrientationAngle ;
#line 13473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aDesired  = en_aDesiredRotationRelative  * _pTimer  -> TickQuantum ;
#line 13474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D mCurr ;MakeRotationMatrixFast  (mCurr  , aCurr );
#line 13475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D mLast ;MakeRotationMatrixFast  (mLast  , aLast );
#line 13476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D mDesired ;MakeRotationMatrixFast  (mDesired  , aDesired );
#line 13477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mDesired  = en_mRotation  * (mDesired  * ! en_mRotation );
#line 13478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D mForced  = ! mDesired  * mCurr  * ! mLast ;
#line 13479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D aForced ;DecomposeRotationMatrixNoSnap  (aForced  , mForced );
#line 13480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aForced  . MaxNorm  () < 1E-2){
#line 13481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aForced  = ANGLE3D (0 , 0 , 0);
#line 13482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qForced ;qForced  . FromEuler  (aForced );
#line 13484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qZero ;qZero  . FromEuler  (ANGLE3D (0 , 0 , 0));
#line 13485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qLerped  = Slerp  (fLerpFactor  , qZero  , qForced );
#line 13486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D m ;
#line 13487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qLerped  . ToMatrix  (m );
#line 13488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m  = m  * mDesired  * mLast ;
#line 13489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DecomposeRotationMatrixNoSnap  (plPosLerped  . pl_OrientationAngle  , m );
#line 13490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . RelativeToAbsoluteSmooth  (plPosLerped );
#line 13495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_3RDPERSONVIEW )
#line 13497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = m_pen3rdPersonView  -> GetLerpedPlacement  ();
#line 13500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_PLAYERAUTOVIEW )
#line 13502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = CPlacement3D (FLOAT3D (0 , plr_fViewHeightStand  , 0) , ANGLE3D (180 , - 90 , 0));
#line 13504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . RelativeToAbsoluteSmooth  (GetLerpedPlacement  ());
#line 13506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Unknown player view");
#line 13510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bDiscard3rdView  = FALSE ;
#line 13512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity * CPlayer::GetViewEntity(BOOL bCamera) 
#line 13516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES )
#line 13519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return this ;
#line 13522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_3RDPERSONVIEW )
#line 13525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_ISZOOMING ){
#line 13527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return this ;
#line 13528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPlayerView  &) * m_pen3rdPersonView ) . m_fDistance  > 0.5f && ! bCamera ){
#line 13534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_pen3rdPersonView ;
#line 13535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 13536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return this ;
#line 13537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_PLAYERAUTOVIEW )
#line 13541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return this ;
#line 13544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 13546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERTALWAYS  ("Unknown player view");
#line 13548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return NULL ;
#line 13549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderChainsawParticles(BOOL bThird) 
#line 13553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fStretch  = 1.0f;
#line 13555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bThird )
#line 13556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fStretch  = 0.4f;
#line 13558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmNow  = _pTimer  -> GetLerpedCurrentTick  ();
#line 13561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iSpray  = 0;iSpray  < MAX_BULLET_SPRAYS ;iSpray  ++)
#line 13562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BulletSprayLaunchData  & bsld  = m_absldData  [ iSpray  ];
#line 13564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fLife  = 1.25f;
#line 13565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > (bsld  . bsld_tmLaunch  + fLife )){continue ;}
#line 13566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_BulletSpray  (bsld  . bsld_iRndBase  , bsld  . bsld_vPos  , bsld  . bsld_vG  , 
#line 13567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bsld  . bsld_eptType  , bsld  . bsld_tmLaunch  , bsld  . bsld_vStretch  * fStretch  , 1.0f);
#line 13568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iGore  = 0;iGore  < MAX_GORE_SPRAYS ;iGore  ++)
#line 13572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoreSprayLaunchData  & gsld  = m_agsldData  [ iGore  ];
#line 13574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fLife  = 2.0f;
#line 13575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmNow  > (gsld  . gsld_tmLaunch  + fLife )){continue ;}
#line 13576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPos  = gsld  . gsld_vPos ;
#line 13577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bThird )
#line 13578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vPos  = gsld  . gsld_v3rdPos ;
#line 13580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_BloodSpray  (gsld  . gsld_sptType  , vPos  , gsld  . gsld_vG  , gsld  . gsld_fGA  , 
#line 13582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_boxHitted  , gsld  . gsld_vSpilDirection  , 
#line 13583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
gsld  . gsld_tmLaunch  , gsld  . gsld_fDamagePower  * fStretch  , gsld  . gsld_colParticles );
#line 13584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderHUD(CPerspectiveProjection3D & prProjection,CDrawPort * pdp,
#line 13589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vViewerLightDirection,COLOR colViewerLight,COLOR colViewerAmbient,
#line 13590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRenderWeapon,INDEX iEye) 
#line 13591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plViewOld  = prProjection  . ViewerPlacementR  ();
#line 13596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRenderModels  = _pShell  -> GetINDEX  ("gfx_bRenderModels");
#line 13606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 13607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prProjection  . ViewerPlacementL  () = plViewOld ;
#line 13608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
prProjection  . Prepare  ();
#line 13609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 13610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
apr  = prProjection ;
#line 13611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 13612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particle_PrepareSystem  (pdp  , apr );
#line 13613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particle_PrepareEntity  (2.0f , FALSE  , FALSE  , TRUE  , this );
#line 13614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderChainsawParticles  (FALSE );
#line 13615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particle_EndSystem  ();
#line 13616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 13620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES )
#line 13621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = en_plViewpoint ;
#line 13624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . RelativeToAbsolute  (GetPlacement  ());
#line 13625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_3RDPERSONVIEW )
#line 13627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = ((CPlayerView  &) * m_pen3rdPersonView ) . GetPlacement  ();
#line 13630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulR  = 255 , ulG  = 0 , ulB  = 0;
#line 13633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulA  = m_fDamageAmmount  * 5.0f;
#line 13636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmSinceWounding  = en_tmEntityTime  - m_tmWoundedTime ;
#line 13637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmSinceWounding  < 4.0f && ! IsReapplyingActions  ())
#line 13638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmSinceWounding  < 0.001f){ulA  = (ulA  + 64) / 2;}
#line 13641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = ClampUp  (ulA  , (ULONG ) 224);
#line 13647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static int  cnt  = 0;
#line 13666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == 4){
#line 13667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulR  = 255;
#line 13668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulG  = 0;
#line 13669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulB  = 0;
#line 13670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = 64;
#line 13671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(cnt  == 1){
#line 13673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulR  = 0;
#line 13674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulG  = 255;
#line 13675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulB  = 0;
#line 13676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = 64;
#line 13677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(cnt  == 2){
#line 13679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulR  = 0;
#line 13680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulG  = 0;
#line 13681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulB  = 255;
#line 13682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = 64;
#line 13683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(cnt  == 3){
#line 13685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulR  = 255;
#line 13686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulG  = 200;
#line 13687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulB  = 0;
#line 13688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = 64;
#line 13689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(cnt  == 0){
#line 13691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulR  = 255;
#line 13692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulG  = 0;
#line 13693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulB  = 0;
#line 13694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulA  = 0;
#line 13695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingRA  += ulR  * ulA ;
#line 13699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingGA  += ulG  * ulA ;
#line 13700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingBA  += ulB  * ulA ;
#line 13701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingA  += ulA ;
#line 13705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colGlare  = GetWorldGlaring  ();
#line 13707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubR  , ubG  , ubB  , ubA ;
#line 13708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ColorToRGBA  (colGlare  , ubR  , ubG  , ubB  , ubA );
#line 13709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubA  != 0){
#line 13710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingRA  += ULONG  (ubR ) * ULONG  (ubA );
#line 13711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingGA  += ULONG  (ubG ) * ULONG  (ubA );
#line 13712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingBA  += ULONG  (ubB ) * ULONG  (ubA );
#line 13713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> dp_ulBlendingA  += ULONG  (ubA );
#line 13714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> BlendScreen  ();
#line 13721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(hud_bShowInfo ){
#line 13722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSnooping  = FALSE ;
#line 13723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penHUDPlayer  = this ;
#line 13724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penHUDOwner  = this ;
#line 13737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DrawHUD  (penHUDPlayer  , pdp  , bSnooping  , penHUDOwner );
#line 13738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderCursor(CDrawPort * pdp,void * pvUserData) 
#line 13742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bShowExtras  = (ULONG  (pvUserData ) & GRV_SHOWEXTRAS );
#line 13745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 13746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penViewer ;
#line 13747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plViewer ;
#line 13748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
COLOR colBlend ;
#line 13751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDrawPort  dpCenter  (pdp  , 0);
#line 13752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dpCenter  . SetAsCurrent  ();
#line 13753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetupView  (& dpCenter  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 13754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , 0 , 1);
#line 13759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderHudPicFX  (& dpCenter );
#line 13761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(hud_bShowAll  && bShowExtras )
#line 13762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 13764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES )
#line 13765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = en_plViewpoint ;
#line 13768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . RelativeToAbsolute  (GetPlacement  ());
#line 13769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iViewState  == PVT_3RDPERSONVIEW )
#line 13771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  = ((CPlayerView  &) * m_pen3rdPersonView ) . GetPlacement  ();
#line 13774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsFlagOn  (ENF_ALIVE ))
#line 13777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pInput  -> IsRMouseButtonPressed  ())
#line 13779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPerspectiveProjection3D  & prProjection  = * (CPerspectiveProjection3D  *) (CProjection3D  *) apr ;
#line 13781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . RenderCrosshair  (prProjection  , & dpCenter  , plView );
#line 13782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pdp  -> SetAsCurrent  ();
#line 13787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::InitializePlayer(BOOL bFirstInit) 
#line 13794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 13797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  = FLOAT3D (0.0f , plr_fViewHeightStand  , 0.0f);
#line 13798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plLastViewpoint  = en_plViewpoint ;
#line 13801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= PLF_INITIALIZED  | PLF_LEVELSTARTED  | PLF_RESPAWNINPLACE ;
#line 13802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fFallTime  = 0.0f;
#line 13803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 13804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fDamageAmmount  = 0.0f;
#line 13805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmWoundedTime  = 0.0f;
#line 13806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmInvisibility  = 0.0f , 
#line 13807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmInvulnerability  = 0.0f , 
#line 13808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousDamage  = 0.0f , 
#line 13809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSeriousSpeed  = 0.0f , 
#line 13811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bIsTransform  = FALSE ;
#line 13812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = FALSE ;
#line 13813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iTransformType  = 0;
#line 13815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nChangeMonsterId  = 0;
#line 13816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = FALSE ;
#line 13817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMobChange  = FALSE ;
#line 13820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . InitializeProperties  ();
#line 13822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> SendEvent  (EStart  ());
#line 13825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_AfterBurner_Prepare  (this );
#line 13828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_WALKING  | EPF_HASLUNGS  | EPF_PUSHABLE );
#line 13829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_MODEL  | ((ECBI_PLAYER ) << ECB_IS ));
#line 13830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_ALIVE );
#line 13833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl ){
#line 13834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , AOF_LOOPING );
#line 13835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 13836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartSkaAnim  (this  , idPlayerWhole_Animation  [ ANIM_IDLE  ] , AN_LOOPING  , 0 , 0.5f);
#line 13837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerTeleportCause  eCause ;
#line 13841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _cmiComm  . IsNetworkOn  ()){
#line 13843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bFirstInit ){
#line 13844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eCause  = TPC_FIRSTINIT ;
#line 13845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 13846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eCause  = TPC_OTHER ;
#line 13847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(eCause  == TPC_FIRSTINIT )
#line 13849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 13851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 13852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 13853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance ){en_pmiModelInstance  -> m_tmSkaTagManager  . Register  (& tag );}
#line 13854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 13855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 13856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 13857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 13858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 13859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 13860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TeleportPlayer  (WLT_FIXED  , eCause );
#line 13862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_cmiComm  . IsNetworkOn  ()){
#line 13866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bFirstInit ){
#line 13867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eCause  = TPC_FIRSTINIT ;
#line 13868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 13869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eCause  = TPC_OTHER ;
#line 13870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(eCause  == TPC_FIRSTINIT )
#line 13872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetModelInstance  ())
#line 13874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 13876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 13877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 13878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pmiModelInstance  -> m_tmSkaTagManager  . Register  (& tag );
#line 13879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 13880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 13881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 13882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 13883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 13884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 13885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bFirstInit )
#line 13892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoTo  (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  , _pNetwork  -> MyCharacterInfo  . z  , 
#line 13894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r );
#line 13895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 13896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D CPlayer::GetTeleportingOffset(void) 
#line 13900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPlayer  = GetMyPlayerIndex  ();
#line 13905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const FLOAT fOffsetY  = 0.1f;
#line 13906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = FLOAT3D (0 , fOffsetY  , 0);
#line 13907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 13908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iRow  = iPlayer  / 4;
#line 13909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iCol  = iPlayer  % 4;
#line 13910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vOffsetRel  = FLOAT3D (- 3.0f + iCol  * 2.0f , fOffsetY  , - 3.0f + iRow  * 2.0f);
#line 13911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return vOffsetRel ;
#line 13914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RemapLevelNames(INDEX & iLevel) 
#line 13917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iLevel ){
#line 13919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 10: 
#line 13920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 1;
#line 13921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 11: 
#line 13923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 2;
#line 13924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 12: 
#line 13926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 3;
#line 13927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 13: 
#line 13929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 4;
#line 13930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 14: 
#line 13932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 5;
#line 13933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 15: 
#line 13935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 6;
#line 13936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 21: 
#line 13938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 7;
#line 13939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 22: 
#line 13941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 8;
#line 13942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 23: 
#line 13944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 9;
#line 13945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 24: 
#line 13947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 10;
#line 13948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 31: 
#line 13950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 11;
#line 13951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 32: 
#line 13953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 12;
#line 13954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 33: 
#line 13956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = 13;
#line 13957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 13959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = - 1;
#line 13960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 13961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 13964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::TeleportPlayer(enum WorldLinkType EwltType,PlayerTeleportCause eCause) 
#line 13965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 13966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iLevel  = - 1;
#line 13967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strLevelName  = GetWorld  () -> wo_fnmFileName  . FileName  ();
#line 13970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX u  , v ;
#line 13971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
u  = v  = - 1;
#line 13972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strLevelName  . ScanF  ("%01d_%01d_" , & u  , & v );
#line 13973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iLevel  = u  * 10 + v ;
#line 13975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RemapLevelNames  (iLevel );
#line 13977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iLevel  > 0){
#line 13978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CSessionProperties  *) GetSP  ()) -> sp_ulLevelsMask  |= 1 << (iLevel  - 1);
#line 13979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 13982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_DONTRENDER ;
#line 13983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPlayer  = GetMyPlayerIndex  ();
#line 13988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plSet  = GetPlacement  ();
#line 13990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (32000.0f + 100.0f * iPlayer  , 32000.0f , 0) , ANGLE3D (0 , 0 , 0)));
#line 13993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl ){
#line 13994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ForceCollisionBoxIndexChange  (PLAYER_COLLISION_BOX_STAND );
#line 13995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 13996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ForceCollisionBoxIndexChange  (GetModelInstance  () -> GetColisionBoxIndex  (idPlayer_Collision_Stand ));
#line 13997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 13999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 14000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . m_bDisableAnimating  = FALSE ;
#line 14001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Stand  ();
#line 14002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 14007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bInitialMarker  = FALSE ;
#line 14010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = GetTeleportingOffset  ();
#line 14013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bSetHealth  = FALSE ;
#line 14014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAdjustHealth  = FALSE ;
#line 14015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = NULL ;
#line 14016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative )
#line 14017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cht_iGoToMarker  >= 0){
#line 14020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 14021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - %d" , (INDEX) cht_iGoToMarker );
#line 14022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 14023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ETrigger  etr ;
#line 14024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
etr  . penCaused  = this ;
#line 14025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  -> SendEvent  (etr );
#line 14026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cht_iGoToMarker  = - 1;
#line 14027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 14028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_penMainMusicHolder  != NULL  && ! (m_ulFlags  & PLF_CHANGINGLEVEL )){
#line 14031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMusicHolder  * pmh  = (CMusicHolder  *) & * m_penMainMusicHolder ;
#line 14033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penRespawnMarker ;
#line 14034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . EntityExists  (pmh  -> m_iRespawnMarker  , penRespawnMarker );
#line 14035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penRespawnMarker  != NULL ){
#line 14037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = penRespawnMarker ;
#line 14038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 14039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  == NULL  && GetSP  () -> sp_bQuickTest  && m_strGroup  == ""){
#line 14046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 14047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Quick Start");
#line 14048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 14049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 14050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  == NULL ){
#line 14055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 14056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - %s" , m_strGroup );
#line 14057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 14058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_strGroup  == ""){
#line 14059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 14060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 14062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(EwltType  == WLT_FIXED ){
#line 14063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = FALSE ;
#line 14064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = TRUE ;
#line 14065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 14066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = FALSE ;
#line 14067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  == NULL ){
#line 14074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 14075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - ");
#line 14076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 14077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 14078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 14079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && eCause  != TPC_OTHER ){
#line 14082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bInitialMarker  = TRUE ;
#line 14083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_ulFlags  & PLF_RESPAWNINPLACE ) && pen  != NULL  && ! ((CPlayerMarker  *) & * pen ) -> m_bNoRespawnInPlace ){
#line 14088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 14090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHealth  (TopHealth  ());
#line 14092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 14094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (CPlacement3D (m_vDied  , m_aDied ));
#line 14097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(pen  != NULL ){
#line 14099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penMainMusicHolder  != NULL ){
#line 14100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMusicHolder  * pmh  = (CMusicHolder  *) & * m_penMainMusicHolder ;
#line 14101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pmh  -> m_iRespawnMarker  == - 1){
#line 14103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pmh  -> m_iRespawnMarker  = pen  -> en_ulID ;
#line 14104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerMarker  & CpmStart  = (CPlayerMarker  &) * pen ;
#line 14109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bSetHealth ){
#line 14110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHealth  (CpmStart  . m_fHealth  / 100.0f * TopHealth  ());
#line 14112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fArmor  = CpmStart  . m_fShield ;
#line 14113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(bAdjustHealth ){
#line 14114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fHealth  = GetHealth  ();
#line 14115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fTopHealth  = TopHealth  ();
#line 14116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fHealth  < fTopHealth ){
#line 14117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHealth  (ClampUp  (fHealth  + fTopHealth  / 2.0f , fTopHealth ));
#line 14118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CpmStart  . m_bStartInComputer  && GetSP  () -> sp_bSinglePlayer ){
#line 14124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){
#line 14125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 14126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 14128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (EShowConsole  () , TRUE );
#line 14129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_bInitialStart  = TRUE ;
#line 14131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(EwltType  == WLT_RELATIVE ){
#line 14159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plSet  . AbsoluteToRelative  (_SwcWorldChange  . plLink );
#line 14160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plSet  . RelativeToAbsolute  (CpmStart  . GetPlacement  ());
#line 14161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (plSet );
#line 14163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(EwltType  == WLT_FIXED ){
#line 14164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plNew  = CpmStart  . GetPlacement  ();
#line 14165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vOffsetRel  *= CpmStart  . en_mRotation ;
#line 14166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plNew  . pl_PositionVector  += vOffsetRel ;
#line 14167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (plNew );
#line 14170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_plPlacement  . pl_PositionVector  (1) != 32000.0f)
#line 14171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_cmiComm  . IsNetworkOn  ())
#line 14173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 14182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  , _pNetwork  -> MyCharacterInfo  . z ) , ANGLE3D (0 , 0 , 0)));
#line 14184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CpmStart  . m_penTarget  != NULL )
#line 14187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (CpmStart  . m_penTarget  , EET_TRIGGER  , this );
#line 14189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHealth  (TopHealth  ());
#line 14197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 14201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (0 , 0 , 0) + vOffsetRel  , ANGLE3D (0 , 0 , 0)));
#line 14202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEventInRange  (ETeleport  () , FLOATaabbox3D (GetPlacement  () . pl_PositionVector  , 200.0f));
#line 14206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ForceFullStop  ();
#line 14209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fMaxHealth  = TopHealth  ();
#line 14212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  && GetSP  () -> sp_gmGameMode  != CSessionProperties  :: GM_FLYOVER ){
#line 14213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 14214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_bNoSaveGame ){
#line 14215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NOTHING ;
#line 14216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 14219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_LEVELSTARTED )){
#line 14223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_LEVELSTARTED ;
#line 14224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmLevelStarted  = _pNetwork  -> GetGameTime  ();
#line 14225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SpawnTeleport  ();
#line 14260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SwitchToModel  ();
#line 14262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSpawned  = en_tmEntityTime ;
#line 14263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_tmLastBreathed  = en_tmEntityTime  + 0.1f;
#line 14264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 14267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::CreateAnimAndBoneIDs(void) 
#line 14268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_RenderType  != RT_SKAMODEL  && en_RenderType  != RT_SKAEDITORMODEL ){return ;}
#line 14271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pmi  = GetModelInstance  ();
#line 14272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pmi  != NULL );
#line 14274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 14276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = ANIM_START ;i  < ANIM_TOTAL ;++ i )
#line 14277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ska_CreateAnimIDFromString  (& idPlayerWhole_Animation  [ i  ] , pmi  , CJobInfo  :: getSingleton  () -> GetAnimationName  (iJob  , i ));
#line 14279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 14283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::FillAnimAndBoneIDs() 
#line 14284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_RenderType  != RT_SKAMODEL  && en_RenderType  != RT_SKAEDITORMODEL ){return ;}
#line 14287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pmi  = GetModelInstance  ();
#line 14288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pmi  != NULL );
#line 14290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 14292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = ANIM_START ;i  < ANIM_TOTAL ;++ i )
#line 14293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ i  ] = ska_GetIDFromStringTable  (CJobInfo  :: getSingleton  () -> GetAnimationName  (iJob  , i ));
#line 14295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 14299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::IdleAnim() 
#line 14300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (0.f);
#line 14303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == FALSE )
#line 14304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bExtension  || m_bMobChange )
#line 14306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 14308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX idBodyAnim  = - 1;
#line 14310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 14311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 14313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ];
#line 14315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ];
#line 14319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 14323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ];
#line 14325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_1  ];
#line 14329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE );
#line 14332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_ATTACK_IDLE  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 14336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 14342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX idBodyAnim  = - 1;
#line 14344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 14345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 14347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ];
#line 14349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ];
#line 14353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 14357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_2  ];
#line 14359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_2  ];
#line 14363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE );
#line 14366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 14370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_FLYING_READY  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , 
#line 14372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_IDLE  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 14377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 14385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX idBodyAnim  = - 1;
#line 14387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 14388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 14390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ];
#line 14392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ];
#line 14396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 14400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ];
#line 14402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_1  ];
#line 14406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE );
#line 14409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 14413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_FLYING_READY  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , 
#line 14415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_IDLE  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 14420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 14426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ChangeWholeAnim(INDEX idBodyAnim,ULONG ulFlags,FLOAT fStrength,FLOAT fFadeTime,FLOAT fSpeed) 
#line 14427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT start_attack_time ;
#line 14429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static float  m_fBodyAnimTime ;
#line 14430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT start_action_time ;
#line 14431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT start_Product_time ;
#line 14432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT start_Damage_time ;
#line 14435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static int  cnt  = 0;
#line 14437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static int  effectCnt  = 0;
#line 14438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nIsCount  = 0;
#line 14439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iCurrentIsAnim  = - 1;
#line 14440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iAttackType  = ATTACK1 ;
#line 14451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance ){en_pmiModelInstance  -> m_tmSkaTagManager  . SetOwner  (this );}
#line 14454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetPos  (0 , 0 , 0);
#line 14455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirection  (0 , 0 , 0);
#line 14457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 14459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 14460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 14462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentCenter  (((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 14463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 14464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 14465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentPos  = this  -> en_plPlacement  . pl_PositionVector  + vCurrentCenter ;
#line 14466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetCenter  (0 , 0 , 0);
#line 14467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT size  = 0;
#line 14468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE  && pen  -> IsFirstExtraFlagOff  (ENF_EX1_CLICK_OBJECT ))
#line 14469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> en_RenderType  == RT_SKAMODEL )
#line 14471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 14474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  -> GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 14475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f * 0.4f;
#line 14476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
size  = vRadius  . Length  ();
#line 14477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetCenter  = FLOAT3D (((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 14479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 14480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 14481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  = pen  -> en_plPlacement  . pl_PositionVector  + vTargetCenter ;
#line 14482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  = vTargetPos  - vCurrentPos ;
#line 14483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 14484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  -= vDirection  * size ;
#line 14485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 14489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RUN_1  ]) || 
#line 14490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_EXT_RUN_2  ]) || 
#line 14491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_RUN_1  ]) || 
#line 14492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_RUN_1  ]) || 
#line 14493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_RUN_1  ]) || 
#line 14494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RUN_2  ]))
#line 14495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) 
#line 14497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (idBodyAnim  == idPlayerWhole_Animation  [ ANIM_WALK_1  ] || 
#line 14498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_WALK_2  ] || 
#line 14499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_WALK_1  ] || 
#line 14500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_WALK_1  ] || 
#line 14501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_WALK_1  ] || 
#line 14502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ] || 
#line 14503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_1  ] || 
#line 14504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ] || 
#line 14505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_2  ] || 
#line 14506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_2  ] || 
#line 14507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_2  ] || 
#line 14508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_WALK_2  ] || 
#line 14509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_IDLE_1  ] || 
#line 14510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_IDLE  ]))
#line 14511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_WALK_1  ]) || 
#line 14518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_EXT_WALK_2  ]) || 
#line 14519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_WALK_1  ]) || 
#line 14520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_WALK_1  ]) || 
#line 14521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_WALK_1  ]) || 
#line 14522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_WALK_2  ]))
#line 14523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && 
#line 14525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_IDLE  ] || 
#line 14526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ] || 
#line 14527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_2  ] || 
#line 14528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_1  ] || 
#line 14529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_2  ] || 
#line 14530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ] || 
#line 14531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_2  ] || 
#line 14532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_IDLE_1  ]))
#line 14533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  _PreAttackTime  , _DoAttackTime  , _PostAttackTime ;
#line 14539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bIsPreDoEnd  = FALSE ;
#line 14540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idBodyAnim ))
#line 14541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_DAMAGE  ]) || 
#line 14544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DAMAGE  ]) || 
#line 14545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DAMAGE  ]) || 
#line 14546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DAMAGE  ]) || 
#line 14547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_EXT_DAMAGE  ]))
#line 14548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_Damage_time  >= m_fBodyAnimTime  - 0.1f)
#line 14550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SIT_CONTINUE  ]) 
#line 14561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT_CONTINUE  ]) 
#line 14562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT_CONTINUE  ])) 
#line 14563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_bPlayAction )
#line 14564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nPlayActionNum  == ACTION_NUM_SITDOWN  && m_nActionSit  == 3)
#line 14566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_action_time  = _pTimer  -> CurrentTick  ();
#line 14569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 14570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX idBodyAnim  = - 1;
#line 14573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 14574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_STANDUP  ];
#line 14576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_STANDUP  ];
#line 14580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE );
#line 14583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_STANDUP  ] , AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 14587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_MINE  ] 
#line 14596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_COLLECT  ] 
#line 14597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_GATHER  ])
#line 14598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  == NULL )
#line 14602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) pen ) -> m_nMobDBIndex ;
#line 14606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 14609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bConsensus )
#line 14610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! MD  -> IsLordSymbol  ())
#line 14613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> StopConsensus  (_pNetwork  -> MyCharacterInfo  . index );
#line 14616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! MD  -> IsCollect  ())
#line 14623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_SHIELD  ] . IsEmptyItem  () == FALSE )
#line 14627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 14629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (696 , "방패를 장착하고서 생산을 할 수 없습니다."));
#line 14630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 14631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 14632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == TRUE )
#line 14639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 14641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iWeaponType  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  ();
#line 14646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (iWeaponType  == CItemData  :: ITEM_WEAPON_MINING  || 
#line 14647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_GATHERING  || 
#line 14648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_CHARGE ))
#line 14649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 14651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 14656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pen )
#line 14657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 14659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((iWeaponType  == CItemData  :: ITEM_WEAPON_MINING ) && MD  -> IsMineral  () || 
#line 14663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(iWeaponType  == CItemData  :: ITEM_WEAPON_GATHERING ) && MD  -> IsCrops  () || 
#line 14664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(iWeaponType  == CItemData  :: ITEM_WEAPON_CHARGE ) && MD  -> IsEnergy  ()))
#line 14665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 14667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_Product_time  >= m_fBodyAnimTime )
#line 14674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_Product_time  = _pTimer  -> CurrentTick  ();
#line 14676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = en_pmiModelInstance  -> GetAnimLength  (idBodyAnim );
#line 14678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsFirstExtraFlagOn  (ENF_EX1_PRODUCTION ))
#line 14679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObjectByCIndex  (eOBJ_MOB  , pen  -> en_ulID );
#line 14682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 14683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsMineral  ())
#line 14685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSelectProduceMessage  (pObject  -> GetSIndex  () , m_nProduceItemDBIndex );
#line 14687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsCrops  ())
#line 14689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSelectProduceMessage  (pObject  -> GetSIndex  () , m_nProduceItemDBIndex );
#line 14691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsEnergy  ())
#line 14693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSelectProduceMessage  (pObject  -> GetSIndex  () , m_nProduceItemDBIndex );
#line 14695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsCollect  ())
#line 14697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCollectProduceMessage  (pObject  -> GetSIndex  ());
#line 14701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , FALSE );
#line 14702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SIT  ]) 
#line 14709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT  ]) 
#line 14710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT  ]) 
#line 14711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_STANDUP  ]) 
#line 14712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_STANDUP  ]) 
#line 14713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_STANDUP  ]) 
#line 14714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Anim_Face3 ) 
#line 14715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Anim_Face4 ))
#line 14716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction )
#line 14718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_action_time  >= m_fBodyAnimTime  - 0.1f)
#line 14720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SIT  ]) || 
#line 14722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT  ]) || 
#line 14723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT  ]))
#line 14724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 14728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX idBodyAnim  = - 1;
#line 14731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 14732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT_CONTINUE  ];
#line 14734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  = idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT_CONTINUE  ];
#line 14738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE );
#line 14742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idPlayerWhole_Animation  [ ANIM_SIT_CONTINUE  ] , AN_LOOPING  | AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 14746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , 1.0f);
#line 14747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = 3;
#line 14750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 2;
#line 14751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 14755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 14756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 14757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (m_bSkilling );
#line 14758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_PICK  ]) 
#line 14766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_EXT_PICK  ]) 
#line 14767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_PICK  ]) 
#line 14768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_PICK  ]) 
#line 14769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_PICK  ]) 
#line 14770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_0  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_1  ]) 
#line 14771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_2  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_3  ]) 
#line 14772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_4  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_5  ]) 
#line 14773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_6  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_7  ]) 
#line 14774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_8  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_9  ]) 
#line 14775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_10  ]) || IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_SOCIAL_11  ])
#line 14790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 14791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction )
#line 14793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_action_time  >= m_fBodyAnimTime )
#line 14795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 14797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 14798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 14799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(nIsCount  = 0;nIsCount  < 4;++ nIsCount )
#line 14807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nAcessNum  = ANIM_ATTACK_1 ;
#line 14809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ nAcessNum  + nIsCount  ]))
#line 14810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iCurrentIsAnim  = nAcessNum  + nIsCount ;
#line 14812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 14813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nAcessNum  = ANIM_EXT_ATTACK_1 ;
#line 14816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAnimationPlaying  (idPlayerWhole_Animation  [ nAcessNum  + nIsCount  ]))
#line 14817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iCurrentIsAnim  = nAcessNum  + nIsCount ;
#line 14819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 14820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCurrentIsAnim  > 0)
#line 14825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 14829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iCurrentIsAnim  >= ANIM_EXT_ATTACK_1  && iCurrentIsAnim  <= ANIM_EXT_ATTACK_4 )
#line 14830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 14832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iAttackType  = (iCurrentIsAnim  - ANIM_EXT_ATTACK_1 );
#line 14834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iAttackType  = (iCurrentIsAnim  - ANIM_EXT_ATTACK_1 ) + EXT_ATTACK1 ;
#line 14838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iCurrentIsAnim  >= ANIM_ATTACK_1  && iCurrentIsAnim  <= ANIM_ATTACK_4 )
#line 14841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iAttackType  = (iCurrentIsAnim  - ANIM_ATTACK_1 );
#line 14843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 14847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_DoAttackTime  = TransformInfo  () . GetImpactTime  (m_iTransformType  , iAttackType ) * _fAttackLengthMul ;
#line 14849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_DoAttackTime  = CJobInfo  :: getSingleton  () -> GetImpactTime  (iJob  , iAttackType ) * _fAttackLengthMul ;
#line 14853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PreAttackTime  = 0.10f;
#line 14856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PostAttackTime  = en_pmiModelInstance  -> GetAnimLength  (idPlayerWhole_Animation  [ iCurrentIsAnim  ]) * _fAttackLengthMul ;
#line 14857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TIME  tmpTime  = _pTimer  -> CurrentTick  ();
#line 14859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cnt  == - 1)
#line 14860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  == this )
#line 14862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 14865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 14866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 14867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 14868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = pen ;
#line 14871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE )
#line 14872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = UI_SUMMON_START ;i  <= UI_SUMMON_END ;++ i )
#line 14875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSummonUI  * pUISummon  = (CSummonUI  *) pUIManager  -> GetUI  (i );
#line 14877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pSummonEntity  = pUISummon  -> GetSummonEntity  ();
#line 14878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity )
#line 14879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 14881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != ((CSlave  *) pSummonEntity ) -> m_penEnemy )
#line 14883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSummonEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 14885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> bIsActive )
#line 14892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pWildPetEntity  = pInfo  -> GetMyApetInfo  () -> m_pEntity ;
#line 14894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity )
#line 14895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ) && 
#line 14897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_penAttackingEnemy  != ((CWildPet  *) pWildPetEntity ) -> m_penEnemy ))
#line 14898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pWildPetEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 14901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bSingleMode  && m_penAttackingEnemy  -> IsEnemy  ())
#line 14907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 14909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (m_penAttackingEnemy );
#line 14913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == HEALER  || 
#line 14914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  == MAGE  || 
#line 14915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsEXMage  (iJob )
#line 14916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 14917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , m_penAttackingEnemy  , m_dcEnemies  , 
#line 14921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
5.0f , 4 , 45.0f);
#line 14922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , m_penAttackingEnemy  , m_dcEnemies  , 
#line 14927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
2.0f , 2 , 45.0f);
#line 14928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessageInContainer  (m_dcEnemies );
#line 14930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  -> IsEnemy  ())
#line 14935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) ((CEntity  *) m_penAttackingEnemy )) -> m_nMobDBIndex ;
#line 14937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - m_penAttackingEnemy  -> GetPlacement  () . pl_PositionVector ;
#line 14938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 14939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , m_penAttackingEnemy  , vDelta  . Length  ());
#line 14941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 14942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == LORD_SYMBOL_INDEX )
#line 14945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackSymbol  ();
#line 14947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessage  (this  , pen  , FALSE );
#line 14951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 14955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessage  (this  , pen  , FALSE );
#line 14957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == KNIGHT )
#line 14962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 14964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 1" 
#line 14966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_4  ])
#line 14969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 2" 
#line 14971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ])
#line 14975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 1_a" 
#line 14977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_4  ])
#line 14980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 2_a" 
#line 14982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == TITAN )
#line 14986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 14988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 1" 
#line 14990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_4  ])
#line 14993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 14994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 2" 
#line 14995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 14996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 14998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ])
#line 14999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 1_a" 
#line 15001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_4  ])
#line 15004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 2_a" 
#line 15006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == MAGE )
#line 15010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 15023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 15028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == ROGUE )
#line 15034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 1" 
#line 15038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 2" 
#line 15043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == SORCERER )
#line 15047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXRogue  (iJob ))
#line 15050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 1" 
#line 15054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 2" 
#line 15059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXMage  (iJob ))
#line 15063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 15076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 15081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 0;
#line 15088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_attack_time  > _PreAttackTime  && cnt  == 0)
#line 15092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  ++;
#line 15094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bIsPreDoEnd  = TRUE ;
#line 15095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_attack_time  > _DoAttackTime  && cnt  == 1)
#line 15099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHitEffect  (idBodyAnim  , _pNetwork  -> MyCharacterInfo  . iHitEffectType  , pen  , iAttackType );
#line 15102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_cmiComm  . IsNetworkOn  ())
#line 15103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 15105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , vTargetPos  , FALSE );
#line 15107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  != HEALER  && 
#line 15112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  != MAGE  && 
#line 15113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! (iJob  == ROGUE  && _pNetwork  -> MyCharacterInfo  . bExtension ) && 
#line 15114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! (IsEXRogue  (iJob ) && _pNetwork  -> MyCharacterInfo  . bExtension ) && 
#line 15115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! IsEXMage  (iJob ) && 
#line 15116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! (iJob  == SORCERER  && m_bIsTransform  && m_iTransformType  == CTransformInfo  :: TYPE_1 ) && 
#line 15117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  != NIGHTSHADOW )
#line 15118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != NULL )
#line 15120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
this  -> InflictDirectDamage  (m_penAttackingEnemy  , this  , DMT_CLOSERANGE  , 1 , vTargetPos  , vDirection );
#line 15122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  ++;
#line 15128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - start_attack_time  >= _PostAttackTime  - 0.1f && cnt  == 2)
#line 15132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_attack_time  = _pTimer  -> CurrentTick  ();
#line 15134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = - 1;
#line 15136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = NULL ;
#line 15139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 15142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 15144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 15146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nDesiredSkillNum  != - 1)
#line 15147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 15150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bReservedCancel )
#line 15151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 15153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReservedCancel  = FALSE ;
#line 15154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UseSkill  (m_nDesiredSkillNum );
#line 15158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! g_iAutoAttack  || m_bReserveMove  || m_nCurrentSkillNum  != - 1 || m_bReservedCancel  || (pen  != NULL  && ! (pen  -> GetFlags  () & ENF_ALIVE )) || pen  == NULL  || penTarget  != m_penAttackingEnemy )
#line 15162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 15166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bReservedCancel  || ! g_iAutoAttack )
#line 15167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 15169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReservedCancel  = FALSE ;
#line 15172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 15173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 15174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 15179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cnt  = 0;
#line 15181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
effectCnt  = 0;
#line 15184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 15186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_WALK_1  ] || 
#line 15187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_WALK_1  ] || 
#line 15188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_WALK_1  ])
#line 15189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ] || 
#line 15192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_1  ] || 
#line 15193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_1  ])
#line 15194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_2  ] || 
#line 15197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_IDLE_2  ] || 
#line 15198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_IDLE_2  ])
#line 15199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_RUN_1  ] || 
#line 15202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_RUN_1  ] || 
#line 15203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_RUN_1  ])
#line 15204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DAMAGE  ] || 
#line 15207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DAMAGE  ] || 
#line 15208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DAMAGE  ])
#line 15209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] || 
#line 15212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DIE  ] || 
#line 15213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DIE  ])
#line 15214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (idBodyAnim  , ulFlags  , fStrength  , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 15219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , fSpeed );
#line 15223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || 
#line 15224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ] || 
#line 15225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_ATTACK_3  ]) || 
#line 15226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsAnimationPlaying  (idPlayerWhole_Animation  [ ANIM_ATTACK_4  ]) || 
#line 15227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || 
#line 15228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ] || 
#line 15229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ] || 
#line 15230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_4  ])
#line 15231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  frandom  = FRnd  ();
#line 15235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 15236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == KNIGHT )
#line 15237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 15239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 1" 
#line 15241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_4  ])
#line 15244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 2" 
#line 15246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ])
#line 15250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 1_a" 
#line 15252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_4  ])
#line 15255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Knight Attack 2_a" 
#line 15257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_KNIGHT_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == TITAN )
#line 15265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 15267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 1" 
#line 15269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_4  ])
#line 15272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 2" 
#line 15274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ])
#line 15278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 1_a" 
#line 15280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_4  ])
#line 15283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Titan Attack 2_a" 
#line 15285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_TITAN_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == MAGE )
#line 15293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 15306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0_a" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 15311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1_a" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_MAGE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == HEALER )
#line 15321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == ROGUE )
#line 15328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 1" 
#line 15332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 2" 
#line 15337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_ROGUE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == SORCERER )
#line 15345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_TITAN_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXRogue  (iJob ))
#line 15375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 1" 
#line 15379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("Rogue Attack 2" 
#line 15384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 15385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_ROGUE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsEXMage  (iJob ))
#line 15392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 15405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall0_a" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 15410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("mEnerBall1_a" , & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 15412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 15413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(frandom  <= 0.25f)
#line 15415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_MAGE_ATTACK ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = GetModelInstance  () -> GetAnimLength  (idBodyAnim ) * _fAttackLengthMul ;
#line 15421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_attack_time  = _pTimer  -> CurrentTick  ();
#line 15423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = TRUE ;
#line 15425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = pen ;
#line 15426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE )
#line 15427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = UI_SUMMON_START ;i  <= UI_SUMMON_END ;++ i )
#line 15430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSummonUI  * pUISummon  = (CSummonUI  *) pUIManager  -> GetUI  (i );
#line 15432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pSummonEntity  = pUISummon  -> GetSummonEntity  ();
#line 15433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity )
#line 15434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 15436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != ((CSlave  *) pSummonEntity ) -> m_penEnemy )
#line 15438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSummonEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 15440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> bIsActive )
#line 15447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pWildPetEntity  = pInfo  -> GetMyApetInfo  () -> m_pEntity ;
#line 15449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity )
#line 15450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ) && 
#line 15452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_penAttackingEnemy  != ((CWildPet  *) pWildPetEntity ) -> m_penEnemy ))
#line 15453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pWildPetEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 15456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bSingleMode  && m_penAttackingEnemy  -> IsEnemy  ())
#line 15461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (m_penAttackingEnemy );
#line 15466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == HEALER  || 
#line 15467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  == MAGE  || 
#line 15468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  == NIGHTSHADOW  || 
#line 15469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IsEXMage  (iJob )
#line 15470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 15471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , m_penAttackingEnemy  , m_dcEnemies  , 
#line 15474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
5.0f , 4 , 45.0f);
#line 15475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , m_penAttackingEnemy  , m_dcEnemies  , 
#line 15480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
2.0f , 2 , 45.0f);
#line 15481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 15483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 15486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 15487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessageInContainer  (m_dcEnemies );
#line 15489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 15493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 15496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 15497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  -> IsEnemy  ())
#line 15501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) ((CEntity  *) m_penAttackingEnemy )) -> m_nMobDBIndex ;
#line 15503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - m_penAttackingEnemy  -> GetPlacement  () . pl_PositionVector ;
#line 15504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , m_penAttackingEnemy  , vDelta  . Length  ());
#line 15507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == LORD_SYMBOL_INDEX )
#line 15511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackSymbol  ();
#line 15513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessage  (this  , pen  , FALSE );
#line 15517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendAttackMessage  (this  , pen  , FALSE );
#line 15523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SIT  ] 
#line 15528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_STANDUP  ] 
#line 15529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Anim_Face3  
#line 15530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Anim_Face4 )
#line 15531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  state  = 0;
#line 15535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bPersonalShop )
#line 15536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SIT  ])
#line 15538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_SITDOWN  , 1);
#line 15540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_SITDOWN  , 0);
#line 15544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = GetModelInstance  () -> GetAnimLength  (idBodyAnim );
#line 15547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_action_time  = _pTimer  -> CurrentTick  ();
#line 15548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT  ] 
#line 15550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT  ] 
#line 15551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_STANDUP  ] 
#line 15552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_STANDUP  ])
#line 15553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  state  = 0;
#line 15556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bPersonalShop )
#line 15557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_SIT  ] || 
#line 15559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_SIT  ])
#line 15560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_SITDOWN  , 1);
#line 15562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_SITDOWN  , 0);
#line 15566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_action_time  = _pTimer  -> CurrentTick  ();
#line 15569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_MINE  ] 
#line 15571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_COLLECT  ] 
#line 15572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_GATHER  ])
#line 15573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = GetModelInstance  () -> GetAnimLength  (idBodyAnim );
#line 15575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_Product_time  = _pTimer  -> CurrentTick  ();
#line 15576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_PICK  ] 
#line 15578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_PICK  ] 
#line 15579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_0  ] 
#line 15580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_1  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_2  ] 
#line 15581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_3  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_4  ] 
#line 15582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_5  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_6  ] 
#line 15583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_7  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_8  ] 
#line 15584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_9  ] || idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_10  ] 
#line 15585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| idBodyAnim  == idPlayerWhole_Animation  [ ANIM_SOCIAL_11  ]
#line 15594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 15595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = GetModelInstance  () -> GetAnimLength  (idBodyAnim );
#line 15597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_action_time  = _pTimer  -> CurrentTick  ();
#line 15598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_DAMAGE  ] || 
#line 15600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DAMAGE  ] || 
#line 15601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DAMAGE  ] || 
#line 15602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DAMAGE  ])
#line 15603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBodyAnimTime  = GetModelInstance  () -> GetAnimLength  (idBodyAnim );
#line 15605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
start_Damage_time  = _pTimer  -> CurrentTick  ();
#line 15606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 15609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetHitEffect(INDEX idBodyAnim,int nHitType,CEntity * pen,INDEX iAttackType) 
#line 15610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 15616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iJob )
#line 15617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case TITAN : 
#line 15619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  > 0)
#line 15620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , DEF_SOUND_HOLYWATER_HIT  , SOF_3D  | SOF_VOLUMETRIC );
#line 15622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (DEF_CAM_SHAKE  , _pTimer  -> CurrentTick  () , this  -> en_plPlacement  . pl_PositionVector  , FLOAT3D (0 , 0 , 0));
#line 15623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension )
#line 15628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 15630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_AXE_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_AXE_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 15642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_BIGSWORD_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_BIGSWORD_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 15654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HEALER : 
#line 15656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 15657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 15659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension )
#line 15661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 15663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 15665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 15667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "STAFF" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0 , 0.0f , 0.0f , 1);
#line 15670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "STAFF" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0 , 0.0f , 0.0f , 1);
#line 15675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 15680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 15682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 15684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 15698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 15699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 15701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 15702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension )
#line 15704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "STAFF" , pEn  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0 , 0.0f , 0.0f , 1);
#line 15706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pEn  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 15720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MAGE : 
#line 15721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL )
#line 15722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vStartPos ;
#line 15724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qStartRot ;
#line 15725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTag  * pTag  = NULL ;
#line 15727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 15728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("WAND");
#line 15730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  == NULL )
#line 15731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 15733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 15737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 15738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 15741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("LHAND");
#line 15743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 15746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 15747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 15750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 15752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 15755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 15756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 15759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 15761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 15764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 15765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pTag  != NULL );
#line 15769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode  && pen  != NULL  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 15772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 15774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 15776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 15778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall" , 
#line 15782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall" , 
#line 15789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 15795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 15796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 15798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 15799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pEn  , 35.0F , 
#line 15801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall" , 
#line 15802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 15812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case KNIGHT : 
#line 15813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  > 0)
#line 15814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , DEF_SOUND_HOLYWATER_HIT  , SOF_3D  | SOF_VOLUMETRIC );
#line 15816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (DEF_CAM_SHAKE  , _pTimer  -> CurrentTick  () , this  -> en_plPlacement  . pl_PositionVector  , FLOAT3D (0 , 0 , 0));
#line 15817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 15822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_SWORD_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_SWORD_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 15832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ROGUE : 
#line 15835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension )
#line 15836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL )
#line 15838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 15840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 15842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 15844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 15846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 15859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 15860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 15862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 15863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pEn  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 15865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  > 0)
#line 15876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , DEF_SOUND_HOLYWATER_HIT  , SOF_3D  | SOF_VOLUMETRIC );
#line 15878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (DEF_CAM_SHAKE  , _pTimer  -> CurrentTick  () , this  -> en_plPlacement  . pl_PositionVector  , FLOAT3D (0 , 0 , 0));
#line 15879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 15884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAGGER_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAGGER_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 15891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 15896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case SORCERER : 
#line 15897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform  && m_iTransformType  == CTransformInfo  :: TYPE_1 )
#line 15899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL )
#line 15901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vStartPos ;
#line 15903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qStartRot ;
#line 15904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTag  * pTag  = NULL ;
#line 15906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("LHAND");
#line 15908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 15911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 15912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pTag  != NULL );
#line 15915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 15916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode  && pen  != NULL  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 15918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 15920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 15922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 15924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 15925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 15926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || 
#line 15929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || 
#line 15930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ] || 
#line 15931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 15932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "so2_Att02_Missile" , 
#line 15935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
"so2_Att01_Hit" , "so2_Att01_Missile" , 
#line 15941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || 
#line 15949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || 
#line 15950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ] || 
#line 15951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 15952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "so2_Att02_Missile" , 
#line 15955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
"so2_Att01_Hit" , "so2_Att01_Missile" , 
#line 15961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 15968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 15969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 15971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 15972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ] || 
#line 15975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ] || 
#line 15976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_3  ] || 
#line 15977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_3  ])
#line 15978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "so2_Att02_Missile" , 
#line 15981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 15986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
"so2_Att01_Hit" , "so2_Att01_Missile" , 
#line 15987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 15988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 15992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 15996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 15997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 15998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 15999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  > 0)
#line 16000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , DEF_SOUND_HOLYWATER_HIT  , SOF_3D  | SOF_VOLUMETRIC );
#line 16002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (DEF_CAM_SHAKE  , _pTimer  -> CurrentTick  () , this  -> en_plPlacement  . pl_PositionVector  , FLOAT3D (0 , 0 , 0));
#line 16003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 16008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_SWORD_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 16010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_SWORD_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 16015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case NIGHTSHADOW : 
#line 16021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 16023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strMissile  = CTString ("ns_basic");
#line 16025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strHit  = szHitEffect  [ iJob  ] [ nHitType  ];
#line 16027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetWearingEffect  (WEAR_WEAPON  , 1) . Length  () > 0)
#line 16028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMissile  = _pNetwork  -> GetWearingEffect  (WEAR_WEAPON  , 1);
#line 16030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> GetWearingEffect  (WEAR_WEAPON  , 2) . Length  () > 0)
#line 16033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  == 0)
#line 16035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strHit  = _pNetwork  -> GetWearingEffect  (WEAR_WEAPON  , 2);
#line 16037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 16041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 16045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 16046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 16048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 16049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iAttackType )
#line 16051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ATTACK1 : case ATTACK3 : 
#line 16053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case EXT_ATTACK1 : case EXT_ATTACK3 : 
#line 16054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "LHAND" , pen  , 40.0f , strHit  , strMissile  , m_bCriticalDamage  != 0 , 0.0f , 0.0f , 2);
#line 16056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ATTACK2 : case ATTACK4 : 
#line 16059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case EXT_ATTACK2 : case EXT_ATTACK4 : 
#line 16060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , strHit  , strMissile  , m_bCriticalDamage  != 0 , 0.0f , 0.0f , 2);
#line 16062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 16072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 16073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 16075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 16076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(iAttackType )
#line 16078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ATTACK1 : case ATTACK3 : 
#line 16080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case EXT_ATTACK1 : case EXT_ATTACK3 : 
#line 16081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "LHAND" , pen  , 40.0f , strHit  , strMissile  , m_bCriticalDamage  != 0);
#line 16083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ATTACK2 : case ATTACK4 : 
#line 16086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case EXT_ATTACK2 : case EXT_ATTACK4 : 
#line 16087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , strHit  , strMissile  , m_bCriticalDamage  != 0);
#line 16089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 16095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 16102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 16103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXRogue  (iJob ))
#line 16106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension )
#line 16109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL )
#line 16111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 16113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 16115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 16117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 16118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 16119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 16120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 16122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pen  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 16127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 16132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 16133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 16135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 16136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , pEn  , 40.0f , szHitEffect  [ iJob  ] [ nHitType  ] , "Normal Arrow Trace" , m_bCriticalDamage  != 0);
#line 16138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 16141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nHitType  > 0)
#line 16149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , DEF_SOUND_HOLYWATER_HIT  , SOF_3D  | SOF_VOLUMETRIC );
#line 16151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (DEF_CAM_SHAKE  , _pTimer  -> CurrentTick  () , this  -> en_plPlacement  . pl_PositionVector  , FLOAT3D (0 , 0 , 0));
#line 16152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCriticalDamage )
#line 16157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAGGER_CRITICAL ) , SOF_3D  | SOF_VOLUMETRIC );
#line 16159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_DAGGER_BLOW ) , SOF_3D  | SOF_VOLUMETRIC );
#line 16164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsEXMage  (iJob ))
#line 16171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  != NULL  && pen  != NULL )
#line 16173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vStartPos ;
#line 16175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D qStartRot ;
#line 16176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTag  * pTag  = NULL ;
#line 16178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_1  ])
#line 16179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("WAND");
#line 16181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  == NULL )
#line 16182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 16184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 16186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 16188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 16189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_ATTACK_2  ])
#line 16192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("LHAND");
#line 16194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 16195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 16197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 16198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_1  ])
#line 16201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 16203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 16204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 16206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 16207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(idBodyAnim  == idPlayerWhole_Animation  [ ANIM_EXT_ATTACK_2  ])
#line 16210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTag  = this  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("RHAND");
#line 16212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 16213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vStartPos  = pTag  -> CurrentTagInfo  () . m_vPos ;
#line 16215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
qStartRot  = pTag  -> CurrentTagInfo  () . m_qRot ;
#line 16216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (pTag  != NULL );
#line 16219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTag  != NULL )
#line 16220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode  && pen  != NULL  && pen  -> IsFlagOn  (ENF_ALIVE ))
#line 16222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> IsEnemy  ())
#line 16224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pen  -> GetPlacement  () . pl_PositionVector ;
#line 16226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 16227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , pen  , vDelta  . Length  ());
#line 16228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 16229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 16231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall_G" , 
#line 16232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 16233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pen  , 35.0F , 
#line 16238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall_G" , 
#line 16239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 16240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 16245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 16246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pEn  = (* it );
#line 16248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEn  != NULL  && pEn  -> IsFlagOn  (ENF_ALIVE ))
#line 16249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vStartPos  , qStartRot  , pEn  , 35.0F , 
#line 16251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
szHitEffect  [ iJob  ] [ nHitType  ] , "mMissileEnerBall_G" , 
#line 16252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  != 0 , 0);
#line 16253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 16256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCriticalDamage  = FALSE ;
#line 16260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 16265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SpawnTeleport(void) 
#line 16266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 16270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 16271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESpawnEffect  ese ;
#line 16273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . colMuliplier  = C_WHITE  | CT_OPAQUE ;
#line 16274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . betType  = BET_TELEPORT ;
#line 16275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vNormal  = FLOAT3D (0 , 1 , 0);
#line 16276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D box ;
#line 16277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetBoundingBox  (box );
#line 16278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fEntitySize  = box  . Size  () . MaxNorm  () * 2;
#line 16279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fEntitySize  , fEntitySize  , fEntitySize );
#line 16280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer penEffect  = CreateEntity  (GetPlacement  () , CLASS_BASIC_EFFECT  , WLD_AUTO_ENTITY_ID  , FALSE );
#line 16281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEffect  -> Initialize  (ese  , FALSE );
#line 16282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 16285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RenderParticles(void) 
#line 16286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bNotRenderParticles )
#line 16288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 16290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT tmNow  = en_tmEntityTime ;
#line 16295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_EmptyShells  (this  , m_asldData );
#line 16298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_RunningDust  (this );
#line 16301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(FLOAT &) m_fLastBurnTime  = (FLOAT) _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 16302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fBurnLeftTime  > 0)
#line 16303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fRatio  = 1.0f;
#line 16305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fBurnLeftTime  < m_fBurnFadeInTime )
#line 16306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fRatio  = m_fBurnLeftTime  / m_fBurnFadeInTime ;
#line 16308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fBurnTime  - m_fBurnLeftTime  < m_fBurnFadeOutTime )
#line 16310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fRatio  = (m_fBurnTime  - m_fBurnLeftTime ) / m_fBurnFadeOutTime ;
#line 16312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fRatio  *= m_fBurnRatio ;
#line 16314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_Burning  (this  , m_fBurnPower  , fRatio );
#line 16315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fCurrentTime  = (FLOAT) _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 16316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fBurnLeftTime  -= fCurrentTime  - m_fLastBurnTime ;
#line 16317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fBurnLeftTime  < 0.0f)
#line 16318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(FLOAT &) m_fBurnLeftTime  = 0.0f;
#line 16320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(FLOAT &) m_fLastBurnTime  = fCurrentTime ;
#line 16322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Particle_GetViewer  () == this ){
#line 16325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_ViewerLocal  (this );
#line 16326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RenderChainsawParticles  (TRUE );
#line 16332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 16333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_tmSeriousDamage  > tmNow  && m_tmInvulnerability  > tmNow ){
#line 16334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , Max  (m_tmSeriousDamage  , m_tmInvulnerability ) , PT_STAR08  , 0.15f , 2 , 0.03f , 0xff00ff00);
#line 16335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_tmInvulnerability  > tmNow ){
#line 16338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , m_tmInvulnerability  , PT_STAR05  , 0.1f , 7 , 0.03f , 0xff777700);
#line 16339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(m_tmSeriousDamage  > tmNow ){
#line 16341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , m_tmSeriousDamage  , PT_STAR08  , 0.1f , 5 , 0.03f , 0xff777700);
#line 16343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bConnectEffect  && m_penStillTarget  != NULL )
#line 16346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  -> en_RenderType  == RT_SKAMODEL  && m_penStillTarget  -> GetFlags  () & ENF_ALIVE )
#line 16348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTag  * pSource_Tag  = en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("LHAND");
#line 16350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTag  * pDest_Tag  = m_penStillTarget  -> en_pmiModelInstance  -> m_tmSkaTagManager  . Find  ("CENTER");
#line 16352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_Ghostbuster  (pSource_Tag  -> CurrentTagInfo  () . m_vPos  , pDest_Tag  -> CurrentTagInfo  () . m_vPos  , 3 , 1.0f , 1.0f , 33.3333333f 
#line 16353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & m_pSkillTexture );
#line 16354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = FALSE ;
#line 16358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillTexture  . SetData  (NULL );
#line 16359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachPlayerEffect  , 0.1f);
#line 16360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachEnemyEffect  , 0.1f);
#line 16361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSpeedUp )
#line 16365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_RunAfterBurner  (this  , m_tmSeriousSpeed  , 0.3f , 0);
#line 16367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 16369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerWeapons  * wpn  = GetPlayerWeapons  ();
#line 16380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_tmSpiritStart  != 0.0f)
#line 16386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_Appearing  (this  , m_tmSpiritStart );
#line 16388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 16391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::TeleportToAutoMarker(CPlayerActionMarker * ppam) 
#line 16392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 16396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 16397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * ppl  = (CPlayer  *) GetPlayerEntity  (iPlayer );
#line 16398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ppl  != NULL ){
#line 16400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D pl  = ppam  -> GetPlacement  ();
#line 16401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = ppl  -> GetTeleportingOffset  ();
#line 16402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pl  . pl_PositionVector  += vOffsetRel  * ppam  -> en_mRotation ;
#line 16403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppl  -> Teleport  (pl  , FALSE );
#line 16405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppl  -> m_vDied  = pl  . pl_PositionVector ;
#line 16406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppl  -> m_aDied  = pl  . pl_OrientationAngle ;
#line 16407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 16412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D pl  = ppam  -> GetPlacement  ();
#line 16413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = GetTeleportingOffset  ();
#line 16414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pl  . pl_PositionVector  += vOffsetRel  * ppam  -> en_mRotation ;
#line 16415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Teleport  (pl  , FALSE );
#line 16416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 16420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::CheckDeathForRespawnInPlace(EPlayerDeath ePLDeath) 
#line 16421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bRespawnInPlace ){
#line 16425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 16426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penKiller  = (CEntity  *) ePLDeath  . eidInflictor ;
#line 16429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsOfClass  (penKiller  , & CPlayer_DLLClass ) 
#line 16430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| IsDerivedFromClass  (penKiller  , & CEnemyBase_DLLClass ))
#line 16431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_RESPAWNINPLACE ;
#line 16434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDied  = GetPlacement  () . pl_PositionVector ;
#line 16435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_aDied  = GetPlacement  () . pl_OrientationAngle ;
#line 16436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
ULONG CPlayer::SetDesiredMovement() 
#line 16444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulFlags  = 0;
#line 16449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL m_bFirstRotate  = TRUE ;
#line 16452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 16453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDeltaTmp  = vDelta ;
#line 16455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL  && 
#line 16456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  == this )
#line 16457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bKeyMove )
#line 16460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return 0;
#line 16462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penEnt  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 16466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 16468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 16471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && (penTarget  -> GetFirstExFlags  () & (ENF_EX1_CURRENT_PET  | ENF_EX1_CURRENT_SLAVE  | ENF_EX1_CURRENT_WILDPET )))
#line 16472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && (unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 16474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 16476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  != NULL  && 
#line 16480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(((penTarget  -> IsCharacter  ()) && 
#line 16481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(((IsPvp  () || _pUISWDoc  -> IsWar  () || IsLegitTarget  (penEnt ) || 
#line 16482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildBattle  () -> IsEnemy  (penTarget  -> en_ulID )) && vDelta  . Length  () < 2.0f) || 
#line 16483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(! IsPvp  () && ! (pUIManager  -> GetGuildBattle  () -> IsEnemy  (penTarget  -> en_ulID )) && vDelta  . Length  () < 1.0f))) 
#line 16484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| vDelta  . Length  () < 0.5f))
#line 16485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 16487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopRotating  ();
#line 16488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopTranslating  ();
#line 16490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 16493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && _cmiComm  . IsNetworkOn  ())
#line 16494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 16496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return 0.0f;
#line 16498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ))
#line 16503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 16505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 16507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_bForward  || m_bKeyMove ))
#line 16512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 16514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vMyPositionTmp  = GetPlacement  () . pl_PositionVector ;
#line 16515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aWantedHeadingRelative ;
#line 16520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_aRotateSpeed  > 0.0f && m_bFirstRotate )
#line 16521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDir ;
#line 16528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDir  = vDelta ;
#line 16530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDir  . SafeNormalize  ();
#line 16533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aWantedHeadingRelative  = GetRelativeHeading  (vDir );
#line 16536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aWantedHeadingRelative  = NormalizeAngle  (aWantedHeadingRelative );
#line 16538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aHeadingRotation ;
#line 16540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aWantedHeadingRelative  < - m_aRotateSpeed  * m_fMoveFrequency )
#line 16541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = - (m_aRotateSpeed  * m_fMoveFrequency );
#line 16545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(aWantedHeadingRelative  > m_aRotateSpeed  * m_fMoveFrequency )
#line 16546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = + (m_aRotateSpeed  * m_fMoveFrequency );
#line 16550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = aWantedHeadingRelative  / m_fMoveFrequency ;
#line 16555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_aHeadingRotation  = aHeadingRotation ;
#line 16562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (aHeadingRotation  , 0 , 0));
#line 16564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (aHeadingRotation ) > 1.0f)
#line 16565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulFlags  |= MF_ROTATEH ;
#line 16567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (aWantedHeadingRelative ) <= 1.0f)
#line 16572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bFirstRotate  = FALSE ;
#line 16576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotating  = FALSE ;
#line 16577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = TRUE ;
#line 16578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bFirstRotate )
#line 16579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = FALSE ;
#line 16581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return 0;
#line 16584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotating  = TRUE ;
#line 16589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0 , 0 , 0));
#line 16594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fMoveSpeed  > 0.0f && ! m_bFirstRotate )
#line 16621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulFlags  |= MF_MOVEZ ;
#line 16623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0 , 0 , 0));
#line 16629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ulFlags ;
#line 16632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 16636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckTarget() 
#line 16637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bStuned ){return FALSE ;}
#line 16643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bDying )
#line 16644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bInit  = FALSE ;
#line 16649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bInit )
#line 16650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 16652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bInit  = TRUE ;
#line 16653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && ! m_bLockMove  && ! m_bHold )
#line 16656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  *) & * m_penView ) -> UnlockRotate  ();
#line 16658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ))
#line 16659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 16662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 16667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 16669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penClickTarget  != penTarget )
#line 16670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> DoesMessageBoxExist  (MSGCMD_CONFIRM_OBJECTCLICK ))
#line 16672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CloseMessageBox  (MSGCMD_CONFIRM_OBJECTCLICK );
#line 16674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penClickTarget  . ep_pen  = NULL ;
#line 16677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 16680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 16682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetType  () == CSkill  :: STT_SELF_ONE  
#line 16683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| SkillData  . GetTargetType  () == CSkill  :: STT_SELF_RANGE  
#line 16684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| SkillData  . GetTargetType  () == CSkill  :: STT_PARTY_ALL  
#line 16685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ALL  
#line 16686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_SELF_RANGE  
#line 16687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_MEMBER_SELF )
#line 16688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  == this )
#line 16694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bKeyMove )
#line 16697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 16703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> GetFirstExFlags  () & (ENF_EX1_CURRENT_PET  | ENF_EX1_CURRENT_SLAVE  | ENF_EX1_CURRENT_WILDPET  | ENF_EX1_TOTEM  | ENF_EX1_TRAP  | ENF_EX1_SUICIDE ))
#line 16706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> GetFlags  () & ENF_ALIVE  && penTarget  -> IsEnemy  () 
#line 16712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ! (penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_NPC )) 
#line 16713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ! (penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_PRODUCTION )) 
#line 16714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ! (_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ))
#line 16716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 16717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * pMD  = CMobData  :: getData  (((CEnemy  *) penTarget ) -> m_nMobDBIndex );
#line 16720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pMD  == NULL )
#line 16721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING  && m_bKeyMove )
#line 16727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsRvrZone  () == TRUE  && 
#line 16733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . iSyndicateType  == pMD  -> GetSyndicateType  ())
#line 16734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bKeyMove  == TRUE )
#line 16737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 16744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_MONSTER_MERCENARY )) || (penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_TOTEM_ITEM )))
#line 16749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL isAttackCheck  = TRUE ;
#line 16752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  () == FALSE )
#line 16753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
isAttackCheck  = FALSE ;
#line 16755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ownerIndex  = 0;
#line 16759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObjectByCIndex  (eOBJ_MOB  , penTarget  -> en_ulID );
#line 16761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 16762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pMT  = static_cast  < CMobTarget  * > (pObject );
#line 16764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ownerIndex  = pMT  -> mob_iOwnerIndex ;
#line 16765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ownerIndex  == _pNetwork  -> MyCharacterInfo  . index )
#line 16768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
isAttackCheck  = FALSE ;
#line 16770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(isAttackCheck  == FALSE )
#line 16774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bKeyMove  == TRUE )
#line 16777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 16783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 16790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 16791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 16792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScaledSize  = pMD  -> GetScaledSize  ();
#line 16794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 16797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fAttackDistance  = GetAttackrange  ();
#line 16798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fAttackDistance  += fScaledSize ;
#line 16801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < fAttackDistance  && ! IsAttacking  () && m_nCurrentSkillNum  == - 1)
#line 16802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 16804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 16806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 16809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penTarget ))
#line 16810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 16812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2086 , "가로막혀서 공격할수 없습니다."));
#line 16813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 16815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 16816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 16818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , penTarget  , vDelta  . Length  ());
#line 16823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 16824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartAttack  ();
#line 16826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 16830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsAttacking  ())
#line 16836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 1800.0f , TRUE );
#line 16838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAttacking  ())
#line 16843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 16845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () >= 2.0f && ! m_bHold )
#line 16848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_bForward  || m_bKeyMove ))
#line 16850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 16852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 16856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 16858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 16860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && (unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 16861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 16863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 16869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 16871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_PRODUCTION ))
#line 16876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDLLEntityClass  * pdecDLLClass  = penTarget  -> GetClass  () -> ec_pdecDLLClass ;
#line 16879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityProperty  & epProperty  = * pdecDLLClass  -> PropertyForTypeAndID  (CEntityProperty  :: EPT_INDEX  , 91);
#line 16880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iMobIndex  = ENTITYPROPERTY  (& * penTarget  , epProperty  . ep_slOffset  , INDEX);
#line 16881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == - 1)
#line 16882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 16887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 16888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 16890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () > (MD  -> GetAttackDistance  () * 0.9f) && _cmiComm  . IsNetworkOn  ())
#line 16891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && penTarget  -> IsEnemy  () && (penTarget  -> GetFlags  () & ENF_ALIVE ))
#line 16896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 360.0f , TRUE );
#line 16898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 16901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 16903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 16905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 16910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsCollectQuest  ())
#line 16911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = TRUE ;
#line 16913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = 4;
#line 16914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSelectResource  () -> OpenSelectResource  (penTarget  -> en_ulID  , m_nProductionNum );
#line 16915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_SHIELD  ] . IsEmptyItem  () == FALSE )
#line 16921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 16923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (696 , "방패를 장착하고서 생산을 할 수 없습니다."));
#line 16924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 16925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide  || m_bWildRide )
#line 16931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 16933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (3074 , "애완동물을 타고서 생산을 할 수 없습니다."));
#line 16934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 16935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nProduceType ;
#line 16939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strItemName ;
#line 16941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsEnergy  ())
#line 16942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nProduceType  = CItemData  :: ITEM_WEAPON_CHARGE ;
#line 16944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsCrops  ())
#line 16946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nProduceType  = CItemData  :: ITEM_WEAPON_GATHERING ;
#line 16948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsMineral  ())
#line 16950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nProduceType  = CItemData  :: ITEM_WEAPON_MINING ;
#line 16952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  :: _map  :: iterator  iter  = CItemData  :: getmapPtr  () -> begin  ();
#line 16956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  :: _map  :: iterator  eiter  = CItemData  :: getmapPtr  () -> end  ();
#line 16958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;iter  != eiter ;++ iter )
#line 16959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = (* iter ) . second ;
#line 16961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  == NULL )
#line 16962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
continue ;
#line 16964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const char  * szItemName  = _pNetwork  -> GetItemName  (pItemData  -> getindex  ());
#line 16968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  -> GetType  () == CItemData  :: ITEM_WEAPON )
#line 16969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  -> GetSubType  () == nProduceType )
#line 16971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  -> GetJob  () & (1 << _pNetwork  -> MyCharacterInfo  . job ))
#line 16973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strItemName  = szItemName ;
#line 16975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == TRUE )
#line 16982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 16983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 16984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (697 , "생산도구를 장착하지 않았습니다."));
#line 16985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 16987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (788 , "%s를 착용하여 주십시오,") , strItemName );
#line 16988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 16990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 16991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 16993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iWeaponType  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  ();
#line 16996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (iWeaponType  == CItemData  :: ITEM_WEAPON_MINING  || 
#line 16997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_GATHERING  || 
#line 16998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_CHARGE ))
#line 16999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 17001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (697 , "생산도구를 장착하지 않았습니다."));
#line 17002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (788 , "%s를 착용하여 주십시오,") , strItemName );
#line 17005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((iWeaponType  == CItemData  :: ITEM_WEAPON_MINING ) && MD  -> IsMineral  ())
#line 17015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = TRUE ;
#line 17017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = 1;
#line 17018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSelectResource  () -> OpenSelectResource  (penTarget  -> en_ulID  , m_nProductionNum );
#line 17019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((iWeaponType  == CItemData  :: ITEM_WEAPON_GATHERING ) && MD  -> IsCrops  ())
#line 17022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = TRUE ;
#line 17024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = 2;
#line 17025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSelectResource  () -> OpenSelectResource  (penTarget  -> en_ulID  , m_nProductionNum );
#line 17026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((iWeaponType  == CItemData  :: ITEM_WEAPON_CHARGE ) && MD  -> IsEnergy  ())
#line 17029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = TRUE ;
#line 17031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = 3;
#line 17032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSelectResource  () -> OpenSelectResource  (penTarget  -> en_ulID  , m_nProductionNum );
#line 17033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 17037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (701 , "생산도구가 올바르지 않습니다."));
#line 17038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (788 , "%s를 착용하여 주십시오,") , strItemName );
#line 17041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_CLICK_OBJECT ))
#line 17056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 17060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D box ;
#line 17061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTarget  -> GetBoundingBox  (box );
#line 17062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fBBoxLength  = box  . Size  () . Length  () / 2 + 1.0f;
#line 17065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bKeyMove  && pUIManager  -> DoesMessageBoxExist  (MSGCMD_CONFIRM_OBJECTCLICK ))
#line 17066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CloseMessageBox  (MSGCMD_CONFIRM_OBJECTCLICK );
#line 17068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penClickTarget  = NULL ;
#line 17069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> DoesMessageBoxExist  (MSGCMD_CONFIRM_OBJECTCLICK ) && (! m_bSendStopMessage ))
#line 17073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () <= fBBoxLength  && ! pUIManager  -> DoesMessageBoxExist  (MSGCMD_CONFIRM_OBJECTCLICK ) 
#line 17079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& m_penClickTarget  != penTarget  && _pInput  -> IsLMouseButtonPressed  ())
#line 17080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIMsgBox_Info  MsgBoxInfo ;
#line 17083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (_S  (191 , "확인") , UMBS_YESNO  , UI_NONE  , MSGCMD_CONFIRM_OBJECTCLICK );
#line 17084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . AddString  (_S  (4683 , "클릭 하시겠습니까?"));
#line 17086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CreateMessageBox  (MsgBoxInfo );
#line 17087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penClickTarget  = penTarget ;
#line 17088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(vDelta  . Length  () > fBBoxLength )
#line 17090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> DoesMessageBoxExist  (MSGCMD_CONFIRM_OBJECTCLICK ))
#line 17092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CloseMessageBox  (MSGCMD_CONFIRM_OBJECTCLICK );
#line 17094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penClickTarget  = NULL ;
#line 17096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> GetFlags  () & ENF_ITEM  && ! (_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 17101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 17106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = FLOAT3D (1000.0f , 0.0f , 0.0f);
#line 17108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_ITEM  , penTarget  -> GetNetworkID  ());
#line 17110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 17111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemTarget  * pTarget  = static_cast  < CItemTarget  * > (pObject );
#line 17114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbLayerDiff  = pObject  -> GetyLayer  () - _pNetwork  -> MyCharacterInfo  . yLayer ;
#line 17116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbLayerDiff  < - 1 || sbLayerDiff  > 1)
#line 17117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 17119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1007 , "현재의 위치에서 줍지 못하는 아이템입니다."));
#line 17120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 17122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  = GetPlacement  () . pl_PositionVector  - pTarget  -> item_place ;
#line 17133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 17138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () <= 2.0f)
#line 17139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ))
#line 17150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 17156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = ACTION_NUM_PICKITEM ;
#line 17157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PickItem  (penTarget  -> GetNetworkID  ());
#line 17158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((penTarget  -> GetFlags  () & ENF_ALIVE ) && (penTarget  -> IsCharacter  ()) && ! m_bKeyMove )
#line 17172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 17175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - ((CCharacterBase  *) penTarget ) -> GetPlacement  () . pl_PositionVector ;
#line 17176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 17178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsRvrZone  () && ! IsPvp  () && ! _pUISWDoc  -> IsWar  () && ! IsLegitTarget  (penTarget ) && ! (pUIManager  -> GetGuildBattle  () -> IsEnemy  (penTarget  -> en_ulID )) 
#line 17179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ! pUIManager  -> GetSiegeWarfareNew  () -> GetWarState  ())
#line 17180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < 1.0f && ! m_bSendStopMessage )
#line 17183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bClicked  = false ;
#line 17194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  cha_index  = - 1;
#line 17195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  cha_shoptype  = 0;
#line 17197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObjectByCIndex  (eOBJ_CHARACTER  , penTarget  -> en_ulID );
#line 17199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 17200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 17203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cha_index  = pTarget  -> m_nIdxServer ;
#line 17204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cha_shoptype  = pTarget  -> cha_sbShopType ;
#line 17205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(cha_shoptype  != PST_NOSHOP )
#line 17209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbShopType  == PST_NOSHOP )
#line 17211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPersonalShop  () -> TradePersonalShop  (cha_index  , 0.0f , 0.0f , TRUE );
#line 17213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! m_bHold )
#line 17220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () >= 1.0f && ! (m_bSkilling  && m_bStartAttack ))
#line 17222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_bForward ))
#line 17225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 17227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < 8.0f && ! m_bClicked  && ! (ulNewButtons  & PLACT_FIRE ))
#line 17230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 17236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bClicked  = true ;
#line 17238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 17242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward ) && (unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 17243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 17245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(vDelta  . Length  () < 1.0f && ! (m_bSkilling  && m_bStartAttack ))
#line 17253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bClicked  = false ;
#line 17256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(vDelta  . Length  () > 30.0f && ! (m_bSkilling  && m_bStartAttack ))
#line 17261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bClicked  = false ;
#line 17264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fAttackDistance  = GetAttackrange  ();
#line 17272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 17275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < fAttackDistance  && ! IsAttacking  () && m_nCurrentSkillNum  == - 1)
#line 17276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penTarget ))
#line 17284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 17286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2086 , "가로막혀서 공격할수 없습니다."));
#line 17287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 17290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , penTarget  , vDelta  . Length  ());
#line 17297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 17298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartAttack  ();
#line 17300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsAttacking  ())
#line 17310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 1800.0f , TRUE );
#line 17312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! m_bHold )
#line 17315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAttacking  ())
#line 17317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () > 2.0f)
#line 17322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_bForward  || m_bKeyMove ))
#line 17325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 17327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 17331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 17335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && (unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 17336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 17338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsPet  () || penTarget  -> IsSlave  () || penTarget  -> IsWildPet  ())
#line 17352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 17356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fAttackDistance  = GetAttackrange  ();
#line 17358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 17361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < fAttackDistance  && ! IsAttacking  () && m_nCurrentSkillNum  == - 1)
#line 17362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penTarget ))
#line 17370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 17372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  ("가로막혀서 공격할수 없습니다.");
#line 17373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 17375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 17376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bAttack  = CheckAttackTarget  (- 1 , penTarget  , 0.0f);
#line 17383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAttack )
#line 17384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartAttack  ();
#line 17386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsAttacking  ())
#line 17396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 1800.0f , TRUE );
#line 17398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAttacking  ())
#line 17403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () >= 2.0f && ! m_bHold )
#line 17408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_bForward  || m_bKeyMove ))
#line 17410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 17412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 17416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 17420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((m_bForward  || m_bKeyMove ) && (unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 1000)
#line 17421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendMyNextMovePosition  (vDelta );
#line 17423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_NPC ))
#line 17435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 17439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CDLLEntityClass  * pdecDLLClass  = penTarget  -> GetClass  () -> ec_pdecDLLClass ;
#line 17440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityProperty  & epProperty  = * pdecDLLClass  -> PropertyForTypeAndID  (CEntityProperty  :: EPT_INDEX  , 91);
#line 17441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iMobIndex  = ENTITYPROPERTY  (& * penTarget  , epProperty  . ep_slOffset  , INDEX);
#line 17443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == - 1)
#line 17444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iVirIdx  = penTarget  -> GetNetworkID  ();
#line 17449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 17450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vNpcPos  = penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 17451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - vNpcPos ;
#line 17453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 17456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 17457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTarget  -> GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 17459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f * 0.4f;
#line 17461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  fLength  = vRadius  . Length  () + 5.0f;
#line 17464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () >= (fLength ) && _cmiComm  . IsNetworkOn  ())
#line 17465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , penTarget  -> en_lNetworkID );
#line 17472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 17473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  -> GetType  () != iMobIndex )
#line 17475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsRvrZone  () && MD  -> GetSyndicateType  () != _pNetwork  -> MyCharacterInfo  . iSyndicateType )
#line 17481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (6090 , "분쟁 지역에서 적대 관계인 경우 사용할 수 없는 기능입니다") , SYSMSG_ERROR );
#line 17486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == 244)
#line 17492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . lGuildLevel  < 4)
#line 17498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildStash  () -> Message  (MSGCMD_NULL  , CTString (_S  (2556 , "길드 레벨 3이하는 창고를 소유할 수 없습니다.")) , UMBS_OK );
#line 17500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildStash  () -> OpenGuildStash  ();
#line 17504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  >= 240 && iMobIndex  <= 243)
#line 17508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildWarPortal  () -> OpenGuildWarPortal  (iMobIndex );
#line 17513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  >= 382 && iMobIndex  <= 386)
#line 17518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetGuildWarPortal  () -> IsVisible  ())
#line 17523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGuildWarPortal  () -> SetPortalIdx  (iMobIndex );
#line 17529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> SendDratanPortalMessage  (iMobIndex );
#line 17530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsZoneMoving  () && ! m_bHold )
#line 17535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 17537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pUIManager  -> GetPortal  () -> IsVisible  ())
#line 17538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityProperty  & epPropertyZone  = * pdecDLLClass  -> PropertyForTypeAndID  (CEntityProperty  :: EPT_ZONEFLAGS_EX  , 237);
#line 17540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityProperty  & epPropertyExtra  = * pdecDLLClass  -> PropertyForTypeAndID  (CEntityProperty  :: EPT_ZONEFLAGS_EX  , 238);
#line 17541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ZONEFLAGS  ulZoneFlag  = ENTITYPROPERTY  (& * penTarget  , epPropertyZone  . ep_slOffset  , ZONEFLAGS );
#line 17542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ZONEFLAGS  ulExtraFlag  = ENTITYPROPERTY  (& * penTarget  , epPropertyExtra  . ep_slOffset  , ZONEFLAGS );
#line 17544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPortal  () -> ResetZoneList  ();
#line 17546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < sizeof  (ZONEFLAGS ) * 8 && i  < CZoneInfo  :: getSingleton  () -> GetZoneCount  ();++ i )
#line 17547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (ulZoneFlag  & (((ZONEFLAGS ) 1) << i ))){continue ;}
#line 17550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX j  = 0;j  < sizeof  (ZONEFLAGS ) * 8 && j  < CZoneInfo  :: getSingleton  () -> GetExtraCount  (i );++ j )
#line 17551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (ulExtraFlag  & (((ZONEFLAGS ) 1) << j ))){continue ;}
#line 17553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPortal  () -> AddToZoneList  (i  , j );
#line 17554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPortal  () -> SetNpcIdx  (MD  -> GetMobIndex  ());
#line 17555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> GetMobIndex  () == 468)
#line 17560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPortal  () -> SetNpcIdx  (MD  -> GetMobIndex  ());
#line 17563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_PORTAL  , vNpcPos  (1) , vNpcPos  (3));
#line 17564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pUIManager  -> GetPortal  () -> GetZoneListCount  ())
#line 17566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPortal  () -> OpenPortal  (vNpcPos  (1) , vNpcPos  (3));
#line 17568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> GetMobIndex  () == 482)
#line 17575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbShopType  == PST_NOSHOP )
#line 17577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPersonalShop  () -> TradePersonalShop  (MD  -> GetOwnerIndex  () , 0.0f , 0.0f , TRUE );
#line 17579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 17580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsAffinityNPC  ())
#line 17584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetAffinity  () -> OpenAffinity  (MD  -> GetMobIndex  () , NULL  , vNpcPos  (1) , vNpcPos  (3));
#line 17589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> GetMobIndex  () == 1106)
#line 17593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> OpenSocketSystem  (MD  -> GetMobIndex  () , NULL  , vNpcPos  (1) , vNpcPos  (3));
#line 17598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> GetMobIndex  () == 1254)
#line 17602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetRadar  () -> OpenRoyalrumbleMgrMenu  (MD  -> GetMobIndex  ());
#line 17607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> GetMobIndex  () == 1261)
#line 17611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChangeWeapon  () -> OpenChangeWeapon  (iMobIndex  , UI_CHANGEWEAPON  , vNpcPos  (1) , vNpcPos  (3));
#line 17616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> GetMobIndex  () == 1200 || MD  -> GetMobIndex  () == 1198)
#line 17621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_SKILLLEARN  , vNpcPos  (1) , vNpcPos  (3));
#line 17627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsShopper  ())
#line 17631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_SHOP  , vNpcPos  (1) , vNpcPos  (3));
#line 17636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsWareHouse  ())
#line 17640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_WARE_HOUSE  , vNpcPos  (1) , vNpcPos  (3));
#line 17645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsRefiner  ())
#line 17649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_REFINE  , vNpcPos  (1) , vNpcPos  (3));
#line 17654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsGuild  ())
#line 17658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_GUILD  , vNpcPos  (1) , vNpcPos  (3));
#line 17663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsResetStat  ())
#line 17667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_INITJOB  , vNpcPos  (1) , vNpcPos  (3));
#line 17672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsChangeWeapon  ())
#line 17676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_CHANGEWEAPON  , vNpcPos  (1) , vNpcPos  (3));
#line 17681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsWarCastle  ())
#line 17685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  tQtr ;
#line 17692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == DRATAN_MASTER_TOWER_INDEX )
#line 17693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_WAR  && 
#line 17696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  == WCJF_OWNER )
#line 17697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuest  () -> OpenQuest  (iMobIndex  , iVirIdx  , FALSE  , vNpcPos  (1) , vNpcPos  (3));
#line 17699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == DRATAN_LORD_SYMBOL_INDEX )
#line 17702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_WAR  && 
#line 17705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  == WCJF_ATTACK_GUILD  && 
#line 17706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! _pNetwork  -> MyCharacterInfo  . bConsensus )
#line 17707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> SendConsensus  ((UBYTE ) MSG_CASTLE_CRISTAL_RESPOND_START );
#line 17709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((tQtr  = MD  -> IsMyQuarter  ()) != QUARTER_NONE )
#line 17712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tQtr  == QUARTER_INSTALL  && _pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  == WCJF_ATTACK_GUILD )
#line 17714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> CreateBuyQuarterBox  (MD  -> GetMobIndex  ());
#line 17716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_SIEGE_WARFARE  , vNpcPos  (1) , vNpcPos  (3));
#line 17722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsCastleTower  ())
#line 17728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  == WCJF_OWNER )
#line 17734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> GetMobIndex  () == 388 || 
#line 17737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MD  -> GetMobIndex  () == 389 || 
#line 17738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MD  -> GetMobIndex  () == 404)
#line 17739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> SendTowerRepairStateRequest  (MD  -> GetMobIndex  ());
#line 17744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsSkillMaster  ())
#line 17749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_SKILLLEARN  , vNpcPos  (1) , vNpcPos  (3));
#line 17754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsSSkillMaster  ())
#line 17758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> GetSpecialSkillMaster  () == SSKILL_PROCESS_NPC )
#line 17760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_PROCESSNPC  , vNpcPos  (1) , vNpcPos  (3));
#line 17765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_SKILLLEARN  , vNpcPos  (1) , vNpcPos  (3));
#line 17774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsMakeItemNPC  ())
#line 17779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_PRODUCTNPC  , vNpcPos  (1) , vNpcPos  (3));
#line 17784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsQuest  ())
#line 17788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_QUEST  , vNpcPos  (1) , vNpcPos  (3));
#line 17793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 192)
#line 17799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_GAMBLE  , vNpcPos  (1) , vNpcPos  (3));
#line 17804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGamble  () -> OpenGamble  (penTarget );
#line 17805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 271)
#line 17810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetGamble  () -> OpenGamble  (penTarget  , TRUE );
#line 17816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 1374)
#line 17821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_GameDataManagerPtr  () -> GetExpressData  () -> SetNPCInfo  (iMobIndex  , vNpcPos  (1) , vNpcPos  (3));
#line 17826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 1520)
#line 17831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetReformSystem  () -> OpenReformSystem  (iMobIndex  , vNpcPos  (1) , vNpcPos  (3));
#line 17836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 253 || iMobIndex  == 1032 || iMobIndex  == 1191 || iMobIndex  == 1201)
#line 17840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_PET_TRAINING  , vNpcPos  (1) , vNpcPos  (3));
#line 17845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iMobIndex  == 32 || iMobIndex  == 88 || iMobIndex  == 160 || iMobIndex  == 343)
#line 17850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> RearrangeOrder  (UI_NPCHELP  , TRUE );
#line 17855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(MD  -> IsPeaceful  ())
#line 17859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bSingleMode )
#line 17861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward )
#line 17863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CEnemy  *) penTarget ) -> m_EventType  == EVENT_MOBCLICK )
#line 17868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CEnemy  *) penTarget ) -> ClickedEvent  ();
#line 17870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetQuestAccept  () -> RequestQuest  (iMobIndex  , iVirIdx  , UI_CHARACTERINFO  , vNpcPos  (1) , vNpcPos  (3));
#line 17874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(! m_bHold  && 
#line 17883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! ((_pNetwork  -> MyCharacterInfo  . job  == ROGUE  && IsAnimationPlaying  (iDeathMotion ) && 
#line 17884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pTimer  -> GetLerpedCurrentTick  () - m_tmSkillStartTime ) < en_pmiModelInstance  -> GetAnimLength  (iDeathMotion ))))
#line 17885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelProduct  ();
#line 17888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAttacking  ())
#line 17889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != NULL ){
#line 17891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = m_vDesiredPosition  - GetPlacement  () . pl_PositionVector ;
#line 17899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> IsEnemy  () && ! (penTarget  -> GetFlags  () & ENF_ALIVE ))
#line 17900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < 2.0f)
#line 17903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 17912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bFirstRotate )
#line 17913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bFinished  = TRUE ;
#line 17915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bFinished  = Rotate  (g_bTargetDirection  , 1800.0f , TRUE );
#line 17916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bFinished )
#line 17917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = FALSE ;
#line 17919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < 0.5f)
#line 17931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 17933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 17935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bIsRotateEnd  = FALSE ;
#line 17942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bFirstRotate )
#line 17943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bFinished  = TRUE ;
#line 17945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bFinished  = Rotate  (g_bTargetDirection  , 1800.0f , TRUE );
#line 17946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bFinished )
#line 17947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bFirstRotate  = FALSE ;
#line 17949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 17956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 17961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAttacking  ())
#line 17963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != NULL )
#line 17966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 17970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 17973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 17976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 17978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopAttack() 
#line 17979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 17981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 17983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StartAttack() 
#line 17984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE )
#line 17986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetSystemMenu  () -> CancelRestart  ();
#line 17988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange )
#line 17991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 17992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 17993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 17995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = TRUE ;
#line 17996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 17998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsAttacking() 
#line 17999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bStartAttack ;
#line 18001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsProduct() 
#line 18004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bProduction ;
#line 18006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopMove() 
#line 18009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward  || m_bKeyMove )
#line 18011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 18013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 18014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  BOOL _bLoginProcess ;
#line 18015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_cmiComm  . IsNetworkOn  () && ! _bLoginProcess )
#line 18016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SE_Get_UIManagerPtr  () -> IsCSFlagOn  (CSF_CANNOT_MOVE_MASK ) && ! m_bSendStopMessage )
#line 18018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmStartTime  > 0.001f)
#line 18021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendStopMessage  (this  , GetPlacement  ());
#line 18023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 18024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SE_Get_UIManagerPtr  () -> GetSelectResource  () -> GetKeyMove  ())
#line 18027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> GetSelectResource  () -> SetKeyMove  (true );
#line 18029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = TRUE ;
#line 18031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 18035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vMyPositionTmp  = GetPlacement  () . pl_PositionVector ;
#line 18036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopRotating  ();
#line 18037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopTranslating  ();
#line 18039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitClick  != NULL )
#line 18040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitClick  = NULL ;
#line 18042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CEffectGroupManager  :: Instance  () . IsValidCreated  (m_pPickingEffectGroup ))
#line 18045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  -> Stop  (PICKING_EFFECT_REMAIN_TIME );
#line 18047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  = NULL ;
#line 18048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::ClearMove() 
#line 18053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 18055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 18057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 18058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopMoveNoSendStopMsg() 
#line 18061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 18063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 18064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 18065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vMyPositionTmp  = GetPlacement  () . pl_PositionVector ;
#line 18066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopRotating  ();
#line 18067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopTranslating  ();
#line 18069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitClick  != NULL )
#line 18070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitClick  = NULL ;
#line 18072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CEffectGroupManager  :: Instance  () . IsValidCreated  (m_pPickingEffectGroup ))
#line 18074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  -> Stop  (PICKING_EFFECT_REMAIN_TIME );
#line 18076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pPickingEffectGroup  = NULL ;
#line 18077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PickItem(ULONG targetindex) 
#line 18081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 18083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendPickMessage  (this  , (ULONG ) targetindex  , TRUE );
#line 18088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::PlayItemSound(BOOL bPick,BOOL bMoney) 
#line 18091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bPick )
#line 18093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_PICK_ITEM  , SOF_3D  | SOF_VOLUMETRIC );
#line 18095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMoney )
#line 18099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_DROP_MONEY  , SOF_3D  | SOF_VOLUMETRIC );
#line 18101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_DROP_ITEM  , SOF_3D  | SOF_VOLUMETRIC );
#line 18105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayButtonSound() 
#line 18110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_BUTTON_CLICK  , SOF_3D  | SOF_VOLUMETRIC );
#line 18112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayJewelDullSound() 
#line 18115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_JEWEL_DULL  , SOF_3D  | SOF_VOLUMETRIC );
#line 18117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayJewelRefinementSound() 
#line 18120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_JEWEL_REFINEMENT  , SOF_3D  | SOF_VOLUMETRIC );
#line 18122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayJewelShinySound() 
#line 18125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_JEWEL_SHINY  , SOF_3D  | SOF_VOLUMETRIC );
#line 18127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayPetStashEffectSound() 
#line 18130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_PETSTASH_CARD  , SOF_3D  | SOF_VOLUMETRIC );
#line 18132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayPetStashCardSelSound() 
#line 18135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_PETSTASH_CARD_SELECT  , SOF_3D  | SOF_VOLUMETRIC );
#line 18137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayHolyWaterSound() 
#line 18140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_UI_HOLYWATER  , SOF_3D  | SOF_VOLUMETRIC );
#line 18142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::PlayItemEffect(SLONG itemindex,SBYTE effecttype) 
#line 18145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(itemindex  != - 1)
#line 18148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(itemindex )
#line 18150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 391: 
#line 18152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 18153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_POTION  , SOF_3D  | SOF_VOLUMETRIC );
#line 18154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::DetectFloorHit(FLOAT deltaX,FLOAT deltaY,FLOAT deltaZ,CPlacement3D & plPlacement) 
#line 18186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRayHit ;
#line 18189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 18190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) + deltaX  , 300.0f , GetPlacement  () . pl_PositionVector  (3) + deltaZ );
#line 18192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fMaxY  = - 9999999.0f;
#line 18196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vSource  = plPlacement  . pl_PositionVector ;
#line 18197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTarget  = vSource ;
#line 18198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTarget  (2) -= 1000.0f;
#line 18199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCastRay  crRay  (this  , vSource  , vTarget );
#line 18200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_ttHitModels  = CCastRay  :: TT_NONE ;
#line 18201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_bHitTranslucentPortals  = TRUE ;
#line 18202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_bPhysical  = TRUE ;
#line 18203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetWorld  () -> CastRay  (crRay );
#line 18206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 18207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D mi_vStretch ;
#line 18208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 18209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_vStretch  = GetModelInstance  () -> mi_vStretch ;
#line 18210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bbox  . maxvect  *= mi_vStretch ;
#line 18211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bbox  . minvect  *= mi_vStretch ;
#line 18212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vLength  = bbox  . Max  () - bbox  . Min  ();
#line 18213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f;
#line 18215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(deltaY  < 0.0f)
#line 18216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaY  = 0.0f;
#line 18218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vSource  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) , GetPlacement  () . pl_PositionVector  (2) + (vLength  . Length  () * 0.5f) , GetPlacement  () . pl_PositionVector  (3));
#line 18221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTarget  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) + deltaX  , GetPlacement  () . pl_PositionVector  (2) + (vLength  . Length  () * 0.5f) + deltaY  , GetPlacement  () . pl_PositionVector  (3) + deltaZ );
#line 18223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCastRay  TestcrRay  (this  , vSource  , vTarget );
#line 18224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_ttHitModels  = CCastRay  :: TT_COLLISIONBOX ;
#line 18225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_bHitTranslucentPortals  = TRUE ;
#line 18226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_bPhysical  = TRUE ;
#line 18227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetWorld  () -> CastRay  (TestcrRay );
#line 18229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((crRay  . cr_penHit  != NULL ) && (crRay  . cr_vHit  (2) > fMaxY ) && TestcrRay  . cr_penHit  == NULL )
#line 18230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fMaxY  = crRay  . cr_vHit  (2);
#line 18232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) += fMaxY  - (plPlacement  . pl_PositionVector  (2) + 0.1f);
#line 18233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SendMyNextMovePosition(FLOAT3D vDelta) 
#line 18241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE )
#line 18243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetSystemMenu  () -> CancelRestart  ();
#line 18245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_cmiComm  . IsNetworkOn  ())
#line 18248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT length  = vDelta  . Length  ();
#line 18250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaX  = 0.0f;
#line 18251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaZ  = 0.0f;
#line 18252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT deltaY  = 0.0f;
#line 18253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT num  = 0.0f;
#line 18256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsMovable  ())
#line 18257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaX  = m_vDesiredPosition  (1) - GetPlacement  () . pl_PositionVector  (1);
#line 18259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaZ  = m_vDesiredPosition  (3) - GetPlacement  () . pl_PositionVector  (3);
#line 18260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaY  = m_vDesiredPosition  (2) - GetPlacement  () . pl_PositionVector  (2);
#line 18261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
num  = length  / plr_fSpeed ;
#line 18262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
num  = 0.0f;
#line 18269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(num  <= 1.0f)
#line 18274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - m_vMyPositionTmp ;
#line 18277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 18279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () < 0.5f)
#line 18280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT flength  = Sqrt  (deltaX  * deltaX  + deltaZ  * deltaZ );
#line 18284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(flength  < 0.5f)
#line 18285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 18288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 18296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsMovable  () && DetectFloorHit  (deltaX  , deltaY  , deltaZ  , plPlacement ))
#line 18297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  = m_vDesiredPosition ;
#line 18299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  = GetPlacement  () . pl_PositionVector ;
#line 18304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_OrientationAngle  = ANGLE3D (GetPlacement  () . pl_OrientationAngle  (1) , 0 , 0);
#line 18306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendMoveMessage  (this  , plPlacement  , plr_fSpeed );
#line 18307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vMyPositionTmp  = GetPlacement  () . pl_PositionVector ;
#line 18308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = FALSE ;
#line 18309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 18310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaX  = deltaX  / num ;
#line 18316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaZ  = deltaZ  / num ;
#line 18319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRayHit ;
#line 18320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plPlacement ;
#line 18321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 18322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) + deltaX  , 300.0f , GetPlacement  () . pl_PositionVector  (3) + deltaZ );
#line 18324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fMaxY  = - 9999999.0f;
#line 18325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bFloorHitted  = FALSE ;
#line 18329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vSource  = plPlacement  . pl_PositionVector ;
#line 18330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTarget  = vSource ;
#line 18331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTarget  (2) -= 1000.0f;
#line 18332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCastRay  crRay  (this  , vSource  , vTarget );
#line 18333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_ttHitModels  = CCastRay  :: TT_NONE ;
#line 18334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_bHitTranslucentPortals  = TRUE ;
#line 18335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_bPhysical  = TRUE ;
#line 18336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetWorld  () -> CastRay  (crRay );
#line 18337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((crRay  . cr_penHit  != NULL ) && (crRay  . cr_vHit  (2) > fMaxY ))
#line 18338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fMaxY  = crRay  . cr_vHit  (2);
#line 18340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bFloorHitted  = TRUE ;
#line 18341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 18344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D mi_vStretch ;
#line 18345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 18346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_vStretch  = GetModelInstance  () -> mi_vStretch ;
#line 18347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bbox  . maxvect  *= mi_vStretch ;
#line 18348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bbox  . minvect  *= mi_vStretch ;
#line 18349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vLength  = bbox  . Max  () - bbox  . Min  ();
#line 18350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f;
#line 18352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(deltaY  < 0.0f)
#line 18353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
deltaY  = 0.0f;
#line 18355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vSource  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) , GetPlacement  () . pl_PositionVector  (2) + (vLength  . Length  () * 0.5f) , GetPlacement  () . pl_PositionVector  (3));
#line 18358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTarget  = FLOAT3D (GetPlacement  () . pl_PositionVector  (1) + deltaX  , GetPlacement  () . pl_PositionVector  (2) + (vLength  . Length  () * 0.5f) + deltaY  , GetPlacement  () . pl_PositionVector  (3) + deltaZ );
#line 18363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCastRay  TestcrRay  (this  , vSource  , vTarget );
#line 18364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_ttHitModels  = CCastRay  :: TT_COLLISIONBOX ;
#line 18365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_bHitTranslucentPortals  = TRUE ;
#line 18366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TestcrRay  . cr_bPhysical  = TRUE ;
#line 18367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetWorld  () -> CastRay  (TestcrRay );
#line 18369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bFloorHitted )
#line 18370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  (2) += fMaxY  - (plPlacement  . pl_PositionVector  (2) + 0.1f);
#line 18372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000);
#line 18376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_OrientationAngle  (1) = GetPlacement  () . pl_OrientationAngle  (1);
#line 18379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(TestcrRay  . cr_penHit  != NULL )
#line 18380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plPlacement  . pl_PositionVector  = GetPlacement  () . pl_PositionVector ;
#line 18383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendMoveMessage  (this  , plPlacement  , plr_fSpeed );
#line 18385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vMyPositionTmp  = GetPlacement  () . pl_PositionVector ;
#line 18386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = FALSE ;
#line 18387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::Rotate(FLOAT3D vDelta,ANGLE aRotateSpeed,BOOL bFirstRotate) 
#line 18392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static ANGLE _aHeadingRotation  = 0.0f;
#line 18396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aRotateSpeed  > 0.0f && bFirstRotate ){
#line 18398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDir  = vDelta ;
#line 18399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDir  . SafeNormalize  ();
#line 18400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aWantedHeadingRelative  = GetRelativeHeading  (vDir );
#line 18403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aWantedHeadingRelative  = NormalizeAngle  (aWantedHeadingRelative );
#line 18405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE aHeadingRotation ;
#line 18407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(aWantedHeadingRelative  < - aRotateSpeed  * m_fMoveFrequency ){
#line 18409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = - aRotateSpeed ;
#line 18411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(aWantedHeadingRelative  > aRotateSpeed  * m_fMoveFrequency ){
#line 18414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = + aRotateSpeed ;
#line 18416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 18418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
aHeadingRotation  = aWantedHeadingRelative  / m_fMoveFrequency ;
#line 18420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_aHeadingRotation  == aHeadingRotation )
#line 18421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_aHeadingRotation  = aHeadingRotation ;
#line 18426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (aHeadingRotation  , 0 , 0));
#line 18432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (aHeadingRotation ) > 1.0f)
#line 18433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(Abs  (aHeadingRotation ) < 1.0f)
#line 18437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 18444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0 , 0 , 0));
#line 18445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopRotating() 
#line 18451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0 , 0 , 0));
#line 18453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopTranslating() 
#line 18457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 18459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CPlayer::CalcDistanceInPlaneToDestination(void) 
#line 18462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vNormal ;
#line 18465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetNormalComponent  (m_vDesiredPosition  - GetPlacement  () . pl_PositionVector  , en_vGravityDir  , vNormal );
#line 18466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return vNormal  . Length  ();
#line 18467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::MoveNow() 
#line 18470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE )
#line 18472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetSystemMenu  () -> CancelRestart  ();
#line 18474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bMoving  = TRUE ;
#line 18476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (EAutoAction  ());
#line 18478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetDefaultWearing() 
#line 18481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::DeleteCurrentArmor(int weartype) 
#line 18488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ weartype  ] . IsEmptyItem  () == TRUE  || 
#line 18491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyWearItem  [ weartype  ] . ItemData  == NULL )
#line 18492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = _pNetwork  -> MyWearItem  [ weartype  ] . ItemData ;
#line 18497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  -> GetType  () == CItemData  :: ITEM_SHIELD  || pItemData  -> GetType  () == CItemData  :: ITEM_WEAPON )
#line 18500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pItemData  -> GetSubType  () == CItemData  :: ITEM_SHIELD_HEAD  && (CTString) pItemData  -> GetItemSmcFileName  () == MODEL_TREASURE )
#line 18502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteDefaultArmor  (pItemData  -> GetSubType  ());
#line 18504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> TakeOffArmor  (pMI  , * pItemData );
#line 18508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::DeleteDefaultArmor(int type) 
#line 18516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iPlayerType  = en_pcCharacter  . pc_iPlayerType ;
#line 18519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , type  , iPlayerType );
#line 18521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 18522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 18523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::WearingDefaultArmor(int type) 
#line 18527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 18530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> DeleteDefaultArmor  (pMI  , type  , iJob );
#line 18532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * mi ;
#line 18533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTFileName fnFileName ;
#line 18535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CJobInfo  * pInfo  = CJobInfo  :: getSingleton  ();
#line 18537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  == NULL )
#line 18538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  iWearPos  = - 1;
#line 18544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(type )
#line 18545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case WEAR_HELMET : 
#line 18547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWearPos  = HEAD ;
#line 18548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case WEAR_JACKET : 
#line 18551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWearPos  = BODYUP ;
#line 18552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case WEAR_PANTS : 
#line 18554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWearPos  = BODYDOWN ;
#line 18555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case WEAR_GLOVES : 
#line 18557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWearPos  = HAND ;
#line 18558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case WEAR_BOOTS : 
#line 18560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWearPos  = FOOT ;
#line 18561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 18562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iWearPos  == - 1)
#line 18565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 18567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(type  == WEAR_PANTS )
#line 18571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetMeshName  (iJob  , SKIRT );
#line 18574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strlen  (fnFileName ) > 0)
#line 18575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi  = pMI  -> AddArmor  (fnFileName );
#line 18579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetTextureName  (iJob  , SKIRT );
#line 18580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (fnFileName  , fnFileName  . FileName  () , mi );
#line 18583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetTexNormalName  (iJob  , SKIRT );
#line 18584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strcmp  (fnFileName  , ""))
#line 18585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (fnFileName  , fnFileName  . FileName  () , mi );
#line 18587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(type  == WEAR_HELMET )
#line 18592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nhair  = _pNetwork  -> MyCharacterInfo  . hairStyle  % 10;
#line 18594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeHairMesh  (pMI  , iJob  , nhair  - 1);
#line 18595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 18597 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetMeshName  (iJob  , iWearPos );
#line 18598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi  = pMI  -> AddArmor  (fnFileName );
#line 18601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetTextureName  (iJob  , iWearPos );
#line 18602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (fnFileName  , fnFileName  . FileName  () , mi );
#line 18605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fnFileName  = pInfo  -> GetTexNormalName  (iJob  , iWearPos );
#line 18606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(strcmp  (fnFileName  , ""))
#line 18607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (fnFileName  , fnFileName  . FileName  () , mi );
#line 18609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsSocialActing() 
#line 18617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction  || m_nPlayActionNum  != - 1)
#line 18619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsPolymophing() 
#line 18629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange  || m_bChanging )
#line 18631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsTransforming() 
#line 18642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform  || m_bTransforming )
#line 18644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsChanging() 
#line 18651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bChanging  || m_bTransforming )
#line 18653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::DeleteWearingWeapon(BOOL bException,BOOL bSkillReady) 
#line 18662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((bException  && m_bDisappearWeapon ) || (! bException  && ! m_bDisappearWeapon ))
#line 18665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . IsEmptyItem  () == FALSE  && bSkillReady )
#line 18667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = _pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . ItemData ;
#line 18671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> TakeOffArmor  (pMI  , * pItemData );
#line 18672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDisappearWeapon  = TRUE ;
#line 18673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == FALSE )
#line 18676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData ;
#line 18680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> TakeOffArmor  (pMI  , * pItemData );
#line 18681 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 18682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . DeleteEffect  (WEAR_WEAPON );
#line 18683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 18684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDisappearWeapon  = TRUE ;
#line 18687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nPlayActionNum  == ACTION_NUM_WATER_SPREAD )
#line 18688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UBYTE  ubJob  = _pNetwork  -> MyCharacterInfo  . job ;
#line 18693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MeshInstance  * mi  = pMI  -> AddArmor  (_afnDishMeshName  [ ubJob  ] [ 0 ]);
#line 18694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddTexture_t  (_afnDishTextureName  , _afnDishTextureName  . FileName  () , mi );
#line 18696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> AddArmor  (_afnDishMeshName  [ ubJob  ] [ 1 ]);
#line 18697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 18698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 18701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubJob  == 0 || ubJob  == 1 || ubJob  == 5 || ubJob  == 6)
#line 18702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("water_sm" 
#line 18704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 18705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  ("water_sw" 
#line 18709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , _pTimer  -> GetLerpedCurrentTick  ());
#line 18710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::AppearWearingWeapon(BOOL bSkillEnd) 
#line 18716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bDisappearWeapon )
#line 18718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . IsEmptyItem  () == FALSE  && bSkillEnd )
#line 18720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SWORD  nTab  , nIdx ;
#line 18722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nTab  = _pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . Item_Tab ;
#line 18723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nIdx  = _pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . InvenIndex ;
#line 18725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . ItemData );
#line 18728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == FALSE )
#line 18731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SWORD  nTab  , nIdx ;
#line 18733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nTab  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . Item_Tab ;
#line 18734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nIdx  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . InvenIndex ;
#line 18736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pGameState  -> WearingArmor  (pMI  , * _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData );
#line 18742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (nTab  < 0 || nIdx ))
#line 18743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItems  & WearNormalItem  = _pNetwork  -> MySlotItem  [ nTab  ] [ nIdx  ];
#line 18745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Change  (_pNetwork  -> MyCharacterInfo  . job  
#line 18746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pNetwork  -> GetItemData  (_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetItemIndex  ()) 
#line 18747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, WEAR_WEAPON  
#line 18748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, WearNormalItem  . Item_Plus  
#line 18749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & pMI  -> m_tmSkaTagManager  
#line 18750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, 1 , _pNetwork  -> GetItemData  (_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetItemIndex  ()) -> GetSubType  ());
#line 18751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 18753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 18754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nPlayActionNum  == ACTION_NUM_WATER_SPREAD )
#line 18758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = GetCurrentPlayerModelInstance  ();
#line 18761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (_afnDishMeshName  [ _pNetwork  -> MyCharacterInfo  . job  ] [ 0 ]);
#line 18762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pMI  -> DeleteMesh  (_afnDishMeshName  [ _pNetwork  -> MyCharacterInfo  . job  ] [ 1 ]);
#line 18764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 18765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 18766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 18767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , 1);
#line 18768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pMI  -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 18769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDisappearWeapon  = FALSE ;
#line 18771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 18774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckSkillBuffer() 
#line 18775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bStartAttack )
#line 18777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nDesiredSkillNum  == - 1 && m_nCurrentSkillNum  == - 1)
#line 18782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 18787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling )
#line 18789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nReservedSkillNum  == m_nCurrentSkillNum )
#line 18792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 18794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nDesiredSkillNum  != - 1 && m_nReservedSkillNum  == - 1)
#line 18797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = m_nDesiredSkillNum ;
#line 18799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nDesiredSkillNum  != - 1 && m_nReservedSkillNum  != - 1)
#line 18802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bStartAttack )
#line 18814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 18827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 18829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetReserve  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 18831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CommandAttack  ();
#line 18833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 18834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  
#line 18835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (GetPlayerWeapons  () -> m_penRayHitTmp  -> GetFlags  () & ENF_ALIVE ) 
#line 18836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ((GetPlayerWeapons  () -> m_penRayHitTmp  -> IsEnemy  ()) || (GetPlayerWeapons  () -> m_penRayHitTmp  -> IsPet  ()) || (GetPlayerWeapons  () -> m_penRayHitTmp  -> IsSlave  ()) 
#line 18837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| ((GetPlayerWeapons  () -> m_penRayHitTmp  -> IsCharacter  ()) || (GetPlayerWeapons  () -> m_penRayHitTmp  -> IsWildPet  ()) 
#line 18838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (IsPvp  () || IsLegitTarget  (penTarget ) || _pUISWDoc  -> IsWar  () || pUIManager  -> GetGuildBattle  () -> IsEnemy  (penTarget  -> en_ulID ))))
#line 18839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 18840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nDesiredSkillNum );
#line 18842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSkillLevel ;
#line 18844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetFlag  () & SF_GUILD )
#line 18845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = pUIManager  -> GetGuild  () -> GetGuildSkillLevel  (SkillData  . GetIndex  ());
#line 18847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . GetJob  () == PET_JOB )
#line 18849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetPetSkillLevel  (pInfo  -> GetMyPetInfo  () -> lIndex  , m_nDesiredSkillNum );
#line 18851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . Skill_Data  . job  == WILDPET_JOB )
#line 18853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetPetSkillLevel  (0 , m_nDesiredSkillNum );
#line 18855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetSkillLevel  (m_nDesiredSkillNum );
#line 18859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  needMP  = SkillData  . GetNeedMP  (nSkillLevel  - 1);
#line 18866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  iMPReducRate  = pUIManager  -> GetNeedMPReductionRate  ();
#line 18867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
needMP  -= (needMP  * iMPReducRate  / 100);
#line 18869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetToggle  () == false  && needMP  > _pNetwork  -> MyCharacterInfo  . mp )
#line 18870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (320 , "MP가 부족합니다.") , SYSMSG_ERROR );
#line 18873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 18876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nDesiredSkillNum ;
#line 18877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nDesiredSkillNum );
#line 18884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSkillLevel ;
#line 18886 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . Skill_Data  . job  == PET_JOB )
#line 18887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetPetSkillLevel  (pInfo  -> GetMyPetInfo  () -> lIndex  , m_nDesiredSkillNum );
#line 18889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . Skill_Data  . job  == WILDPET_JOB )
#line 18891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetPetSkillLevel  (0 , m_nDesiredSkillNum );
#line 18893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . GetFlag  () & SF_GUILD )
#line 18895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = pUIManager  -> GetGuild  () -> GetGuildSkillLevel  (m_nDesiredSkillNum );
#line 18897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSkillLevel  = MY_INFO  () -> GetSkillLevel  (m_nDesiredSkillNum );
#line 18901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nSkillLevel  == 0)
#line 18904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  needMP  = SkillData  . GetNeedMP  (nSkillLevel  - 1);
#line 18910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  iMPReducRate  = pUIManager  -> GetNeedMPReductionRate  ();
#line 18911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
needMP  -= (needMP  * iMPReducRate  / 100);
#line 18913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetToggle  () == false  && needMP  > _pNetwork  -> MyCharacterInfo  . mp )
#line 18914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (320 , "MP가 부족합니다.") , SYSMSG_ERROR );
#line 18917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  == this )
#line 18919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 18921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nDesiredSkillNum ;
#line 18922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(GetPlayerWeapons  () -> m_penRayHitTmp  && (GetPlayerWeapons  () -> m_penRayHitTmp  -> IsCharacter  ()))
#line 18926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 18928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nDesiredSkillNum ;
#line 18929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 18932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillData  . IsNeedTarget  ())
#line 18935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 18938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = m_nDesiredSkillNum ;
#line 18939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 18940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = TRUE ;
#line 18944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CheckSkill(void) 
#line 18952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bStuned ){return TRUE ;}
#line 18955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! CheckSkillBuffer  ())
#line 18956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == - 1)
#line 18961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 18967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_PETRIDING ) || pUIManager  -> IsCSFlagOn  (CSF_TELEPORT ))
#line 18968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bStartAttack )
#line 18973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 18975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetInitJob  () -> IsFaceDecoMode  ())
#line 18977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 18980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 18983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 18984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 18985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  curlv  = MY_INFO  () -> GetSkillLevel  (m_nCurrentSkillNum );
#line 18987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(curlv  == 0)
#line 18988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetJob  () == PET_JOB )
#line 18990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyPetInfo  () -> lIndex  < 0)
#line 18992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 18993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 18994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 18996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lRemain ;
#line 18998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsSealPet  (& lRemain ) == true )
#line 18999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString str ;
#line 19003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
str  . PrintF  (_S  (2508 , "펫 봉인해제 시간이 %d시간 %d분 남았습니다.") , lRemain  / 3600 , (lRemain  % 3600) / 60);
#line 19004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetChattingUI  () -> AddSysMessage  (str  , SYSMSG_ERROR );
#line 19006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
curlv  = MY_INFO  () -> GetPetSkillLevel  (pInfo  -> GetMyPetInfo  () -> lIndex  , m_nCurrentSkillNum );
#line 19010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != 688 && _pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 19014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (4684 , "비행 모드에서 사용할 수 없는 스킬입니다.") , SYSMSG_ERROR );
#line 19016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == 688 && ! (_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 19021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_BACKWING  ] . IsEmptyItem  () == TRUE )
#line 19023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (4685 , "날개를 착용한 상태에서 사용이 가능합니다.") , SYSMSG_ERROR );
#line 19025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_DARKNESS )
#line 19032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (SkillData  . Skill_Data  . useState  & SCT_DARKNESS ))
#line 19034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (4686 , "사도 모드에서 사용할 수 없는 스킬입니다.") , SYSMSG_ERROR );
#line 19036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbSoulCount  < SkillData  . Skill_Data  . useSoulCount )
#line 19042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (4719 , "영혼의 갯수가 부족합니다.") , SYSMSG_ERROR );
#line 19044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iFlag  = SkillData  . GetSorcererFlag  ();
#line 19051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bIsTransform )
#line 19052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((iFlag  & (SSF_USE_HELLOUND  | SSF_USE_ELENEN ))))
#line 19055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iFlag  && ! (iFlag  & SSF_USE_CHARACTER ))
#line 19065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  == NULL  && SkillData  . IsNeedTarget  ())
#line 19072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && (penTarget  -> IsFirstExtraFlagOn  (ENF_EX1_NPC )) && SkillData  . IsNeedTarget  ())
#line 19078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ONE )
#line 19084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX chaindex  = penTarget  -> GetNetworkID  ();
#line 19087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , chaindex );
#line 19089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 19090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 19093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  -> cha_lGuildIndex  != _pNetwork  -> MyCharacterInfo  . lGuildIndex )
#line 19094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (3748 , "길드원이 아닙니다.") , SYSMSG_ERROR );
#line 19097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bLostTarget  , bAutoAttack ;
#line 19102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillCondition  (m_nCurrentSkillNum  , penTarget  , bLostTarget  , bAutoAttack ))
#line 19103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , FALSE  , FALSE );
#line 19105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bCannotUseSkill )
#line 19109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (1450 , "현재 스킬을 사용할 수 없는 상태입니다.") , SYSMSG_ERROR );
#line 19111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == FALSE )
#line 19115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nUsingWeapon  = 0;
#line 19117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bCanUse  = TRUE ;
#line 19119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . Skill_Data  . useWeaponType0  != - 1 && SkillData  . Skill_Data  . useWeaponType1  == - 1)
#line 19120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nUsingWeapon  = 1;
#line 19122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . Skill_Data  . useWeaponType0  == - 1 && SkillData  . Skill_Data  . useWeaponType1  != - 1)
#line 19124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nUsingWeapon  = 2;
#line 19126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SkillData  . Skill_Data  . useWeaponType0  != - 1 && SkillData  . Skill_Data  . useWeaponType1  != - 1)
#line 19128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nUsingWeapon  = 3;
#line 19130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(nUsingWeapon )
#line 19133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 1: 
#line 19135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  () != SkillData  . Skill_Data  . useWeaponType0 )
#line 19137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bCanUse  = FALSE ;
#line 19139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 2: 
#line 19143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  () != SkillData  . Skill_Data  . useWeaponType1 )
#line 19145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bCanUse  = FALSE ;
#line 19147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 19151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  () != SkillData  . Skill_Data  . useWeaponType0  && 
#line 19153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  () != SkillData  . Skill_Data  . useWeaponType1 )
#line 19154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bCanUse  = FALSE ;
#line 19156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bCanUse )
#line 19162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strTemp ;
#line 19164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTemp  . PrintF  (_S  (298 , "%s 스킬을 스펠합니다.") , SkillData  . GetName  ());
#line 19165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strTemp  , SYSMSG_ERROR );
#line 19166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (1451 , "알맞는 무기를 장비해야 사용할 수 있는 스킬입니다.") , SYSMSG_ERROR );
#line 19167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bStartAttack )
#line 19183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . IsSingleDungeonSkill  ())
#line 19185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 19187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (404 , "퍼스널 던젼에서만 사용할 수 있는 스킬입니다.") , SYSMSG_ERROR );
#line 19190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillData  . IsNeedTarget  ())
#line 19197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bWaitForSkillResponse )
#line 19200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetNum  (curlv ) > 1)
#line 19202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 19206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (this );
#line 19208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = TRUE ;
#line 19210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , FALSE );
#line 19212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const char  chTargetType  = SkillData  . GetTargetType  ();
#line 19215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chTargetType  == CSkill  :: STT_SELF_RANGE  || chTargetType  == CSkill  :: STT_GUILD_SELF_RANGE )
#line 19216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , this  , m_dcEnemies  , 
#line 19218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetAppRange  () , SkillData  . GetTargetNum  (curlv ) , 360.0f , m_nCurrentSkillNum );
#line 19219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSendSkillMessage  = _pTimer  -> CurrentTick  ();
#line 19222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == 309 || m_nCurrentSkillNum  == 313)
#line 19227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> Set_MyChar_MorphStatus_EVOCATION_BEGIN  ();
#line 19231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = TRUE ;
#line 19234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , this  , _pNetwork  -> MyCharacterInfo  . index  , FALSE );
#line 19236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSendSkillMessage  = _pTimer  -> CurrentTick  ();
#line 19237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 19241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget )
#line 19245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (penTarget  -> IsPlayer  () || penTarget  -> IsEnemy  () || penTarget  -> IsCharacter  () || penTarget  -> IsPet  () || penTarget  -> IsSlave  () || penTarget  -> IsWildPet  ()))
#line 19247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! CheckAttackTarget  (m_nCurrentSkillNum  , penTarget  , 0.0f))
#line 19252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 19254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (406 , "잘못된 타겟입니다. %s 스킬을 취소합니다.") , SkillData  . GetName  ());
#line 19256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsVisibleCheckAll  (penTarget ))
#line 19263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 19265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2086 , "가로막혀서 스킬을 사용할수 없습니다."));
#line 19266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = penTarget ;
#line 19268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTarget  = NULL ;
#line 19270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 19271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 19275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 19277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetPos  (0 , 0 , 0);
#line 19278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirection  (0 , 0 , 0);
#line 19280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = penTarget ;
#line 19281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentCenter  (((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 19282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 19283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 19284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentPos  = this  -> en_plPlacement  . pl_PositionVector  + vCurrentCenter ;
#line 19285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetCenter  (0 , 0 , 0);
#line 19286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT size  = 0;
#line 19287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE )
#line 19288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> en_RenderType  == RT_SKAMODEL )
#line 19290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 19293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  -> GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 19294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f * 0.4f;
#line 19295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
size  = vRadius  . Length  ();
#line 19296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetCenter  = FLOAT3D (((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 19298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 19299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 19300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  = pen  -> en_plPlacement  . pl_PositionVector  + vTargetCenter ;
#line 19301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  = vTargetPos  - vCurrentPos ;
#line 19302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 19303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  -= vDirection  * size ;
#line 19304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 19307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fScaledSize  = 0.f;
#line 19309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX chaindex  = penTarget  -> GetNetworkID  ();
#line 19311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_MOB  , chaindex );
#line 19313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 19314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobTarget  * pTarget  = static_cast  < CMobTarget  * > (pObject );
#line 19317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (pTarget  -> m_nType );
#line 19319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  != NULL  && MD  -> index  > 0)
#line 19320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fScaledSize  = MD  -> GetScaledSize  ();
#line 19322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillDistance  = SkillData  . GetFireRange  ();
#line 19326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(vDelta  . Length  () <= (m_fSkillDistance  + fScaledSize ))
#line 19327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE  && (m_bForward ))
#line 19330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 19332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bWaitForSkillResponse )
#line 19339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == TRUE ) && (SkillData  . Skill_Data  . useState  & SCT_WEAPON ))
#line 19341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage  = _S  (702 , "무기를 장착해야 사용할수 있는 스킬입니다.");
#line 19344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . Skill_Data  . useState  & SCT_WEAPON )
#line 19351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . IsEmptyItem  () == FALSE )
#line 19353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iWeaponType  = _pNetwork  -> MyWearItem  [ WEAR_WEAPON  ] . ItemData  -> GetSubType  ();
#line 19356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iWeaponType  == CItemData  :: ITEM_WEAPON_MINING  || 
#line 19357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_GATHERING  || 
#line 19358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iWeaponType  == CItemData  :: ITEM_WEAPON_CHARGE )
#line 19359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage  = _S  (702 , "무기를 장착해야 사용할수 있는 스킬입니다.");
#line 19362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pNetwork  -> MyWearItem  [ WEAR_SHIELD  ] . IsEmptyItem  () == TRUE ) && (SkillData  . Skill_Data  . useState  & SCT_SHIELD ))
#line 19371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 19374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2087 , "방패를 장착해야 사용할수 있는 스킬입니다."));
#line 19375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  MobIndex  = - 1;
#line 19383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 19384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MobIndex  = penTarget  -> GetNetworkID  ();
#line 19386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = penTarget ;
#line 19390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 19393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = UI_SUMMON_START ;i  <= UI_SUMMON_END ;++ i )
#line 19394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSummonUI  * pUISummon  = (CSummonUI  *) pUIManager  -> GetUI  (i );
#line 19396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pSummonEntity  = pUISummon  -> GetSummonEntity  ();
#line 19397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity )
#line 19398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pSummonEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 19400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penAttackingEnemy  != ((CSlave  *) pSummonEntity ) -> m_penEnemy )
#line 19402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSummonEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 19404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> bIsActive )
#line 19411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pWildPetEntity  = pInfo  -> GetMyApetInfo  () -> m_pEntity ;
#line 19413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity )
#line 19414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPetEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_WILDPET ) && 
#line 19416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_penAttackingEnemy  != ((CWildPet  *) pWildPetEntity ) -> m_penEnemy ))
#line 19417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pWildPetEntity  -> SendEvent  (ESlaveKilledEnemy  ());
#line 19420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penStillTarget  = penTarget ;
#line 19426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = TRUE ;
#line 19429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetNum  (curlv ) > 1)
#line 19430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 19433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (m_penAttackingEnemy );
#line 19435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , FALSE );
#line 19437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const char  chTargetType  = SkillData  . GetTargetType  ();
#line 19438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fAngle  = 360.0f;
#line 19440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(chTargetType  == CSkill  :: STT_TARGET_D120 )
#line 19441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fAngle  = 60.0f;
#line 19443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (m_penAttackingEnemy );
#line 19447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> FindTargetsInRange  (this  , m_penAttackingEnemy  , m_dcEnemies  , 
#line 19448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetAppRange  () , SkillData  . GetTargetNum  (curlv ) - 1 , fAngle  , m_nCurrentSkillNum  , chTargetType );
#line 19449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_bSingleMode )
#line 19453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CheckAttackTarget  (m_nCurrentSkillNum  , penTarget  , 0.0f))
#line 19455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , penTarget  , MobIndex  , FALSE );
#line 19457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Add  (penTarget );
#line 19458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CheckAttackTarget  (m_nCurrentSkillNum  , penTarget  , 0.0f))
#line 19467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == 436)
#line 19470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerEntity  *) CEntity  :: GetPlayerEntity  (0)) -> UseAction  (ACTION_NUM_WATER_SPREAD );
#line 19472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , penTarget  , MobIndex  , FALSE );
#line 19476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSendSkillMessage  = _pTimer  -> CurrentTick  ();
#line 19486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 19488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  == this )
#line 19497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetType  () == CSkill  :: ST_MAGIC  || SkillData  . GetType  () == CSkill  :: ST_SUMMON_TOTEM_SKILL )
#line 19499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_ONE  || 
#line 19502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_RANGE  || 
#line 19503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_D120  || 
#line 19504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_RECT )
#line 19505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 19507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (406 , "잘못된 타겟입니다. %s 스킬을 취소합니다.") , SkillData  . GetName  ());
#line 19509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bWaitForSkillResponse )
#line 19518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = TRUE ;
#line 19520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , penTarget  , _pNetwork  -> MyCharacterInfo  . index  , FALSE );
#line 19522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSendSkillMessage  = _pTimer  -> CurrentTick  ();
#line 19523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 19526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 19530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (406 , "잘못된 타겟입니다. %s 스킬을 취소합니다.") , SkillData  . GetName  ());
#line 19531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 19533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (FALSE  , g_iAutoAttack  , FALSE );
#line 19535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = TRUE ;
#line 19541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bStartAttack )
#line 19546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("here...\n");
#line 19553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 19558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SpellSkill(INDEX m_nCurrentSkillNum) 
#line 19559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bHardcodingSkill  = HardCodingSkill  (TRUE );
#line 19561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 19562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 19565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT skillSpeed  = (100 - _pNetwork  -> MyCharacterInfo  . skillSpeed ) / 100.0f;
#line 19572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iTempAnim  = _pNetwork  -> MyCharacterInfo  . bExtension ;
#line 19577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == 688 && ! (_pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING ))
#line 19578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddSkaModel  (CTString ("Data\\Item\\shield\\Nightshadow\\ns_fly.smc"));
#line 19581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , TRUE );
#line 19582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iTempAnim  = 0;
#line 19585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . ulPlayerState  |= PLAYER_STATE_FLYING ;
#line 19586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nCurrentSkillNum  == 688 && _pNetwork  -> MyCharacterInfo  . ulPlayerState  & PLAYER_STATE_FLYING )
#line 19588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DelSkaModel  (CTString ("Data\\Item\\shield\\Nightshadow\\ns_fly.smc"));
#line 19590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (TRUE );
#line 19591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iTempAnim  = 1;
#line 19594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . ulPlayerState  &= ~ PLAYER_STATE_FLYING ;
#line 19595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . bCanCancel )
#line 19601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = SkillData  . idPlayer_Anim_Skill  [ iTempAnim  ] [ 0 ];
#line 19604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_idCurrentSkillAnim  == - 1)
#line 19606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . bCanCancel  = FALSE ;
#line 19608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = SkillData  . idPlayer_Anim_Skill  [ iTempAnim  ] [ 2 ];
#line 19610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_idCurrentSkillAnim  == - 1 && SkillData  . GetFlag  () & SF_GUILD )
#line 19612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bNoAniGuildSkill  = TRUE ;
#line 19614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_idCurrentSkillAnim  == - 1 && ! m_bNoAniGuildSkill )
#line 19616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 19620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bNoAniGuildSkill )
#line 19623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 19625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillAnimTime  = GetModelInstance  () -> GetAnimLength  (m_idCurrentSkillAnim ) * skillSpeed ;
#line 19628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> CurrentTick  ();
#line 19629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = TRUE ;
#line 19631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = TRUE ;
#line 19635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . bCanCancel  == FALSE  || m_bNoAniGuildSkill )
#line 19637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPreSkill  = FALSE ;
#line 19639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bDoSkill  = FALSE ;
#line 19640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = TRUE ;
#line 19641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else {
#line 19643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPreSkill  = TRUE ;
#line 19644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bDoSkill  = FALSE ;
#line 19645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = FALSE ;
#line 19646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (m_idCurrentSkillAnim  , AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 19649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 19650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> SetCSFlagOn  (CSF_SKILL );
#line 19653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 19656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::CheckAction() 
#line 19657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nPlayActionNum  == - 1)
#line 19659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bStartAttack  || (m_bForward  || m_bKeyMove ))
#line 19664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 19666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 19667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 19671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction )
#line 19675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 19678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 19680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 19682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SkillAnimation(void) 
#line 19683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bEffect  = TRUE ;
#line 19686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static CEntity  * penEntity ;
#line 19689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
float  _PreSkillTime ;
#line 19690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bPlayPreSkill  = TRUE ;
#line 19691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bPlayDoSkill  = FALSE ;
#line 19692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bPlayPostSkill  = FALSE ;
#line 19693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static INDEX step  = 0;
#line 19697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta ;
#line 19698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 19700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 19703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 19705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . IsNeedTarget  () && 
#line 19706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! (skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_NOTHING  && 
#line 19707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  && 
#line 19708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! m_bReadySendSkillMessage ))
#line 19709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && (penTarget  -> IsEnemy  () || penTarget  -> IsPet  () || penTarget  -> IsSlave  () || penTarget  -> IsWildPet  ()))
#line 19711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 19713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 19714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 360.0f , TRUE );
#line 19715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  != NULL  && penTarget  == this )
#line 19717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  != NULL  && penTarget  -> IsCharacter  ())
#line 19721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bPostSkill )
#line 19723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  = GetPlacement  () . pl_PositionVector  - penTarget  -> GetPlacement  () . pl_PositionVector ;
#line 19725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 19726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rotate  (- vDelta  , 360.0f , TRUE );
#line 19727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_NOTHING  && 
#line 19771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  && 
#line 19772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! m_bReadySendSkillMessage )
#line 19773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 19775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 19780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 19782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT skillSpeed  = (100 - _pNetwork  -> MyCharacterInfo  . skillSpeed ) / 100.0f;
#line 19786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bPreSkill )
#line 19787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 0)
#line 19789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 19793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  = StartEffectGroup  (skill  . GetReadyEffect  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 19794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  
#line 19795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 19796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime ))
#line 19799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPreSkill  = FALSE ;
#line 19803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bDoSkill  = TRUE ;
#line 19804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 19806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = TRUE ;
#line 19810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetReadyTime  () > 0 && SkillData  . idPlayer_Anim_Skill  [ _pNetwork  -> MyCharacterInfo  . bExtension  ] [ 1 ] > 0)
#line 19811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillAnimTime  = ((SkillData  . GetReadyTime  () / 10.f) - m_fSkillAnimTime ) * skillSpeed ;
#line 19813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillAnimTime  = 0.f;
#line 19817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19819 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> CurrentTick  ();
#line 19821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (SkillData  . idPlayer_Anim_Skill  [ _pNetwork  -> MyCharacterInfo  . bExtension  ] [ 1 ] , AN_NORESTART  , 1.0f , PLAYER_ANIM_GROUP_WHOLEBODY  , 
#line 19822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 19824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LOG_DEBUG  ("SkillName : %s, StillTime : %f, Anim : %s" , SkillData  . GetName  () , (float ) m_fSkillAnimTime  , SkillData  . GetStillAnim  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 19825 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(m_nCurrentSkillNum )
#line 19829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_SELF_HEAL : 
#line 19831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_PARTY_HEAL : 
#line 19832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_HEAL : 
#line 19833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PreSkillTime  = 0.0f;
#line 19834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > _PreSkillTime  && bPlayPreSkill )
#line 19835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = FALSE ;
#line 19837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_HEAL_PRE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 19838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_DEFENCE_MANA : 
#line 19843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PreSkillTime  = 0.0f;
#line 19844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > _PreSkillTime  && bPlayPreSkill )
#line 19845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = FALSE ;
#line 19847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_DEFENCE_MANA_PRE ) , SOF_3D  | SOF_VOLUMETRIC );
#line 19848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 19851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bDoSkill )
#line 19858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 19860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime ))
#line 19861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bDoSkill  = FALSE ;
#line 19863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = TRUE ;
#line 19865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fSkillAnimTime  = GetModelInstance  () -> GetAnimLength  (SkillData  . idPlayer_Anim_Skill  [ _pNetwork  -> MyCharacterInfo  . bExtension  ] [ 2 ]) * skillSpeed ;
#line 19868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = _pTimer  -> CurrentTick  ();
#line 19870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 19872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AddAnimation  (SkillData  . idPlayer_Anim_Skill  [ _pNetwork  -> MyCharacterInfo  . bExtension  ] [ 2 ] , AN_NORESTART  , 1.0f , 
#line 19873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PLAYER_ANIM_GROUP_WHOLEBODY  , ESKA_MASTER_MODEL_INSTANCE  , skillSpeed );
#line 19874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bPostSkill )
#line 19880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bReadySendSkillMessage )
#line 19884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartPostSkill  = FALSE ;
#line 19887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 19889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bFire  = FALSE ;
#line 19891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) != CSkill  :: MT_DASH )
#line 19892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == HE_SHINING_ARROW  || 
#line 19894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  == HE_STORM_ARROW  || 
#line 19895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  == HE_DOUBLE_STING )
#line 19896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 1.0f)
#line 19898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bFire  = TRUE ;
#line 19900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 19903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bFire  = TRUE ;
#line 19905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bFire )
#line 19911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  lv  = MY_INFO  () -> GetSkillLevel  (m_nCurrentSkillNum );
#line 19916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const char  chTargetType  = SkillData  . GetTargetType  ();
#line 19918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(lv  == 0)
#line 19919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetJob  () == PET_JOB )
#line 19921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
lv  = MY_INFO  () -> GetPetSkillLevel  (pInfo  -> GetMyPetInfo  () -> lIndex  , m_nCurrentSkillNum );
#line 19924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetJob  () != NIGHTSHADOW  && 
#line 19929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(chTargetType  == CSkill  :: STT_SELF_RANGE  || chTargetType  == CSkill  :: STT_GUILD_SELF_RANGE ) || 
#line 19930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(SkillData  . GetTargetNum  (lv ) > 1))
#line 19931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessageInContainer  (m_nCurrentSkillNum  , m_dcEnemies  , TRUE );
#line 19933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = FALSE ;
#line 19934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillData  . IsNeedTarget  () && SkillData  . GetTargetNum  (lv ) <= 1)
#line 19937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("------%f--SendSkillMessage\n" , _pTimer  -> GetLerpedCurrentTick  ());
#line 19939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , this  , _pNetwork  -> MyCharacterInfo  . index  , TRUE );
#line 19940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = FALSE ;
#line 19941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  != NULL  && SkillData  . IsNeedTarget  ())
#line 19944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = penTarget ;
#line 19946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetPos  (0 , 0 , 0);
#line 19947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirection  (0 , 0 , 0);
#line 19949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 19950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentCenter  (((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 19951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 19952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 19953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentPos  = this  -> en_plPlacement  . pl_PositionVector  + vCurrentCenter ;
#line 19954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetCenter  (0 , 0 , 0);
#line 19955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT size  = 0;
#line 19956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE )
#line 19957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> en_RenderType  == RT_SKAMODEL )
#line 19959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 19962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  -> GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 19963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f * 0.4f;
#line 19964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
size  = vRadius  . Length  ();
#line 19965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetCenter  = FLOAT3D (((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 19967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 19968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 19969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  = pen  -> en_plPlacement  . pl_PositionVector  + vTargetCenter ;
#line 19970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  = vTargetPos  - vCurrentPos ;
#line 19971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 19972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  -= vDirection  * size ;
#line 19973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection  . Normalize  ();
#line 19976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 19977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetType  () == CSkill  :: STT_SELF_ONE  || 
#line 19978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_ONE  || 
#line 19979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_PARTY_ONE  || 
#line 19980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_PARTY_ALL  || 
#line 19981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ONE  || 
#line 19982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ALL )
#line 19983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("------%f--SendSkillMessage\n" , _pTimer  -> GetLerpedCurrentTick  ());
#line 19986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendSkillMessage  (m_nCurrentSkillNum  , penTarget  , penTarget  -> GetNetworkID  () , TRUE );
#line 19987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = FALSE ;
#line 19990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penTarget  == NULL  && SkillData  . IsNeedTarget  ())
#line 19992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 19994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 19995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = FALSE ;
#line 19996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 19998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static std  :: vector  < TagInfo  > vecLastEffectInfo ;
#line 20002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == - 1)
#line 20003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 20009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bAnimPlay  = true ;
#line 20010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nEvo  = _pNetwork  -> MyCharacterInfo  . nEvocationIndex ;
#line 20013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nEvo  > 0 && nEvo  == m_nCurrentSkillNum )
#line 20014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bAnimPlay  = false ;
#line 20016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bAnimPlay  == true  && m_iSkillEffectStep  == 0 && 
#line 20019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(! skill  . IsNeedTarget  () || (penTarget  != NULL  && penTarget  -> en_pmiModelInstance  != NULL  && penTarget  -> en_RenderType  == RT_SKAMODEL )))
#line 20020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 20023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEffectGroup  * pFireEffect  = StartEffectGroup  (skill  . GetFireEffect1  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en_pmiModelInstance  -> m_tmSkaTagManager  , 
#line 20025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pTimer  -> GetLerpedCurrentTick  ());
#line 20027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pSkillReadyEffect  != NULL  && CEffectGroupManager  :: Instance  () . IsValidCreated  (m_pSkillReadyEffect ))
#line 20028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < m_pSkillReadyEffect  -> GetEffectCount  ();++ i )
#line 20030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEffect  * pEffect  = m_pSkillReadyEffect  -> GetEffectKeyVector  () [ i  ] . m_pCreatedEffect ;
#line 20032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEffect  != NULL  && pEffect  -> GetType  () == ET_SKA )
#line 20033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaEffect  * pSkaEffect  = (CSkaEffect  *) pEffect ;
#line 20035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TagInfo  ti ;
#line 20036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ti  . m_vPos  = pSkaEffect  -> GetInstancePosition  ();
#line 20037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ti  . m_qRot  = FLOATquat3D (1 , 0 , 0 , 0);
#line 20038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vecLastEffectInfo  . push_back  (ti );
#line 20039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  -> Stop  (0.1f);
#line 20042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  = NULL ;
#line 20043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pFireEffect  != NULL  && vecLastEffectInfo  . empty  ())
#line 20046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pFireEffect  -> Process  (_pTimer  -> GetLerpedCurrentTick  ());
#line 20048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < pFireEffect  -> GetEffectCount  ();++ i )
#line 20049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEffect  * pEffect  = pFireEffect  -> GetEffectKeyVector  () [ i  ] . m_pCreatedEffect ;
#line 20051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEffect  != NULL  && pEffect  -> GetType  () == ET_SKA )
#line 20052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaEffect  * pSkaEffect  = (CSkaEffect  *) pEffect ;
#line 20054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TagInfo  ti ;
#line 20055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ti  . m_vPos  = pSkaEffect  -> GetInstancePosition  ();
#line 20056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ti  . m_qRot  = FLOATquat3D (1 , 0 , 0 , 0);
#line 20057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vecLastEffectInfo  . push_back  (ti );
#line 20058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSkaEffect  -> SetLifeTime  (0);
#line 20059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT skillSpeed  = (100 - _pNetwork  -> MyCharacterInfo  . skillSpeed ) / 100.0f;
#line 20065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (skill  . GetDelay  (m_iSkillEffectStep  - 1 , _pNetwork  -> MyCharacterInfo  . bExtension ) * skillSpeed  < m_fSkillAnimTime  && "SkillAnimTime은 반드시 MissileSpeedFireTime보다 커야합니다.");
#line 20068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  > 0 && m_iSkillEffectStep  <= skill  . GetDelayCount  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pTimer  -> CurrentTick  () - m_tmSkillStartTime  > skill  . GetDelay  (m_iSkillEffectStep  - 1 , _pNetwork  -> MyCharacterInfo  . bExtension ) * skillSpeed )
#line 20070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
++ m_iSkillEffectStep ;
#line 20073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_NONE )
#line 20074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPoint ;
#line 20076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitDir ;
#line 20077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . IsNeedTarget  ())
#line 20078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{GetTargetDirection  (this  , GetPlayerWeapons  () -> m_penRayHitTmp  , vHitPoint  , vHitDir );}
#line 20079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetTargetDirection  (this  , this  , vHitPoint  , vHitDir );
#line 20082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 20085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , vHitPoint  , TRUE );
#line 20087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 20088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && ! (penTarget  -> GetFirstExFlags  () & ENF_EX1_CLICK_OBJECT ))
#line 20092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
this  -> InflictDirectDamage  (penTarget  , this  , DMT_NONE  , 0 , vHitPoint  , vHitDir );
#line 20095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vAxisY  (0 , 1 , 0);
#line 20098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT angle  = acos  (vHitDir  % vAxisY );
#line 20099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D axis  = vAxisY  * vHitDir ;
#line 20100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
axis  . Normalize  ();
#line 20101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATquat3D quat ;
#line 20102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
quat  . FromAxisAngle  (axis  , angle );
#line 20103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  () 
#line 20105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, vHitPoint  , quat );
#line 20106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_ARROW )
#line 20108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (en_pmiModelInstance  != NULL );
#line 20111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 20112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 20114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 20115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & en  = * (* it );
#line 20117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en  . IsFlagOn  (ENF_ALIVE ))
#line 20118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fHoriOffset  = 0.0f;
#line 20120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fVertiOffset  = 0.0f;
#line 20121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetDelayCount  (_pNetwork  -> MyCharacterInfo  . bExtension ) > 1)
#line 20122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDist  = (penTarget  -> en_plPlacement  . pl_PositionVector  - en_plPlacement  . pl_PositionVector ) . Length  ();
#line 20124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT factor  = 1.3f * fDist  / skill  . GetFireRange  ();
#line 20125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
factor  = Clamp  (factor  , 0.0f , 1.0f);
#line 20126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 2){fHoriOffset  = + 1.0f * factor ;}
#line 20127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 3){fHoriOffset  = - 1.0f * factor ;}
#line 20129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 5){fVertiOffset  = - 1.0f * factor ;}
#line 20130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension  && (_pNetwork  -> MyCharacterInfo  . job  != ROGUE  && (! IsEXRogue  (_pNetwork  -> MyCharacterInfo  . job ))))
#line 20132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "STAFF" , & en  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , fHoriOffset  , fVertiOffset  , 1);
#line 20137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , & en  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , fHoriOffset  , fVertiOffset );
#line 20144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 20148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && penTarget  -> IsFlagOn  (ENF_ALIVE ))
#line 20152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fHoriOffset  = 0.0f;
#line 20154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fVertiOffset  = 0.0f;
#line 20155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetDelayCount  (_pNetwork  -> MyCharacterInfo  . bExtension ) > 1)
#line 20156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDist  = (penTarget  -> en_plPlacement  . pl_PositionVector  - en_plPlacement  . pl_PositionVector ) . Length  ();
#line 20158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT factor  = 1.3f * fDist  / skill  . GetFireRange  ();
#line 20159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
factor  = Clamp  (factor  , 0.0f , 1.0f);
#line 20160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 2){fHoriOffset  = + 1.0f * factor ;}
#line 20161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 3){fHoriOffset  = - 1.0f * factor ;}
#line 20163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_iSkillEffectStep  == 5){fVertiOffset  = - 1.0f * factor ;}
#line 20164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bExtension  && (_pNetwork  -> MyCharacterInfo  . job  != ROGUE  && (! IsEXRogue  (_pNetwork  -> MyCharacterInfo  . job ))))
#line 20166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "STAFF" , penTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , fHoriOffset  , fVertiOffset  , 1);
#line 20171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMissile  (this  , "RHAND" , penTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , fHoriOffset  , fVertiOffset );
#line 20178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_DIRECT )
#line 20183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! skill  . IsNeedTarget  ())
#line 20186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & this  -> en_pmiModelInstance  -> m_tmSkaTagManager  
#line 20189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 20190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && penTarget  -> GetFlags  () & ENF_ALIVE  && penTarget  -> en_pmiModelInstance  != NULL )
#line 20195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & penTarget  -> en_pmiModelInstance  -> m_tmSkaTagManager  
#line 20198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 20199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_DIRECTDAMAGE )
#line 20203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 20205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 20207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 20208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & en  = * (* it );
#line 20210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en  . IsFlagOn  (ENF_ALIVE ) && en  . en_pmiModelInstance  != NULL )
#line 20211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & (en  . en_pmiModelInstance  -> m_tmSkaTagManager ) 
#line 20214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 20215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 20220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitPoint ;
#line 20222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vHitDir ;
#line 20223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetTargetDirection  (this  , GetPlayerWeapons  () -> m_penRayHitTmp  , vHitPoint  , vHitDir );
#line 20224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DamagedTargetsInRange  (this  , m_dcEnemies  , DMT_EXPLOSION  , 1 , vHitPoint  , TRUE );
#line 20225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 20226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 20231 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
this  -> InflictDirectDamage  (penTarget  , this  , DMT_NONE  , 0 , FLOAT3D (0 , 0 , 0) , FLOAT3D (0 , 0 , 0));
#line 20234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> en_pmiModelInstance  != NULL )
#line 20235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  -> GetRenderType  () != RT_TERRAIN )
#line 20238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartEffectGroup  (skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & penTarget  -> en_pmiModelInstance  -> m_tmSkaTagManager  
#line 20241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, _pTimer  -> GetLerpedCurrentTick  ());
#line 20242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_CONTINUE  || 
#line 20248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_MAGECUTTER  || 
#line 20249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_DASH ) 
#line 20250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ! vecLastEffectInfo  . empty  ())
#line 20251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_dcEnemies  . Count  () > 0)
#line 20253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(ENTITIES_ITERATOR  it  = m_dcEnemies  . vectorSelectedEntities  . begin  ();
#line 20255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
it  != m_dcEnemies  . vectorSelectedEntities  . end  ();++ it )
#line 20256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  & en  = * (* it );
#line 20258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en  . IsFlagOn  (ENF_ALIVE ))
#line 20259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vecLastEffectInfo  [ 0 ] . m_vPos  , vecLastEffectInfo  [ 0 ] . m_qRot  
#line 20261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, & en  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 20265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 20268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL  && penTarget  -> IsFlagOn  (ENF_ALIVE ))
#line 20272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotMagicContinued  (this  , vecLastEffectInfo  [ 0 ] . m_vPos  , vecLastEffectInfo  [ 0 ] . m_qRot  
#line 20274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, penTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false  , skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 20278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vecLastEffectInfo  . erase  (vecLastEffectInfo  . begin  ());
#line 20281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_GOWAITBACK )
#line 20283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 20285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotGoWaitBack  (this  , vecLastEffectInfo  [ 0 ] . m_vPos  , vecLastEffectInfo  [ 0 ] . m_qRot  
#line 20287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, penTarget  , skill  . GetMissileSpeed  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetDestDelay  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, false );
#line 20292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vecLastEffectInfo  . erase  (vecLastEffectInfo  . begin  ());
#line 20294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(skill  . GetMissileType  (_pNetwork  -> MyCharacterInfo  . bExtension ) == CSkill  :: MT_CONNECT )
#line 20296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  != NULL )
#line 20298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShotConnect  (this  , penTarget  , skill  . GetDestDelay  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect3  (_pNetwork  -> MyCharacterInfo  . bExtension ) 
#line 20301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
, skill  . GetFireEffect2  (_pNetwork  -> MyCharacterInfo  . bExtension ));
#line 20302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > m_fSkillAnimTime  - 0.1f))
#line 20307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 20310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 20314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetTargetType  () == CSkill  :: STT_SELF_ONE  || 
#line 20315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_TARGET_ONE  || 
#line 20316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_PARTY_ALL  || 
#line 20317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ONE  || 
#line 20318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SkillData  . GetTargetType  () == CSkill  :: STT_GUILD_ALL )
#line 20319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 20321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReadySendSkillMessage  = TRUE ;
#line 20326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = FALSE ;
#line 20328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 20329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vecLastEffectInfo  . clear  ();
#line 20331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = - 1;
#line 20332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = 0.0f;
#line 20333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = FALSE ;
#line 20334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 20336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartPostSkill  = TRUE ;
#line 20338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = TRUE ;
#line 20339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
step  = 0;
#line 20340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 20342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = TRUE ;
#line 20345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
NewClearState  (CLEAR_STATE_LENGTH );
#line 20346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 20347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bNoAniGuildSkill  = FALSE ;
#line 20348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nReservedSkillNum  != - 1)
#line 20349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = m_nReservedSkillNum ;
#line 20351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 20352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 20356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & skill  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 20358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . GetFlag  () & SF_FORHELP  
#line 20359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& (skill  . GetTargetType  () != CSkill  :: STT_SELF_ONE  
#line 20360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| skill  . GetTargetType  () != CSkill  :: STT_SELF_RANGE  
#line 20361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| skill  . GetTargetType  () != CSkill  :: STT_PARTY_ALL  
#line 20362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| skill  . GetTargetType  () != CSkill  :: STT_GUILD_ONE  
#line 20363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| skill  . GetTargetType  () != CSkill  :: STT_GUILD_ALL ))
#line 20364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 20366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! g_iAutoAttack )
#line 20371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 20373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 20378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILL );
#line 20379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetPos  (0 , 0 , 0);
#line 20384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirection  (0 , 0 , 0);
#line 20387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skill  . IsNeedTarget  ())
#line 20388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetTargetDirection  (this  , GetPlayerWeapons  () -> m_penRayHitTmp  , vTargetPos  , vDirection );
#line 20390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetTargetDirection  (this  , this  , vTargetPos  , vDirection );
#line 20394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(m_nCurrentSkillNum )
#line 20398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_SELF_HEAL : 
#line 20400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_PARTY_HEAL : 
#line 20401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_HEAL : 
#line 20402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PreSkillTime  = 0.0f;
#line 20403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > _PreSkillTime  && bPlayPreSkill )
#line 20404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = FALSE ;
#line 20406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_HEAL_DO ) , SOF_3D  | SOF_VOLUMETRIC );
#line 20407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case HE_DEFENCE_MANA : 
#line 20412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_PreSkillTime  = 0.0f;
#line 20413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () - m_tmSkillStartTime  > _PreSkillTime  && bPlayPreSkill )
#line 20414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPlayPreSkill  = FALSE ;
#line 20416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , GenderSound  (SOUND_HEALER_DEFENCE_MANA_DO ) , SOF_3D  | SOF_VOLUMETRIC );
#line 20417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UseSkill(int skillIndex) 
#line 20426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE )
#line 20428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetSystemMenu  () -> CancelRestart  ();
#line 20430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 20434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction  || IsTransform  () || IsPolymophing  ())
#line 20438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(skillIndex  == - 1)
#line 20443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 20449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_PETRIDING ) || pUIManager  -> IsCSFlagOn  (CSF_TELEPORT ))
#line 20450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (skillIndex );
#line 20457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1 && m_bSkilling )
#line 20458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  == skillIndex  || m_nReservedSkillNum  == skillIndex )
#line 20460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DOUBLE  dDelayTime  = DOUBLE  (SkillData  . GetReUseTime  () + GetMagicspeed  ()) / 10.0;
#line 20468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DOUBLE  dElapsedTime  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  () - SkillData  . Skill_Data  . Skill_StartTime ;
#line 20470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nCoolTimeReductionRate  = 0;
#line 20472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . GetJob  () != PET_JOB  && SkillData  . GetJob  () != WILDPET_JOB  && ! (SkillData  . GetFlag  () & SF_GUILD ))
#line 20473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (SkillData  . Skill_Data  . appState  & SCT_NOCOOLTIME ))
#line 20475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nCoolTimeReductionRate  = SE_Get_UIManagerPtr  () -> GetCoolTimeReductionRate  ();
#line 20477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
dDelayTime  *= DOUBLE  (100 - nCoolTimeReductionRate ) / 100.0f;
#line 20479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dElapsedTime  <= dDelayTime )
#line 20482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = skillIndex ;
#line 20489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bStartAttack )
#line 20490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillData  . IsNeedTarget  ())
#line 20510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget )
#line 20517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = penTarget ;
#line 20519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UsePetPickItem() 
#line 20524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 20527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyPetInfo  () -> pen_pEntity )
#line 20528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPetBase  *) pInfo  -> GetMyPetInfo  () -> pen_pEntity ) -> SearchNearItem  ();
#line 20530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPetBase  *) pInfo  -> GetMyPetInfo  () -> pen_pEntity ) -> FindNewItemTarget  ();
#line 20531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UsePetSkill(int skillIndex) 
#line 20536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction  || m_bMobChange )
#line 20538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (skillIndex );
#line 20544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iSkillType  = SkillData  . GetType  ();
#line 20547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iSkillType  != CSkill  :: ST_PET_SKILL_ACTIVE )
#line 20548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = skillIndex ;
#line 20554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bStartAttack )
#line 20555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SkillData  . IsNeedTarget  ())
#line 20561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget )
#line 20568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = penTarget ;
#line 20570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UseSlaveSkill(CEntity * pEntity,int skillIndex) 
#line 20575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CSlave  *) pEntity ) -> UseSkill  (skillIndex );
#line 20577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UseWildSkill(CEntity * pEntity,int skillIndex) 
#line 20580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 20582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UseSkill  (skillIndex );
#line 20584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CWildPet  *) pEntity ) -> UseSkill  (skillIndex );
#line 20588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::UseAction(int ActionIndex) 
#line 20592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsFlagOff  (ENF_ALIVE ))
#line 20594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ))
#line 20601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 20607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(ActionIndex )
#line 20608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SITDOWN : 
#line 20618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide  && m_bWildRide )
#line 20619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 20621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 20622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 20623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction  && 
#line 20626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  != - 1 && 
#line 20627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  != ACTION_NUM_SITDOWN )
#line 20628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nActionSit  == 0)
#line 20633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 1;
#line 20635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . job  == NIGHTSHADOW )
#line 20636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , FALSE );
#line 20638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nActionSit  == 2)
#line 20641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 3;
#line 20643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20646 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 20649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = ActionIndex ;
#line 20650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bPersonalShop  = FALSE ;
#line 20652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_WALK_RUN : 
#line 20655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRunningMode  = ! m_bRunningMode ;
#line 20656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRunningMode )
#line 20659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fSpeed  = GetRunspeed  ();
#line 20662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plr_fSpeed  = GetWalkspeed  ();
#line 20667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_WALK_RUN  , 0);
#line 20670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_PK : 
#line 20673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide  || m_bWildRide )
#line 20674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_WAR  || 
#line 20684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . level  > 15)
#line 20686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsLegit  () == FALSE )
#line 20688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ACTION_NUM_PK  , 0);
#line 20690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (_S  (806 , "15레벨 이하는 PVP를 할 수가 없습니다.") , SYSMSG_ERROR );
#line 20695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_WILDPET_RIDING : 
#line 20698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_PET  ] . IsEmptyItem  () == FALSE  && ! pUIManager  -> IsCSFlagOn  (CSF_SKILLREADY ) && ! m_bSkilling )
#line 20700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemData  * pItemData  = _pNetwork  -> GetItemData  (_pNetwork  -> MyWearItem  [ WEAR_PET  ] . Item_Index );
#line 20702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 20704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsTransform  ())
#line 20705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (2574 , "변신중일때는 애완동물을 탈 수 없습니다.") , SYSMSG_ERROR );
#line 20707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pItemData  -> GetSubType  () != CItemData  :: ACCESSORY_WILDPET ))
#line 20711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5489 , "펫을 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () == NULL )
#line 20716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5489 , "펫을 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CWildPetData  * rWildPet  = CWildPetData  :: getData  (pInfo  -> GetMyApetInfo  () -> m_nIndex );
#line 20723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(rWildPet  != NULL  && (rWildPet  -> nMount  [ pInfo  -> GetMyApetInfo  () -> m_sbTransStat  ] < 1))
#line 20724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5489 , "펫을 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((pInfo  -> GetMyApetInfo  () -> m_pEntity  == NULL ) || pInfo  -> GetMyApetInfo  () -> m_pEntity  -> IsWildPet  () && ! pInfo  -> GetMyApetInfo  () -> m_pEntity  -> IsAvailableRide  ())
#line 20730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5489 , "펫을 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . job  == NIGHTSHADOW )
#line 20735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5308 , "나이트 셰도우는 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((static_cast  < CPlayerEntity  * > (CEntity  :: GetPlayerEntity  (0))) -> IsSitting  ()))
#line 20742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetChattingUI  () -> AddSysMessage  (_S  (5310 , "앉은 상태에서는 탑승할 수 없습니다.") , SYSMSG_ERROR );
#line 20744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_iNetworkResponse  [ MSG_PERSONALSHOP  ] != 0)
#line 20749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> Is_MyChar_MorphStatus_MORPH_END  ())
#line 20757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendWildPetMountReq  (_pNetwork  -> MyCharacterInfo  . bWildPetRide );
#line 20762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GREET : 
#line 20766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SMILE : 
#line 20767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_CRY : 
#line 20768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_NUMBER_ONE : 
#line 20769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_HANDCLAP : 
#line 20770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_REFUSE : 
#line 20771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GOOD_LOOKS : 
#line 20772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_GOOD_LOOKS2 : 
#line 20773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_BANTER : 
#line 20774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_CHEER : 
#line 20775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_COMBAT : 
#line 20776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_SUBMISSION : 
#line 20777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case ACTION_NUM_WATER_SPREAD : 
#line 20778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide  || m_bWildRide )
#line 20779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction  && (m_nPlayActionNum  == ActionIndex  
#line 20784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| m_nPlayActionNum  == ACTION_NUM_WATER_SPREAD )
#line 20785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 20786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange  || m_bIsTransform )
#line 20791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 20793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 20794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 20795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 20796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bSkilling  || m_bStartAttack  || (m_bForward  || m_bKeyMove ))
#line 20798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 20800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 20801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 20805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nActionSit  != 2 && m_nActionSit  != 1 && m_nActionSit  != 3)
#line 20808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = ActionIndex ;
#line 20810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 20811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteWearingWeapon  (FALSE  , FALSE );
#line 20812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendActionMessage  (0 , ActionIndex  , 0 , GetPlayerWeapons  () -> m_penRayHitTmp );
#line 20813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20814 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
default  : 
#line 20816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 20817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ClearMultiTargets() 
#line 20821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 20823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsLegit() 
#line 20826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nLegit  != 0 && _pNetwork  -> MyCharacterInfo  . pk_mode  > 0)
#line 20828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 20830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (858 , "현재 당신에게 정당방위가 발동되어 있어서 PVP 해제가 불가능합니다."));
#line 20831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 20832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 20833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 20835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 20837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetTargetNull() 
#line 20838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 20840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = NULL ;
#line 20842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 20843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetTargetMe() 
#line 20846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 20850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetReserve  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWaitForSkillTarget )
#line 20853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = this ;
#line 20855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = this ;
#line 20856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = this ;
#line 20860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bRet  = this  -> SetTargetInfo  (_pNetwork  -> MyCharacterInfo  . maxHP  , _pNetwork  -> MyCharacterInfo  . hp  , TRUE  , 0 , _pNetwork  -> MyCharacterInfo  . pk_mode  , _pNetwork  -> MyCharacterInfo  . pkpenalty );
#line 20864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRet  == true )
#line 20865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
this  -> SetTargetSyndicateInfo  (_pNetwork  -> MyCharacterInfo  . iSyndicateType  , _pNetwork  -> MyCharacterInfo  . iSyndicateGrade );
#line 20867 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsSameTarget(CEntity * penEntity) 
#line 20871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return INFO  () -> GetTargetEntity  (eTARGET ) == penEntity ;
#line 20873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetTarget(CEntity * penEntity) 
#line 20876 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWaitForSkillTarget )
#line 20879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = penEntity ;
#line 20881 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20882 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = penEntity ;
#line 20885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penEntity  -> SetTargetInfo  (0 , 0 , FALSE  , 0);
#line 20888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetMobData(CEntity * penEntity,SLONG hp,SLONG maxHp,int level,BOOL bNpc,int mobIdx) 
#line 20891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = maxHp ;
#line 20893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = hp ;
#line 20894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMobLevel  = level ;
#line 20895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CEnemyBase  *) penEntity ) -> m_bNpc  = bNpc ;
#line 20896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMobDBIndex  = mobIdx ;
#line 20897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetPetData(CEntity * penEntity,SLONG hp,SLONG maxHP) 
#line 20900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = maxHP ;
#line 20902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = hp ;
#line 20903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetWildPetData(CEntity * penEntity,SLONG hp,SLONG maxHP) 
#line 20906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = maxHP ;
#line 20908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = hp ;
#line 20909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((CUnit  *) penEntity )
#line 20910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> SendActEvent  ();
#line 20912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetElementalData(CEntity * penEntity,SLONG hp,SLONG maxHP) 
#line 20916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nMaxiHealth  = maxHP ;
#line 20918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_nCurrentHealth  = hp ;
#line 20921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsFirstExtraFlagOn  (ENF_EX1_CURRENT_SLAVE ))
#line 20922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 20924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 20925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSlaveTargetInfom  * pSlaveInfo  = NULL ;
#line 20927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = UI_SUMMON_START ;i  <= UI_SUMMON_END ;++ i )
#line 20928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSummonUI  * pUISummon  = (CSummonUI  *) pUIManager  -> GetUI  (i );
#line 20930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSlaveInfo  = pInfo  -> GetMySlaveInfo  (i  - UI_SUMMON_START );
#line 20932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUISummon  -> GetSummonEntity  () && pUISummon  -> GetSummonIndex  () == penEntity  -> GetNetworkID  () && pSlaveInfo  != NULL )
#line 20933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSlaveInfo  -> fHealth  = hp ;
#line 20935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pSlaveInfo  -> fMaxHealth  = maxHP ;
#line 20936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetElementalStatus(CEntity * penEntity,SBYTE sbAttackSpeed,SBYTE sbMagicSpeed,LONG lSkillSpeed,FLOAT fWalkSpeed,FLOAT fRunSpeed,FLOAT fAttackRange) 
#line 20942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fWalkSpeed  = fWalkSpeed ;
#line 20944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackRunSpeed  = fRunSpeed ;
#line 20945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseRunSpeed  = fRunSpeed ;
#line 20946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fAttackDistance  = fAttackRange ;
#line 20947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fCloseDistance  = fAttackRange ;
#line 20948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fStopDistance  = fAttackRange ;
#line 20949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penEntity ) -> m_fSkillSpeed  = (100 - lSkillSpeed ) / 100.0f;
#line 20950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bHardCode  = FALSE ;
#line 20951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static FLOAT AttackSpeed  = 10.0f;
#line 20952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bHardCode )
#line 20953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
sbAttackSpeed  = AttackSpeed ;
#line 20955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CSlave  *) penEntity ) -> SetAttackSpeed  (sbAttackSpeed );
#line 20958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::CommandAttack() 
#line 20961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penRayHitTmp ;
#line 20963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetReserve  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  && GetPlayerWeapons  () -> m_penReservedTarget  -> GetFlags  () & ENF_ALIVE )
#line 20965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CommandAction() 
#line 20971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTarget  = GetPlayerWeapons  () -> m_penReservedTarget ;
#line 20974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  == this )
#line 20975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 20977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTarget  && (penTarget  -> GetFlags  () & ENF_ALIVE  && penTarget  -> IsCharacter  ()))
#line 20980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 20983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((! IsPvp  () || (IsPvp  () && GAMEDATAMGR  () -> GetPartyInfo  () -> IsPartyMember  (penTarget  -> GetNetworkID  ()))) && 
#line 20984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! pUIManager  -> GetGuildBattle  () -> IsEnemy  (penTarget  -> en_ulID )
#line 20985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 20986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 20988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 20992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 20995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 20996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 20997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 20998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 21000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::InflictDirectDamage(CEntity * penToDamage,CEntity * penInflictor,enum DamageType dmtType,
#line 21001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDamageAmmount,const FLOAT3D & vHitPoint,const FLOAT3D & vDirection) 
#line 21002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  == NULL ){return ;}
#line 21005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (penToDamage  -> GetFlags  () & ENF_ALIVE )){return ;}
#line 21007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pen  = penToDamage ;
#line 21008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentCenter  (((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 21009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 21010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (this  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 21011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vCurrentPos  = this  -> en_plPlacement  . pl_PositionVector  + vCurrentCenter ;
#line 21012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetCenter  (0 , 0 , 0);
#line 21013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vTargetPos  (0 , 0 , 0);
#line 21014 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDirection2  (0 , 0 , 0);
#line 21015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT size  = 0;
#line 21016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  -> GetFlags  () & ENF_ALIVE )
#line 21017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  -> en_RenderType  == RT_SKAMODEL )
#line 21019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D bbox ;
#line 21022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pen  -> GetModelInstance  () -> GetCurrentColisionBox  (bbox );
#line 21023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRadius  = (bbox  . maxvect  - bbox  . minvect ) * 0.5f * 0.4f;
#line 21030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
size  = vRadius  . Length  ();
#line 21031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetCenter  = FLOAT3D (((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 0 ] , 
#line 21033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 1 ] , 
#line 21034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((EntityInfo  *) (pen  -> GetEntityInfo  ())) -> vTargetCenter  [ 2 ]);
#line 21035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  = pen  -> en_plPlacement  . pl_PositionVector  + vTargetCenter ;
#line 21036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection2  = vTargetPos  - vCurrentPos ;
#line 21037 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection2  . Normalize  ();
#line 21038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTargetPos  -= vDirection2  * size ;
#line 21039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection2  . Normalize  ();
#line 21042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 21045 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage )
#line 21046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("------%f--InflictDirectDamage\n" , _pTimer  -> GetLerpedCurrentTick  ());
#line 21048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX preHealth  , curHealth ;
#line 21049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
preHealth  = ((CUnit  *) penToDamage ) -> m_nPreHealth ;
#line 21050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
curHealth  = ((CUnit  *) penToDamage ) -> m_nCurrentHealth ;
#line 21052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(preHealth  != - 1)
#line 21053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 21056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  = 1;
#line 21058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penToDamage ) -> m_nCurrentHealth  = ((CUnit  *) penToDamage ) -> m_nPreHealth ;
#line 21060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else fDamageAmmount  = 0;
#line 21063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == penToDamage )
#line 21064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetEntity  (eTARGET ) == this )
#line 21066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> UpdateTargetInfo  (_pNetwork  -> MyCharacterInfo  . maxHP  , _pNetwork  -> MyCharacterInfo  . hp );
#line 21068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> UpdateTargetInfo  (((CUnit  *) penToDamage ) -> m_nMaxiHealth  , ((CUnit  *) penToDamage ) -> m_nCurrentHealth );
#line 21072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetTargetCurHP  (eTARGET ) <= 0)
#line 21076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  == pInfo  -> GetTargetEntity  (eTARGET ))
#line 21078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 21080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  -> IsEnemy  () && preHealth  >= 0)
#line 21084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) penToDamage ) -> m_nMobDBIndex ;
#line 21087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iMobIndex  == LORD_SYMBOL_INDEX )
#line 21088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 21090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fMaxHealth  = ((CUnit  *) penToDamage ) -> m_nMaxiHealth ;
#line 21092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((curHealth  <= fMaxHealth  * 0.25f))
#line 21093 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) penToDamage ) -> m_nPlayActionNum  != 0)
#line 21095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> SetSkaModel  ("data\\npc\\Gguard\\sword04.smc");
#line 21097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> RefreshTagManager  ();
#line 21098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> StretchModel  (FLOAT3D (MD  -> GetScale  () , MD  -> GetScale  () , MD  -> GetScale  ()));
#line 21099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penToDamage ) -> m_nPlayActionNum  = 0;
#line 21100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((curHealth  <= fMaxHealth  * 0.50f))
#line 21103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) penToDamage ) -> m_nPlayActionNum  != 1)
#line 21105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> SetSkaModel  ("data\\npc\\Gguard\\sword03.smc");
#line 21107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> RefreshTagManager  ();
#line 21108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> StretchModel  (FLOAT3D (MD  -> GetScale  () , MD  -> GetScale  () , MD  -> GetScale  ()));
#line 21109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penToDamage ) -> m_nPlayActionNum  = 1;
#line 21110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((curHealth  <= fMaxHealth  * 0.75f))
#line 21113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) penToDamage ) -> m_nPlayActionNum  != 2)
#line 21115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> SetSkaModel  ("data\\npc\\Gguard\\sword02.smc");
#line 21117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> RefreshTagManager  ();
#line 21118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> GetModelInstance  () -> StretchModel  (FLOAT3D (MD  -> GetScale  () , MD  -> GetScale  () , MD  -> GetScale  ()));
#line 21119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penToDamage ) -> m_nPlayActionNum  = 2;
#line 21120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) penToDamage ) -> m_nPreHealth  = - 1;
#line 21126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  -> IsEnemy  ())
#line 21130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const INDEX iMobIndex  = ((CEnemy  *) penToDamage ) -> m_nMobDBIndex ;
#line 21133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 21134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> m_bSingleMode )
#line 21135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (iMobIndex );
#line 21138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> IsLordSymbol  () || MD  -> IsCastleTower  ())
#line 21139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , dmtType  , 
#line 21141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if((iJob  == TITAN  || 
#line 21144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iJob  == KNIGHT  || 
#line 21145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(iJob  == ROGUE  && ! _pNetwork  -> MyCharacterInfo  . bExtension ) || 
#line 21146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(IsEXRogue  (iJob ) && ! _pNetwork  -> MyCharacterInfo  . bExtension ) || 
#line 21147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(iJob  == SORCERER  && m_iTransformType  != CTransformInfo  :: TYPE_1 )) && 
#line 21148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penToDamage )) -> m_nCurrentHealth  <= 0 && penToDamage  != this )
#line 21149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , DMT_EXPLOSION  , 
#line 21151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
15.0f , vTargetPos  , vDirection2 );
#line 21152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , dmtType  , 
#line 21156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21163 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == EXTREAM_SINGLEDUNGEON )
#line 21166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(dmtType  == DMT_EXPLOSION )
#line 21170 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 21172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDamageAmount  = 40;
#line 21173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! ((CEnemy  *) penToDamage ) -> m_bBoss )
#line 21174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iJob  == TITAN )
#line 21176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmount  = 70;
#line 21178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iJob  == KNIGHT )
#line 21180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmount  = 60;
#line 21182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmount  = 15;
#line 21187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection2  (1) = 0.0f;
#line 21189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDirection2  . Normalize  ();
#line 21190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , DMT_EXPLOSION  , 
#line 21191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmount  , vTargetPos  , vDirection2 );
#line 21192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , DMT_EXPLOSION  , 
#line 21196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , DMT_EXPLOSION  , 
#line 21202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21203 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(penToDamage  -> IsCharacter  ())
#line 21207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> ShowDamage  (penToDamage  -> en_ulID );
#line 21209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , dmtType  , 
#line 21210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const int  iJob  = en_pcCharacter  . pc_iPlayerType ;
#line 21217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((iJob  == TITAN  || iJob  == KNIGHT  || 
#line 21218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
! (iJob  == SORCERER  && m_iTransformType  == CTransformInfo  :: TYPE_1 ) || 
#line 21219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(iJob  == ROGUE  && ! _pNetwork  -> MyCharacterInfo  . bExtension ) || 
#line 21220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(IsEXRogue  (iJob ) && ! _pNetwork  -> MyCharacterInfo  . bExtension )) && 
#line 21221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penToDamage )) -> m_nCurrentHealth  <= 0 && penToDamage  != this )
#line 21222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , DMT_EXPLOSION  , 
#line 21224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
15.0f , vTargetPos  , vDirection2 );
#line 21225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  :: InflictDirectDamage  (penToDamage  , penInflictor  , dmtType  , 
#line 21229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDamageAmmount  , vTargetPos  , vDirection2 );
#line 21230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CLiveEntity  *) ((CEntity  *) penToDamage )) -> SetHealth  (1000.0f);
#line 21237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  -> IsEnemy  ())
#line 21238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) ((CEntity  *) penToDamage )) -> m_nCurrentHealth  <= 0 && penToDamage  != this )
#line 21240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CMobData  * MD  = CMobData  :: getData  (((CEnemy  *) penToDamage ) -> m_nMobDBIndex );
#line 21242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! MD  -> IsCastleTower  ())
#line 21243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penToDamage )) -> DeathNow  ();
#line 21245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MD  -> GetMobIndex  () >= DEF_MOB_ID_DRATAN_TOWER  && 
#line 21251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MD  -> GetMobIndex  () <= DEF_MOB_ID_MASTER_TOWER )
#line 21252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penToDamage )) -> DeathNow  ();
#line 21254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penToDamage  -> SetFlagOff  (ENF_ALIVE );
#line 21258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  == pInfo  -> GetTargetEntity  (eTARGET ))
#line 21262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 21264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CUnit  *) ((CEntity  *) penToDamage )) -> m_nCurrentHealth  <= 0 && penToDamage  != this )
#line 21270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CUnit  *) ((CEntity  *) penToDamage )) -> DeathNow  ();
#line 21273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penToDamage  == pInfo  -> GetTargetEntity  (eTARGET ))
#line 21274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 21276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::CancelSkill(BOOL bLostTarget,BOOL bAutoAttack,BOOL bSkillError) 
#line 21282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartPostSkill  = TRUE ;
#line 21285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penStillTarget  != NULL )
#line 21286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penStillTarget  = NULL ;
#line 21288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bConnectEffect )
#line 21291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bConnectEffect  = FALSE ;
#line 21293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillTexture  . SetData  (NULL );
#line 21294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachPlayerEffect  , 0.1f);
#line 21295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopEffectGroupIfValid  (m_pAttachEnemyEffect  , 0.1f);
#line 21296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bPostSkill  && INFO  () -> GetTargetEntity  (eTARGET ) != NULL )
#line 21299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 21301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 21303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_bPostSkill  && INFO  () -> GetTargetEntity  (eTARGET ) == NULL )
#line 21308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPostSkill  = FALSE ;
#line 21310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 21311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bLockSkillCancel  || (m_bWaitForSkillResponse  && ! bSkillError ))
#line 21314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 21316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 21318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ) && 
#line 21324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack )
#line 21325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 21327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bStartAttack )
#line 21330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 21332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReservedCancel  = ! bAutoAttack ;
#line 21333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 21338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkill  & SkillData  = _pNetwork  -> GetSkillData  (m_nCurrentSkillNum );
#line 21340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SkillData  . bCanCancel )
#line 21341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((g_bPreSkill  || g_bDoSkill ) && ! g_bPostSkill )
#line 21343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 21345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 21346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReservedCancel  = ! bAutoAttack ;
#line 21351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 21352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((g_bPreSkill  || g_bDoSkill ) && ! g_bPostSkill ) || ! (g_bPreSkill  || g_bDoSkill  || g_bPostSkill ))
#line 21361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = - 1;
#line 21364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = 0.0f;
#line 21365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = FALSE ;
#line 21366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 21367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 21369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 21371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 21373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 21375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 21377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = TRUE ;
#line 21379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 21381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL  
#line 21382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& ((! bLostTarget  && ! bAutoAttack ) || bLostTarget )
#line 21383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 21384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 21387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bLostTarget )
#line 21390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 21395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(STAGEMGR  () -> GetCurStage  () == eSTAGE_GAMEPLAY  && STAGEMGR  () -> GetNextStage  () == eSTAGE_NONE )
#line 21396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendClickObject  (- 1);
#line 21398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitClick  != NULL )
#line 21401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitClick  = NULL ;
#line 21403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  != NULL )
#line 21405 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = NULL ;
#line 21407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> SetCSFlagOff  (CSF_SKILL );
#line 21413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pSkillReadyEffect  != NULL  && CEffectGroupManager  :: Instance  () . IsValidCreated  (m_pSkillReadyEffect ))
#line 21414 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  -> Stop  (0.1f);
#line 21416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pSkillReadyEffect  = NULL ;
#line 21417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 21421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPreSkill  = g_bDoSkill  = g_bPostSkill  = FALSE ;
#line 21422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::Rebirth() 
#line 21428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDeathChk  = FALSE ;
#line 21430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = FALSE ;
#line 21431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fHealth  = 1000000.0f;
#line 21432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRcvAtMsg  = TRUE ;
#line 21433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 21436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 21438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CloseMessageBox  (MSGCMD_PC_DEATH );
#line 21441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetResurrectionMsgBox  () -> CloseResurrectionMsgBox  ();
#line 21443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (EEnd  ());
#line 21444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 21446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::CheckField() 
#line 21447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == 0)
#line 21449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . x  <= AREA_CASTLE_X0  + 100 || _pNetwork  -> MyCharacterInfo  . x  >= AREA_CASTLE_X1  + 100 
#line 21451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pNetwork  -> MyCharacterInfo  . z  <= AREA_CASTLE_Z0  - 100 || _pNetwork  -> MyCharacterInfo  . z  >= AREA_CASTLE_Z1  + 100)
#line 21452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEnvironmentSound  = FALSE ;
#line 21454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEnvironmentSound  = FALSE ;
#line 21458 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . x  >= AREA_CASTLE_X0  && _pNetwork  -> MyCharacterInfo  . x  <= AREA_CASTLE_X1  
#line 21461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pNetwork  -> MyCharacterInfo  . z  >= AREA_CASTLE_Z0  && _pNetwork  -> MyCharacterInfo  . z  <= AREA_CASTLE_Z1 )
#line 21462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bFieldArea  = FALSE ;
#line 21464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bFieldArea  = TRUE ;
#line 21468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_slZone  == 4)
#line 21471 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21472 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . x  <= AREA_CASTLE_DRATAN_X0  + 100 || _pNetwork  -> MyCharacterInfo  . x  >= AREA_CASTLE_DRATAN_X1  + 100 
#line 21473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
|| _pNetwork  -> MyCharacterInfo  . z  <= AREA_CASTLE_DRATAN_Z0  - 100 || _pNetwork  -> MyCharacterInfo  . z  >= AREA_CASTLE_DRATAN_Z1  + 100)
#line 21474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEnvironmentSound  = FALSE ;
#line 21476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21478 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEnvironmentSound  = FALSE ;
#line 21480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . x  >= AREA_CASTLE_DRATAN_X0  && _pNetwork  -> MyCharacterInfo  . x  <= AREA_CASTLE_DRATAN_X1  
#line 21483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pNetwork  -> MyCharacterInfo  . z  >= AREA_CASTLE_DRATAN_Z0  && _pNetwork  -> MyCharacterInfo  . z  <= AREA_CASTLE_DRATAN_Z1 )
#line 21484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bFieldArea  = FALSE ;
#line 21486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bFieldArea  = TRUE ;
#line 21490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::PlayBGM(CTFileName fnFileName) 
#line 21499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penMusicHolder  = _pNetwork  -> GetEntityWithName  ("MusicHolder" , 0);
#line 21501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penMusicHolder  != NULL  && "Cannot find Music-Holder!");
#line 21503 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EChangeMusic  ecm ;
#line 21504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fVolume  = m_fVolume ;
#line 21505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . mtType  = m_mtType ;
#line 21506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . bForceStart  = TRUE ;
#line 21507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = fnFileName ;
#line 21508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penMusicHolder  -> SendEvent  (ecm );
#line 21509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 21511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::PlayMusic() 
#line 21512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  != 0 && g_slZone  != 4)
#line 21514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penMusicHolder  = _pNetwork  -> GetEntityWithName  ("MusicHolder" , 0);
#line 21519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penMusicHolder  != NULL  && "Cannot find Music-Holder!");
#line 21521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EChangeMusic  ecm ;
#line 21522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fVolume  = m_fVolume ;
#line 21523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . mtType  = m_mtType ;
#line 21524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . bForceStart  = TRUE ;
#line 21526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL _bEnviron  = FALSE ;
#line 21528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bEnvironmentSound )
#line 21529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(g_slZone )
#line 21531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 0: 
#line 21533 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_FIELD_ENVIRON ;
#line 21534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 1: 
#line 21536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_DUNGEON_ENVIRON ;
#line 21537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 3: 
#line 21539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_DUNGEON_ENVIRON ;
#line 21540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 4: 
#line 21542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_DRATAN_ENVIRON ;
#line 21543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 7: 
#line 21545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_MERAC_FIELD ;
#line 21546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 9: 
#line 21548 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_DUNGEON_ENVIRON ;
#line 21549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case 15: 
#line 21551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_EGEHA_PEASE ;
#line 21552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 21553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penMusicHolder  -> SendEvent  (ecm );
#line 21556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL _bField  = FALSE ;
#line 21562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bField  != m_bFieldArea )
#line 21563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_bField  = m_bFieldArea ;
#line 21565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bFieldArea )
#line 21566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  == 0)
#line 21568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_FIELD_AREA ;
#line 21571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_slZone  == 4)
#line 21573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_FIELD_AREA ;
#line 21576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(g_slZone  == 15)
#line 21578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_FIELD_AREA ;
#line 21580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ecm  . fnMusic  = MUSIC_CASTLE_AREA ;
#line 21585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penMusicHolder  -> SendEvent  (ecm );
#line 21587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::AddDeathItem(CEntity * penEnemy,FLOAT3D pos,class CItemTarget * pItemTarget,class CItemData * pItemData) 
#line 21592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penEnemy  != NULL  && pItemTarget  != NULL );
#line 21594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CEnemy  *) penEnemy ) -> AddDeathItem  (pos  , pItemTarget  , pItemData );
#line 21595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::DropDeathItem(CEntity * penEnemy) 
#line 21600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penEnemy  != NULL );
#line 21602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CEnemy  *) penEnemy ) -> DropDeathItem  ();
#line 21603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 21605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool CPlayer::IsTestClient() 
#line 21606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21607 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  UINT  g_uiEntityVersion ;
#line 21608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  ENGINE_API  INDEX g_bTestClient ;
#line 21609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bTestClient  && g_uiEntityVersion  >= 10000)
#line 21610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return true ;
#line 21612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return false ;
#line 21614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SearchNearItem() 
#line 21617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fDistance  = 1000.0f;
#line 21619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fTmpDistance  = - 1.0f;
#line 21620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * pItemEntity  = NULL ;
#line 21621 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iItemID  = - 1;
#line 21624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide  || m_bWildRide )
#line 21625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . statusEffect  . IsState  (EST_ASSIST_FAKEDEATH ))
#line 21632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bPlayAction )
#line 21637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObjectByDistance  (GetPlacement  () . pl_PositionVector );
#line 21643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL  && pObject  -> m_eType  == eOBJ_ITEM )
#line 21644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21645 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CItemTarget  * pTarget  = static_cast  < CItemTarget  * > (pObject );
#line 21647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vDelta  = GetPlacement  () . pl_PositionVector  - pTarget  -> item_place ;
#line 21648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vDelta  (2) = 0.0f;
#line 21650 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
iItemID  = pTarget  -> GetSIndex  ();
#line 21651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fDistance  = vDelta  . Length  ();
#line 21652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pItemEntity  = pTarget  -> GetEntity  ();
#line 21653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  ("Near Item Distance : %f \n" , fDistance );
#line 21656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDistance  != 1000.0f && pItemEntity  != NULL  && fDistance  <= 20.0f)
#line 21657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(fDistance  <= 2.0f && iItemID  != - 1)
#line 21660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetInfo  (AU_PICK_ITEM );
#line 21662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = TRUE ;
#line 21663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = ACTION_NUM_PICKITEM ;
#line 21664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendPickMessage  (this  , iItemID  , FALSE );
#line 21665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bLockMove )
#line 21669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_vRayHitTmp  = pItemEntity  -> en_plPlacement  . pl_PositionVector ;
#line 21674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = pItemEntity ;
#line 21676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ))
#line 21677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = TRUE ;
#line 21680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = FLOAT3D (GetPlayerWeapons  () -> m_vRayHitTmp  (1) , GetPlayerWeapons  () -> m_vRayHitTmp  (2) , GetPlayerWeapons  () -> m_vRayHitTmp  (3));
#line 21684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 21685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 21688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsNotPersnalDungeon() 
#line 21689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_slZone  != PD_STRAIA  && g_slZone  != PD_MINOC  && 
#line 21691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_slZone  != T_STRAIA  && g_slZone  != PD_AJAKA  && g_slZone  != PD_GATEofDIMENSION )
#line 21692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 21694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 21697 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::DeathYou() 
#line 21700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 21703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> m_DamageLogInfo  . GetStart  ())
#line 21704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> m_DamageLogInfo  . EndDamageMode  ();
#line 21706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetGMNotice  ("데미지를 기록하는 모드를 종료합니다." , 0xFFAA33FF);
#line 21707 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> ClearDamageData  ();
#line 21711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = TRUE ;
#line 21712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iSkillEffectStep  = 0;
#line 21713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = TRUE ;
#line 21714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nLegit  = 0;
#line 21715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStuned  = FALSE ;
#line 21716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bHold  = FALSE ;
#line 21717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDeathChk  = TRUE ;
#line 21719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bChanging  = FALSE ;
#line 21720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bTransforming  = FALSE ;
#line 21723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMobChange  || ISTRANSFORMATION  (_pNetwork  -> MyCharacterInfo  . eMorphStatus ))
#line 21724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnChange  (TRUE );
#line 21726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bIsTransform  || ISEVOCATION  (_pNetwork  -> MyCharacterInfo  . eMorphStatus ))
#line 21728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ReturnSorcerer  ();
#line 21730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iTransformType  = 0;
#line 21731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EvocationStop  (_pNetwork  -> MyCharacterInfo  . index );
#line 21732 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AppearWearingWeapon  (FALSE );
#line 21736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL )
#line 21737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 21739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  ();
#line 21743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitNow  != NULL )
#line 21744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitNow  = NULL ;
#line 21746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = NULL ;
#line 21749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 21751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 21752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 21754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nCurrentSkillNum  != - 1)
#line 21755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bPreSkill  || g_bDoSkill  || g_bPostSkill )
#line 21757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendCancelSkillMessage  ();
#line 21759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_bPreSkill  = g_bDoSkill  = g_bPostSkill  = FALSE ;
#line 21763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 21764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayerInit  (true );
#line 21766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . hp  = 0;
#line 21767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . pk_mode  = 0;
#line 21768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRcvAtMsg  = FALSE ;
#line 21771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bPlayAction  = FALSE ;
#line 21772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nPlayActionNum  = - 1;
#line 21773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nActionSit  = 0;
#line 21775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bProduction  = FALSE ;
#line 21776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nProductionNum  = - 1;
#line 21778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  ())
#line 21779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21780 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetPvpMode  ();
#line 21781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Reset  ();
#line 21786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CloseMessageBox  (MSGCMD_PC_DEATH );
#line 21788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> m_iServerType  == SERVER_TYPE_HARDCORE )
#line 21789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetResurrectionMsgBox  () -> OpenResurrectionMsgBox  (300 , TRUE );
#line 21791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strTitle  , strMessage ;
#line 21800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . zoneNo  == 38)
#line 21801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetResurrectionMsgBox  () -> OpenResurrectionMsgBox  (30 , TRUE );
#line 21803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsNotPersnalDungeon  ())
#line 21809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> GetSiegeWarfareNew  () -> GetWarState  () && 
#line 21816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pNetwork  -> MyCharacterInfo  . sbAttributePos  & MATT_WAR  || MyCheckDratanWarInside  ()) 
#line 21817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
&& _pNetwork  -> MyCharacterInfo  . sbJoinFlagDratan  != WCJF_NONE )
#line 21818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetSiegeWarfareNew  () -> OpenWaitTime  ();
#line 21821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21823 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (RECOVER_HEXP_ITEM ) || _pUIBuff  -> IsBuff  (RECOVER_HEXP_ITEM_LUCKY ))
#line 21827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21828 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTitle  = _S  (2088 , "사용 확인");
#line 21829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIMsgBox_Info  MsgBoxInfo ;
#line 21832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  = _S  (4689 , "캐릭터가 죽었습니다.\n경험치 복구 주문서를 \n사용하시겠습니까? \n취소시  부활위치로 이동합니다.(제한 시간 이후 자동으로 이동합니다.)");
#line 21834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (RECOVER_HEXP_ITEM ))
#line 21835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_HEXP );
#line 21837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_HEXP_LUCKY );
#line 21841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . AddString  (strMessage );
#line 21843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxTimer  (300 , FALSE );
#line 21845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CreateMessageBox  (MsgBoxInfo );
#line 21846 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (RECOVER_AEXP_ITEM ) || _pUIBuff  -> IsBuff  (RECOVER_AEXP_ITEM_LUCKY ))
#line 21853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21854 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTitle  = _S  (2088 , "사용 확인");
#line 21855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIMsgBox_Info  MsgBoxInfo ;
#line 21858 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  = _S  (4690 , "캐릭터가 죽었습니다.\n숙련도 복구 주문서를\n사용하시겠습니까? \n취소시  부활위치로 이동합니다.(제한 시간 이후 자동으로 이동합니다.)");
#line 21859 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (RECOVER_AEXP_ITEM ))
#line 21860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_AEXP );
#line 21862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_AEXP_LUCKY );
#line 21866 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . AddString  (strMessage );
#line 21869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxTimer  (300 , FALSE );
#line 21871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CreateMessageBox  (MsgBoxInfo );
#line 21872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21877 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (REBIRTH_ITEM ) || _pUIBuff  -> IsBuff  (REBIRTH_ITEM_NEWBIE ) || _pUIBuff  -> IsBuff  (REBIRTH_ITEM_EVENT ))
#line 21878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21879 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTitle  = _S  (2088 , "사용 확인");
#line 21880 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIMsgBox_Info  MsgBoxInfo ;
#line 21883 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  = _S  (4691 , "캐릭터가 죽었습니다.\n부활 주문서를\n사용하시겠습니까? \n취소시  부활위치로 이동합니다.(제한 시간 이후 자동으로 이동합니다.)");
#line 21884 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_REBIRTH );
#line 21885 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . AddString  (strMessage );
#line 21888 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsGamigo  (g_iCountry ))
#line 21889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxTimer  (300 , TRUE );
#line 21891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxTimer  (300 , FALSE );
#line 21895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CreateMessageBox  (MsgBoxInfo );
#line 21898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pUIBuff  -> IsBuff  (REBIRTH_ITEM_PHOENIX ))
#line 21904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strTitle  = _S  (2088 , "사용 확인");
#line 21906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIMsgBox_Info  MsgBoxInfo ;
#line 21909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strMessage  = _S  (4692 , "캐릭터가 죽었습니다.\n피닉스의부활을\n사용하시겠습니까? \n취소시  부활위치로 이동합니다.(제한 시간 이후 자동으로 이동합니다.)");
#line 21910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxInfo  (strTitle  , UMBS_YESNO  | UMBS_USE_TIMER  , UI_NONE  , MSGCMD_USE_CONFIRM_REBIRTH );
#line 21911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . AddString  (strMessage );
#line 21912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MsgBoxInfo  . SetMsgBoxTimer  (300 , FALSE );
#line 21914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> CreateMessageBox  (MsgBoxInfo );
#line 21915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 21922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetResurrectionMsgBox  () -> OpenResurrectionMsgBox  (300 , TRUE );
#line 21926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 21930 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetResurrectionMsgBox  () -> OpenResurrectionMsgBox  (300);
#line 21933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 21934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath );
#line 21935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsAlreadyDie() 
#line 21938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bDying ;
#line 21940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetDie() 
#line 21943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDying  = TRUE ;
#line 21945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::PlayerInit(bool bDeath) 
#line 21948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bStartAttack  = FALSE ;
#line 21950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockSkillCancel  = FALSE ;
#line 21951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillResponse  = FALSE ;
#line 21953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_idCurrentSkillAnim  = - 1;
#line 21954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSkillStartTime  = 0.0f;
#line 21955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSkilling  = FALSE ;
#line 21956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nCurrentSkillNum  = - 1;
#line 21957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nDesiredSkillNum  = - 1;
#line 21959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 21961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nReservedSkillNum  = - 1;
#line 21963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWaitForSkillTarget  = FALSE ;
#line 21965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bCanSkillCancel  = TRUE ;
#line 21967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = GetPlacement  () . pl_PositionVector ;
#line 21968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL )
#line 21969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 21971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 21974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitClick  != NULL )
#line 21975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitClick  = NULL ;
#line 21977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  != NULL )
#line 21979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = NULL ;
#line 21981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 21985 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_SKILL );
#line 21986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_TELEPORT );
#line 21989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_PERSONALSHOP ))
#line 21990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_PERSONALSHOP );
#line 21992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . sbShopType  = PST_NOSHOP ;
#line 21993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . ShopMsg  . Reset  ();
#line 21994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> GetPersonalShop  () -> ResetShop  ();
#line 21995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 21997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bDeath  == false )
#line 21998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 21999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 22000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 22001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 22003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = TRUE ;
#line 22005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_HIDDEN );
#line 22006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsPvp() 
#line 22010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return _pNetwork  -> m_bIsPvp ;
#line 22012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsMoving() 
#line 22015 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bForward  | m_bKeyMove ;
#line 22017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsInputMovingKey() 
#line 22020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (((INDEX) _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_W  ] . ic_fValue ) | 
#line 22022 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((INDEX) _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_S  ] . ic_fValue ) | 
#line 22023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((INDEX) _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_A  ] . ic_fValue ) | 
#line 22024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((INDEX) _pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_D  ] . ic_fValue ));
#line 22025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22027 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsInputRotateKey() 
#line 22028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ((_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_W  ] . ic_fValue ) == 0.0f && 
#line 22030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_S  ] . ic_fValue ) == 0.0f && 
#line 22031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_A  ] . ic_fValue ) > 0.0f || 
#line 22032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_D  ] . ic_fValue ) > 0.0f));
#line 22033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::InputKey(INDEX Code) 
#line 22036 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAction  pa ;
#line 22040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bButtonAction  = FALSE ;
#line 22041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bRotate  = FALSE ;
#line 22042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL bMove  = FALSE ;
#line 22043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL s_bButtonPressedType  = 0;
#line 22044 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
static BOOL bPrevPressType  = 0;
#line 22046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 22048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! pUIManager  -> GetSelectResource  () -> GetKeyMove  ())
#line 22049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22054 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! IsInputMovingKey  ())
#line 22055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bKeyMove  && (! m_bOnlyRotate ))
#line 22059 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 22061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22067 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22070 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bKeyMove  && ! m_bOnlyRotate )
#line 22071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bForward 
#line 22073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
)
#line 22074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22075 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 22076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = TRUE ;
#line 22081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bOnlyRotate  = FALSE ;
#line 22085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATmatrix3D m ;
#line 22086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 22087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetLerpedAbsoluteViewPlacement  (plView );
#line 22088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  (2) = 0.0f;
#line 22089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  (3) = 0.0f;
#line 22091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
MakeRotationMatrixFast  (m  , plView  . pl_OrientationAngle );
#line 22094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vRight  = m  . GetColumn  (1);
#line 22095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vUp  = m  . GetColumn  (2);
#line 22096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vFront  = m  . GetColumn  (3);
#line 22104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((! m_bHold  || ! m_bStuned ))
#line 22105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_W  ] . ic_fValue  == 1.0f)
#line 22107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
s_bButtonPressedType  = 1;
#line 22109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_S  ] . ic_fValue  == 1.0f)
#line 22111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
s_bButtonPressedType  = 2;
#line 22113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 22115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bSendStopMessage )
#line 22117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMove  = FALSE ;
#line 22121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bButtonAction  = FALSE ;
#line 22122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(s_bButtonPressedType )
#line 22131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (IsAttacking  () || IsSkilling  ()))
#line 22133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(s_bButtonPressedType  == 1)
#line 22136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = en_plPlacement  . pl_PositionVector  - (vFront  * (plr_fSpeed  * 1.5f));
#line 22138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bButtonAction  = TRUE ;
#line 22139 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMove  = TRUE ;
#line 22140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(s_bButtonPressedType  == 2)
#line 22142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vDesiredPosition  = en_plPlacement  . pl_PositionVector  + (vFront  * (plr_fSpeed  * 1.5f));
#line 22144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bButtonAction  = TRUE ;
#line 22145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bMove  = TRUE ;
#line 22146 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bPrevPressType  != s_bButtonPressedType )
#line 22149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bPrevPressType  = s_bButtonPressedType ;
#line 22151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 22152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
s_bButtonPressedType  = 0;
#line 22155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_A  ] . ic_fValue  == 1.0f)
#line 22172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22173 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) += 2;
#line 22174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bButtonAction  = TRUE ;
#line 22175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRotate  = TRUE ;
#line 22176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pInput  -> GetInputDevice  (1) -> id_aicControls  [ KID_D  ] . ic_fValue  == 1.0f)
#line 22179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) -= 2;
#line 22181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bButtonAction  = TRUE ;
#line 22182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRotate  = TRUE ;
#line 22183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bButtonAction  && _pInput  -> IsLMouseButtonPressed  ())
#line 22186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22189 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! bMove  && bRotate )
#line 22193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bOnlyRotate  = TRUE ;
#line 22199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRotate  == TRUE  && bMove  == TRUE )
#line 22205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((unsigned  int  (_pTimer  -> GetLerpedCurrentTick  () * 1000)) - tmStartTime  > 200)
#line 22209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmStartTime  = 0;
#line 22211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bOnlyRotate )
#line 22215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSendStopMessage  = FALSE ;
#line 22217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pGameState  -> IsRestartGame  () == TRUE )
#line 22220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetSystemMenu  () -> CancelRestart  ();
#line 22222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsEXRogue(int job) 
#line 22228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (charEXRogue  && (job  == 7));
#line 22230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsEXMage(int job) 
#line 22233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(charEXRogue ){
#line 22235 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (charEXMage  && (job  == 8));
#line 22236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 22237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return (charEXMage  && (job  == 7));
#line 22238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ClearTargetInfo(CEntity * penEntity) 
#line 22242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  != NULL )
#line 22244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 22247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  == pInfo  -> GetTargetEntity  (eTARGET ))
#line 22248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET );
#line 22250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SendClickObject  (- 1);
#line 22251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  == pInfo  -> GetTargetEntity  (eTARGET_REAL ))
#line 22253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pInfo  -> TargetClear  (eTARGET_REAL );
#line 22255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22257 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  == penEntity )
#line 22258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 22260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  == penEntity )
#line 22262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = NULL ;
#line 22264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22266 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsSkilling() 
#line 22269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bSkilling ;
#line 22271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsPetActing() 
#line 22274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 22277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyPetInfo  () -> pen_pEntity )
#line 22278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CPet  *) pInfo  -> GetMyPetInfo  () -> pen_pEntity ) -> IsCommandAnimationPlaying  ())
#line 22280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsActionSitting() 
#line 22288 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nActionSit  == 1 || m_nActionSit  == 3)
#line 22290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22294 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsSitting() 
#line 22297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nActionSit  == 2)
#line 22299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_nActionSit  == 1 || m_nActionSit  == 3)
#line 22303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 22307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::LostTarget() 
#line 22315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 22318 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitTmp  != NULL )
#line 22319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 22321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22322 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penRayHitClick  != NULL )
#line 22323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitClick  = NULL ;
#line 22325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_penReservedTarget  != NULL )
#line 22327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22328 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penReservedTarget  = NULL ;
#line 22329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22330 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsIdle() 
#line 22334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsSitting  () || IsSkilling  () || IsMoving  () || IsAlreadyDie  ())
#line 22336 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
const BOOL CPlayer::IsTransform()const 
#line 22345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! m_bChanging  && ! m_bMobChange )
#line 22347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetSpeedUp(BOOL bMe,INDEX index,BOOL bSpeedup) 
#line 22355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bMe )
#line 22357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bSpeedUp  = bSpeedup ;
#line 22359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 22360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penCharacter ;
#line 22362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (index  , penCharacter ))
#line 22363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penCharacter  -> IsCharacter  ())
#line 22365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacterBase  *) penCharacter ) -> m_bSpeedUp  = bSpeedup ;
#line 22367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 22371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::IsRidePet(CEntity * pCharacter) 
#line 22374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharacter  -> IsPlayer  ())
#line 22376 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_bRide ;
#line 22378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pCharacter  -> IsCharacter  ())
#line 22380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pCharacter ) -> m_bRide ;
#line 22382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::RidingPet(CEntity * pCharacter,INDEX iPetType) 
#line 22387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbPetType  = iPetType  & 0xFF;
#line 22389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SBYTE  sbPetColor  = iPetType  >> 8;
#line 22391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharacter  -> IsPlayer  () && ! m_bRide )
#line 22392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 22396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(MY_PET_INFO  () -> fHungry  <= 0)
#line 22397 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22398 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOn  (CSF_MOUNT_HUNGRY );
#line 22399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_PETRIDING ))
#line 22402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_PETRIDING );
#line 22404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 22407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 22409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 22410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22412 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_qvOffset  = pCharacter  -> GetModelInstance  () -> mi_qvOffset ;
#line 22413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_iParentBoneID  = pCharacter  -> GetModelInstance  () -> mi_iParentBoneID ;
#line 22416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bPetRide  = TRUE ;
#line 22417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRide  = TRUE ;
#line 22418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iRideType  = sbPetType ;
#line 22420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vPos ;
#line 22421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ANGLE3D vAngle ;
#line 22424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRiderModelInstance  = ObtainModelInstance_t  (PetInfo  () . GetFileName  (sbPetType  , 2));
#line 22428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(sbPetColor  > 0)
#line 22429 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strTexFile  = PetInfo  () . GetColoredTexFileName  (sbPetType  , 2 , sbPetColor );
#line 22431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRiderModelInstance  -> mi_aMeshInst  [ 0 ] . mi_tiTextures  [ 0 ] . ti_toTexture  . SetData_t  (strTexFile );
#line 22432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
QVect  tmp_qvOfset ;
#line 22435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX tmp_iParentBoneID ;
#line 22436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmp_qvOfset  = m_pRiderModelInstance  -> mi_qvRideOffset ;
#line 22437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmp_iParentBoneID  = m_pRiderModelInstance  -> mi_iRideParentBoneID ;
#line 22439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  = CreateModelInstance  ("");
#line 22440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  -> Copy  (* pCharacter  -> GetModelInstance  ());
#line 22441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRiderModelInstance  -> AddChild  (m_pRideCharModelInstance  , tmp_iParentBoneID );
#line 22443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> Copy  (* m_pRiderModelInstance );
#line 22445 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & child  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
child  . mi_qvOffset  = tmp_qvOfset ;
#line 22450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22453 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> NewClearState  (0.0f);
#line 22454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & cmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& cmi  . m_tmSkaTagManager  , 1);
#line 22461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& cmi  . m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 22463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 22465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22466 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pCharacter  -> IsCharacter  ())
#line 22467 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22468 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pCharacter ) -> RidingPet  (pCharacter  , iPetType );
#line 22469 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22470 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::LeavingPet(CEntity * pCharacter) 
#line 22473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharacter  -> IsPlayer  () && m_bRide  && ! m_bWildRide )
#line 22475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CUIManager  * pUIManager  = SE_Get_UIManagerPtr  ();
#line 22479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_MOUNT_HUNGRY ))
#line 22480 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_MOUNT_HUNGRY );
#line 22482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22484 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pUIManager  -> IsCSFlagOn  (CSF_PETRIDING ))
#line 22485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pUIManager  -> SetCSFlagOff  (CSF_PETRIDING );
#line 22487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 22490 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 22492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 22493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22498 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22500 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & cmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  -> Copy  (cmi );
#line 22504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  . ClearChild  ();
#line 22505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> Copy  (* m_pRideCharModelInstance );
#line 22506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteModelInstance  (m_pRiderModelInstance );
#line 22507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  = NULL ;
#line 22508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRiderModelInstance  = NULL ;
#line 22509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> mi_qvOffset  = mi_qvOffset ;
#line 22510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> mi_iParentBoneID  = mi_iParentBoneID ;
#line 22511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> NewClearState  (0.0f);
#line 22513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  , 1);
#line 22514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 22515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22516 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bPetRide  = FALSE ;
#line 22517 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRide  = FALSE ;
#line 22518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWildRide  = FALSE ;
#line 22519 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iRideType  = - 1;
#line 22521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_WALKING );
#line 22522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_MODEL );
#line 22523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pCharacter  -> IsCharacter  ())
#line 22525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pCharacter ) -> LeavingPet  (pCharacter );
#line 22527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::InitBeastAnimation(void) 
#line 22531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22532 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CJobInfo  * pInfo  = CJobInfo  :: getSingleton  ();
#line 22534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  == NULL )
#line 22535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22536 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 22537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_WALK_1  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_WALK_1 ));
#line 22540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_1  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_IDLE_1 ));
#line 22541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_IDLE_2  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_IDLE_2 ));
#line 22542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_RUN_1  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_RUN_1 ));
#line 22543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_PICK  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_PICK ));
#line 22544 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DAMAGE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_DAMAGE ));
#line 22545 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_DIE ));
#line 22546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_LEVELUP  ] = ska_GetIDFromStringTable  (pInfo  -> GetAnimationName  (_pNetwork  -> MyCharacterInfo  . job  , ANIM_RIDE_HORSE_LEVELUP ));
#line 22547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetBeastAnimation(CEntity * pWildPet) 
#line 22550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPet  != NULL )
#line 22552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX animationIdx  = ANIM_RIDE_DEMONBAT_WALK_1 ;
#line 22554 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 22555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22556 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
animationIdx  = ANIM_RIDE_HORSE_WALK_1 ;
#line 22557 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22559 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Walk ;
#line 22560 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Idle1 ;
#line 22561 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Idle2 ;
#line 22562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Run ;
#line 22563 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Idle1 ;
#line 22564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Damage ;
#line 22565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ++ ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Death ;
#line 22566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
idPlayerWhole_Animation  [ animationIdx  ] = ((CWildPet  *) pWildPet ) -> iAnimWildPet_Idle1 ;
#line 22567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22568 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::RidingWildPet(CEntity * pCharacter,CEntity * pWildPet,CTString strFileName) 
#line 22571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pWildPet  != NULL )
#line 22573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pWildPet  -> en_EntityUseType  = CEntity  :: EU_DUMMY ;
#line 22575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharacter  -> IsPlayer  () && ! m_bRide )
#line 22578 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(static_cast  < CPlayerEntity  * > (CEntity  :: GetPlayerEntity  (0))) -> ClearTargetInfo  (pWildPet );
#line 22583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 22584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 22586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 22587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nWildPetType  = pWildPet  -> en_pWildPetTarget  -> m_nType ;
#line 22590 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetBeastAnimation  (pWildPet );
#line 22592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRidePetModelInstance  = ObtainModelInstance_t  (strFileName );
#line 22593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRidePetModelInstance  -> Copy  (* pWildPet  -> GetModelInstance  ());
#line 22595 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_qvOffset  = pCharacter  -> GetModelInstance  () -> mi_qvOffset ;
#line 22596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
mi_iParentBoneID  = pCharacter  -> GetModelInstance  () -> mi_iParentBoneID ;
#line 22598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bWildPetRide  = TRUE ;
#line 22599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRide  = TRUE ;
#line 22600 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWildRide  = TRUE ;
#line 22602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
QVect  tmp_qvOfset ;
#line 22603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX tmp_iParentBoneID ;
#line 22605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmp_qvOfset  = m_pRidePetModelInstance  -> mi_qvRideOffset ;
#line 22606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmp_iParentBoneID  = m_pRidePetModelInstance  -> mi_iRideParentBoneID ;
#line 22609 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  = CreateModelInstance  ("");
#line 22610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  -> Copy  (* pCharacter  -> GetModelInstance  ());
#line 22611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRidePetModelInstance  -> AddChild  (m_pRideCharModelInstance  , tmp_iParentBoneID );
#line 22612 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> Copy  (* m_pRidePetModelInstance );
#line 22614 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22615 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & child  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
child  . mi_qvOffset  = tmp_qvOfset ;
#line 22619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> NewClearState  (0.0f);
#line 22623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & cmit  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& cmit  . m_tmSkaTagManager  , 1);
#line 22630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& cmit  . m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 22632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 22637 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pWildPet  -> Destroy  ();
#line 22638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pCharacter  -> IsCharacter  ())
#line 22640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(static_cast  < CCharacter  * > (pCharacter )) -> RidingWildPet  (static_cast  < CCharacter  * > (pCharacter ) , pWildPet  , strFileName );
#line 22643 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22644 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::LeavingWildPet(CEntity * pCharacter) 
#line 22647 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pCharacter  -> IsPlayer  () && m_bRide  && m_bWildRide )
#line 22649 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SE_Get_UIManagerPtr  () -> IsCSFlagOn  (CSF_MOUNT_HUNGRY ))
#line 22652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> SetCSFlagOff  (CSF_MOUNT_HUNGRY );
#line 22654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bForward  = FALSE ;
#line 22657 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bKeyMove  = FALSE ;
#line 22658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 22659 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 22660 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 22663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ctmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  . Count  ();
#line 22664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ctmi  > 0)
#line 22665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance & cmi  = pCharacter  -> GetModelInstance  () -> mi_cmiChildren  [ 0 ];
#line 22668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  -> Copy  (cmi );
#line 22671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  . ClearChild  ();
#line 22672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> Copy  (* m_pRideCharModelInstance );
#line 22675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DeleteModelInstance  (m_pRidePetModelInstance );
#line 22676 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  = NULL ;
#line 22677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRidePetModelInstance  = NULL ;
#line 22678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> mi_qvOffset  = mi_qvOffset ;
#line 22679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> mi_iParentBoneID  = mi_iParentBoneID ;
#line 22680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pCharacter  -> GetModelInstance  () -> NewClearState  (0.0f);
#line 22682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . Refresh  (& pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  , 1);
#line 22683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . Refresh  (& pCharacter  -> GetModelInstance  () -> m_tmSkaTagManager  , CStatusEffect  :: R_NONE );
#line 22684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . bWildPetRide  = FALSE ;
#line 22686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bRide  = FALSE ;
#line 22687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bWildRide  = FALSE ;
#line 22688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InitBeastAnimation  ();
#line 22690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
IdleAnim  ();
#line 22692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_WALKING );
#line 22693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_MODEL );
#line 22694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(pCharacter  -> IsCharacter  ())
#line 22696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(static_cast  < CCharacter  * > (pCharacter )) -> LeavingWildPet  (pCharacter );
#line 22699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetBodyAnimTime(float fAnimTime) 
#line 22703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  * penAnimator  = (CPlayerAnimator  *) ((CEntity  *) m_penAnimator );
#line 22705 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penAnimator  -> m_fBodyAnimTime  = fAnimTime ;
#line 22706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22708 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool CPlayer::IsSealPet(LONG * remain) 
#line 22709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . bPetRide  == TRUE )
#line 22711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyWearItem  [ WEAR_PET  ] . IsEmptyItem  () == FALSE )
#line 22713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lRemain  = UIMGR  () -> GetPetInfo  () -> GetRemainSealed  (_pNetwork  -> MyWearItem  [ WEAR_PET  ] . Item_Plus );
#line 22716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(lRemain  > 0)
#line 22717 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(remain  != NULL )
#line 22719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* remain ) = lRemain ;
#line 22721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return true ;
#line 22724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22728 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return false ;
#line 22729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
const BOOL CPlayer::IsMovable() 
#line 22735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LONG  lRemain ;
#line 22738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsSealPet  (& lRemain ) == true )
#line 22739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 22742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString str ;
#line 22743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
str  = _S  (6283 , "펫이 봉인되었기 때문에 이동할 수 없습니다. 펫을 해제하시기 바랍니다.");
#line 22744 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetChattingUI  () -> AddSysMessage  (str  , SYSMSG_ERROR );
#line 22746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
str  . PrintF  (_S  (2508 , "펫 봉인해제 시간이 %d시간 %d분 남았습니다.") , lRemain  / 3600 , (lRemain  % 3600) / 60);
#line 22747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UIMGR  () -> GetChattingUI  () -> AddSysMessage  (str  , SYSMSG_ERROR );
#line 22749 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bWildPetRide )
#line 22753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22757 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjInfo  * pInfo  = ObjInfo  :: getSingleton  ();
#line 22759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pInfo  -> GetMyApetInfo  () != NULL  && pInfo  -> GetMyApetInfo  () -> m_nStm  > 0)
#line 22760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> m_penRayHitTmp  = NULL ;
#line 22765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetRepairLegit(SLONG chainex,CCharacterTarget * Ct) 
#line 22769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity ;
#line 22772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (Ct  -> m_nIdxClient  , penTargetEntity ))
#line 22773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> SetSecondExtraFlagOn  (ENF_EX2_LEGIT );
#line 22775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Ct  -> SetLegitimate  (TRUE );
#line 22776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nLegit  = 1;
#line 22777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nPkMode  = 3;
#line 22778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SetLegit(UBYTE ubType,SLONG chaindex) 
#line 22782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . index  == chaindex )
#line 22784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubType  == MSG_RIGHT_ATTACK_ADD )
#line 22788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSecondExtraFlagOn  (ENF_EX2_LEGIT );
#line 22792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nLegit  = 1;
#line 22794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(ubType  == MSG_RIGHT_ATTACK_DELAY )
#line 22796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSecondExtraFlagOn  (ENF_EX2_LEGIT );
#line 22800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nLegit  = 2;
#line 22802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(ubType  == MSG_RIGHT_ATTACK_DEL )
#line 22804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetSecondExtraFlagOff  (ENF_EX2_LEGIT );
#line 22808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nLegit  = 0;
#line 22810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 22812 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 22813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22815 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = ACTORMGR  () -> GetObject  (eOBJ_CHARACTER  , chaindex );
#line 22817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 22818 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22821 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCharacterTarget  * pTarget  = static_cast  < CCharacterTarget  * > (pObject );
#line 22822 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity  = pObject  -> GetEntity  ();
#line 22824 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22826 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ubType  == MSG_RIGHT_ATTACK_ADD )
#line 22827 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22829 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> SetSecondExtraFlagOn  (ENF_EX2_LEGIT );
#line 22830 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> AddLegitList  (chaindex );
#line 22831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetLegitimate  (TRUE );
#line 22832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nLegit  = 1;
#line 22833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nPkMode  = 3;
#line 22834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (833 , "%s 에 대하여 정당방위가 성립되었습니다.") , pTarget  -> m_strName  . c_str  ());
#line 22835 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(ubType  == MSG_RIGHT_ATTACK_DELAY )
#line 22837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> SetSecondExtraFlagOn  (ENF_EX2_LEGIT );
#line 22841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nLegit  = 2;
#line 22842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (834 , "%s 에 대한 정당방위가 5초후 해제됩니다.") , pTarget  -> m_strName  . c_str  ());
#line 22843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(ubType  == MSG_RIGHT_ATTACK_DEL )
#line 22845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> SetSecondExtraFlagOff  (ENF_EX2_LEGIT );
#line 22848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> DelLegitList  (chaindex );
#line 22849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> SetLegitimate  (FALSE );
#line 22850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nLegit  = 0;
#line 22851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) penTargetEntity ) -> m_nPkMode  = 2;
#line 22852 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (835 , "%s 에 대한 정당방위가 해제되었습니다.") , pTarget  -> m_strName  . c_str  ());
#line 22853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22855 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage );
#line 22856 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22857 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22860 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsLegitTarget(CEntity * penEntity) 
#line 22861 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  == NULL  || ! (penEntity  -> GetFlags  () & ENF_ALIVE ) || ! (penEntity  -> IsCharacter  ()))
#line 22863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22864 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22865 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22868 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penEntity  -> IsSecondExtraFlagOn  (ENF_EX2_LEGIT ))
#line 22869 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22870 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 22871 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22872 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 22873 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22887 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 22890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::DisplayChangeErr(SBYTE err) 
#line 22891 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22893 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(err )
#line 22894 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22895 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_DEAD : 
#line 22896 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1015 , "죽은 상태에서는 변신할 수 없습니다."));
#line 22897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22898 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_SITDOWN : 
#line 22899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1016 , "앉은 상태에서는 변신할 수 없습니다."));
#line 22900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_WRAP : 
#line 22902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1017 , "이동장치 사용 중에는 변신할 수 없습니다."));
#line 22903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_SKILL : 
#line 22905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1018 , "스킬 사용 중에는 변신할 수 없습니다."));
#line 22906 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22907 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_EXCHANGE : 
#line 22908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1019 , "교환 중에는 변신할 수 없습니다."));
#line 22909 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_PARTY : 
#line 22911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1020 , "파티 신청 중에는 변신할 수 없습니다."));
#line 22912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_PK : 
#line 22914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1021 , "PK 중에는 변신할 수 없습니다."));
#line 22915 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22916 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_LEVEL : 
#line 22917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1022 , "변신할 수 있는 레벨이 아닙니다."));
#line 22918 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22919 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_ZONE : 
#line 22920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1023 , "현재의 지역에서는 사용할 수 없습니다."));
#line 22921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case MSG_CHANGE_ERR_BATTLE : 
#line 22923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1024 , "전투 중에는 변신할 수 없습니다."));
#line 22924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 22925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 22928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::CheckChangeCondition(INDEX level,INDEX zone) 
#line 22931 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22932 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsAlreadyDie  ())
#line 22933 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22934 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_DEAD );
#line 22935 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsSitting  ())
#line 22938 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22939 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_SITDOWN );
#line 22940 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22941 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22942 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(SE_Get_UIManagerPtr  () -> IsCSFlagOn  (CSF_TELEPORT ))
#line 22943 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_WRAP );
#line 22945 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsSkilling  ())
#line 22948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_SKILL );
#line 22950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsPvp  ())
#line 22953 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22954 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_PK );
#line 22955 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22956 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22957 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(IsAttacking  ())
#line 22958 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22959 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_BATTLE );
#line 22960 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22961 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22962 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(level  > _pNetwork  -> MyCharacterInfo  . level )
#line 22963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22964 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_LEVEL );
#line 22965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22967 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(zone  != g_slZone )
#line 22968 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22969 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DisplayChangeErr  (MSG_CHANGE_ERR_ZONE );
#line 22970 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22971 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22972 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bPlayAction )
#line 22973 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22974 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22975 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1013 , "사교동작 또는 액션 중에는 변신할 수 없습니다."));
#line 22976 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 22977 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22978 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22979 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bForward  || m_bKeyMove )
#line 22980 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22982 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (1014 , "이동 중에는 변신할 수 없습니다."));
#line 22983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 22984 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_bRide )
#line 22988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22989 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2584 , "애완동물을 타고 있는 중에는 변신할 수 없습니다."));
#line 22991 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 22992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 22993 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 22994 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(_pNetwork  -> MyCharacterInfo  . nEvocationIndex  > 0)
#line 22995 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 22996 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strSysMessage ;
#line 22997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strSysMessage  . PrintF  (_S  (2585 , "강신 중에는 변신할 수 없습니다."));
#line 22998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ClientSystemMessage  (strSysMessage  , SYSMSG_ERROR );
#line 22999 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE ;
#line 23000 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 23003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::AppearChaPolymoph(CEntity * pentity,INDEX mobindex) 
#line 23007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pentity  && pentity  -> IsCharacter  ())
#line 23009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pentity ) -> MonsterChange  (mobindex  , TRUE );
#line 23011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::TransfromPet(CEntity * pentity,INDEX mobIndex,INDEX mobSize) 
#line 23016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23017 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pentity  && pentity  -> IsPet  ())
#line 23018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(mobIndex  > 0)
#line 23020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT fmobSize  = 1.0f;
#line 23023 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(mobSize  > 0)
#line 23024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23025 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
fmobSize  = mobSize  * 0.1f;
#line 23026 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23028 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPet  *) pentity ) -> TransformPetModel  (mobIndex  , fmobSize );
#line 23029 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23030 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23031 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23032 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPet  *) pentity ) -> ReturnPetModel  ();
#line 23033 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23034 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ReturnTransformPet(CEntity * pentity) 
#line 23038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23039 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pentity  && pentity  -> IsPet  ())
#line 23040 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23041 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPet  *) pentity ) -> ReturnPetModel  ();
#line 23042 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23043 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::AppearChaTransform(CEntity * pEntity,INDEX iTransformType) 
#line 23047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pEntity  && pEntity  -> IsCharacter  ())
#line 23049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nType  = TransformInfo  () . GetType  (iTransformType );
#line 23051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCharacter  *) pEntity ) -> TransformSorcerer  (nType  , TRUE );
#line 23052 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23053 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 23055 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::StopPlayer() 
#line 23056 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23057 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 23058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 23060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
BOOL CPlayer::IsVisibleCheckAll(CEntity * penEntity) 
#line 23061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (penEntity  != NULL );
#line 23065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT3D vSource  , vTarget ;
#line 23066 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPositionCastRay  (this  , penEntity  , vSource  , vTarget );
#line 23068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vSource  (2) += 1.8f;
#line 23069 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
vTarget  (2) += 1.0f;
#line 23071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CCastRay  crRay  (this  , vSource  , vTarget );
#line 23072 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_ttHitModels  = CCastRay  :: TT_COLLISIONBOX ;
#line 23073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_bHitTranslucentPortals  = FALSE ;
#line 23074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pwoWorld  -> CastRay  (crRay );
#line 23076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(crRay  . cr_penHit  == NULL )
#line 23077 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 23079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(crRay  . cr_penHit  != NULL  && 
#line 23081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(crRay  . cr_penHit  -> IsCharacter  () || 
#line 23082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_penHit  -> IsEnemy  () || 
#line 23083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_penHit  -> IsPet  () || 
#line 23084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_penHit  -> IsSlave  () || 
#line 23085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_penHit  -> GetFlags  () & ENF_ALIVE  || 
#line 23086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
crRay  . cr_penHit  -> GetFlags  () & ENF_ITEM ))
#line 23087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE ;
#line 23089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return crRay  . cr_penHit  == penEntity ;
#line 23092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::PlAddAccessoryEffect(CEntity * penEntity,CCharacterTarget * pTarget) 
#line 23095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strEffectName  = CTString ("Item_support");
#line 23098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pTarget  == NULL )
#line 23099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 23102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . itemEffect  . AddAccessoryEffect  (strEffectName  , & pMI  -> m_tmSkaTagManager );
#line 23103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23105 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelInstance * pMI  = ((CCharacter  *) penEntity ) -> GetCurrentPlayerModelInstance  ();
#line 23108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pTarget  -> cha_itemEffect  . AddAccessoryEffect  (strEffectName  , & pMI  -> m_tmSkaTagManager );
#line 23109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 23113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::SetTarget(SLONG targetID,SBYTE targetType) 
#line 23114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetEntity ;
#line 23116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penPlEntity  = CEntity  :: GetPlayerEntity  (0);
#line 23117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerEntity  * penPlayerEntity  = static_cast  < CPlayerEntity  * > (penPlEntity );
#line 23119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ObjectBase  * pObject  = NULL ;
#line 23121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  i ;
#line 23122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(i  = 0;i  < eOBJ_MAX ;++ i )
#line 23123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23124 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pObject  = ACTORMGR  () -> GetObject  ((eOBJ_TYPE ) i  , targetID );
#line 23126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL ){
#line 23127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pObject  != NULL )
#line 23132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  = pObject  -> GetEntity  ();
#line 23135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  == NULL )
#line 23136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 23138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23140 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT MaxHealth  = ((CUnit  *) penTargetEntity ) -> m_nMaxiHealth ;
#line 23141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOAT CurrentHealth  = ((CUnit  *) penTargetEntity ) -> m_nCurrentHealth ;
#line 23142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  Level  = ((CUnit  *) penTargetEntity ) -> m_nMobLevel ;
#line 23143 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  mobIdx  = ((CUnit  *) penTargetEntity ) -> m_nMobDBIndex ;
#line 23144 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSyndicateType  = 0;
#line 23145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  nSyndicateGrade  = 0;
#line 23147 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkMode  = - 1;
#line 23148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkState ;
#line 23149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  PkLegit ;
#line 23150 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bool  bRet  = false ;
#line 23152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> en_pMobTarget  != NULL )
#line 23153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23154 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateType  = penTargetEntity  -> en_pMobTarget  -> mob_iSyndicateType ;
#line 23155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateGrade  = penTargetEntity  -> en_pMobTarget  -> mob_iSyndicateGrade ;
#line 23156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23157 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> IsCharacter  ())
#line 23158 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23159 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Level  = 0;
#line 23160 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkMode  = ((CCharacter  *) ((CEntity  *) penTargetEntity )) -> m_nPkMode ;
#line 23161 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkState  = ((CCharacter  *) ((CEntity  *) penTargetEntity )) -> m_nPkState ;
#line 23162 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PkLegit  = ((CCharacter  *) ((CEntity  *) penTargetEntity )) -> m_nLegit ;
#line 23164 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penTargetEntity  -> en_pCharacterTarget  != NULL )
#line 23165 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23166 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateType  = penTargetEntity  -> en_pCharacterTarget  -> cha_iSyndicateType ;
#line 23167 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
nSyndicateGrade  = penTargetEntity  -> en_pCharacterTarget  -> cha_iSyndicateGrade ;
#line 23168 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23169 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23171 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlayerEntity  -> SetTarget  (penTargetEntity );
#line 23172 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  (eTARGET );
#line 23174 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(PkMode  != - 1)
#line 23175 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23176 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRet  = penTargetEntity  -> SetTargetInfo  (MaxHealth  , CurrentHealth  , FALSE  , Level  , PkMode  , PkState  , PkLegit );
#line 23177 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23178 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
bRet  = penTargetEntity  -> SetTargetInfo  (MaxHealth  , CurrentHealth  , FALSE  , Level  , 0 , 0 , 0 , mobIdx );
#line 23181 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23183 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(bRet  == true )
#line 23184 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23185 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetEntity  -> SetTargetSyndicateInfo  (nSyndicateType  , nSyndicateGrade );
#line 23186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23188 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}

#line 23190 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
void CPlayer::RaidSceneOutputProcessing(SLONG slOutputType,INDEX iObjIndex,INDEX iData) 
#line 23191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
switch(slOutputType )
#line 23193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23194 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OUTPUT_PAUSE_AREA : 
#line 23195 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CZoneInfo  :: ObjInZone  * tmpData ;
#line 23198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tmpData  = CZoneInfo  :: getSingleton  () -> GetInZoneData  (iObjIndex )) != NULL )
#line 23199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpData  -> bActive )
#line 23201 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23202 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iData  == 1 && ! tmpData  -> bOnTrigger ){
#line 23204 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendTriggerEvent  (iObjIndex  , EET_TRIGGER );
#line 23205 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpData  -> bOnTrigger  = TRUE ;
#line 23206 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23207 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iData  == 0 && tmpData  -> bOnTrigger ){
#line 23209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendTriggerEvent  (iObjIndex  , EET_TRIGGER );
#line 23210 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpData  -> bOnTrigger  = FALSE ;
#line 23211 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23212 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23215 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23216 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OBJECT_TOUCH_FIELD : 
#line 23217 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23219 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OUTPUT_TOGGLE_GATE : 
#line 23222 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OBJECT_GATE : 
#line 23223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CZoneInfo  :: ObjInZone  * tmpData ;
#line 23226 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tmpData  = CZoneInfo  :: getSingleton  () -> GetInZoneData  (iObjIndex )) != NULL )
#line 23227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpData  -> bActive )
#line 23229 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23230 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetObject  = NULL ;
#line 23232 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (iObjIndex  , penTargetObject ))
#line 23233 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23234 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EDoorControll  eDoor ;
#line 23236 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iData  == 1 && ! tmpData  -> bOnTrigger ){
#line 23238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eDoor  . bOpen  = TRUE ;
#line 23239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (penTargetObject  , EET_DOORCONTROLL  , this  , & eDoor );
#line 23240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpData  -> bOnTrigger  = TRUE ;
#line 23241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iData  == 0 && tmpData  -> bOnTrigger ){
#line 23244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eDoor  . bOpen  = FALSE ;
#line 23245 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (penTargetObject  , EET_DOORCONTROLL  , this  , & eDoor );
#line 23246 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tmpData  -> bOnTrigger  = FALSE ;
#line 23247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23248 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23250 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23251 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23253 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OUTPUT_MODEL_HOLDER_PADOX : 
#line 23254 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OBJECT_PADOX_MODEL : 
#line 23255 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23256 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CZoneInfo  :: ObjInZone  * tmpData ;
#line 23258 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tmpData  = CZoneInfo  :: getSingleton  () -> GetInZoneData  (iObjIndex )) != NULL )
#line 23259 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23260 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpData  -> bActive )
#line 23261 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23262 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetObject  = NULL ;
#line 23263 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (iObjIndex  , penTargetObject ))
#line 23264 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23265 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EChangeAnim  eChangeAnim ;
#line 23267 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iData  == 1)
#line 23268 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23269 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eChangeAnim  . AnimType  = ACTION_APPEAR ;
#line 23270 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetObject  -> SendEvent  (eChangeAnim );
#line 23271 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23272 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iData  == 0)
#line 23273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23274 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eChangeAnim  . strAnimation  = CTString ("Padocs_appear");
#line 23275 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eChangeAnim  . AnimType  = ACTION_DISAPPEAR ;
#line 23276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetObject  -> SendEvent  (eChangeAnim );
#line 23277 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23280 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23281 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23283 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OUTPUT_TOGGLE_PORTAL : 
#line 23284 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OBJECT_PORTAL : 
#line 23285 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OBJECT_ITEM : 
#line 23286 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23287 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CZoneInfo  :: ObjInZone  * tmpData ;
#line 23289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tmpData  = CZoneInfo  :: getSingleton  () -> GetInZoneData  (iObjIndex )) != NULL )
#line 23290 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23291 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpData  -> bActive )
#line 23292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetObject  = NULL ;
#line 23295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (iObjIndex  , penTargetObject ))
#line 23296 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23297 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iData  == 1)
#line 23298 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23299 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendTriggerEvent  (iObjIndex  , EET_ACTIVATE );
#line 23300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23301 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(iData  == 0)
#line 23302 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23303 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendTriggerEvent  (iObjIndex  , EET_DEACTIVATE );
#line 23304 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23305 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23307 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23308 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23310 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
case OUTPUT_MODEL_NPC_SAY : 
#line 23311 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> GetChattingUI  () -> ShowNPCTalk  (iObjIndex  , iData );
#line 23313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
break ;
#line 23315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23316 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ReceiveRaidScene(CNetworkMessage * istr) 
#line 23319 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  subType ;
#line 23321 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> subType ;
#line 23323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(subType  == MSG_EX_RAID_SCENE_SEND_OUTPUT )
#line 23324 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23325 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  OutputType ;
#line 23326 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ObjIndex ;
#line 23327 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iData ;
#line 23329 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> OutputType  >> ObjIndex  >> iData ;
#line 23331 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RaidSceneOutputProcessing  (OutputType  , ObjIndex  , iData );
#line 23332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23333 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(subType  == MSG_EX_RAID_SCENE_SEND_PADOX_SKILL )
#line 23334 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CZoneInfo  :: ObjInZone  * tmpData ;
#line 23337 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((tmpData  = CZoneInfo  :: getSingleton  () -> GetInZoneData  (CTString ("PadocsObject"))) != NULL )
#line 23338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23339 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(tmpData  -> bActive )
#line 23340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetObject  = NULL ;
#line 23342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (tmpData  -> iObjectID  , penTargetObject ))
#line 23343 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23344 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EChangeAnim  eChangeAnim ;
#line 23345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eChangeAnim  . strAnimation  = "padocs_skill01";
#line 23346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eChangeAnim  . AnimType  = ACTION_SKILL ;
#line 23347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penTargetObject  -> SendEvent  (eChangeAnim );
#line 23348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23349 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23350 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(subType  == MSG_EX_RAID_SCENE_SEND_OBJECT_REFRESH )
#line 23353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23354 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  slType ;
#line 23355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ObjIndex  , iData ;
#line 23357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> slType  >> ObjIndex  >> iData ;
#line 23359 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RaidSceneOutputProcessing  (slType  , ObjIndex  , iData );
#line 23360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(subType  == MSG_EX_RAID_SCENE_SEND_OBJECT_ALL_STATE )
#line 23362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ZoneNo ;
#line 23364 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX nCount ;
#line 23365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  ObjectType ;
#line 23366 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX ObjIndex ;
#line 23367 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iData ;
#line 23369 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> ZoneNo  >> nCount ;
#line 23371 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(nCount  > 0)
#line 23372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(int  i  = 0;i  < nCount ;++ i )
#line 23374 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> ObjectType  >> ObjIndex  >> iData ;
#line 23377 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
RaidSceneOutputProcessing  (ObjectType  , ObjIndex  , iData );
#line 23378 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23380 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(subType  == MSG_EX_RAID_SCENE_SEND_COUNT_DOWN )
#line 23382 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SLONG  slSeconds ;
#line 23384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strCount ;
#line 23386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* istr ) >> slSeconds ;
#line 23388 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
strCount  . PrintF  (_S  (5101 , "%d초 후 파독스의 거처의 문이 닫힙니다") , slSeconds );
#line 23390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_UIAutoHelp  -> SetGMNotice  (strCount );
#line 23391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::SendTriggerEvent(INDEX iTarget,INDEX eetEventType) 
#line 23399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iTarget  == 0)
#line 23401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23402 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (m_pen3rdPersonView  , (EventEType ) eetEventType  , this );
#line 23403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return ;
#line 23404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23406 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penTargetObject  = NULL ;
#line 23407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> ga_World  . EntityExists  (iTarget  , penTargetObject ))
#line 23408 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23409 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (penTargetObject  , (EventEType ) eetEventType  , this );
#line 23410 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
void CPlayer::ReceiveTriggerEvent(INDEX iIn,INDEX iOut,INDEX iContinued,CNetworkMessage * iStr) 
#line 23418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iInputObject  = iIn ;
#line 23420 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iOutputObject  = iOut ;
#line 23423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * EntTriggerObjIn  = NULL  , * EntTriggerObjOut  = NULL ;
#line 23425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iIn  > 0)
#line 23426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EntTriggerObjIn  = _pNetwork  -> ga_World  . EntityFromID  (iIn );
#line 23428 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iOut  > 0)
#line 23431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EntTriggerObjOut  = _pNetwork  -> ga_World  . EntityFromID  (iOut );
#line 23433 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(EntTriggerObjIn  != NULL  && iContinued  == 0)
#line 23436 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (EntTriggerObjIn  , EET_TRIGGER  , this );
#line 23438 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(EntTriggerObjOut  != NULL )
#line 23441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23442 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (EntTriggerObjOut  , EET_TRIGGER  , this );
#line 23443 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23446 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iStr  != NULL )
#line 23447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23448 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iObjectCount  = 0;
#line 23449 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iActiveObj  = - 1;
#line 23450 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX i ;
#line 23452 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* iStr ) >> iObjectCount ;
#line 23454 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(i  = 0;i  < iObjectCount ;++ i )
#line 23455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(* iStr ) >> iActiveObj ;
#line 23457 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * EntObj  = _pNetwork  -> ga_World  . EntityFromID  (iActiveObj );
#line 23459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(EntObj  != NULL )
#line 23460 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23461 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (EntObj  , EET_TRIGGER  , NULL );
#line 23462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23463 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23464 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23465 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
CEntity * CPlayer::GetClickObject(void) 
#line 23474 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23475 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return m_penClickTarget  . ep_pen ;
#line 23476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
BOOL CPlayer::
#line 23483 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Main(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Main
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EPlayerInit, "CPlayer::Main expects 'EPlayerInit' as input!");	const EPlayerInit &ePLInit = (const EPlayerInit &)__eeInput;
#line 23485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . statusEffect  . SetType  (CStatusEffect  :: T_PLAYER );
#line 23487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
time  ((time_t  *) & m_iStartTime );
#line 23489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOn  (ENF_CLIENTHANDLING );
#line 23491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bInitializeOverNet  = FALSE ;
#line 23492 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ctUnreadMessages  = 0;
#line 23494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRiderModelInstance  = NULL ;
#line 23495 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRidePetModelInstance  = NULL ;
#line 23496 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pRideCharModelInstance  = NULL ;
#line 23497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_nWildPetType  = - 1;
#line 23499 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_CROSSESLEVELS  | ENF_NOTIFYLEVELCHANGE );
#line 23502 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAttackingEnemy  = NULL ;
#line 23505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl )
#line 23506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23507 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InitAsEditorModel  ();
#line 23508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23509 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23510 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InitAsSkaEditorModel  ();
#line 23512 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MOVABLE  | EPF_PUSHABLE  | EPF_RT_SYNCHRONIZED  | EPF_ABSOLUTETRANSLATE );
#line 23515 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ EPF_TRANSLATEDBYGRAVITY );
#line 23518 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CTString strDummy ;
#line 23520 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl )
#line 23521 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23522 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearance  (GetModelObject  () , NULL  , strDummy  , FALSE );
#line 23523 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23524 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23525 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23526 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(en_pmiModelInstance  == NULL )
#line 23527 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_pmiModelInstance  = CreateModelInstance  ("");
#line 23529 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearanceSka  (GetModelInstance  () , NULL  , strDummy  , FALSE  , en_pcCharacter  . pc_iPlayerType );
#line 23531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23535 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 23537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bMdl )
#line 23538 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 23540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23542 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CreateAnimAndBoneIDs  ();
#line 23546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPlayerAppearanceSka  (& m_miRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 23547 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ParseGender  (strDummy );
#line 23550 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOn  (ENF_RENDERREFLECTION );
#line 23566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ModelChangeNotify  ();
#line 23569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iWeaponsID  = ePLInit  . ulWeaponsID ;
#line 23570 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ePLInit  . bCreate ){
#line 23571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penWeapons  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_WEAPONS  , ePLInit  . ulWeaponsID  , FALSE );
#line 23572 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 23573 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penWeapons  = _pNetwork  -> ga_World  . EntityFromID  (m_iWeaponsID );
#line 23574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EWeaponsInit  eInitWeapons ;
#line 23576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInitWeapons  . eidOwner  = this ;
#line 23577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penWeapons  -> Initialize  (eInitWeapons  , FALSE );
#line 23579 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iAnimatorID  = ePLInit  . ulAnimatorID ;
#line 23581 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ePLInit  . bCreate ){
#line 23582 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAnimator  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_ANIMATOR  , ePLInit  . ulAnimatorID  , FALSE );
#line 23583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 23584 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAnimator  = _pNetwork  -> ga_World  . EntityFromID  (m_iAnimatorID );
#line 23585 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EAnimatorInit  eInitAnimator ;
#line 23587 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eInitAnimator  . eidPlayer  = this ;
#line 23588 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAnimator  -> Initialize  (eInitAnimator  , FALSE );
#line 23591 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_cmiComm  . IsNetworkOn  ())
#line 23592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23593 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pInput  -> m_bTcpIp  = TRUE ;
#line 23594 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(!(_pNetwork  -> IsServer  ())){ Jump(STATE_CURRENT,0x01910011, FALSE, EInternal());return TRUE;}
#line 23598 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(0.2f);
Jump(STATE_CURRENT, 0x0191000f, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191000f_Main_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191000f
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x01910010, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;

#line 23602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Destroy  ();
#line 23603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 23603 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23604 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 23606 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x01910010_Main_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910010
Jump(STATE_CURRENT,0x01910011, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910011_Main_03(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910011

#line 23610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SwitchToModel  ();
#line 23611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 23613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Particles_RunningDust_Prepare  (this );
#line 23616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_tmMaxHoldBreath  = 60.0f;
#line 23617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fDensity  = 1000.0f;
#line 23618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetHealth  (10000.0f);
#line 23619 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ModelChangeNotify  ();
#line 23622 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetModelInstance  ())
#line 23623 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23624 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CSkaTag  tag ;
#line 23625 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__ROOT");
#line 23626 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 23627 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 23628 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetName  ("__TOP");
#line 23629 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetRot  (GetEulerAngleFromQuaternion  (en_pmiModelInstance  -> mi_qvOffset  . qRot ));
#line 23630 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FLOATaabbox3D aabb ;
#line 23631 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> GetAllFramesBBox  (aabb );
#line 23632 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
tag  . SetOffsetPos  (0 , aabb  . Size  () (2) * GetModelInstance  () -> mi_vStretch  (2) , 0);
#line 23633 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetModelInstance  () -> m_tmSkaTagManager  . Register  (& tag );
#line 23634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23638 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , 1.0f);
#line 23639 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soFootL  . Set3DParameters  (20.0f , 2.0f , 1.0f , 1.0f);
#line 23640 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soFootR  . Set3DParameters  (20.0f , 2.0f , 1.0f , 1.0f);
#line 23641 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soBody  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 23642 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soMessage  . Set3DParameters  (30.0f , 5.0f , 1.0f , 1.0f);
#line 23651 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
try {
#line 23652 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_aoLightAnimation  . SetData_t  (CTFILENAME  ("Data\\Animations\\BasicEffects.ani"));
#line 23653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}catch  (char  * strError ){
#line 23654 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
WarningMessage  (TRANS  ("Cannot load Data\\Animations\\BasicEffects.ani: %s") , strError );
#line 23655 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
PlayLightAnim  (LIGHT_ANIM_NONE  , 0);
#line 23658 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x01910012, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910012_Main_04(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910012
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_FirstInit, TRUE, EVoid());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_ERebirth):{const ERebirth&e= (ERebirth&)__eeInput;

#line 23661 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 23662 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerRebirth  epr ;
#line 23663 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epr  . iRespawnInPlace  = m_ulFlags  & PLF_RESPAWNINPLACE ;
#line 23664 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (epr  , TRUE );
#line 23665 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;
#line 23666 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23667 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EPlayerRebirth):{const EPlayerRebirth&epr= (EPlayerRebirth&)__eeInput;

#line 23670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> IsServer  ()){
#line 23671 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(epr  . iRespawnInPlace ){
#line 23672 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_RESPAWNINPLACE ;
#line 23673 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 23674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 23675 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23677 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;
#line 23678 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23680 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDeath):{const EDeath&eDeath= (EDeath&)__eeInput;

#line 23682 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . hp  == 0)
#line 23683 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 23685 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerDeath  ePLDeath ;
#line 23686 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLDeath  . eidInflictor  = (CEntity  *) eDeath  . eLastDamage  . penInflictor ;
#line 23687 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLDeath  . vDirection  = eDeath  . eLastDamage  . vDirection ;
#line 23688 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLDeath  . vHitPoint  = eDeath  . eLastDamage  . vHitPoint ;
#line 23689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLDeath  . fAmount  = eDeath  . eLastDamage  . fAmount ;
#line 23690 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePLDeath  . dmtType  = eDeath  . eLastDamage  . dmtType ;
#line 23691 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (ePLDeath  , TRUE );
#line 23692 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_Death, TRUE, ePLDeath );return TRUE;
#line 23693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EPlayerDeath):{const EPlayerDeath&ePLDeath= (EPlayerDeath&)__eeInput;

#line 23698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> MyCharacterInfo  . hp  == 0)
#line 23699 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_Death, TRUE, ePLDeath );return TRUE;
#line 23703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23704 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDamage):{const EDamage&eDamage= (EDamage&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_Wounded, TRUE, eDamage );return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EPreLevelChange):
#line 23709 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EPreLevelChange&e= (EPreLevelChange&)__eeInput;

#line 23710 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_INITIALIZED ;
#line 23711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_CHANGINGLEVEL ;
#line 23712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_LEVELSTARTED ;
#line 23713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_DONTRENDER ;
#line 23714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
LevelChangePlayerClear  ();
#line 23715 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23716 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):
#line 23718 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;

#line 23719 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  || (GetFlags  () & ENF_ALIVE ))
#line 23720 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23721 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_WorldChange, TRUE, EVoid());return TRUE;
#line 23722 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23723 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23724 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23725 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_WorldChangeDead, TRUE, EVoid());return TRUE;
#line 23726 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23727 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EAutoLogin):
#line 23729 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EAutoLogin&eAutologin= (EAutoLogin&)__eeInput;

#line 23730 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(g_bAutoLogin  || g_bAutoRestart )
#line 23731 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23733 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GameDataManager  * pGameData  = GameDataManager  :: getSingleton  ())
#line 23734 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23735 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(CServerSelect  * pServerSelect  = pGameData  -> GetServerData  ())
#line 23736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
pServerSelect  -> ConnectToServer  (_cmiComm  . cci_szAddr  , _cmiComm  . cci_iPort );
#line 23738 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23739 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23740 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23741 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ECameraStart):
#line 23745 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const ECameraStart&eStart= (ECameraStart&)__eeInput;

#line 23746 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bDontLerpView  = TRUE ;
#line 23747 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = eStart  . penCamera ;
#line 23751 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _bLoginProcess )
#line 23752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CancelSkill  (TRUE  , g_iAutoAttack  , FALSE );
#line 23755 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopAttack  ();
#line 23756 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StopMove  ();
#line 23758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(SE_Get_UIManagerPtr  () -> IsVisibleUIs  ())
#line 23759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> ToggleVisibleUIs  ();
#line 23761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23764 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if((g_bAutoLogin  || g_bAutoRestart ) && STAGEMGR  () -> GetCurStage  () == eSTAGE_LOGIN )
#line 23765 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23766 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EAutoLogin  eAutologin ;
#line 23767 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (eAutologin  , TRUE );
#line 23768 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23770 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EStopLerp  eStop ;
#line 23771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eStop  . bActive  = FALSE ;
#line 23772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  -> SendEvent  (eStop  , TRUE );
#line 23775 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penActionMarker  == NULL )
#line 23776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 23778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 23779 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23781 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 23782 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ECameraStop):
#line 23785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const ECameraStop&eCameraStop= (ECameraStop&)__eeInput;

#line 23787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  BOOL _bWorldEditorApp ;
#line 23788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_bLoginProcess  && ! _bWorldEditorApp )
#line 23789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EStopLerp  eStop ;
#line 23791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eStop  . bActive  = TRUE ;
#line 23792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  -> SendEvent  (eStop  , TRUE );
#line 23793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  == eCameraStop  . penCamera )
#line 23794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23797 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23798 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 23800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23801 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  == eCameraStop  . penCamera )
#line 23802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! SE_Get_UIManagerPtr  () -> IsVisibleUIs  () && ! _bWorldEditorApp )
#line 23804 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23805 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SE_Get_UIManagerPtr  () -> ToggleVisibleUIs  ();
#line 23806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 23808 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23809 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23811 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EVoiceMessage):
#line 23831 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EVoiceMessage&eMsg= (EVoiceMessage&)__eeInput;

#line 23832 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SayVoiceMessage  (eMsg  . fnmMessage );
#line 23833 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23834 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&eke= (EKilledEnemy&)__eeInput;

#line 23836 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 23837 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPlayerKilledEnemy  epke ;
#line 23838 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epke  . eidEnemy  = eke  . penEnemy ;
#line 23839 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epke  . iScore  = eke  . iScore ;
#line 23840 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epke  . eCauseOfDeath  = eke  . eCauseOfDeath ;
#line 23841 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
epke  . eKillType  = eke  . eKillType ;
#line 23842 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendEvent  (epke  , TRUE );
#line 23843 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23844 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23845 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EPlayerKilledEnemy):
#line 23847 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EPlayerKilledEnemy&epke= (EPlayerKilledEnemy&)__eeInput;

#line 23848 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  += 1;
#line 23849 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_psGameStats  . ps_iKills  += 1;
#line 23850 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23851 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EWeaponChanged):
#line 23853 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const EWeaponChanged&e= (EWeaponChanged&)__eeInput;

#line 23862 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23863 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;

#line 23874 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UnsetTimer();Jump(STATE_CURRENT,0x01910013, FALSE, EInternal());return TRUE;
#line 23875 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ETouch):
#line 23878 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{const ETouch&eTouch= (ETouch&)__eeInput;

#line 23889 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 23890 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ESound):{const ESound&e= (ESound&)__eeInput;
return TRUE;}ASSERT(FALSE);break;default: return FALSE; break;
#line 23892 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x01910013_Main_05(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910013

#line 23897 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_ulKeys  != 0){
#line 23899 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * penNextPlayer  = NULL ;
#line 23900 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 23901 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayer  * pen  = (CPlayer  *) & * GetPlayerEntity  (iPlayer );
#line 23902 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(pen  != NULL  && pen  != this  && (pen  -> GetFlags  () & ENF_ALIVE ) && ! (pen  -> GetFlags  () & ENF_DELETED )){
#line 23903 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penNextPlayer  = pen ;
#line 23904 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23905 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23908 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penNextPlayer  != NULL ){
#line 23910 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s leaving, all keys transfered to %s\n") , 
#line 23911 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(const char  *) m_strName  , (const char  *) penNextPlayer  -> GetPlayerName  ());
#line 23912 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penNextPlayer  -> m_ulKeys  |= m_ulKeys ;
#line 23913 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23914 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23917 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SpawnTeleport  ();
#line 23920 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penWeapons  -> Destroy  (FALSE );
#line 23921 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penAnimator  -> Destroy  (FALSE );
#line 23922 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 23923 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penView  -> Destroy  (FALSE );
#line 23924 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23925 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 23926 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Destroy  (FALSE );
#line 23927 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23928 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Destroy  (FALSE );
#line 23929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 23929 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 23936 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Wounded(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Wounded
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EDamage, "CPlayer::Wounded expects 'EDamage' as input!");	const EDamage &eDamage = (const EDamage &)__eeInput;
#line 23937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 23937 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 23944 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
WorldChange(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_WorldChange
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::WorldChange expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 23946 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_dcEnemies  . Clear  ();
#line 23947 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  ())
#line 23948 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 23949 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetPvpMode  ();
#line 23950 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 23951 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 23952 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 23963 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 23965 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_strGroup  = _SwcWorldChange  . strGroup ;
#line 23966 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TeleportPlayer  ((WorldLinkType ) _SwcWorldChange  . iType  , TPC_WORLDCHANGED );
#line 23981 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_soWeaponAmbient  . Stop  ();
#line 23983 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerAnimator  () -> InitializeProperties  ();
#line 23986 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 23987 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 23988 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_CHANGINGLEVEL ;
#line 23990 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ShowCursor  (TRUE );
#line 23992 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INFO  () -> TargetClear  ();
#line 23997 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
extern  ENGINE_API  FLOAT g_fFramePerSecond ;
#line 23998 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
g_fFramePerSecond  = FLT_MAX ;
#line 24001 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
int  count  = CMobData  :: getsize  ();
#line 24002 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  && _pNetwork  -> m_bSingleMode  && count )
#line 24003 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24004 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntity  * penPlayer  = CEntity  :: GetPlayerEntity  (0);
#line 24005 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(std  :: find  (_pNetwork  -> ga_World  . m_vectorTargetNPC  . begin  () , 
#line 24006 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . m_vectorTargetNPC  . end  () , 
#line 24007 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penPlayer ) 
#line 24008 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
== _pNetwork  -> ga_World  . m_vectorTargetNPC  . end  ())
#line 24009 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24010 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> ga_World  . m_vectorTargetNPC  . push_back  (penPlayer );
#line 24011 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24012 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 24013 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24016 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
WorldChangeDead(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_WorldChangeDead
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::WorldChangeDead expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24018 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(IsPvp  ())
#line 24019 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24020 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> SetPvpMode  ();
#line 24021 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24024 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 24035 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 24038 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_Rebirth, TRUE;
Jump(STATE_CURRENT, 0x01910017, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910017_WorldChangeDead_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910017
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910018, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910018_WorldChangeDead_02(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910018
const EReturn&__e= (EReturn&)__eeInput;
;
#line 24046 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 24047 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 24048 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_CHANGINGLEVEL ;
#line 24049 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bLockMove  = FALSE ;
#line 24050 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bReserveMove  = FALSE ;
#line 24051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 24051 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24058 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Death(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Death
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EPlayerDeath, "CPlayer::Death expects 'EPlayerDeath' as input!");	const EPlayerDeath &ePLDeath = (const EPlayerDeath &)__eeInput;
#line 24060 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerSource  * ppls  = _pNetwork  -> GetPlayerSource  (this );
#line 24061 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(ppls  != NULL ){
#line 24062 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
for(INDEX iAction  = 0;iAction  < PLS_MAXLASTACTIONS ;iAction  ++){
#line 24063 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ppls  -> pls_apaLastActions  [ iAction  ] . Clear  ();
#line 24064 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24065 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24068 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iLastViewState  = m_iViewState ;
#line 24071 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlags  (GetFlags  () & ~ ENF_ALIVE );
#line 24073 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 24074 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 24076 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 24078 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! _pNetwork  -> MyCharacterInfo  . bExtension  || m_bMobChange )
#line 24079 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24080 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 24081 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24082 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 24083 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24084 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 24085 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24086 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24087 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24088 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24089 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24090 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24091 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24092 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24094 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 24095 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24096 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24097 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24098 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24099 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24100 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24101 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24102 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24103 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24104 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24106 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24107 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24108 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24109 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24110 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24111 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bRide )
#line 24112 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24113 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_bWildRide )
#line 24114 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24115 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_nWildPetType  == 2)
#line 24116 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24117 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24118 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24119 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24120 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24121 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_DEMONBAT_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24122 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24123 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24125 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(m_iRideType  % 2 == CPetInfo  :: PET_HORSE )
#line 24126 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24127 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_HORSE_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24128 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24129 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24130 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24131 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_RIDE_DRAGON_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24132 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24133 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24134 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else 
#line 24135 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24136 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ChangeWholeAnim  (idPlayerWhole_Animation  [ ANIM_EXT_DIE  ] , AN_NORESTART  , 1.0f , 0.2f , 1.0f);
#line 24137 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24138 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24141 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_CORPSE );
#line 24142 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_CORPSE );
#line 24145 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_fDensity  = 400.0f;
#line 24148 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 24149 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 24151 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("DeathWater");}
#line 24152 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 24153 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 24155 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("Death");}
#line 24156 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24179 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOn  (ENF_CLIENTHANDLING );
#line 24180 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iMayRespawn  = 0;
#line 24182 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(1.2f);
Jump(STATE_CURRENT, 0x0191001a, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191001a_Death_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001a
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;

#line 24186 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 24187 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;

#line 24191 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iMayRespawn  = 1;
#line 24192 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 24193 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDamage):{const EDamage&eDamage= (EDamage&)__eeInput;

#line 24196 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(eDamage  . dmtType  == DMT_ABYSS ){
#line 24197 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 24198 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  *) & * m_penView ) -> m_bFixed  = TRUE ;
#line 24199 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24200 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24208 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 24209 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDeath):{const EDeath&e= (EDeath&)__eeInput;
return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EEnd):{const EEnd&e= (EEnd&)__eeInput;

#line 24213 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UnsetTimer();Jump(STATE_CURRENT,0x0191001b, FALSE, EInternal());return TRUE;
#line 24214 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EAutoAction):{const EAutoAction&eAutoAction= (EAutoAction&)__eeInput;

#line 24218 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 24220 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(((CEntity  *) eAutoAction  . eidFirstMarker ) != NULL  && 
#line 24221 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerActionMarker  *) (CEntity  *) eAutoAction  . eidFirstMarker ) -> m_paaAction  == PAA_TELEPORT ){
#line 24223 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TeleportToAutoMarker  ((CPlayerActionMarker  *) (CEntity  *) eAutoAction  . eidFirstMarker );
#line 24224 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24225 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24227 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE;
#line 24228 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&e= (EKilledEnemy&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPlayerKilledEnemy):{const EPlayerKilledEnemy&e= (EPlayerKilledEnemy&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPreLevelChange):{const EPreLevelChange&e= (EPreLevelChange&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_ERebirth):{const ERebirth&e= (ERebirth&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x0191001b, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EPlayerRebirth):{const EPlayerRebirth&epr= (EPlayerRebirth&)__eeInput;

#line 24237 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_CLIENTHANDLING );
#line 24238 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(epr  . iRespawnInPlace ){
#line 24239 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_RESPAWNINPLACE ;
#line 24240 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 24241 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 24242 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24243 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;UnsetTimer();Jump(STATE_CURRENT,0x0191001b, FALSE, EInternal());return TRUE;
#line 24244 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EReturn):{const EReturn&e= (EReturn&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x0191001b, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 24247 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191001b_Death_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001b

#line 24249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,ERebirth  ());
#line 24249 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24252 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TheEnd(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_TheEnd
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::TheEnd expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24273 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 24276 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlags  (GetFlags  () & ~ ENF_ALIVE );
#line 24278 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 24279 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 24282 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 24289 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 24292 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEndOfGame  = TRUE ;
#line 24293 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetGameEnd  ();
#line 24295 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x0191001d, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191001d_TheEnd_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001d
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 24300 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191001e_TheEnd_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001e
 ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24306 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FirstInit(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_FirstInit
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::FirstInit expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24309 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = m_iLastViewState ;
#line 24312 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 24313 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 24314 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 24315 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24317 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 24320 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 24323 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InitializePlayer  (TRUE );
#line 24332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 24332 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24335 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Rebirth(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Rebirth
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::Rebirth expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24338 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_iViewState  = m_iLastViewState ;
#line 24340 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_RESPAWNINPLACE )){
#line 24341 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlayerWeapons  () -> ClearWeapons  ();
#line 24342 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24345 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 24346 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 24347 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 24348 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24351 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CEntityPointer penFlame  = GetChildOfClass  ("Flame");
#line 24352 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(penFlame  != NULL )
#line 24353 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24355 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EStopFlaming  esf ;
#line 24356 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
esf  . m_bNow  = TRUE ;
#line 24357 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
penFlame  -> SendEvent  (esf );
#line 24358 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24360 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 24361 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 24362 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 24363 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24365 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 24368 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
InitializePlayer  (FALSE );
#line 24370 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetFlagOff  (ENF_CLIENTHANDLING );
#line 24372 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GoTo  (_pNetwork  -> MyCharacterInfo  . x  , _pNetwork  -> MyCharacterInfo  . h  + 0.5f , _pNetwork  -> MyCharacterInfo  . z  , 
#line 24373 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
_pNetwork  -> MyCharacterInfo  . r );
#line 24375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24375 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24379 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoGoToMarker(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoGoToMarker
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoGoToMarker expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24381 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulFlags  = AOF_LOOPING  | AOF_NORESTART ;
#line 24383 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iAnim  = GetModelObject  () -> GetAnim  ();
#line 24384 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iAnim  != PLAYER_ANIM_STAND )
#line 24385 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24386 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulFlags  |= AOF_SMOOTHCHANGE ;
#line 24387 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24389 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24390 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . m_bAttacking  = FALSE ;
#line 24391 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyWalkAnimation  ();
#line 24392 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fAutoSpeed  > plr_fSpeed  / 2){
#line 24393 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_RUN  , ulFlags );
#line 24394 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 24395 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_NORMALWALK  , ulFlags );
#line 24396 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24399 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x01910024, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910024_AutoGoToMarker_03(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910024
if(!(
#line 24400 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 24401 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ) . Length  () > 1.0f)){ Jump(STATE_CURRENT,0x01910025, FALSE, EInternal());return TRUE;}
#line 24403 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x01910022, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910022_AutoGoToMarker_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910022
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910023, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910023_AutoGoToMarker_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910023
;Jump(STATE_CURRENT,0x01910024, FALSE, EInternal());return TRUE;
#line 24404 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}BOOL CPlayer::H0x01910025_AutoGoToMarker_04(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910025

#line 24407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24407 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24411 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoGoToMarkerAndStop(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoGoToMarkerAndStop
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoGoToMarkerAndStop expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24413 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ULONG  ulFlags  = AOF_LOOPING  | AOF_NORESTART ;
#line 24415 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
INDEX iAnim  = GetModelObject  () -> GetAnim  ();
#line 24416 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(iAnim  != PLAYER_ANIM_STAND )
#line 24417 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24418 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ulFlags  |= AOF_SMOOTHCHANGE ;
#line 24419 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24421 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24422 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyWalkAnimation  ();
#line 24423 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_fAutoSpeed  > plr_fSpeed  / 2){
#line 24424 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_RUN  , ulFlags );
#line 24425 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 24426 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_NORMALWALK  , ulFlags );
#line 24427 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24430 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x01910029, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910029_AutoGoToMarkerAndStop_03(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910029
if(!(
#line 24431 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
(m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 24432 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ) . Length  () > m_fAutoSpeed  * _pTimer  -> TickQuantum  * 2.00f)){ Jump(STATE_CURRENT,0x0191002a, FALSE, EInternal());return TRUE;}
#line 24434 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x01910027, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910027_AutoGoToMarkerAndStop_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910027
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910028, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910028_AutoGoToMarkerAndStop_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910028
;Jump(STATE_CURRENT,0x01910029, FALSE, EInternal());return TRUE;
#line 24435 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}BOOL CPlayer::H0x0191002a_AutoGoToMarkerAndStop_04(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002a

#line 24437 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fAutoSpeed  = 0.0f;
#line 24439 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24440 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyStillAnimation  ();
#line 24441 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , AOF_LOOPING  | AOF_NORESTART );
#line 24444 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ForceFullStop  ();
#line 24447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24447 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24451 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoUseItem(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoUseItem
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoUseItem expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24455 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24456 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyPullItemAnimation  ();
#line 24459 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(0.2f);
Jump(STATE_CURRENT, 0x0191002c, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191002c_AutoUseItem_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002c
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191002d, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191002d_AutoUseItem_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002d
;
#line 24462 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerActionMarker  * ppam  = GetActionMarker  ();
#line 24473 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(2.20f - 0.2f);
Jump(STATE_CURRENT, 0x0191002e, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191002e_AutoUseItem_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002e
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191002f, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191002f_AutoUseItem_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002f
;
#line 24476 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24477 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 24479 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL ){
#line 24481 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 24482 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24485 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penDoorController  != NULL ){
#line 24486 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
EPass  ePass ;
#line 24487 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ePass  . penOther  = this ;
#line 24488 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetActionMarker  () -> m_penDoorController  -> SendEvent  (ePass );
#line 24489 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24491 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(3.25f - 2.20f);
Jump(STATE_CURRENT, 0x01910030, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910030_AutoUseItem_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910030
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910031, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910031_AutoUseItem_06(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910031
;
#line 24493 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24494 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 24497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24497 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24501 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoPickItem(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoPickItem
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoPickItem expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24504 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24505 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyPickItemAnimation  ();
#line 24506 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_KEYLIFT  , 0);
#line 24508 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(1.2f);
Jump(STATE_CURRENT, 0x01910033, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910033_AutoPickItem_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910033
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910034, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910034_AutoPickItem_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910034
;
#line 24511 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL ){
#line 24513 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 24514 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24528 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(3.6f - 1.2f + GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910035, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910035_AutoPickItem_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910035
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910036, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910036_AutoPickItem_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910036
;
#line 24530 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24531 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 24534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24534 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24537 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoFallDown(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoFallDown
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoFallDown expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24539 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_BRIDGEFALLPOSE  , 0);
#line 24540 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24541 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_BRIDGEFALLPOSE  , 0);
#line 24543 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910038, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910038_AutoFallDown_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910038
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910039, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910039_AutoFallDown_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910039
;
#line 24546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24546 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24549 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoFallToAbys(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoFallToAbys
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoFallToAbys expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24551 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_ABYSSFALL  , AOF_LOOPING );
#line 24552 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24553 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_ABYSSFALL  , AOF_LOOPING );
#line 24555 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x0191003b, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191003b_AutoFallToAbys_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003b
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191003c, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191003c_AutoFallToAbys_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003c
;
#line 24558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24558 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24562 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoLookAround(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoLookAround
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoLookAround expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24564 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_BACKPEDAL  , 0);
#line 24565 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vAutoSpeed  = FLOAT3D (0 , 0 , plr_fSpeed  / 4 / 0.75f);
#line 24566 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24567 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_NORMALWALK  , 0);
#line 24569 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(GetModelObject  () -> GetCurrentAnimLength  () / 2);
Jump(STATE_CURRENT, 0x0191003e, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191003e_AutoLookAround_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003e
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191003f, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191003f_AutoLookAround_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003f
;
#line 24571 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_vAutoSpeed  = FLOAT3D (0 , 0 , 0);
#line 24574 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 24575 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24576 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_LOOKAROUND  , 0);
#line 24577 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24580 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(moBody  . GetCurrentAnimLength  () + 0.1f);
Jump(STATE_CURRENT, 0x01910040, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910040_AutoLookAround_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910040
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910041, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910041_AutoLookAround_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910041
;
#line 24583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24583 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24586 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
AutoTeleport(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoTeleport
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoTeleport expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24589 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
TeleportToAutoMarker  (GetActionMarker  ());
#line 24592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 24592 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 24596 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
DoAutoActions(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_DoAutoActions
	ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::DoAutoActions expects 'EVoid' as input!");	const EVoid &e = (const EVoid &)__eeInput;
#line 24599 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 24601 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24602 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . m_bDisableAnimating  = TRUE ;
#line 24605 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x0191007d, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007d_DoAutoActions_58(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007d
if(!(m_penActionMarker  != NULL  && IsOfClass  (m_penActionMarker  , "PlayerActionMarker"))){ Jump(STATE_CURRENT,0x0191007e, FALSE, EInternal());return TRUE;}
#line 24608 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(!(GetActionMarker  () -> m_paaAction  == PAA_WAIT )){ Jump(STATE_CURRENT,0x0191007c, FALSE, EInternal());return TRUE;}
#line 24610 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24611 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_WAIT  , AOF_NORESTART  | AOF_LOOPING );
#line 24613 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910044, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910044_DoAutoActions_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910044
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910045, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910045_DoAutoActions_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910045
;Jump(STATE_CURRENT,0x0191007b, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007c_DoAutoActions_57(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007c
if(!(GetActionMarker  () -> m_paaAction  == PAA_STOPANDWAIT )){ Jump(STATE_CURRENT,0x0191007a, FALSE, EInternal());return TRUE;}
#line 24616 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 24617 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 24618 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_WAIT  , AOF_NORESTART  | AOF_LOOPING );
#line 24620 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910046, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910046_DoAutoActions_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910046
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910047, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910047_DoAutoActions_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910047
;Jump(STATE_CURRENT,0x01910079, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007a_DoAutoActions_55(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007a
if(!(GetActionMarker  () -> m_paaAction  == PAA_INTROSE_SELECT_WEAPON )){ Jump(STATE_CURRENT,0x01910078, FALSE, EInternal());return TRUE;}
#line 24634 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 24635 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSelect  . iWeapon  = 1;
#line 24636 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );Jump(STATE_CURRENT,0x01910077, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910078_DoAutoActions_53(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910078
if(!(GetActionMarker  () -> m_paaAction  == PAA_TELEPORT )){ Jump(STATE_CURRENT,0x01910076, FALSE, EInternal());return TRUE;}
#line 24648 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoTeleport, TRUE;
Jump(STATE_CURRENT, 0x01910048, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910048_DoAutoActions_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910048
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoTeleport, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910049, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910049_DoAutoActions_06(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910049
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910075, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910076_DoAutoActions_51(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910076
if(!(GetActionMarker  () -> m_paaAction  == PAA_WAITFOREVER )){ Jump(STATE_CURRENT,0x01910074, FALSE, EInternal());return TRUE;}
#line 24653 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x0191004a, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004a_DoAutoActions_07(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004a
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;default:{return FALSE;}ASSERT(FALSE);break;
#line 24656 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191004b_DoAutoActions_08(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004b
Jump(STATE_CURRENT,0x01910073, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910074_DoAutoActions_49(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910074
if(!(GetActionMarker  () -> m_paaAction  == PAA_DRAWWEAPON )){ Jump(STATE_CURRENT,0x01910072, FALSE, EInternal());return TRUE;}
#line 24668 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 24669 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 4;
#line 24670 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );Jump(STATE_CURRENT,0x01910071, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910072_DoAutoActions_47(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910072
if(!(GetActionMarker  () -> m_paaAction  == PAA_LOOKAROUND )){ Jump(STATE_CURRENT,0x01910070, FALSE, EInternal());return TRUE;}
#line 24674 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoLookAround, TRUE;
Jump(STATE_CURRENT, 0x0191004c, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004c_DoAutoActions_09(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004c
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoLookAround, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191004d, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191004d_DoAutoActions_10(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004d
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191006f, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910070_DoAutoActions_45(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910070
if(!(GetActionMarker  () -> m_paaAction  == PAA_USEITEM )){ Jump(STATE_CURRENT,0x0191006e, FALSE, EInternal());return TRUE;}
#line 24679 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoUseItem, TRUE;
Jump(STATE_CURRENT, 0x0191004e, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004e_DoAutoActions_11(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004e
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoUseItem, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191004f, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191004f_DoAutoActions_12(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004f
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191006d, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191006e_DoAutoActions_43(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006e
if(!(GetActionMarker  () -> m_paaAction  == PAA_PICKITEM )){ Jump(STATE_CURRENT,0x0191006c, FALSE, EInternal());return TRUE;}
#line 24684 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoPickItem, TRUE;
Jump(STATE_CURRENT, 0x01910050, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910050_DoAutoActions_13(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910050
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoPickItem, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910051, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910051_DoAutoActions_14(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910051
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191006b, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191006c_DoAutoActions_41(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006c
if(!(GetActionMarker  () -> m_paaAction  == PAA_FALLDOWN )){ Jump(STATE_CURRENT,0x0191006a, FALSE, EInternal());return TRUE;}
#line 24689 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoFallDown, TRUE;
Jump(STATE_CURRENT, 0x01910052, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910052_DoAutoActions_15(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910052
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoFallDown, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910053, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910053_DoAutoActions_16(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910053
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910069, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191006a_DoAutoActions_39(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006a
if(!(GetActionMarker  () -> m_paaAction  == PAA_RELEASEPLAYER )){ Jump(STATE_CURRENT,0x01910068, FALSE, EInternal());return TRUE;}
#line 24693 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 24694 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CCamera  *) & * m_penCamera ) -> m_bStopMoving  = TRUE ;
#line 24695 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24696 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 24698 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_iCurrentWeapon  == WEAPON_NONE ){
#line 24700 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 24701 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 4;
#line 24702 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 24703 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24706 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmSpiritStart  = 0;Jump(STATE_CURRENT,0x01910067, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910068_DoAutoActions_37(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910068
if(!(GetActionMarker  () -> m_paaAction  == PAA_STARTCOMPUTER )){ Jump(STATE_CURRENT,0x01910066, FALSE, EInternal());return TRUE;}
#line 24711 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ) && GetSP  () -> sp_bSinglePlayer ){
#line 24712 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 24713 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_bInitialStart  = TRUE ;
#line 24714 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x01910065, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910066_DoAutoActions_35(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910066
if(!(GetActionMarker  () -> m_paaAction  == PAA_RUN )){ Jump(STATE_CURRENT,0x01910064, FALSE, EInternal());return TRUE;}
#line 24736 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fAutoSpeed  = plr_fSpeed  * GetActionMarker  () -> m_fSpeed ;
#line 24737 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoGoToMarker, TRUE;
Jump(STATE_CURRENT, 0x01910054, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910054_DoAutoActions_17(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910054
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoGoToMarker, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910055, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910055_DoAutoActions_18(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910055
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910063, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910064_DoAutoActions_33(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910064
if(!(GetActionMarker  () -> m_paaAction  == PAA_RUNANDSTOP )){ Jump(STATE_CURRENT,0x01910062, FALSE, EInternal());return TRUE;}
#line 24742 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fAutoSpeed  = plr_fSpeed  * GetActionMarker  () -> m_fSpeed ;
#line 24743 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
STATE_CPlayer_AutoGoToMarkerAndStop, TRUE;
Jump(STATE_CURRENT, 0x01910056, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910056_DoAutoActions_19(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910056
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoGoToMarkerAndStop, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910057, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910057_DoAutoActions_20(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910057
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910061, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910062_DoAutoActions_31(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910062
if(!(GetActionMarker  () -> m_paaAction  == PAA_RECORDSTATS )){ Jump(STATE_CURRENT,0x01910060, FALSE, EInternal());return TRUE;}
#line 24748 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  || GetSP  () -> sp_bPlayEntireGame ){
#line 24750 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_tmEstTime  = GetActionMarker  () -> m_tmWait ;
#line 24752 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else {
#line 24753 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetGameEnd  ();
#line 24754 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x0191005f, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910060_DoAutoActions_29(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910060
if(!(GetActionMarker  () -> m_paaAction  == PAA_SHOWSTATS )){ Jump(STATE_CURRENT,0x0191005e, FALSE, EInternal());return TRUE;}
#line 24758 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(!(cmp_ppenPlayer  == NULL  && _pNetwork  -> IsPlayerLocal  (this ) && GetSP  () -> sp_bSinglePlayer )){ Jump(STATE_CURRENT,0x0191005c, FALSE, EInternal());return TRUE;}
#line 24759 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEndOfLevel  = TRUE ;
#line 24760 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 24761 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  |= PLF_DONTRENDER ;
#line 24762 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x0191005a, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191005a_DoAutoActions_23(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005a
if(!(m_bEndOfLevel )){ Jump(STATE_CURRENT,0x0191005b, FALSE, EInternal());return TRUE;}
#line 24763 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x01910058, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910058_DoAutoActions_21(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910058
switch(__eeInput.ee_slEvent){case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x01910059, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EPreLevelChange):{const EPreLevelChange&e= (EPreLevelChange&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;

#line 24769 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(_pNetwork  -> IsServer  ()){
#line 24771 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_bEndOfLevel  = FALSE ;
#line 24772 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24773 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return FALSE;
#line 24774 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 24776 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x01910059_DoAutoActions_22(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910059
Jump(STATE_CURRENT,0x0191005a, FALSE, EInternal());return TRUE;
#line 24777 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}BOOL CPlayer::H0x0191005b_DoAutoActions_24(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005b

#line 24778 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_ulFlags  &= ! PLF_DONTRENDER ;Jump(STATE_CURRENT,0x0191005c, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191005c_DoAutoActions_25(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005c
Jump(STATE_CURRENT,0x0191005d, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191005e_DoAutoActions_27(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005e
if(GetActionMarker  () -> m_paaAction  == PAA_ENDOFGAME ){
#line 24783 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Jump(STATE_CURRENT, STATE_CPlayer_TheEnd, TRUE, EVoid());return TRUE;
#line 24784 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(GetActionMarker  () -> m_paaAction  == PAA_NOGRAVITY ){
#line 24785 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 24786 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> GetParent  () != NULL )
#line 24787 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
{
#line 24788 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetParent  (GetActionMarker  () -> GetParent  ());
#line 24789 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24790 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}else if(GetActionMarker  () -> m_paaAction  == PAA_TURNONGRAVITY ){
#line 24791 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY );
#line 24792 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SetParent  (NULL );
#line 24793 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24794 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
else if(TRUE ){
#line 24795 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
ASSERT  (FALSE );
#line 24796 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x0191005d, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191005d_DoAutoActions_26(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005d
Jump(STATE_CURRENT,0x0191005f, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191005f_DoAutoActions_28(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005f
Jump(STATE_CURRENT,0x01910061, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910061_DoAutoActions_30(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910061
Jump(STATE_CURRENT,0x01910063, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910063_DoAutoActions_32(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910063
Jump(STATE_CURRENT,0x01910065, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910065_DoAutoActions_34(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910065
Jump(STATE_CURRENT,0x01910067, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910067_DoAutoActions_36(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910067
Jump(STATE_CURRENT,0x01910069, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910069_DoAutoActions_38(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910069
Jump(STATE_CURRENT,0x0191006b, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191006b_DoAutoActions_40(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006b
Jump(STATE_CURRENT,0x0191006d, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191006d_DoAutoActions_42(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006d
Jump(STATE_CURRENT,0x0191006f, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191006f_DoAutoActions_44(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006f
Jump(STATE_CURRENT,0x01910071, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910071_DoAutoActions_46(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910071
Jump(STATE_CURRENT,0x01910073, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910073_DoAutoActions_48(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910073
Jump(STATE_CURRENT,0x01910075, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910075_DoAutoActions_50(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910075
Jump(STATE_CURRENT,0x01910077, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910077_DoAutoActions_52(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910077
Jump(STATE_CURRENT,0x01910079, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910079_DoAutoActions_54(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910079
Jump(STATE_CURRENT,0x0191007b, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191007b_DoAutoActions_56(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007b

#line 24799 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL  && 
#line 24800 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
GetActionMarker  () -> m_paaAction  != PAA_PICKITEM ){
#line 24802 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 24803 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}
#line 24806 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penActionMarker  = GetActionMarker  () -> m_penTarget ;Jump(STATE_CURRENT,0x0191007d, FALSE, EInternal());return TRUE;
#line 24807 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
}BOOL CPlayer::H0x0191007e_DoAutoActions_59(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007e

#line 24810 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_fAutoSpeed  = 0.0f;
#line 24813 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
m_penActionMarker  = NULL ;
#line 24816 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 24817 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
plan  . m_bDisableAnimating  = FALSE ;
#line 24820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid  ());
#line 24820 "F:/SD-Source/mandra/Reco_Csrc/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};